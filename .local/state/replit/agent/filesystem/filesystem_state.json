{"file_contents":{"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2765,"size_tokens":null},"replit.md":{"content":"# Overview\n\nThe Infod Trading Partner System is a professional financial analysis platform designed for real-time market scanning, signal generation, trade history tracking, and advanced analytics. It specializes in Smart Money Concepts (SMC), multi-timeframe analysis, and various trading strategies including scalping, day trading, swing trading, and Opening Range Breakout (ORB). The system provides a Bloomberg Terminal-inspired interface, optimized for displaying dense financial information and supporting high-frequency trading decisions. Its primary purpose is to empower traders with sophisticated tools for identifying and acting on market opportunities.\n\n# User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n# System Architecture\n\n## Frontend\n- **Framework**: React 18 with TypeScript, using Vite for building.\n- **UI/UX**: Radix UI with shadcn/ui components, styled with Tailwind CSS, featuring a dark-mode palette inspired by financial trading colors (blue, green, red, amber) and Inter font for readability. Card-based layouts with an 18rem sidebar and mobile-first responsive design.\n- **State Management**: TanStack React Query for data fetching and caching.\n- **Routing**: Wouter for client-side navigation.\n\n## Backend\n- **Runtime**: Node.js with Express.js, written in TypeScript.\n- **Session Management**: PostgreSQL-backed sessions using `connect-pg-simple`.\n\n## Data Storage\n- **Database**: PostgreSQL, hosted on Neon serverless.\n- **ORM**: Drizzle ORM with Zod for schema validation.\n- **Data**: Stores comprehensive trade history, real-time trading metrics, and scraped economic calendar data (15-minute cache, 7-day retention).\n\n## Real-time Capabilities\n- **Market Data**: Live price feeds for various asset classes via Python/tessa integration (Yahoo Finance, CoinGecko).\n- **Session Monitoring**: Real-time tracking of major trading sessions (London, New York, Tokyo, Sydney).\n- **Signal Generation**: Live scanning and notification system for trading opportunities, utilizing a modular strategy engine.\n- **In-App Notifications**: PostgreSQL-backed system for trading sessions, economic events, and signals, with real-time updates.\n- **Telegram Notifications**: Critical alerts for trading sessions and high/medium impact economic events via `node-telegram-bot-api`.\n\n## Trading Analysis Framework\n- **Methodologies**: Multi-timeframe analysis (1D, 4H, 30M, 15M, 1M), institutional candle patterns, Fair Value Gaps (FVG), order blocks, liquidity sweeps, Supply/Demand zone detection, and Change of Character (CHoCH) detection.\n- **Risk Management**: Integrated stop-loss/take-profit with risk-reward ratios.\n- **Strategy Engine**: Modular architecture (`server/strategies/`) allowing independent, isolated strategies with shared utilities (zone detection, swing points, candle patterns, multi-timeframe data).\n- **SMC Strategy Implementation**: A 5-step adaptive timeframe analysis process (Clarity Analysis, Context Analysis, Zone Detection, Zone Refinement, Entry Detection with LTF Confirmation) focusing on quality setups with confidence scoring.\n\n## AI Integration (Google Gemini)\n- **Role**: Gemini acts as an ASSISTANT for signal validation, confidence adjustment, risk assessment, and quick market scans for the refined SMC strategy.\n- **Critical Validation Rules**: Enforces no counter-trend trading unless CHoCH is confirmed, avoids unclear markets, and ensures trend alignment for signals.\n\n## PNG Chart Generation\n- **Functionality**: Generates professional, dark-themed trading charts with supply/demand zones, entry/SL/TP markers, and confidence percentages for Telegram. Utilizes `mplfinance` and `matplotlib` in Python.\n\n## Real-Time Signal Management\n- **Scanning**: Scans 62 instruments every minute using the modular strategy engine.\n- **Lifecycle**: Signals move through stages (Forming, Monitoring, Ready, Active, Expired, Archived). Active signals have a 4-hour expiry.\n- **Watchlist & Monitoring**: Tracks pending signals and monitors active signals for SL/TP hits, automatically archiving outcomes.\n\n## Trading Journal\n- **Purpose**: Records only confirmed/executed trades when signals hit stop-loss or take-profit levels.\n- **Persistent Storage**: Uses PostgreSQL database for unlimited trade history (no more 60-trade limit from in-memory storage).\n- **Journal Fields**: Symbol, type, strategy, entry/exit prices, stop-loss, take-profit, P&L, risk-reward ratio, duration, entry reason, lessons learned, asset class.\n- **Filtering**: Time-based filters (Today, Week, Month, All Time) and outcome filters (Wins/Losses).\n- **Statistics**: Total P&L, win rate, average win/loss, profit factor, wins/losses count.\n- **Export**: CSV export functionality for further analysis.\n\n# External Dependencies\n\n## UI and Component Libraries\n- **@radix-ui/**: Accessible UI primitives.\n- **class-variance-authority**: Type-safe styling variants.\n- **cmdk**: Command palette.\n- **embla-carousel-react**: Touch-friendly carousels.\n- **lucide-react**: Icon library.\n\n## Database and Data Management\n- **@neondatabase/serverless**: Serverless PostgreSQL.\n- **drizzle-orm**: Type-safe ORM.\n- **drizzle-zod**: Schema validation.\n- **connect-pg-simple**: PostgreSQL session store.\n- **@tanstack/react-query**: Data fetching and caching.\n\n## Web Scraping and Data Collection\n- **cheerio**: HTML parsing.\n- **axios**: HTTP client.\n- **node-cron**: Task scheduler.\n\n## AI and Analysis\n- **@google/genai**: Google Gemini AI SDK.\n- **mplfinance**: Python library for generating trading charts.\n- **matplotlib**: Chart rendering backend.\n- **tessa**, **yfinance**, **pycoingecko** (Python libraries): Market data fetching.\n\n## External APIs\n- **Google Gemini API**: AI-powered signal validation and market scanning.\n- **Yahoo Finance**: Free price data for stocks, forex, commodities.\n- **CoinGecko**: Free cryptocurrency price data.\n- **Telegram Bot API**: Signal notifications with PNG charts.\n- **MyFXBook**: Primary economic calendar data source (web scraped). Located at `server/scrapers/economicCalendarScraper.ts` with scheduled scraping pre-London session (7:50 UTC), pre-NY session (14:20 UTC), and every 2 hours on weekdays.","path":null,"size_bytes":6186,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5741,"size_tokens":null},"client/src/pages/Dashboard.tsx":{"content":"import TradingSession from '@/components/TradingSession';\nimport { Search } from 'lucide-react';\nimport { useQuery } from '@tanstack/react-query';\nimport SignalCard from '@/components/SignalCard';\nimport StockSignalCard from '@/components/StockSignalCard';\nimport WatchlistCard from '@/components/WatchlistCard';\nimport SectionHeader from '@/components/SectionHeader';\nimport { Zap, Activity, Bookmark } from 'lucide-react';\nimport type { TradingSignal, PendingSetup } from '@shared/schema';\n\nexport default function Dashboard() {\n  const { data: allSignals = [], isLoading: signalsLoading } = useQuery<TradingSignal[]>({\n    queryKey: ['/api/trading-signals'],\n    refetchInterval: 10000,\n  });\n\n  const { data: pendingSetups = [], isLoading: setupsLoading } = useQuery<PendingSetup[]>({\n    queryKey: ['/api/pending-setups'],\n    refetchInterval: 15000,\n  });\n\n  // Filter active signals (all timeframes confirmed) vs watchlist (HTF only)\n  const activeSignals = allSignals.filter(s => s.status === 'active');\n  const watchlistSignals = allSignals.filter(s => s.status === 'watchlist' || s.status === 'pending');\n  \n  // Split active signals by asset class\n  const activeCurrencySignals = activeSignals.filter(s => {\n    const assetClass = s.assetClass?.toLowerCase();\n    return assetClass === 'forex' || assetClass === 'crypto' || assetClass === 'commodity';\n  });\n  const activeStockSignals = activeSignals.filter(s => s.assetClass?.toLowerCase() === 'stock' || s.assetClass?.toLowerCase() === 'index');\n  \n  // Split watchlist signals by asset class\n  const watchlistCurrencySignals = watchlistSignals.filter(s => {\n    const assetClass = s.assetClass?.toLowerCase();\n    return assetClass === 'forex' || assetClass === 'crypto' || assetClass === 'commodity';\n  });\n  const watchlistStockSignals = watchlistSignals.filter(s => s.assetClass?.toLowerCase() === 'stock' || s.assetClass?.toLowerCase() === 'index');\n  \n  // Pending setups from scanner (not yet saved as signals)\n  const pendingWatchlistItems = pendingSetups.filter(s => s.readyForSignal !== true);\n\n  return (\n    <div>\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6\">\n        {/* Search Bar */}\n        <div className=\"border border-blue-500/50 bg-card dark:bg-background rounded-none shadow-md\" style={{ fontFamily: \"'Montserrat', sans-serif\" }}>\n          <div className=\"relative flex items-center py-4 px-6\">\n            <Search className=\"h-5 w-5 text-muted-foreground mr-4\" />\n            <input\n              type=\"text\"\n              placeholder=\"Search markets, pairs, or signals...\"\n              className=\"flex-grow bg-transparent text-sm text-foreground placeholder-muted-foreground focus:outline-none\"\n              data-testid=\"input-search\"\n            />\n          </div>\n        </div>\n\n        {/* Trading Sessions */}\n        <TradingSession />\n\n        {/* Full-Width Sections - NO SIDEBARS */}\n        <div className=\"space-y-8\">\n          \n          {/* Section 1: Active Currency, Metals & Crypto Signals - ALL 4 TIERS CONFIRMED */}\n          <section className=\"bg-card border-t-2 border-bull-green\">\n            <SectionHeader \n              icon={Zap} \n              title=\"Active Signals - Currency, Metals & Crypto\" \n              countLabel={`${activeCurrencySignals.length} Confirmed`}\n              variant=\"confirmed\"\n            />\n            <p className=\"px-6 py-1.5 text-[10px] text-muted-foreground/50 border-b border-border/30 italic\">\n              1D Context + Major Zone (4H/2H/1H) + Zone ID (30M/15M) + Entry Trigger (5M/3M/1M) all confirmed\n            </p>\n            <div className=\"flex flex-col\">\n              {signalsLoading ? (\n                <div className=\"p-8 text-center text-muted-foreground\">Loading signals...</div>\n              ) : activeCurrencySignals.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground/70 text-sm\">No confirmed signals - waiting for entry trigger on 5M/3M/1M</div>\n              ) : (\n                activeCurrencySignals.slice(0, 10).map(signal => (\n                  <SignalCard key={signal.id} signal={signal} />\n                ))\n              )}\n            </div>\n          </section>\n\n          {/* Section 2: Active Stock & Index Signals - ALL 4 TIERS CONFIRMED */}\n          <section className=\"bg-card border-t-2 border-bull-green\">\n            <SectionHeader \n              icon={Zap} \n              title=\"Active Signals - Stocks & Indices\" \n              countLabel={`${activeStockSignals.length} Confirmed`}\n              variant=\"confirmed\"\n            />\n            <p className=\"px-6 py-1.5 text-[10px] text-muted-foreground/50 border-b border-border/30 italic\">\n              1D Context + Major Zone (4H/2H/1H) + Zone ID (30M/15M) + Entry Trigger (5M/3M/1M) all confirmed\n            </p>\n            <div className=\"flex flex-col\">\n              {signalsLoading ? (\n                <div className=\"p-8 text-center text-muted-foreground\">Loading stock signals...</div>\n              ) : activeStockSignals.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground/70 text-sm\">No confirmed stock signals - waiting for entry trigger on 5M/3M/1M</div>\n              ) : (\n                activeStockSignals.slice(0, 10).map(signal => (\n                  <StockSignalCard key={signal.id} signal={signal} />\n                ))\n              )}\n            </div>\n          </section>\n\n          {/* Section 3: Watchlist - 3 TIERS CONFIRMED, AWAITING ENTRY TRIGGER */}\n          <section className=\"bg-card border-t-2 border-amber-500\">\n            <SectionHeader \n              icon={Bookmark} \n              title=\"Watchlist - Awaiting Entry Trigger\" \n              countLabel={`${watchlistCurrencySignals.length + watchlistStockSignals.length + pendingWatchlistItems.length} Pending`}\n              variant=\"pending\"\n            />\n            <p className=\"px-6 py-1.5 text-[10px] text-muted-foreground/50 border-b border-border/30 italic\">\n              1D Context + Major Zone (4H/2H/1H) + Zone ID (30M/15M) confirmed. Watching 5M/3M/1M for entry trigger.\n            </p>\n            <div className=\"flex flex-col\">\n              {signalsLoading ? (\n                <div className=\"p-8 text-center text-muted-foreground\">Loading watchlist...</div>\n              ) : (watchlistCurrencySignals.length + watchlistStockSignals.length + pendingWatchlistItems.length) === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground/70 text-sm\">No pending setups - scanning for major zones on 4H/2H/1H...</div>\n              ) : (\n                <>\n                  {watchlistCurrencySignals.slice(0, 5).map(signal => (\n                    <SignalCard key={signal.id} signal={signal} isWatchlist={true} />\n                  ))}\n                  {watchlistStockSignals.slice(0, 5).map(signal => (\n                    <StockSignalCard key={signal.id} signal={signal} isWatchlist={true} />\n                  ))}\n                  {pendingWatchlistItems.slice(0, 5).map(item => (\n                    <WatchlistCard key={`pending-${item.symbol}-${item.id}`} item={item} />\n                  ))}\n                </>\n              )}\n            </div>\n          </section>\n\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":7321,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1056,"size_tokens":null},"client/src/components/ThemeToggle.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Moon, Sun } from 'lucide-react';\n\nexport default function ThemeToggle() {\n  const [theme, setTheme] = useState<'light' | 'dark'>('dark');\n\n  useEffect(() => {\n    const savedTheme = localStorage.getItem('theme') as 'light' | 'dark' | null;\n    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;\n    const initialTheme = savedTheme || (prefersDark ? 'dark' : 'light');\n    \n    setTheme(initialTheme);\n    document.documentElement.classList.toggle('dark', initialTheme === 'dark');\n  }, []);\n\n  const toggleTheme = () => {\n    const newTheme = theme === 'light' ? 'dark' : 'light';\n    setTheme(newTheme);\n    localStorage.setItem('theme', newTheme);\n    document.documentElement.classList.toggle('dark', newTheme === 'dark');\n    console.log(`Theme switched to ${newTheme}`);\n  };\n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"icon\"\n      onClick={toggleTheme}\n      className=\"w-9 h-9\"\n      data-testid=\"button-theme-toggle\"\n    >\n      {theme === 'light' ? (\n        <Moon className=\"w-4 h-4\" />\n      ) : (\n        <Sun className=\"w-4 h-4\" />\n      )}\n    </Button>\n  );\n}","path":null,"size_bytes":1219,"size_tokens":null},"design_guidelines.md":{"content":"# Infod Trading Partner System - Design Guidelines\n\n## Design Approach\n**Selected Approach**: Design System (Material Design) with Financial Trading Industry References\n**Justification**: This is a utility-focused, information-dense financial application requiring maximum efficiency and data clarity. Drawing inspiration from Bloomberg Terminal, TradingView, and MetaTrader interfaces.\n\n**Key Design Principles**:\n- Data-first hierarchy with clear visual separation\n- High contrast for critical trading information\n- Minimal cognitive load through consistent patterns\n- Professional, trustworthy aesthetic\n\n## Core Design Elements\n\n### A. Color Palette\n**Dark Mode Primary** (default):\n- Background: 210 15% 8%\n- Surface: 210 12% 12% \n- Primary: 210 100% 60% (trading blue)\n- Success: 120 60% 50% (profit green)\n- Danger: 0 75% 60% (loss red)\n- Warning: 45 90% 60% (alert amber)\n- Text Primary: 210 15% 95%\n- Text Secondary: 210 10% 70%\n\n**Light Mode**:\n- Background: 210 15% 98%\n- Surface: 210 10% 95%\n- Text Primary: 210 15% 15%\n\n### B. Typography\n**Font Stack**: Inter (Google Fonts) for optimal number readability\n- Headers: 600 weight, 24px-32px\n- Body: 400 weight, 14px-16px  \n- Data/Numbers: 500 weight, 14px (tabular numbers)\n- Labels: 500 weight, 12px uppercase\n\n### C. Layout System\n**Spacing Units**: Consistent use of 4, 8, 16, 24 units\n- Component padding: p-4, p-6\n- Section margins: m-8, m-12\n- Grid gaps: gap-4, gap-6\n\n### D. Component Library\n\n**Dashboard Layout**:\n- 12-column grid system with breakpoints\n- Sidebar navigation (240px fixed width)\n- Main content area with card-based modules\n- Status bar showing active session and connection\n\n**Data Display Components**:\n- Market overview cards with price, change, volume\n- Economic calendar table with impact indicators\n- Signal cards showing entry/exit levels and R:R ratios\n- Chart containers with technical indicator overlays\n\n**Navigation**:\n- Vertical sidebar with market categories\n- Horizontal tabs for timeframe switching\n- Breadcrumb navigation for deep analysis views\n\n**Interactive Elements**:\n- Real-time price tickers with color-coded changes\n- Expandable signal details with reasoning\n- Filterable watchlists and screeners\n\n### E. Specialized Financial UI Patterns\n\n**Price Display Standards**:\n- Green/red color coding for positive/negative changes\n- Consistent decimal precision per asset class\n- Percentage changes in parentheses\n- Volume with K/M/B abbreviations\n\n**Chart Integration**:\n- Dark theme candlestick charts\n- Support/resistance level overlays\n- Signal annotation markers\n- Multi-timeframe toggle buttons\n\n**Alert System**:\n- Toast notifications for new signals\n- Status indicators for market sessions\n- Connection status with WebSocket health\n- Priority-based notification styling\n\n**Data Tables**:\n- Sortable columns with directional indicators\n- Row highlighting for active positions\n- Expandable rows for additional details\n- Fixed headers for long datasets\n\n## Visual Hierarchy\n1. **Critical Trading Data**: Largest, highest contrast\n2. **Market Context**: Secondary prominence with clear grouping\n3. **Historical/Reference**: Subtle styling, easily scannable\n4. **System Status**: Minimal but always visible\n\nThis design system prioritizes speed of information processing and decision-making while maintaining the professional standards expected in financial trading applications.","path":null,"size_bytes":3386,"size_tokens":null},"client/src/components/EconomicCalendar.tsx":{"content":"import { useState } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Calendar, AlertTriangle, TrendingUp, TrendingDown, Minus } from 'lucide-react';\nimport { format } from 'date-fns';\nimport EventDetailsDialog from './EventDetailsDialog';\n\ninterface EconomicEvent {\n  id: string;\n  title: string;\n  currency: string;\n  countryCode?: string;\n  impactLevel: string;\n  eventTime: string;\n  expectedValue: string | null;\n  previousValue: string | null;\n  actualValue: string | null;\n  marketImpactAnalysis: string | null;\n  isReleased: boolean;\n  preReleaseSentiment?: string;\n  postReleaseSentiment?: string;\n  expertSentiment?: string;\n}\n\nexport default function EconomicCalendar() {\n  const [selectedEventId, setSelectedEventId] = useState<string | null>(null);\n  const [dialogOpen, setDialogOpen] = useState(false);\n\n  const { data: allEvents = [], isLoading } = useQuery<EconomicEvent[]>({\n    queryKey: ['/api/economic-events'],\n  });\n\n  const events = allEvents.slice(0, 20);\n\n  const handleEventClick = (eventId: string) => {\n    setSelectedEventId(eventId);\n    setDialogOpen(true);\n  };\n\n  const getImpactVariant = (impact: string): \"default\" | \"secondary\" | \"outline\" => {\n    const impactLower = impact?.toLowerCase() || '';\n    if (impactLower === 'high') return 'default';\n    if (impactLower === 'medium') return 'secondary';\n    return 'outline';\n  };\n\n  const groupEventsByDate = (events: EconomicEvent[]) => {\n    const grouped: { [key: string]: EconomicEvent[] } = {};\n    events.forEach(event => {\n      const dateKey = format(new Date(event.eventTime), 'yyyy-MM-dd');\n      if (!grouped[dateKey]) {\n        grouped[dateKey] = [];\n      }\n      grouped[dateKey].push(event);\n    });\n    return grouped;\n  };\n\n  const groupedEvents = groupEventsByDate(events);\n\n  const getMarketSentiment = (event: EconomicEvent) => {\n    let sentiment = 'neutral';\n    \n    if (event.isReleased && event.postReleaseSentiment) {\n      sentiment = event.postReleaseSentiment;\n    } else if (event.preReleaseSentiment) {\n      sentiment = event.preReleaseSentiment;\n    } else if (event.expertSentiment) {\n      sentiment = event.expertSentiment;\n    }\n    \n    if (sentiment === 'bullish') {\n      return { \n        sentiment: 'Bullish', \n        icon: <TrendingUp className=\"w-3 h-3 text-green-500\" />\n      };\n    } else if (sentiment === 'bearish') {\n      return { \n        sentiment: 'Bearish', \n        icon: <TrendingDown className=\"w-3 h-3 text-red-500\" />\n      };\n    }\n    return { \n      sentiment: 'Neutral', \n      icon: <Minus className=\"w-3 h-3 text-muted-foreground/50\" />\n    };\n  };\n\n  if (isLoading) {\n    return (\n      <Card data-testid=\"card-economic-calendar\">\n        <CardHeader className=\"pb-4\">\n          <CardTitle className=\"flex items-center gap-2 text-lg font-semibold\">\n            <Calendar className=\"w-5 h-5\" />\n            Economic Calendar\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <p className=\"text-sm text-muted-foreground text-center py-4\">Loading events...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card data-testid=\"card-economic-calendar\">\n      <CardHeader className=\"pb-4\">\n        <CardTitle className=\"flex items-center gap-2 text-lg font-semibold\">\n          <Calendar className=\"w-5 h-5\" />\n          Economic Calendar\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-4\">\n          {events.length === 0 ? (\n            <p className=\"text-sm text-muted-foreground text-center py-4\">No upcoming events</p>\n          ) : (\n            Object.entries(groupedEvents).map(([dateKey, dateEvents]) => {\n              const date = new Date(dateKey);\n              const isToday = format(new Date(), 'yyyy-MM-dd') === dateKey;\n              const isTomorrow = format(new Date(Date.now() + 86400000), 'yyyy-MM-dd') === dateKey;\n              \n              return (\n                <div key={dateKey} className=\"space-y-3\">\n                  <div className=\"sticky top-0 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 z-10 pb-2 pt-1\">\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"text-sm font-semibold\">\n                        {isToday ? 'Today' : isTomorrow ? 'Tomorrow' : format(date, 'EEE, MMM d')}\n                      </div>\n                      <div className=\"h-px flex-1 bg-border\"></div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    {dateEvents.map((event) => {\n                      const sentiment = getMarketSentiment(event);\n                      const eventTime = new Date(event.eventTime);\n                      \n                      return (\n                        <div\n                          key={event.id}\n                          onClick={() => handleEventClick(event.id)}\n                          className=\"group p-3 rounded-md border border-border hover-elevate active-elevate-2 transition-all cursor-pointer\"\n                          data-testid={`card-event-${event.id}`}\n                        >\n                          <div className=\"flex items-start justify-between mb-2\">\n                            <div className=\"flex items-center gap-2 flex-wrap\">\n                              <Badge \n                                variant=\"secondary\"\n                                className=\"text-xs font-medium shrink-0\"\n                              >\n                                {event.currency || event.countryCode}\n                              </Badge>\n                              <span className=\"text-xs font-mono text-muted-foreground shrink-0\" data-testid={`text-time-${event.id}`}>\n                                {format(eventTime, 'HH:mm')}\n                              </span>\n                              {event.impactLevel?.toLowerCase() === 'high' && (\n                                <AlertTriangle className=\"w-3 h-3 text-destructive shrink-0\" />\n                              )}\n                            </div>\n                            <div className=\"flex items-center gap-1.5 shrink-0\">\n                              {sentiment.icon}\n                              <Badge \n                                variant={getImpactVariant(event.impactLevel)}\n                                className=\"text-xs\"\n                              >\n                                {event.impactLevel?.toUpperCase() || 'MEDIUM'}\n                              </Badge>\n                            </div>\n                          </div>\n                          \n                          <div className=\"mb-2\">\n                            <h4 className=\"font-medium text-sm leading-snug group-hover:text-foreground transition-colors\" data-testid={`text-event-${event.id}`}>\n                              {event.title}\n                            </h4>\n                          </div>\n                          \n                          {(event.expectedValue || event.previousValue) && (\n                            <div className=\"flex items-center gap-3 text-xs mb-1.5\">\n                              {event.previousValue && (\n                                <div className=\"flex items-center gap-1\">\n                                  <span className=\"text-muted-foreground\">Prev:</span>\n                                  <span className=\"font-mono font-medium\" data-testid={`text-previous-${event.id}`}>\n                                    {event.previousValue}\n                                  </span>\n                                </div>\n                              )}\n                              {event.expectedValue && (\n                                <div className=\"flex items-center gap-1\">\n                                  <span className=\"text-muted-foreground\">Fcst:</span>\n                                  <span className=\"font-mono font-medium\" data-testid={`text-forecast-${event.id}`}>\n                                    {event.expectedValue}\n                                  </span>\n                                </div>\n                              )}\n                            </div>\n                          )}\n                          \n                          <div className=\"flex items-center justify-between text-xs\">\n                            <div className={`font-medium ${\n                              sentiment.sentiment === 'Bullish' ? 'text-green-500' : \n                              sentiment.sentiment === 'Bearish' ? 'text-red-500' : 'text-muted-foreground'\n                            }`}>\n                              {sentiment.sentiment}\n                            </div>\n                            {event.actualValue && (\n                              <Badge variant=\"outline\" className=\"text-xs bg-blue-500/10 text-blue-500 border-blue-500/20\">\n                                Released: {event.actualValue}\n                              </Badge>\n                            )}\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </div>\n              );\n            })\n          )}\n        </div>\n      </CardContent>\n      \n      <EventDetailsDialog \n        eventId={selectedEventId}\n        open={dialogOpen}\n        onOpenChange={setDialogOpen}\n      />\n    </Card>\n  );\n}","path":null,"size_bytes":9572,"size_tokens":null},"client/src/components/examples/EconomicCalendar.tsx":{"content":"import EconomicCalendar from '../EconomicCalendar';\n\nexport default function EconomicCalendarExample() {\n  return <EconomicCalendar />;\n}","path":null,"size_bytes":137,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":1977,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3848,"size_tokens":null},"server/scrapers/scheduler.ts":{"content":"import * as cron from 'node-cron';\nimport { economicCalendarScraper } from './economicCalendarScraper';\nimport { cacheService } from './cacheService';\nimport { scraperSettings } from './config';\nimport { telegramNotificationService } from '../services/telegramNotification';\nimport { signalScannerService } from '../services/signalScanner';\n\nexport class ScraperScheduler {\n  private upcomingEventsJob: ReturnType<typeof cron.schedule> | null = null;\n  private fullWeekJob: ReturnType<typeof cron.schedule> | null = null;\n  private cleanupJob: ReturnType<typeof cron.schedule> | null = null;\n  private notificationJob: ReturnType<typeof cron.schedule> | null = null;\n  private signalScanJob: ReturnType<typeof cron.schedule> | null = null;\n  private signalCleanupJob: ReturnType<typeof cron.schedule> | null = null;\n  private scraperJobs: ReturnType<typeof cron.schedule>[] = [];\n  private sessionAwareScanJobs: ReturnType<typeof cron.schedule>[] = [];\n  private isRunning = false;\n\n  async fetchEvents(): Promise<void> {\n    if (this.isRunning) {\n      console.log('[Calendar] Fetch already in progress, skipping...');\n      return;\n    }\n\n    try {\n      this.isRunning = true;\n      console.log('[Calendar] Starting web scraper...');\n      const events = await economicCalendarScraper.scrapeWithRetry();\n      if (events.length > 0) {\n        await cacheService.storeEvents(events);\n        console.log(`[Calendar] Scraper fetched ${events.length} events`);\n      } else {\n        console.log('[Calendar] Scraper returned no events');\n      }\n    } catch (error) {\n      console.error('[Calendar] Error during fetch:', error);\n    } finally {\n      this.isRunning = false;\n    }\n  }\n\n  async runUpcomingEventsScrape(): Promise<void> {\n    await this.fetchEvents();\n  }\n\n  async runFullWeekScrape(): Promise<void> {\n    await this.fetchEvents();\n  }\n\n  async runCleanup(): Promise<void> {\n    try {\n      console.log('Running cleanup of old events...');\n      await cacheService.cleanupOldEvents();\n      console.log('Cleanup completed');\n    } catch (error) {\n      console.error('Error during cleanup:', error);\n    }\n  }\n\n  private setupSessionAwareScanJobs(): void {\n    this.sessionAwareScanJobs.forEach(job => job.stop());\n    this.sessionAwareScanJobs = [];\n\n    this.sessionAwareScanJobs.push(\n      cron.schedule('0,15,30,45 7,8 * * 1-5', async () => {\n        console.log('[SignalScanner] London session open - intensive scan (every 15 min)');\n        await signalScannerService.scanMarkets();\n      }, { timezone: 'UTC' })\n    );\n\n    this.sessionAwareScanJobs.push(\n      cron.schedule('0,15,30,45 12,13,14 * * 1-5', async () => {\n        console.log('[SignalScanner] NY session open - intensive scan (every 15 min)');\n        await signalScannerService.scanMarkets();\n      }, { timezone: 'UTC' })\n    );\n\n    console.log('[SignalScanner] Session-aware scanning configured:');\n    console.log('  - London open (7:00-9:00 UTC): every 15 minutes');\n    console.log('  - NY open (12:00-15:00 UTC): every 15 minutes');\n  }\n\n  private setupScraperSchedule(): void {\n    this.scraperJobs.forEach(job => job.stop());\n    this.scraperJobs = [];\n\n    // Pre-London session fetch (10 min before open)\n    this.scraperJobs.push(\n      cron.schedule('50 7 * * 1-5', async () => {\n        console.log('[Calendar] Pre-London fetch (10 min before open)');\n        await this.fetchEvents();\n      }, { timezone: 'Europe/London' })\n    );\n\n    // Pre-NY session fetch (10 min before open)\n    this.scraperJobs.push(\n      cron.schedule('20 9 * * 1-5', async () => {\n        console.log('[Calendar] Pre-NY fetch (10 min before open)');\n        await this.fetchEvents();\n      }, { timezone: 'America/New_York' })\n    );\n\n    // Hourly fetch during trading hours (every 2 hours)\n    this.scraperJobs.push(\n      cron.schedule('0 */2 * * 1-5', async () => {\n        console.log('[Calendar] Scheduled hourly fetch');\n        await this.fetchEvents();\n      }, { timezone: 'UTC' })\n    );\n\n    // Weekend fetch\n    this.scraperJobs.push(\n      cron.schedule('0 12 * * 0,6', async () => {\n        console.log('[Calendar] Weekend fetch');\n        await this.fetchEvents();\n      }, { timezone: 'UTC' })\n    );\n\n    console.log('[Calendar] Web scraper scheduled:');\n    console.log('  - Pre-London session (7:50 London time)');\n    console.log('  - Pre-NY session (9:20 NY time)');\n    console.log('  - Every 2 hours on weekdays');\n    console.log('  - Weekend maintenance at noon UTC');\n  }\n\n  start(): void {\n    console.log('Starting economic calendar scheduler (scraper only)...');\n\n    this.setupScraperSchedule();\n\n    const cleanupIntervalHours = Math.floor(\n      scraperSettings.cacheSettings.cleanupInterval / (60 * 60 * 1000)\n    );\n    const cleanupCronPattern = `0 */${cleanupIntervalHours} * * *`;\n    \n    this.cleanupJob = cron.schedule(cleanupCronPattern, async () => {\n      await this.runCleanup();\n    });\n\n    this.notificationJob = cron.schedule('*/5 * * * *', async () => {\n      console.log('Checking for events and sessions to notify...');\n      await telegramNotificationService.checkAndNotifyUpcomingEvents();\n      await telegramNotificationService.checkAndNotifyTradingSessions();\n    });\n\n    this.signalScanJob = cron.schedule('*/1 * * * *', async () => {\n      console.log('Running automated signal market scan...');\n      await signalScannerService.scanMarkets();\n    });\n\n    this.setupSessionAwareScanJobs();\n\n    this.signalCleanupJob = cron.schedule('0 */2 * * *', async () => {\n      console.log('Running signal cleanup...');\n      await signalScannerService.cleanupExpiredSignals();\n    });\n\n    console.log(`Scheduled cleanup: every ${cleanupIntervalHours} hours`);\n    console.log('Scheduled Telegram notifications: every 5 minutes');\n    console.log('Scheduled signal scanning: every 1 minute');\n    console.log('Scheduled signal cleanup: every 2 hours');\n\n    this.fetchEvents();\n    signalScannerService.scanMarkets();\n  }\n\n  stop(): void {\n    console.log('Stopping economic calendar scheduler...');\n    \n    this.scraperJobs.forEach(job => job.stop());\n    this.scraperJobs = [];\n\n    this.sessionAwareScanJobs.forEach(job => job.stop());\n    this.sessionAwareScanJobs = [];\n\n    if (this.upcomingEventsJob) {\n      this.upcomingEventsJob.stop();\n      this.upcomingEventsJob = null;\n    }\n    \n    if (this.fullWeekJob) {\n      this.fullWeekJob.stop();\n      this.fullWeekJob = null;\n    }\n    \n    if (this.cleanupJob) {\n      this.cleanupJob.stop();\n      this.cleanupJob = null;\n    }\n\n    if (this.notificationJob) {\n      this.notificationJob.stop();\n      this.notificationJob = null;\n    }\n\n    if (this.signalScanJob) {\n      this.signalScanJob.stop();\n      this.signalScanJob = null;\n    }\n\n    if (this.signalCleanupJob) {\n      this.signalCleanupJob.stop();\n      this.signalCleanupJob = null;\n    }\n    \n    console.log('Scheduler stopped');\n  }\n}\n\nexport const scraperScheduler = new ScraperScheduler();\n","path":null,"size_bytes":6955,"size_tokens":null},"client/src/components/examples/ThemeToggle.tsx":{"content":"import ThemeToggle from '../ThemeToggle';\n\nexport default function ThemeToggleExample() {\n  return <ThemeToggle />;\n}","path":null,"size_bytes":117,"size_tokens":null},"client/src/components/examples/TradingSession.tsx":{"content":"import TradingSession from '../TradingSession';\n\nexport default function TradingSessionExample() {\n  return <TradingSession />;\n}","path":null,"size_bytes":129,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":689,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":791,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":971,"size_tokens":null},"server/storage.ts":{"content":"import { type User, type InsertUser, type Trade, type InsertTrade, type EconomicEvent, type InsertEconomicEvent, type TradingSignal, type InsertTradingSignal, type PendingSetup, type InsertPendingSetup, trades, users, tradingSignals, pendingSetups } from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\nimport { db } from \"./db\";\nimport { eq, desc, and } from \"drizzle-orm\";\n\nexport interface IStorage {\n  getUser(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n  \n  getTrades(userId?: string): Promise<Trade[]>;\n  getTradeById(id: string): Promise<Trade | undefined>;\n  createTrade(trade: InsertTrade): Promise<Trade>;\n  updateTrade(id: string, trade: Partial<InsertTrade>): Promise<Trade | undefined>;\n  deleteTrade(id: string): Promise<boolean>;\n  \n  getEconomicEvents(filters?: { region?: string; impactLevel?: string; currency?: string }): Promise<EconomicEvent[]>;\n  getEconomicEventById(id: string): Promise<EconomicEvent | undefined>;\n  createEconomicEvent(event: InsertEconomicEvent): Promise<EconomicEvent>;\n  updateEconomicEvent(id: string, event: Partial<InsertEconomicEvent>): Promise<EconomicEvent | undefined>;\n  deleteEconomicEvent(id: string): Promise<boolean>;\n  \n  getTradingSignals(filters?: { status?: string; assetClass?: string; symbol?: string }): Promise<TradingSignal[]>;\n  getTradingSignalById(id: string): Promise<TradingSignal | undefined>;\n  createTradingSignal(signal: InsertTradingSignal): Promise<TradingSignal>;\n  updateTradingSignal(id: string, signal: Partial<InsertTradingSignal>): Promise<TradingSignal | undefined>;\n  deleteTradingSignal(id: string): Promise<boolean>;\n  cleanupExpiredSignals(): Promise<number>;\n  \n  getPendingSetups(filters?: { symbol?: string; readyForSignal?: boolean; invalidated?: boolean }): Promise<PendingSetup[]>;\n  getPendingSetupById(id: string): Promise<PendingSetup | undefined>;\n  createPendingSetup(setup: InsertPendingSetup): Promise<PendingSetup>;\n  updatePendingSetup(id: string, setup: Partial<InsertPendingSetup>): Promise<PendingSetup | undefined>;\n  deletePendingSetup(id: string): Promise<boolean>;\n}\n\nexport class DbStorage implements IStorage {\n  private economicEvents: Map<string, EconomicEvent>;\n  private tradingSignalsCache: Map<string, TradingSignal>;\n  private pendingSetupsCache: Map<string, PendingSetup>;\n\n  constructor() {\n    this.economicEvents = new Map();\n    this.tradingSignalsCache = new Map();\n    this.pendingSetupsCache = new Map();\n  }\n\n  async getUser(id: string): Promise<User | undefined> {\n    const result = await db.select().from(users).where(eq(users.id, id)).limit(1);\n    return result[0];\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    const result = await db.select().from(users).where(eq(users.username, username)).limit(1);\n    return result[0];\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const result = await db.insert(users).values(insertUser).returning();\n    return result[0];\n  }\n\n  async getTrades(userId?: string): Promise<Trade[]> {\n    try {\n      let result;\n      if (userId) {\n        result = await db.select().from(trades).where(eq(trades.userId, userId)).orderBy(desc(trades.createdAt));\n      } else {\n        result = await db.select().from(trades).orderBy(desc(trades.createdAt));\n      }\n      return result;\n    } catch (error) {\n      console.error('[Storage] Error fetching trades:', error);\n      return [];\n    }\n  }\n\n  async getTradeById(id: string): Promise<Trade | undefined> {\n    try {\n      const result = await db.select().from(trades).where(eq(trades.id, id)).limit(1);\n      return result[0];\n    } catch (error) {\n      console.error('[Storage] Error fetching trade by id:', error);\n      return undefined;\n    }\n  }\n\n  async createTrade(insertTrade: InsertTrade): Promise<Trade> {\n    try {\n      const result = await db.insert(trades).values(insertTrade).returning();\n      console.log(`[Storage] Trade created: ${result[0].symbol} - ${result[0].outcome}`);\n      return result[0];\n    } catch (error) {\n      console.error('[Storage] Error creating trade:', error);\n      throw error;\n    }\n  }\n\n  async updateTrade(id: string, updateData: Partial<InsertTrade>): Promise<Trade | undefined> {\n    try {\n      const result = await db.update(trades).set(updateData).where(eq(trades.id, id)).returning();\n      return result[0];\n    } catch (error) {\n      console.error('[Storage] Error updating trade:', error);\n      return undefined;\n    }\n  }\n\n  async deleteTrade(id: string): Promise<boolean> {\n    try {\n      const result = await db.delete(trades).where(eq(trades.id, id)).returning();\n      return result.length > 0;\n    } catch (error) {\n      console.error('[Storage] Error deleting trade:', error);\n      return false;\n    }\n  }\n\n  async getEconomicEvents(filters?: { region?: string; impactLevel?: string; currency?: string }): Promise<EconomicEvent[]> {\n    let events = Array.from(this.economicEvents.values());\n    \n    if (filters) {\n      if (filters.region) {\n        events = events.filter(e => e.region === filters.region);\n      }\n      if (filters.impactLevel) {\n        events = events.filter(e => e.impactLevel === filters.impactLevel);\n      }\n      if (filters.currency) {\n        events = events.filter(e => e.currency === filters.currency);\n      }\n    }\n    \n    return events.sort((a, b) => \n      new Date(a.eventTime).getTime() - new Date(b.eventTime).getTime()\n    );\n  }\n\n  async getEconomicEventById(id: string): Promise<EconomicEvent | undefined> {\n    return this.economicEvents.get(id);\n  }\n\n  async createEconomicEvent(insertEvent: InsertEconomicEvent): Promise<EconomicEvent> {\n    const id = randomUUID();\n    const event: EconomicEvent = {\n      ...insertEvent,\n      id,\n      countryCode: insertEvent.countryCode ?? null,\n      affectedCurrencies: insertEvent.affectedCurrencies ?? [],\n      affectedStocks: insertEvent.affectedStocks ?? [],\n      description: insertEvent.description ?? null,\n      expectedValue: insertEvent.expectedValue ?? null,\n      previousValue: insertEvent.previousValue ?? null,\n      actualValue: insertEvent.actualValue ?? null,\n      unit: insertEvent.unit ?? null,\n      futuresImpliedExpectation: insertEvent.futuresImpliedExpectation ?? null,\n      surpriseFactor: insertEvent.surpriseFactor ?? null,\n      marketImpactAnalysis: insertEvent.marketImpactAnalysis ?? null,\n      expertSentiment: insertEvent.expertSentiment ?? null,\n      preReleaseSentiment: insertEvent.preReleaseSentiment ?? null,\n      postReleaseSentiment: insertEvent.postReleaseSentiment ?? null,\n      currencyPairImpacts: insertEvent.currencyPairImpacts ?? null,\n      stockImpacts: insertEvent.stockImpacts ?? null,\n      sourceSite: insertEvent.sourceSite ?? null,\n      sourceUrl: insertEvent.sourceUrl ?? null,\n      isReleased: insertEvent.isReleased ?? false,\n      telegramNotified: false,\n      lastScraped: new Date(),\n      createdAt: new Date(),\n    };\n    this.economicEvents.set(id, event);\n    return event;\n  }\n\n  async updateEconomicEvent(id: string, updateData: Partial<InsertEconomicEvent>): Promise<EconomicEvent | undefined> {\n    const event = this.economicEvents.get(id);\n    if (!event) {\n      return undefined;\n    }\n    const updatedEvent = { ...event, ...updateData };\n    this.economicEvents.set(id, updatedEvent);\n    return updatedEvent;\n  }\n\n  async deleteEconomicEvent(id: string): Promise<boolean> {\n    return this.economicEvents.delete(id);\n  }\n\n  async getTradingSignals(filters?: { status?: string; assetClass?: string; symbol?: string }): Promise<TradingSignal[]> {\n    let signals = Array.from(this.tradingSignalsCache.values());\n    \n    if (filters) {\n      if (filters.status) {\n        signals = signals.filter(s => s.status === filters.status);\n      }\n      if (filters.assetClass) {\n        signals = signals.filter(s => s.assetClass === filters.assetClass);\n      }\n      if (filters.symbol) {\n        signals = signals.filter(s => s.symbol === filters.symbol);\n      }\n    }\n    \n    return signals.sort((a, b) => \n      new Date(b.createdAt!).getTime() - new Date(a.createdAt!).getTime()\n    );\n  }\n\n  async getTradingSignalById(id: string): Promise<TradingSignal | undefined> {\n    return this.tradingSignalsCache.get(id);\n  }\n\n  async createTradingSignal(insertSignal: InsertTradingSignal): Promise<TradingSignal> {\n    const id = randomUUID();\n    const signal: TradingSignal = {\n      ...insertSignal,\n      id,\n      status: insertSignal.status ?? 'active',\n      confirmationTimeframe: insertSignal.confirmationTimeframe ?? null,\n      executionTimeframe: insertSignal.executionTimeframe ?? null,\n      interestRateDiffScore: insertSignal.interestRateDiffScore ?? null,\n      interestRateDiffValue: insertSignal.interestRateDiffValue ?? null,\n      interestRateNotes: insertSignal.interestRateNotes ?? null,\n      inflationImpactScore: insertSignal.inflationImpactScore ?? null,\n      inflationDifferential: insertSignal.inflationDifferential ?? null,\n      inflationNotes: insertSignal.inflationNotes ?? null,\n      trendScore: insertSignal.trendScore ?? null,\n      trendDirection: insertSignal.trendDirection ?? null,\n      trendStrength: insertSignal.trendStrength ?? null,\n      trendTimeframes: insertSignal.trendTimeframes ?? [],\n      smcScore: insertSignal.smcScore ?? null,\n      institutionalCandleDetected: insertSignal.institutionalCandleDetected ?? false,\n      institutionalCandleData: insertSignal.institutionalCandleData ?? null,\n      orderBlockType: insertSignal.orderBlockType ?? null,\n      orderBlockLevel: insertSignal.orderBlockLevel ?? null,\n      fvgDetected: insertSignal.fvgDetected ?? false,\n      fvgLevel: insertSignal.fvgLevel ?? null,\n      liquiditySweep: insertSignal.liquiditySweep ?? false,\n      liquiditySweepLevel: insertSignal.liquiditySweepLevel ?? null,\n      breakerBlockDetected: insertSignal.breakerBlockDetected ?? false,\n      bocChochDetected: insertSignal.bocChochDetected ?? null,\n      smcFactors: insertSignal.smcFactors ?? [],\n      technicalReasons: insertSignal.technicalReasons ?? [],\n      marketContext: insertSignal.marketContext ?? null,\n      strength: insertSignal.strength ?? null,\n      zonesTested: insertSignal.zonesTested ?? 0,\n      expiresAt: insertSignal.expiresAt ?? null,\n      executedAt: insertSignal.executedAt ?? null,\n      invalidatedAt: insertSignal.invalidatedAt ?? null,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n    this.tradingSignalsCache.set(id, signal);\n    return signal;\n  }\n\n  async updateTradingSignal(id: string, updateData: Partial<InsertTradingSignal>): Promise<TradingSignal | undefined> {\n    const signal = this.tradingSignalsCache.get(id);\n    if (!signal) {\n      return undefined;\n    }\n    const updatedSignal = { ...signal, ...updateData, updatedAt: new Date() };\n    this.tradingSignalsCache.set(id, updatedSignal);\n    return updatedSignal;\n  }\n\n  async deleteTradingSignal(id: string): Promise<boolean> {\n    return this.tradingSignalsCache.delete(id);\n  }\n\n  async cleanupExpiredSignals(): Promise<number> {\n    const now = new Date();\n    let cleanedCount = 0;\n    const entries = Array.from(this.tradingSignalsCache.entries());\n    \n    for (const [id, signal] of entries) {\n      if (signal.status === 'expired' || signal.status === 'stopped_out' || signal.status === 'target_hit') {\n        this.tradingSignalsCache.delete(id);\n        cleanedCount++;\n      } else if (signal.expiresAt && new Date(signal.expiresAt) < now && signal.status === 'active') {\n        this.tradingSignalsCache.delete(id);\n        cleanedCount++;\n      }\n    }\n    \n    if (cleanedCount > 0) {\n      console.log(`[Storage] Cleaned up ${cleanedCount} expired/completed signals`);\n    }\n    \n    return cleanedCount;\n  }\n\n  async getPendingSetups(filters?: { symbol?: string; readyForSignal?: boolean; invalidated?: boolean }): Promise<PendingSetup[]> {\n    let setups = Array.from(this.pendingSetupsCache.values());\n    \n    if (filters) {\n      if (filters.symbol) {\n        setups = setups.filter(s => s.symbol === filters.symbol);\n      }\n      if (filters.readyForSignal !== undefined) {\n        setups = setups.filter(s => s.readyForSignal === filters.readyForSignal);\n      }\n      if (filters.invalidated !== undefined) {\n        setups = setups.filter(s => s.invalidated === filters.invalidated);\n      }\n    }\n    \n    return setups.sort((a, b) => \n      new Date(b.createdAt!).getTime() - new Date(a.createdAt!).getTime()\n    );\n  }\n\n  async getPendingSetupById(id: string): Promise<PendingSetup | undefined> {\n    return this.pendingSetupsCache.get(id);\n  }\n\n  async createPendingSetup(insertSetup: InsertPendingSetup): Promise<PendingSetup> {\n    const id = randomUUID();\n    const setup: PendingSetup = {\n      ...insertSetup,\n      id,\n      potentialStrategy: insertSetup.potentialStrategy ?? null,\n      confirmationTimeframe: insertSetup.confirmationTimeframe ?? null,\n      interestRateBias: insertSetup.interestRateBias ?? null,\n      inflationBias: insertSetup.inflationBias ?? null,\n      trendBias: insertSetup.trendBias ?? null,\n      chochDetected: insertSetup.chochDetected ?? false,\n      chochDirection: insertSetup.chochDirection ?? null,\n      liquiditySweepDetected: insertSetup.liquiditySweepDetected ?? false,\n      supplyDemandZoneTargeted: insertSetup.supplyDemandZoneTargeted ?? false,\n      zoneLevel: insertSetup.zoneLevel ?? null,\n      zoneMitigated: insertSetup.zoneMitigated ?? false,\n      levelsBroken: insertSetup.levelsBroken ?? 0,\n      confirmationsPending: insertSetup.confirmationsPending ?? [],\n      setupNotes: insertSetup.setupNotes ?? [],\n      marketContext: insertSetup.marketContext ?? null,\n      lastCheckedPrice: insertSetup.lastCheckedPrice ?? null,\n      lastCheckedAt: new Date(),\n      readyForSignal: insertSetup.readyForSignal ?? false,\n      invalidated: insertSetup.invalidated ?? false,\n      invalidationReason: insertSetup.invalidationReason ?? null,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n    this.pendingSetupsCache.set(id, setup);\n    return setup;\n  }\n\n  async updatePendingSetup(id: string, updateData: Partial<InsertPendingSetup>): Promise<PendingSetup | undefined> {\n    const setup = this.pendingSetupsCache.get(id);\n    if (!setup) {\n      return undefined;\n    }\n    const updatedSetup = { ...setup, ...updateData, updatedAt: new Date(), lastCheckedAt: new Date() };\n    this.pendingSetupsCache.set(id, updatedSetup);\n    return updatedSetup;\n  }\n\n  async deletePendingSetup(id: string): Promise<boolean> {\n    return this.pendingSetupsCache.delete(id);\n  }\n}\n\nexport const storage = new DbStorage();\n","path":null,"size_bytes":14747,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1883,"size_tokens":null},"client/src/components/examples/TradingSignals.tsx":{"content":"import TradingSignals from '../TradingSignals';\n\nexport default function TradingSignalsExample() {\n  return <TradingSignals />;\n}","path":null,"size_bytes":129,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":710,"size_tokens":null},"client/src/pages/EconomicCalendar.tsx":{"content":"import { useState } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Calendar, TrendingUp, TrendingDown, Minus, Clock, AlertTriangle, DollarSign, BarChart3, ChevronDown, ChevronUp } from 'lucide-react';\nimport { format } from 'date-fns';\nimport type { EconomicEvent } from '@shared/schema';\n\nexport default function EconomicCalendar() {\n  const [regionFilter, setRegionFilter] = useState<string>('all');\n  const [impactFilter, setImpactFilter] = useState<string>('all');\n  const [currencyFilter, setCurrencyFilter] = useState<string>('all');\n  const [expandedEventId, setExpandedEventId] = useState<string | null>(null);\n\n  const { data: events = [], isLoading } = useQuery<EconomicEvent[]>({\n    queryKey: ['/api/economic-events', regionFilter, impactFilter, currencyFilter],\n    queryFn: async () => {\n      const params = new URLSearchParams();\n      if (regionFilter !== 'all') params.append('region', regionFilter);\n      if (impactFilter !== 'all') params.append('impactLevel', impactFilter);\n      if (currencyFilter !== 'all') params.append('currency', currencyFilter);\n      \n      const response = await fetch(`/api/economic-events?${params.toString()}`);\n      if (!response.ok) throw new Error('Failed to fetch events');\n      return response.json();\n    },\n  });\n\n  const upcomingEvents = events.filter(e => !e.isReleased && new Date(e.eventTime) > new Date());\n  const recentEvents = events.filter(e => e.isReleased);\n\n  const getImpactColor = (level: string) => {\n    return level === 'HIGH' ? 'hsl(0 84% 60%)' : 'hsl(38 92% 50%)';\n  };\n\n  const getImpactIcon = (level: string) => {\n    return level === 'HIGH' ? <AlertTriangle className=\"w-4 h-4\" /> : <TrendingUp className=\"w-4 h-4\" />;\n  };\n\n  const calculateSurprise = (expected: string | null, actual: string | null) => {\n    if (!expected || !actual) return null;\n    const exp = parseFloat(expected);\n    const act = parseFloat(actual);\n    if (isNaN(exp) || isNaN(act)) return null;\n    const diff = act - exp;\n    return diff > 0 ? `+${diff.toFixed(2)}` : diff.toFixed(2);\n  };\n\n  const getMarketSentiment = (event: EconomicEvent) => {\n    let sentiment = 'neutral';\n    \n    if (event.isReleased && event.postReleaseSentiment) {\n      sentiment = event.postReleaseSentiment;\n    } else if (event.preReleaseSentiment) {\n      sentiment = event.preReleaseSentiment;\n    } else if (event.expertSentiment) {\n      sentiment = event.expertSentiment;\n    }\n    \n    if (sentiment === 'bullish') {\n      return { \n        sentiment: 'Bullish', \n        icon: <TrendingUp className=\"w-3 h-3 text-green-500\" />\n      };\n    } else if (sentiment === 'bearish') {\n      return { \n        sentiment: 'Bearish', \n        icon: <TrendingDown className=\"w-3 h-3 text-red-500\" />\n      };\n    }\n    return { \n      sentiment: 'Neutral', \n      icon: <Minus className=\"w-3 h-3 text-muted-foreground/50\" />\n    };\n  };\n\n  const handleEventClick = (eventId: string) => {\n    setExpandedEventId(expandedEventId === eventId ? null : eventId);\n  };\n\n  return (\n    <div className=\"h-full flex flex-col p-6 space-y-6 overflow-auto\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\" data-testid=\"text-page-title\">Economic Calendar</h1>\n          <p className=\"text-muted-foreground\">Track high-impact economic events and market-moving data releases</p>\n        </div>\n      </div>\n\n      <Card data-testid=\"card-filters\">\n        <CardHeader>\n          <CardTitle className=\"text-lg\">Filters</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium\">Region</label>\n              <Select value={regionFilter} onValueChange={setRegionFilter}>\n                <SelectTrigger data-testid=\"select-region\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Regions</SelectItem>\n                  <SelectItem value=\"NA\">North America</SelectItem>\n                  <SelectItem value=\"EU\">Europe</SelectItem>\n                  <SelectItem value=\"ASIA\">Asia</SelectItem>\n                  <SelectItem value=\"OCEANIA\">Oceania</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium\">Impact Level</label>\n              <Select value={impactFilter} onValueChange={setImpactFilter}>\n                <SelectTrigger data-testid=\"select-impact\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Levels</SelectItem>\n                  <SelectItem value=\"HIGH\">High Impact</SelectItem>\n                  <SelectItem value=\"MEDIUM\">Medium Impact</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium\">Currency</label>\n              <Select value={currencyFilter} onValueChange={setCurrencyFilter}>\n                <SelectTrigger data-testid=\"select-currency\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Currencies</SelectItem>\n                  <SelectItem value=\"USD\">USD</SelectItem>\n                  <SelectItem value=\"EUR\">EUR</SelectItem>\n                  <SelectItem value=\"GBP\">GBP</SelectItem>\n                  <SelectItem value=\"JPY\">JPY</SelectItem>\n                  <SelectItem value=\"AUD\">AUD</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {isLoading ? (\n        <Card>\n          <CardContent className=\"p-12 text-center\">\n            <p className=\"text-muted-foreground\">Loading events...</p>\n          </CardContent>\n        </Card>\n      ) : events.length === 0 ? (\n        <Card data-testid=\"card-empty\">\n          <CardContent className=\"p-12 text-center space-y-4\">\n            <Calendar className=\"w-12 h-12 mx-auto text-muted-foreground\" />\n            <div>\n              <h3 className=\"text-lg font-medium\">No Events Found</h3>\n              <p className=\"text-sm text-muted-foreground\">\n                No economic events match your current filters\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n      ) : (\n        <>\n          {upcomingEvents.length > 0 && (\n            <div className=\"space-y-4\">\n              <h2 className=\"text-xl font-semibold flex items-center gap-2\">\n                <Clock className=\"w-5 h-5\" />\n                Upcoming Events\n              </h2>\n              <div className=\"grid gap-4\">\n                {upcomingEvents.map((event) => {\n                  const sentiment = getMarketSentiment(event);\n                  const isExpanded = expandedEventId === event.id;\n                  return (\n                  <Card \n                    key={event.id} \n                    className=\"cursor-pointer transition-all duration-200\" \n                    onClick={() => handleEventClick(event.id)}\n                    data-testid={`card-event-${event.id}`}\n                  >\n                    <CardContent className=\"p-4\">\n                      <div className=\"flex items-start justify-between gap-4\">\n                        <div className=\"flex-1 space-y-2\">\n                          <div className=\"flex items-center gap-2 flex-wrap\">\n                            <Badge\n                              variant=\"default\"\n                              style={{ backgroundColor: getImpactColor(event.impactLevel) }}\n                              className=\"text-xs\"\n                              data-testid={`badge-impact-${event.id}`}\n                            >\n                              {getImpactIcon(event.impactLevel)}\n                              <span className=\"ml-1\">{event.impactLevel} IMPACT</span>\n                            </Badge>\n                            <Badge variant=\"secondary\" className=\"text-xs\" data-testid={`badge-currency-${event.id}`}>\n                              {event.currency}\n                            </Badge>\n                            <div className=\"flex items-center gap-1\">\n                              {sentiment.icon}\n                              <span className={`text-xs font-medium ${\n                                sentiment.sentiment === 'Bullish' ? 'text-green-500' : \n                                sentiment.sentiment === 'Bearish' ? 'text-red-500' : 'text-muted-foreground'\n                              }`}>\n                                {sentiment.sentiment}\n                              </span>\n                            </div>\n                          </div>\n\n                          <div>\n                            <h3 className=\"font-semibold text-lg\" data-testid={`text-title-${event.id}`}>{event.title}</h3>\n                          </div>\n\n                          <div className=\"flex items-center gap-4 text-sm\">\n                            <div className=\"flex items-center gap-1 text-muted-foreground\">\n                              <Clock className=\"w-4 h-4\" />\n                              <span data-testid={`text-time-${event.id}`}>\n                                {format(new Date(event.eventTime), 'MMM dd, yyyy HH:mm')} UTC\n                              </span>\n                            </div>\n                            <div className=\"flex items-center gap-1 text-muted-foreground\">\n                              <BarChart3 className=\"w-4 h-4\" />\n                              <span>{event.eventType}</span>\n                            </div>\n                          </div>\n\n                          {/* Expanded Details */}\n                          {isExpanded && (\n                            <div className=\"mt-4 pt-4 border-t space-y-4 animate-in fade-in duration-200\">\n                              {event.description && (\n                                <div>\n                                  <p className=\"text-xs text-muted-foreground font-semibold uppercase mb-1\">Description</p>\n                                  <p className=\"text-sm\">{event.description}</p>\n                                </div>\n                              )}\n\n                              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\n                                {event.previousValue && (\n                                  <div className=\"space-y-1\">\n                                    <p className=\"text-xs text-muted-foreground\">Previous</p>\n                                    <p className=\"font-medium\" data-testid={`text-previous-${event.id}`}>\n                                      {event.previousValue} {event.unit}\n                                    </p>\n                                  </div>\n                                )}\n                                {event.expectedValue && (\n                                  <div className=\"space-y-1\">\n                                    <p className=\"text-xs text-muted-foreground\">Expected</p>\n                                    <p className=\"font-medium\" data-testid={`text-expected-${event.id}`}>\n                                      {event.expectedValue} {event.unit}\n                                    </p>\n                                  </div>\n                                )}\n                                {event.futuresImpliedExpectation && (\n                                  <div className=\"space-y-1\">\n                                    <p className=\"text-xs text-muted-foreground\">Futures Implied</p>\n                                    <p className=\"font-medium text-primary\">\n                                      {event.futuresImpliedExpectation} {event.unit}\n                                    </p>\n                                  </div>\n                                )}\n                              </div>\n\n                              {event.marketImpactAnalysis && (\n                                <div>\n                                  <p className=\"text-xs text-muted-foreground font-semibold uppercase mb-1\">Market Impact Analysis</p>\n                                  <p className=\"text-sm\">{event.marketImpactAnalysis}</p>\n                                </div>\n                              )}\n                            </div>\n                          )}\n                        </div>\n                        \n                        <div className=\"flex-shrink-0\">\n                          {isExpanded ? (\n                            <ChevronUp className=\"w-5 h-5 text-muted-foreground\" />\n                          ) : (\n                            <ChevronDown className=\"w-5 h-5 text-muted-foreground\" />\n                          )}\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                  )\n                })}\n              </div>\n            </div>\n          )}\n\n          {recentEvents.length > 0 && (\n            <div className=\"space-y-4\">\n              <h2 className=\"text-xl font-semibold flex items-center gap-2\">\n                <DollarSign className=\"w-5 h-5\" />\n                Released Events\n              </h2>\n              <div className=\"grid gap-4\">\n                {recentEvents.map((event) => {\n                  const surprise = calculateSurprise(event.expectedValue, event.actualValue);\n                  const sentiment = getMarketSentiment(event);\n                  const isExpanded = expandedEventId === event.id;\n                  return (\n                    <Card \n                      key={event.id} \n                      className=\"cursor-pointer transition-all duration-200\" \n                      onClick={() => handleEventClick(event.id)}\n                      data-testid={`card-released-${event.id}`}\n                    >\n                      <CardContent className=\"p-4\">\n                        <div className=\"flex items-start justify-between gap-4\">\n                          <div className=\"flex-1 space-y-2\">\n                            <div className=\"flex items-center gap-2 flex-wrap\">\n                              <Badge\n                                variant=\"default\"\n                                style={{ backgroundColor: getImpactColor(event.impactLevel) }}\n                                className=\"text-xs\"\n                              >\n                                {getImpactIcon(event.impactLevel)}\n                                <span className=\"ml-1\">{event.impactLevel} IMPACT</span>\n                              </Badge>\n                              <Badge variant=\"secondary\" className=\"text-xs\">\n                                {event.currency}\n                              </Badge>\n                              <Badge variant=\"default\" className=\"text-xs bg-green-600\">\n                                RELEASED\n                              </Badge>\n                              <div className=\"flex items-center gap-1\">\n                                {sentiment.icon}\n                                <span className={`text-xs font-medium ${\n                                  sentiment.sentiment === 'Bullish' ? 'text-green-500' : \n                                  sentiment.sentiment === 'Bearish' ? 'text-red-500' : 'text-muted-foreground'\n                                }`}>\n                                  {sentiment.sentiment}\n                                </span>\n                              </div>\n                            </div>\n\n                            <div>\n                              <h3 className=\"font-semibold text-lg\">{event.title}</h3>\n                            </div>\n\n                            <div className=\"flex items-center gap-4 text-sm\">\n                              <div className=\"flex items-center gap-1 text-muted-foreground\">\n                                <Clock className=\"w-4 h-4\" />\n                                <span>\n                                  {format(new Date(event.eventTime), 'MMM dd, yyyy HH:mm')} UTC\n                                </span>\n                              </div>\n                              <div className=\"flex items-center gap-1 text-muted-foreground\">\n                                <BarChart3 className=\"w-4 h-4\" />\n                                <span>{event.eventType}</span>\n                              </div>\n                            </div>\n\n                            {/* Expanded Details */}\n                            {isExpanded && (\n                              <div className=\"mt-4 pt-4 border-t space-y-4 animate-in fade-in duration-200\">\n                                {event.description && (\n                                  <div>\n                                    <p className=\"text-xs text-muted-foreground font-semibold uppercase mb-1\">Description</p>\n                                    <p className=\"text-sm\">{event.description}</p>\n                                  </div>\n                                )}\n\n                                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                                  {event.previousValue && (\n                                    <div className=\"space-y-1\">\n                                      <p className=\"text-xs text-muted-foreground\">Previous</p>\n                                      <p className=\"font-medium\">\n                                        {event.previousValue} {event.unit}\n                                      </p>\n                                    </div>\n                                  )}\n                                  {event.expectedValue && (\n                                    <div className=\"space-y-1\">\n                                      <p className=\"text-xs text-muted-foreground\">Expected</p>\n                                      <p className=\"font-medium\">\n                                        {event.expectedValue} {event.unit}\n                                      </p>\n                                    </div>\n                                  )}\n                                  {event.actualValue && (\n                                    <div className=\"space-y-1\">\n                                      <p className=\"text-xs text-muted-foreground\">Actual</p>\n                                      <p className=\"font-medium text-primary\" data-testid={`text-actual-${event.id}`}>\n                                        {event.actualValue} {event.unit}\n                                      </p>\n                                    </div>\n                                  )}\n                                  {surprise && (\n                                    <div className=\"space-y-1\">\n                                      <p className=\"text-xs text-muted-foreground\">Surprise</p>\n                                      <p className={`font-medium ${parseFloat(surprise) > 0 ? 'text-green-600' : 'text-red-600'}`}>\n                                        {surprise} {event.unit}\n                                      </p>\n                                    </div>\n                                  )}\n                                </div>\n\n                                {event.marketImpactAnalysis && (\n                                  <div>\n                                    <p className=\"text-xs text-muted-foreground font-semibold uppercase mb-1\">Market Impact Analysis</p>\n                                    <p className=\"text-sm\">{event.marketImpactAnalysis}</p>\n                                  </div>\n                                )}\n                              </div>\n                            )}\n                          </div>\n                          \n                          <div className=\"flex-shrink-0\">\n                            {isExpanded ? (\n                              <ChevronUp className=\"w-5 h-5 text-muted-foreground\" />\n                            ) : (\n                              <ChevronDown className=\"w-5 h-5 text-muted-foreground\" />\n                            )}\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  );\n                })}\n              </div>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":20825,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5128,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1209,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4885,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1527,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/components/AppSidebar.tsx":{"content":"import { Activity, BarChart3, Calendar, History, Home, Settings, Target, TrendingUp } from 'lucide-react';\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n} from '@/components/ui/sidebar';\n\nconst menuItems = [\n  {\n    title: 'Dashboard',\n    url: '/',\n    icon: Home,\n  },\n  {\n    title: 'Market Overview',\n    url: '/markets',\n    icon: Activity,\n  },\n  {\n    title: 'Trading Signals',\n    url: '/signals',\n    icon: Target,\n  },\n  {\n    title: 'Economic Calendar',\n    url: '/calendar',\n    icon: Calendar,\n  },\n  {\n    title: 'Trade History',\n    url: '/history',\n    icon: History,\n  },\n  {\n    title: 'Analytics',\n    url: '/analytics',\n    icon: BarChart3,\n  },\n];\n\nconst strategyItems = [\n  {\n    title: 'Scalping',\n    url: '/strategies/scalping',\n    icon: TrendingUp,\n  },\n  {\n    title: 'Day Trading',\n    url: '/strategies/day',\n    icon: TrendingUp,\n  },\n  {\n    title: 'Swing Trading',\n    url: '/strategies/swing',\n    icon: TrendingUp,\n  },\n  {\n    title: 'ORB Strategy',\n    url: '/strategies/orb',\n    icon: TrendingUp,\n  },\n];\n\nexport default function AppSidebar() {\n  return (\n    <Sidebar data-testid=\"sidebar-main\">\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel>Navigation</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {menuItems.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton asChild>\n                    <a href={item.url} data-testid={`link-${item.title.toLowerCase().replace(' ', '-')}`}>\n                      <item.icon />\n                      <span>{item.title}</span>\n                    </a>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n\n        <SidebarGroup>\n          <SidebarGroupLabel>Trading Strategies</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {strategyItems.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton asChild>\n                    <a href={item.url} data-testid={`link-strategy-${item.title.toLowerCase().replace(' ', '-')}`}>\n                      <item.icon />\n                      <span>{item.title}</span>\n                    </a>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n\n        <SidebarGroup>\n          <SidebarGroupLabel>Settings</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              <SidebarMenuItem>\n                <SidebarMenuButton asChild>\n                  <a href=\"/settings\" data-testid=\"link-settings\">\n                    <Settings />\n                    <span>Settings</span>\n                  </a>\n                </SidebarMenuButton>\n              </SidebarMenuItem>\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n    </Sidebar>\n  );\n}","path":null,"size_bytes":3210,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1251,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1467,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":844,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/components/examples/MarketOverview.tsx":{"content":"import MarketOverview from '../MarketOverview';\n\nexport default function MarketOverviewExample() {\n  return <MarketOverview />;\n}","path":null,"size_bytes":129,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3021,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1202,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","path":null,"size_bytes":2695,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7609,"size_tokens":null},"client/src/pages/TradeHistoryPage.tsx":{"content":"import TradeHistory from '@/components/TradeHistory';\n\nexport default function TradeHistoryPage() {\n  return (\n    <div className=\"container mx-auto p-6\">\n      <TradeHistory />\n    </div>\n  );\n}\n","path":null,"size_bytes":196,"size_tokens":null},"server/services/finnhub.ts":{"content":"interface FinnhubEconomicEvent {\n  country: string;\n  event: string;\n  impact: string;\n  actual: string | null;\n  estimate: string | null;\n  prev: string | null;\n  time: string;\n}\n\ninterface EconomicCalendarResponse {\n  economicCalendar: FinnhubEconomicEvent[];\n}\n\nconst COUNTRY_TO_REGION: Record<string, string> = {\n  'US': 'NA',\n  'CA': 'NA',\n  'MX': 'NA',\n  'GB': 'EU',\n  'DE': 'EU',\n  'FR': 'EU',\n  'IT': 'EU',\n  'ES': 'EU',\n  'EU': 'EU',\n  'JP': 'ASIA',\n  'CN': 'ASIA',\n  'IN': 'ASIA',\n  'AU': 'OCEANIA',\n  'NZ': 'OCEANIA',\n};\n\nconst COUNTRY_TO_CURRENCY: Record<string, string> = {\n  'US': 'USD',\n  'CA': 'CAD',\n  'MX': 'MXN',\n  'GB': 'GBP',\n  'DE': 'EUR',\n  'FR': 'EUR',\n  'IT': 'EUR',\n  'ES': 'EUR',\n  'EU': 'EUR',\n  'JP': 'JPY',\n  'CN': 'CNY',\n  'IN': 'INR',\n  'AU': 'AUD',\n  'NZ': 'NZD',\n};\n\nfunction generateEventId(event: FinnhubEconomicEvent): string {\n  const str = `${event.time}-${event.event}-${event.country}`;\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash;\n  }\n  return Math.abs(hash).toString(36);\n}\n\nexport async function fetchEconomicCalendar(fromDate?: string, toDate?: string) {\n  const apiKey = process.env.FINNHUB_API_KEY;\n  \n  if (!apiKey) {\n    throw new Error('FINNHUB_API_KEY environment variable is not set');\n  }\n\n  const today = new Date();\n  const from = fromDate || today.toISOString().split('T')[0];\n  const to = toDate || new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];\n\n  const url = `https://finnhub.io/api/v1/calendar/economic?from=${from}&to=${to}&token=${apiKey}`;\n\n  try {\n    const response = await fetch(url);\n    \n    if (!response.ok) {\n      if (response.status === 403) {\n        console.error('Finnhub API key does not have access to economic calendar endpoint. This feature requires a paid plan or different API key.');\n        return [];\n      }\n      throw new Error(`Finnhub API error: ${response.status} ${response.statusText}`);\n    }\n\n    const data: EconomicCalendarResponse = await response.json();\n    \n    const events = data.economicCalendar\n      .filter(event => {\n        const impact = event.impact?.toLowerCase() || '';\n        return impact === 'high' || impact === 'medium';\n      })\n      .map(event => {\n        const country = event.country || 'US';\n        const region = COUNTRY_TO_REGION[country] || 'NA';\n        const currency = COUNTRY_TO_CURRENCY[country] || 'USD';\n        \n        const eventDate = new Date(event.time);\n        const isReleased = event.actual !== null && event.actual !== '';\n        \n        let marketImpact = '';\n        if (isReleased && event.estimate && event.actual) {\n          const estimate = parseFloat(event.estimate);\n          const actual = parseFloat(event.actual);\n          if (!isNaN(estimate) && !isNaN(actual)) {\n            if (actual > estimate) {\n              marketImpact = 'Actual exceeded expectations, potentially bullish for ' + currency;\n            } else if (actual < estimate) {\n              marketImpact = 'Actual below expectations, potentially bearish for ' + currency;\n            } else {\n              marketImpact = 'In line with expectations, neutral impact';\n            }\n          }\n        }\n\n        const affectedCurrencies = [currency];\n        if (currency === 'USD') {\n          affectedCurrencies.push('EUR/USD', 'GBP/USD', 'USD/JPY');\n        } else if (currency === 'EUR') {\n          affectedCurrencies.push('EUR/USD', 'EUR/GBP');\n        } else if (currency === 'GBP') {\n          affectedCurrencies.push('GBP/USD', 'EUR/GBP');\n        }\n\n        return {\n          id: generateEventId(event),\n          title: event.event,\n          description: `${country} - ${event.event}`,\n          eventType: event.event.includes('GDP') ? 'GDP' : \n                     event.event.includes('CPI') ? 'Inflation' :\n                     event.event.includes('Employment') || event.event.includes('Payrolls') ? 'Employment' :\n                     event.event.includes('PMI') ? 'Manufacturing' :\n                     event.event.includes('Rate') ? 'Interest Rate' : 'Economic Indicator',\n          country: country,\n          region: region,\n          currency: currency,\n          impactLevel: event.impact?.toUpperCase() || 'MEDIUM',\n          eventTime: eventDate,\n          expectedValue: event.estimate || null,\n          previousValue: event.prev || null,\n          actualValue: event.actual || null,\n          unit: null,\n          futuresImpliedExpectation: null,\n          surpriseFactor: null,\n          marketImpactAnalysis: marketImpact || null,\n          affectedCurrencies: affectedCurrencies,\n          affectedStocks: [],\n          isReleased: isReleased,\n        };\n      });\n    \n    return events.sort((a, b) => \n      new Date(a.eventTime).getTime() - new Date(b.eventTime).getTime()\n    );\n  } catch (error) {\n    console.error('Error fetching Finnhub economic calendar:', error);\n    throw error;\n  }\n}\n","path":null,"size_bytes":5008,"size_tokens":null},"client/src/pages/Stocks.tsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport SignalCard from '@/components/SignalCard';\nimport WatchlistCard from '@/components/WatchlistCard';\nimport SectionHeader from '@/components/SectionHeader';\nimport { Zap, Bookmark } from 'lucide-react';\n\nexport default function Stocks() {\n  const { data: allSignals = [], isLoading: signalsLoading } = useQuery<any[]>({\n    queryKey: ['/api/trading-signals'],\n    refetchInterval: 10000,\n  });\n\n  const { data: pendingSetups = [], isLoading: setupsLoading } = useQuery<any[]>({\n    queryKey: ['/api/pending-setups'],\n    refetchInterval: 15000,\n  });\n\n  const stockSignals = allSignals.filter(s => s.assetClass === 'stock');\n  const watchlistItems = pendingSetups.filter(s => !s.readyForSignal && s.assetClass === 'stock');\n\n  return (\n    <div className=\"min-h-screen bg-background text-foreground p-4 md:p-8\">\n      <div className=\"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8\">\n        <div className=\"lg:col-span-8 flex flex-col gap-8\">\n          <section className=\"bg-card border-t-2 border-gray-900 dark:border-foreground\">\n            <SectionHeader \n              icon={Zap} \n              title=\"US Stock Signals\" \n              countLabel={`${stockSignals.length} Active`}\n              variant=\"active\"\n            />\n            <div className=\"flex flex-col\">\n              {signalsLoading ? (\n                <div className=\"p-8 text-center text-muted-foreground\">Loading signals...</div>\n              ) : stockSignals.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">No active stock signals</div>\n              ) : (\n                stockSignals.map(signal => (\n                  <SignalCard key={signal.id} signal={signal} />\n                ))\n              )}\n            </div>\n          </section>\n        </div>\n\n        <div className=\"lg:col-span-4\">\n          <section className=\"bg-card border-t-2 border-gray-900 dark:border-foreground sticky top-8\">\n            <SectionHeader \n              icon={Bookmark} \n              title=\"Stock Watchlist\" \n              countLabel={`${watchlistItems.length} Pending`}\n              variant=\"pending\"\n            />\n            <div className=\"flex flex-col\">\n              {setupsLoading ? (\n                <div className=\"p-8 text-center text-muted-foreground\">Loading watchlist...</div>\n              ) : watchlistItems.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">No stocks being monitored</div>\n              ) : (\n                watchlistItems.map(item => (\n                  <WatchlistCard key={item.id} item={item} />\n                ))\n              )}\n            </div>\n          </section>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2769,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4281,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4420,"size_tokens":null},"client/src/components/TradeHistory.tsx":{"content":"import { useState } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { BookOpen, TrendingUp, TrendingDown, Filter, Download, Calendar, Target, AlertTriangle, Clock, BarChart3 } from 'lucide-react';\nimport type { Trade } from '@shared/schema';\n\nconst safeParseFloat = (value: string | null | undefined, defaultValue = 0): number => {\n  if (value === null || value === undefined || value === '') return defaultValue;\n  const parsed = parseFloat(value);\n  return isNaN(parsed) ? defaultValue : parsed;\n};\n\nconst safeFormatPrice = (value: string | null | undefined, decimals = 5): string => {\n  if (value === null || value === undefined || value === '') return 'N/A';\n  const parsed = parseFloat(value);\n  return isNaN(parsed) ? 'N/A' : parsed.toFixed(decimals);\n};\n\nexport default function TradeHistory() {\n  const [filter, setFilter] = useState<'all' | 'wins' | 'losses'>('all');\n  const [timeFilter, setTimeFilter] = useState<'all' | 'today' | 'week' | 'month'>('all');\n  \n  const { data: trades = [], isLoading } = useQuery<Trade[]>({\n    queryKey: ['/api/trades'],\n  });\n\n  const filterByTime = (trade: Trade) => {\n    if (timeFilter === 'all') return true;\n    const exitDate = new Date(trade.exitDate);\n    const now = new Date();\n    \n    if (timeFilter === 'today') {\n      return exitDate.toDateString() === now.toDateString();\n    } else if (timeFilter === 'week') {\n      const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\n      return exitDate >= weekAgo;\n    } else if (timeFilter === 'month') {\n      const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\n      return exitDate >= monthAgo;\n    }\n    return true;\n  };\n\n  if (isLoading) {\n    return (\n      <Card data-testid=\"card-trade-journal\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <BookOpen className=\"w-5 h-5\" />\n            Trading Journal\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-center py-8 text-muted-foreground\">\n            Loading journal entries...\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const timeFilteredTrades = trades.filter(filterByTime);\n  \n  const filteredTrades = timeFilteredTrades.filter(trade => {\n    if (filter === 'wins') return trade.outcome === 'win';\n    if (filter === 'losses') return trade.outcome === 'loss';\n    return true;\n  });\n\n  const totalPnL = timeFilteredTrades.reduce((sum, trade) => sum + safeParseFloat(trade.pnl), 0);\n  const winningTrades = timeFilteredTrades.filter(t => t.outcome === 'win');\n  const losingTrades = timeFilteredTrades.filter(t => t.outcome === 'loss');\n  const winRate = timeFilteredTrades.length > 0 ? (winningTrades.length / timeFilteredTrades.length) * 100 : 0;\n  const avgWin = winningTrades.length > 0 \n    ? winningTrades.reduce((sum, t) => sum + safeParseFloat(t.pnl), 0) / winningTrades.length \n    : 0;\n  const avgLoss = losingTrades.length > 0\n    ? Math.abs(losingTrades.reduce((sum, t) => sum + safeParseFloat(t.pnl), 0) / losingTrades.length)\n    : 0;\n  const profitFactor = avgLoss > 0 ? (avgWin * winningTrades.length) / (avgLoss * losingTrades.length) : 0;\n\n  if (trades.length === 0) {\n    return (\n      <Card data-testid=\"card-trade-journal\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <BookOpen className=\"w-5 h-5\" />\n            Trading Journal\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-center py-12\">\n            <BookOpen className=\"w-12 h-12 mx-auto mb-4 text-muted-foreground\" />\n            <h3 className=\"text-lg font-semibold mb-2\">No journal entries yet</h3>\n            <p className=\"text-muted-foreground text-sm max-w-md mx-auto\">\n              Your trading journal will automatically record confirmed trades when signals hit their stop-loss or take-profit levels.\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const exportToCSV = () => {\n    const headers = ['Date', 'Symbol', 'Type', 'Strategy', 'Entry', 'Exit', 'SL', 'TP', 'P&L', 'P&L %', 'R:R', 'Outcome', 'Duration', 'Reason', 'Lesson'];\n    const rows = filteredTrades.map(t => [\n      new Date(t.exitDate).toLocaleDateString(),\n      t.symbol,\n      t.type,\n      t.strategy,\n      t.entryPrice,\n      t.exitPrice,\n      t.stopLoss || 'N/A',\n      t.takeProfit || 'N/A',\n      t.pnl,\n      t.pnlPercent + '%',\n      t.riskReward || 'N/A',\n      t.outcome,\n      t.duration,\n      t.entryReason,\n      t.lesson || ''\n    ]);\n    \n    const csvContent = [headers.join(','), ...rows.map(r => r.map(cell => `\"${cell}\"`).join(','))].join('\\n');\n    const blob = new Blob([csvContent], { type: 'text/csv' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `trading-journal-${new Date().toISOString().split('T')[0]}.csv`;\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  return (\n    <Card data-testid=\"card-trade-journal\">\n      <CardHeader className=\"pb-4\">\n        <div className=\"flex items-center justify-between flex-wrap gap-2\">\n          <CardTitle className=\"flex items-center gap-2 text-lg font-semibold\">\n            <BookOpen className=\"w-5 h-5\" />\n            Trading Journal\n            <Badge variant=\"secondary\" className=\"ml-2\">\n              {trades.length} trades\n            </Badge>\n          </CardTitle>\n          <div className=\"flex items-center gap-2 flex-wrap\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={exportToCSV}\n              data-testid=\"button-export-journal\"\n            >\n              <Download className=\"w-4 h-4 mr-1\" />\n              Export CSV\n            </Button>\n          </div>\n        </div>\n        \n        <div className=\"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3 mt-4 p-4 bg-muted/30 rounded-md\">\n          <div className=\"text-center\">\n            <div className=\"text-xs text-muted-foreground mb-1\">Total P&L</div>\n            <div className={`font-mono font-semibold ${totalPnL >= 0 ? 'text-green-500' : 'text-red-500'}`} data-testid=\"text-total-pnl\">\n              ${totalPnL >= 0 ? '+' : ''}{totalPnL.toFixed(0)}\n            </div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-xs text-muted-foreground mb-1\">Win Rate</div>\n            <div className=\"font-mono font-semibold\" data-testid=\"text-win-rate\">\n              {winRate.toFixed(1)}%\n            </div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-xs text-muted-foreground mb-1\">Wins / Losses</div>\n            <div className=\"font-mono font-semibold\">\n              <span className=\"text-green-500\">{winningTrades.length}</span>\n              {' / '}\n              <span className=\"text-red-500\">{losingTrades.length}</span>\n            </div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-xs text-muted-foreground mb-1\">Avg Win</div>\n            <div className=\"font-mono font-semibold text-green-500\">\n              ${avgWin.toFixed(0)}\n            </div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-xs text-muted-foreground mb-1\">Avg Loss</div>\n            <div className=\"font-mono font-semibold text-red-500\">\n              ${avgLoss.toFixed(0)}\n            </div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-xs text-muted-foreground mb-1\">Profit Factor</div>\n            <div className={`font-mono font-semibold ${profitFactor >= 1 ? 'text-green-500' : 'text-red-500'}`}>\n              {profitFactor.toFixed(2)}\n            </div>\n          </div>\n        </div>\n      </CardHeader>\n      \n      <CardContent>\n        <div className=\"flex flex-wrap items-center gap-2 mb-4\">\n          <div className=\"flex items-center gap-2\">\n            <Calendar className=\"w-4 h-4 text-muted-foreground\" />\n            <Button\n              variant={timeFilter === 'all' ? 'default' : 'outline'}\n              size=\"sm\"\n              onClick={() => setTimeFilter('all')}\n              data-testid=\"button-time-all\"\n            >\n              All Time\n            </Button>\n            <Button\n              variant={timeFilter === 'today' ? 'default' : 'outline'}\n              size=\"sm\"\n              onClick={() => setTimeFilter('today')}\n              data-testid=\"button-time-today\"\n            >\n              Today\n            </Button>\n            <Button\n              variant={timeFilter === 'week' ? 'default' : 'outline'}\n              size=\"sm\"\n              onClick={() => setTimeFilter('week')}\n              data-testid=\"button-time-week\"\n            >\n              This Week\n            </Button>\n            <Button\n              variant={timeFilter === 'month' ? 'default' : 'outline'}\n              size=\"sm\"\n              onClick={() => setTimeFilter('month')}\n              data-testid=\"button-time-month\"\n            >\n              This Month\n            </Button>\n          </div>\n          \n          <div className=\"h-4 w-px bg-border mx-2 hidden sm:block\" />\n          \n          <div className=\"flex items-center gap-2\">\n            <Filter className=\"w-4 h-4 text-muted-foreground\" />\n            <Button\n              variant={filter === 'all' ? 'default' : 'outline'}\n              size=\"sm\"\n              onClick={() => setFilter('all')}\n              data-testid=\"button-filter-all\"\n            >\n              All ({timeFilteredTrades.length})\n            </Button>\n            <Button\n              variant={filter === 'wins' ? 'default' : 'outline'}\n              size=\"sm\"\n              onClick={() => setFilter('wins')}\n              data-testid=\"button-filter-wins\"\n            >\n              Wins ({winningTrades.length})\n            </Button>\n            <Button\n              variant={filter === 'losses' ? 'default' : 'outline'}\n              size=\"sm\"\n              onClick={() => setFilter('losses')}\n              data-testid=\"button-filter-losses\"\n            >\n              Losses ({losingTrades.length})\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"space-y-4\">\n          {filteredTrades.map((trade) => (\n            <div\n              key={trade.id}\n              className={`p-4 rounded-md border ${\n                trade.outcome === 'win' \n                  ? 'border-green-500/20 bg-green-500/5' \n                  : 'border-red-500/20 bg-red-500/5'\n              } hover-elevate transition-colors`}\n              data-testid={`card-journal-entry-${trade.id}`}\n            >\n              <div className=\"flex items-start justify-between mb-3 flex-wrap gap-2\">\n                <div className=\"flex items-center gap-3 flex-wrap\">\n                  <Badge \n                    variant=\"secondary\"\n                    className=\"text-xs font-medium\"\n                    style={{ \n                      backgroundColor: trade.type === 'buy' ? 'hsl(142 76% 36% / 0.2)' : 'hsl(0 84% 60% / 0.2)',\n                      color: trade.type === 'buy' ? 'hsl(142 76% 36%)' : 'hsl(0 84% 60%)'\n                    }}\n                  >\n                    {trade.type.toUpperCase()}\n                  </Badge>\n                  <div>\n                    <h4 className=\"font-semibold text-base\" data-testid={`text-symbol-${trade.id}`}>\n                      {trade.symbol}\n                    </h4>\n                    <div className=\"flex items-center gap-2 text-xs text-muted-foreground flex-wrap\">\n                      <span>{trade.strategy}</span>\n                      <span className=\"text-muted-foreground/50\">|</span>\n                      <span>{trade.timeframe}</span>\n                      {trade.assetClass && (\n                        <>\n                          <span className=\"text-muted-foreground/50\">|</span>\n                          <span className=\"capitalize\">{trade.assetClass}</span>\n                        </>\n                      )}\n                    </div>\n                  </div>\n                </div>\n                \n                <div className=\"text-right\">\n                  <div className={`font-mono font-bold text-lg ${safeParseFloat(trade.pnl) >= 0 ? 'text-green-500' : 'text-red-500'}`}>\n                    {safeParseFloat(trade.pnl) >= 0 ? '+' : ''}${safeParseFloat(trade.pnl).toFixed(2)}\n                  </div>\n                  <div className={`text-xs ${safeParseFloat(trade.pnl) >= 0 ? 'text-green-500' : 'text-red-500'}`}>\n                    ({safeParseFloat(trade.pnl) >= 0 ? '+' : ''}{safeParseFloat(trade.pnlPercent).toFixed(2)}%)\n                  </div>\n                </div>\n              </div>\n              \n              <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-3 text-xs\">\n                <div className=\"bg-background/50 rounded p-2\">\n                  <div className=\"text-muted-foreground mb-1 flex items-center gap-1\">\n                    <TrendingUp className=\"w-3 h-3\" />\n                    Entry\n                  </div>\n                  <div className=\"font-mono font-medium\">{safeFormatPrice(trade.entryPrice)}</div>\n                </div>\n                <div className=\"bg-background/50 rounded p-2\">\n                  <div className=\"text-muted-foreground mb-1 flex items-center gap-1\">\n                    <TrendingDown className=\"w-3 h-3\" />\n                    Exit\n                  </div>\n                  <div className=\"font-mono font-medium\">{safeFormatPrice(trade.exitPrice)}</div>\n                </div>\n                <div className=\"bg-background/50 rounded p-2\">\n                  <div className=\"text-muted-foreground mb-1 flex items-center gap-1\">\n                    <AlertTriangle className=\"w-3 h-3 text-red-500\" />\n                    Stop Loss\n                  </div>\n                  <div className=\"font-mono font-medium text-red-500\">\n                    {safeFormatPrice(trade.stopLoss)}\n                  </div>\n                </div>\n                <div className=\"bg-background/50 rounded p-2\">\n                  <div className=\"text-muted-foreground mb-1 flex items-center gap-1\">\n                    <Target className=\"w-3 h-3 text-green-500\" />\n                    Take Profit\n                  </div>\n                  <div className=\"font-mono font-medium text-green-500\">\n                    {safeFormatPrice(trade.takeProfit)}\n                  </div>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center justify-between flex-wrap gap-2 text-xs mb-3\">\n                <div className=\"flex items-center gap-4 flex-wrap\">\n                  <div className=\"flex items-center gap-1\">\n                    <BarChart3 className=\"w-3 h-3 text-muted-foreground\" />\n                    <span className=\"text-muted-foreground\">R:R</span>\n                    <span className=\"font-mono font-medium\">{trade.riskReward || 'N/A'}</span>\n                  </div>\n                  <div className=\"flex items-center gap-1\">\n                    <Clock className=\"w-3 h-3 text-muted-foreground\" />\n                    <span className=\"text-muted-foreground\">Duration</span>\n                    <span className=\"font-mono font-medium\">{trade.duration}</span>\n                  </div>\n                </div>\n                <Badge \n                  variant={trade.outcome === 'win' ? 'default' : 'destructive'}\n                  className=\"text-xs\"\n                >\n                  {trade.outcome === 'win' ? 'WIN' : 'LOSS'}\n                </Badge>\n              </div>\n              \n              <div className=\"space-y-2 text-xs border-t border-border/50 pt-3\">\n                <div>\n                  <span className=\"text-muted-foreground font-medium\">Entry Reason: </span>\n                  <span>{trade.entryReason}</span>\n                </div>\n                {trade.lesson && (\n                  <div>\n                    <span className=\"text-muted-foreground font-medium\">Lesson: </span>\n                    <span className=\"italic\">{trade.lesson}</span>\n                  </div>\n                )}\n              </div>\n              \n              <div className=\"mt-3 text-xs text-muted-foreground flex items-center justify-between flex-wrap gap-2\">\n                <span>\n                  {trade.entryDate && `Opened: ${new Date(trade.entryDate).toLocaleDateString()} ${new Date(trade.entryDate).toLocaleTimeString()}`}\n                </span>\n                <span>\n                  Closed: {new Date(trade.exitDate).toLocaleDateString()} {new Date(trade.exitDate).toLocaleTimeString()}\n                </span>\n              </div>\n            </div>\n          ))}\n        </div>\n        \n        {filteredTrades.length === 0 && (\n          <div className=\"text-center py-8 text-muted-foreground\">\n            No trades match the selected filters.\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":17190,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"server/services/sentimentAnalysis.ts":{"content":"import { EconomicEvent } from '@shared/schema';\n\nexport interface CurrencyPairImpact {\n  pair: string;\n  sentiment: 'bullish' | 'bearish' | 'neutral';\n  reasoning: string;\n}\n\nexport interface StockImpact {\n  sector: string;\n  sentiment: 'bullish' | 'bearish' | 'neutral';\n  reasoning: string;\n}\n\nexport interface SentimentAnalysis {\n  expertSentiment: 'bullish' | 'bearish' | 'neutral';\n  preReleaseSentiment: 'bullish' | 'bearish' | 'neutral';\n  postReleaseSentiment: 'bullish' | 'bearish' | 'neutral' | null;\n  currencyPairImpacts: CurrencyPairImpact[];\n  stockImpacts: StockImpact[];\n  marketImpactAnalysis: string;\n  surpriseFactor: string | null;\n}\n\nconst eventSentimentRules: Record<string, {\n  betterThanExpected: 'bullish' | 'bearish';\n  worseThanExpected: 'bullish' | 'bearish';\n  currencyEffect: 'positive' | 'negative';\n  stockEffect: 'positive' | 'negative';\n  description: string;\n}> = {\n  'GDP': {\n    betterThanExpected: 'bullish',\n    worseThanExpected: 'bearish',\n    currencyEffect: 'positive',\n    stockEffect: 'positive',\n    description: 'GDP growth indicates economic strength'\n  },\n  'CPI': {\n    betterThanExpected: 'bearish',\n    worseThanExpected: 'bullish',\n    currencyEffect: 'positive',\n    stockEffect: 'negative',\n    description: 'Higher inflation may lead to rate hikes'\n  },\n  'Inflation': {\n    betterThanExpected: 'bearish',\n    worseThanExpected: 'bullish',\n    currencyEffect: 'positive',\n    stockEffect: 'negative',\n    description: 'Higher inflation typically negative for stocks'\n  },\n  'NFP': {\n    betterThanExpected: 'bullish',\n    worseThanExpected: 'bearish',\n    currencyEffect: 'positive',\n    stockEffect: 'positive',\n    description: 'Strong employment supports economic growth'\n  },\n  'Employment': {\n    betterThanExpected: 'bullish',\n    worseThanExpected: 'bearish',\n    currencyEffect: 'positive',\n    stockEffect: 'positive',\n    description: 'Employment data reflects economic health'\n  },\n  'Unemployment': {\n    betterThanExpected: 'bearish',\n    worseThanExpected: 'bullish',\n    currencyEffect: 'negative',\n    stockEffect: 'negative',\n    description: 'Higher unemployment indicates economic weakness'\n  },\n  'Interest Rate': {\n    betterThanExpected: 'bearish',\n    worseThanExpected: 'bullish',\n    currencyEffect: 'positive',\n    stockEffect: 'negative',\n    description: 'Rate hikes strengthen currency but pressure stocks'\n  },\n  'Retail Sales': {\n    betterThanExpected: 'bullish',\n    worseThanExpected: 'bearish',\n    currencyEffect: 'positive',\n    stockEffect: 'positive',\n    description: 'Strong consumer spending drives growth'\n  },\n  'PMI': {\n    betterThanExpected: 'bullish',\n    worseThanExpected: 'bearish',\n    currencyEffect: 'positive',\n    stockEffect: 'positive',\n    description: 'Manufacturing activity indicates economic momentum'\n  },\n  'Trade Balance': {\n    betterThanExpected: 'bullish',\n    worseThanExpected: 'bearish',\n    currencyEffect: 'positive',\n    stockEffect: 'positive',\n    description: 'Trade surplus supports currency strength'\n  }\n};\n\nfunction getEventRule(title: string) {\n  for (const [key, rule] of Object.entries(eventSentimentRules)) {\n    if (title.toLowerCase().includes(key.toLowerCase())) {\n      return rule;\n    }\n  }\n  return eventSentimentRules['GDP'];\n}\n\nfunction parseNumericValue(value: string | null): number | null {\n  if (!value) return null;\n  const cleaned = value.replace(/[^\\d.-]/g, '');\n  const parsed = parseFloat(cleaned);\n  return isNaN(parsed) ? null : parsed;\n}\n\nfunction calculateSurpriseFactor(actual: number, expected: number): string {\n  const diff = actual - expected;\n  const percentDiff = ((diff / Math.abs(expected)) * 100);\n  \n  if (Math.abs(percentDiff) < 5) return 'In-line';\n  if (Math.abs(percentDiff) < 15) return percentDiff > 0 ? 'Mild Beat' : 'Mild Miss';\n  if (Math.abs(percentDiff) < 30) return percentDiff > 0 ? 'Strong Beat' : 'Strong Miss';\n  return percentDiff > 0 ? 'Major Beat' : 'Major Miss';\n}\n\nfunction getCurrencyPairs(currency: string): string[] {\n  const majorPairs: Record<string, string[]> = {\n    'USD': ['EUR/USD', 'USD/JPY', 'GBP/USD', 'USD/CHF', 'AUD/USD', 'USD/CAD'],\n    'EUR': ['EUR/USD', 'EUR/GBP', 'EUR/JPY', 'EUR/CHF'],\n    'GBP': ['GBP/USD', 'EUR/GBP', 'GBP/JPY'],\n    'JPY': ['USD/JPY', 'EUR/JPY', 'GBP/JPY'],\n    'AUD': ['AUD/USD', 'AUD/JPY'],\n    'CAD': ['USD/CAD', 'CAD/JPY'],\n    'CHF': ['USD/CHF', 'EUR/CHF'],\n    'NZD': ['NZD/USD', 'NZD/JPY']\n  };\n  \n  return majorPairs[currency] || [`${currency}/USD`];\n}\n\nfunction getAffectedStocks(currency: string, eventType: string): string[] {\n  const stocksByEvent: Record<string, string[]> = {\n    'Interest Rate': ['Banks', 'Financial Services', 'Real Estate'],\n    'CPI': ['Consumer Goods', 'Retail', 'Energy'],\n    'GDP': ['Broad Market', 'Industrials', 'Financials'],\n    'Employment': ['Consumer Discretionary', 'Services', 'Retail'],\n    'PMI': ['Manufacturing', 'Industrials', 'Materials'],\n    'Retail Sales': ['Retail', 'Consumer Discretionary', 'E-commerce']\n  };\n  \n  const stocksByCurrency: Record<string, string[]> = {\n    'USD': ['S&P 500', 'Dow Jones', 'NASDAQ'],\n    'EUR': ['DAX', 'CAC 40', 'Euro Stoxx 50'],\n    'GBP': ['FTSE 100', 'FTSE 250'],\n    'JPY': ['Nikkei 225', 'TOPIX'],\n    'AUD': ['ASX 200'],\n    'CAD': ['TSX Composite']\n  };\n  \n  for (const [key, stocks] of Object.entries(stocksByEvent)) {\n    if (eventType.includes(key)) {\n      return [...stocks, ...(stocksByCurrency[currency] || [])];\n    }\n  }\n  \n  return stocksByCurrency[currency] || ['Local Market Indices'];\n}\n\nexport function analyzeEventSentiment(event: Partial<EconomicEvent>): SentimentAnalysis {\n  const rule = getEventRule(event.title || '');\n  const currency = event.currency || event.countryCode || 'USD';\n  \n  let expertSentiment: 'bullish' | 'bearish' | 'neutral' = 'neutral';\n  let preReleaseSentiment: 'bullish' | 'bearish' | 'neutral' = 'neutral';\n  let postReleaseSentiment: 'bullish' | 'bearish' | 'neutral' | null = null;\n  let surpriseFactor: string | null = null;\n  \n  const expectedValue = parseNumericValue(event.expectedValue || null);\n  const previousValue = parseNumericValue(event.previousValue || null);\n  const actualValue = parseNumericValue(event.actualValue || null);\n  \n  if (expectedValue !== null && previousValue !== null) {\n    if (expectedValue > previousValue) {\n      preReleaseSentiment = rule.betterThanExpected;\n      expertSentiment = rule.betterThanExpected;\n    } else if (expectedValue < previousValue) {\n      preReleaseSentiment = rule.worseThanExpected;\n      expertSentiment = rule.worseThanExpected;\n    }\n  } else if (event.futuresImpliedExpectation) {\n    const futuresSentiment = event.futuresImpliedExpectation.toLowerCase();\n    if (futuresSentiment.includes('higher') || futuresSentiment.includes('increase')) {\n      preReleaseSentiment = rule.betterThanExpected;\n    } else if (futuresSentiment.includes('lower') || futuresSentiment.includes('decrease')) {\n      preReleaseSentiment = rule.worseThanExpected;\n    }\n  }\n  \n  if (actualValue !== null && expectedValue !== null) {\n    surpriseFactor = calculateSurpriseFactor(actualValue, expectedValue);\n    \n    if (actualValue > expectedValue) {\n      postReleaseSentiment = rule.betterThanExpected;\n    } else if (actualValue < expectedValue) {\n      postReleaseSentiment = rule.worseThanExpected;\n    } else {\n      postReleaseSentiment = 'neutral';\n    }\n  }\n  \n  const currencyPairs = getCurrencyPairs(currency);\n  const currencyPairImpacts: CurrencyPairImpact[] = currencyPairs.map(pair => {\n    const sentiment = event.isReleased && postReleaseSentiment \n      ? postReleaseSentiment \n      : preReleaseSentiment;\n    \n    const isBaseCurrency = pair.startsWith(currency);\n    const effectiveSentiment = rule.currencyEffect === 'positive' \n      ? sentiment \n      : (sentiment === 'bullish' ? 'bearish' : sentiment === 'bearish' ? 'bullish' : 'neutral');\n    \n    const finalSentiment = isBaseCurrency \n      ? effectiveSentiment \n      : (effectiveSentiment === 'bullish' ? 'bearish' : effectiveSentiment === 'bearish' ? 'bullish' : 'neutral');\n    \n    return {\n      pair,\n      sentiment: finalSentiment,\n      reasoning: event.isReleased \n        ? `Post-release: ${surpriseFactor} - ${rule.description}`\n        : `Pre-release: Market expects ${preReleaseSentiment} impact - ${rule.description}`\n    };\n  });\n  \n  const affectedStocks = getAffectedStocks(currency, event.title || '');\n  const stockImpacts: StockImpact[] = affectedStocks.slice(0, 3).map(sector => {\n    const sentiment = event.isReleased && postReleaseSentiment \n      ? postReleaseSentiment \n      : preReleaseSentiment;\n    \n    const effectiveSentiment = rule.stockEffect === 'positive' \n      ? sentiment \n      : (sentiment === 'bullish' ? 'bearish' : sentiment === 'bearish' ? 'bullish' : 'neutral');\n    \n    return {\n      sector,\n      sentiment: effectiveSentiment,\n      reasoning: event.isReleased\n        ? `${surpriseFactor} data ${effectiveSentiment === 'bullish' ? 'supports' : 'pressures'} ${sector}`\n        : `Expected data to ${effectiveSentiment === 'bullish' ? 'support' : 'pressure'} ${sector}`\n    };\n  });\n  \n  let marketImpactAnalysis = '';\n  if (event.isReleased && postReleaseSentiment) {\n    marketImpactAnalysis = `${surpriseFactor}: Actual ${actualValue} vs Expected ${expectedValue}. `;\n    marketImpactAnalysis += `${currency} likely to ${postReleaseSentiment === 'bullish' ? 'strengthen' : 'weaken'}. `;\n    marketImpactAnalysis += rule.description;\n  } else {\n    marketImpactAnalysis = `Market consensus expects ${expectedValue || 'no change'}. `;\n    marketImpactAnalysis += `Previous: ${previousValue}. `;\n    marketImpactAnalysis += `${preReleaseSentiment === 'bullish' ? 'Bullish' : 'Bearish'} outlook for ${currency}. `;\n    marketImpactAnalysis += rule.description;\n  }\n  \n  return {\n    expertSentiment,\n    preReleaseSentiment,\n    postReleaseSentiment,\n    currencyPairImpacts,\n    stockImpacts,\n    marketImpactAnalysis,\n    surpriseFactor\n  };\n}\n\nexport function updateEventWithSentiment(event: Partial<EconomicEvent>): Partial<EconomicEvent> {\n  const analysis = analyzeEventSentiment(event);\n  \n  return {\n    ...event,\n    expertSentiment: analysis.expertSentiment,\n    preReleaseSentiment: analysis.preReleaseSentiment,\n    postReleaseSentiment: analysis.postReleaseSentiment || undefined,\n    surpriseFactor: analysis.surpriseFactor || undefined,\n    marketImpactAnalysis: analysis.marketImpactAnalysis,\n    currencyPairImpacts: JSON.stringify(analysis.currencyPairImpacts),\n    stockImpacts: JSON.stringify(analysis.stockImpacts)\n  };\n}\n","path":null,"size_bytes":10602,"size_tokens":null},"server/scrapers/cacheService.ts":{"content":"import { db } from '../db';\nimport { economicEvents, InsertEconomicEvent } from '@shared/schema';\nimport { eq, gte, and, sql } from 'drizzle-orm';\nimport { ScrapedEvent } from './economicCalendarScraper';\nimport { scraperSettings } from './config';\n\nexport class CacheService {\n  private cacheDuration = scraperSettings.cacheSettings.cacheDuration;\n  private dataRetentionDays = scraperSettings.cacheSettings.dataRetentionDays;\n\n  async isCacheFresh(): Promise<boolean> {\n    try {\n      const recentEvent = await db\n        .select()\n        .from(economicEvents)\n        .where(\n          gte(\n            economicEvents.lastScraped,\n            new Date(Date.now() - this.cacheDuration)\n          )\n        )\n        .limit(1);\n\n      return recentEvent.length > 0;\n    } catch (error) {\n      console.error('Error checking cache freshness:', error);\n      return false;\n    }\n  }\n\n  async storeEvents(scrapedEvents: ScrapedEvent[]): Promise<void> {\n    if (scrapedEvents.length === 0) {\n      console.log('No events to store');\n      return;\n    }\n\n    try {\n      const eventsToInsert: InsertEconomicEvent[] = scrapedEvents.map(event => ({\n        title: event.title,\n        description: null,\n        eventType: 'economic',\n        country: event.country,\n        countryCode: event.countryCode || null,\n        region: this.getRegionFromCountry(event.country),\n        currency: event.currency || event.countryCode || 'USD',\n        impactLevel: event.impactLevel,\n        eventTime: event.eventTime,\n        expectedValue: event.expectedValue || null,\n        previousValue: event.previousValue || null,\n        actualValue: event.actualValue || null,\n        unit: null,\n        futuresImpliedExpectation: null,\n        surpriseFactor: null,\n        marketImpactAnalysis: null,\n        affectedCurrencies: event.currency ? [event.currency] : null,\n        affectedStocks: null,\n        isReleased: !!event.actualValue,\n        sourceSite: event.sourceSite,\n        sourceUrl: event.sourceUrl,\n      }));\n\n      await db.delete(economicEvents).where(\n        and(\n          gte(economicEvents.eventTime, new Date()),\n          eq(economicEvents.sourceSite, scrapedEvents[0].sourceSite)\n        )\n      );\n\n      await db.insert(economicEvents).values(eventsToInsert);\n\n      console.log(`Stored ${eventsToInsert.length} events in cache`);\n    } catch (error) {\n      console.error('Error storing events:', error);\n      throw error;\n    }\n  }\n\n  async getUpcomingEvents(hoursAhead: number = 24): Promise<typeof economicEvents.$inferSelect[]> {\n    try {\n      const now = new Date();\n      const futureTime = new Date(now.getTime() + hoursAhead * 60 * 60 * 1000);\n\n      const events = await db\n        .select()\n        .from(economicEvents)\n        .where(\n          and(\n            gte(economicEvents.eventTime, now),\n            sql`${economicEvents.eventTime} <= ${futureTime}`\n          )\n        )\n        .orderBy(economicEvents.eventTime);\n\n      return events;\n    } catch (error) {\n      console.error('Error fetching upcoming events:', error);\n      return [];\n    }\n  }\n\n  async getTodayEvents(): Promise<typeof economicEvents.$inferSelect[]> {\n    try {\n      const now = new Date();\n      const startOfDay = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n      const endOfDay = new Date(startOfDay);\n      endOfDay.setDate(endOfDay.getDate() + 1);\n\n      const events = await db\n        .select()\n        .from(economicEvents)\n        .where(\n          and(\n            gte(economicEvents.eventTime, startOfDay),\n            sql`${economicEvents.eventTime} < ${endOfDay}`\n          )\n        )\n        .orderBy(economicEvents.eventTime);\n\n      return events;\n    } catch (error) {\n      console.error('Error fetching today events:', error);\n      return [];\n    }\n  }\n\n  async getWeekEvents(): Promise<typeof economicEvents.$inferSelect[]> {\n    try {\n      const now = new Date();\n      const weekLater = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000);\n\n      const events = await db\n        .select()\n        .from(economicEvents)\n        .where(\n          and(\n            gte(economicEvents.eventTime, now),\n            sql`${economicEvents.eventTime} <= ${weekLater}`\n          )\n        )\n        .orderBy(economicEvents.eventTime);\n\n      return events;\n    } catch (error) {\n      console.error('Error fetching week events:', error);\n      return [];\n    }\n  }\n\n  async cleanupOldEvents(): Promise<void> {\n    try {\n      const cutoffDate = new Date();\n      cutoffDate.setDate(cutoffDate.getDate() - this.dataRetentionDays);\n\n      await db\n        .delete(economicEvents)\n        .where(sql`${economicEvents.eventTime} < ${cutoffDate}`);\n\n      console.log(`Cleaned up events older than ${this.dataRetentionDays} days`);\n    } catch (error) {\n      console.error('Error cleaning up old events:', error);\n    }\n  }\n\n  private getRegionFromCountry(country: string): string {\n    const regionMap: Record<string, string> = {\n      'United States': 'Americas',\n      'Canada': 'Americas',\n      'Eurozone': 'Europe',\n      'Euro Zone': 'Europe',\n      'United Kingdom': 'Europe',\n      'Switzerland': 'Europe',\n      'Japan': 'Asia',\n      'China': 'Asia',\n      'Australia': 'Asia Pacific',\n      'New Zealand': 'Asia Pacific',\n    };\n\n    return regionMap[country] || 'Global';\n  }\n\n  async getOrFetchEvents(\n    type: 'today' | 'week' | 'upcoming',\n    scraper: any\n  ): Promise<typeof economicEvents.$inferSelect[]> {\n    const isFresh = await this.isCacheFresh();\n\n    if (!isFresh) {\n      console.log('Cache is stale, fetching new data...');\n      const scrapedEvents = await scraper.scrapeWithRetry();\n      await this.storeEvents(scrapedEvents);\n    }\n\n    switch (type) {\n      case 'today':\n        return this.getTodayEvents();\n      case 'week':\n        return this.getWeekEvents();\n      case 'upcoming':\n        return this.getUpcomingEvents(24);\n      default:\n        return this.getTodayEvents();\n    }\n  }\n\n  async getEventById(id: string): Promise<typeof economicEvents.$inferSelect | undefined> {\n    try {\n      const event = await db\n        .select()\n        .from(economicEvents)\n        .where(eq(economicEvents.id, id))\n        .limit(1);\n\n      return event[0];\n    } catch (error) {\n      console.error('Error fetching event by ID:', error);\n      return undefined;\n    }\n  }\n}\n\nexport const cacheService = new CacheService();\n","path":null,"size_bytes":6403,"size_tokens":null},"client/src/components/HeroSection.tsx":{"content":"import { motion } from 'framer-motion';\n\nexport function HeroSection() {\n  return (\n    <header className=\"bg-blue-600 py-6 sm:py-8 lg:py-10 text-white\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <motion.div \n          className=\"text-center flex flex-col items-center\"\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.6 }}\n        >\n          <motion.h1 \n            className=\"text-3xl sm:text-4xl lg:text-6xl font-extrabold leading-tight tracking-tight\"\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6, delay: 0.1 }}\n          >\n            Less Charting. No worries. Only precision.\n          </motion.h1>\n          <motion.p \n            className=\"mt-4 lg:mt-6 text-base sm:text-lg lg:text-xl text-blue-100 max-w-xl\"\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6, delay: 0.2 }}\n          >\n            Access premium signals, real-time analytics, and expert research to confidently navigate global financial markets.\n          </motion.p>\n        </motion.div>\n      </div>\n    </header>\n  );\n}\n","path":null,"size_bytes":1260,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"server/services/signalScanner.ts":{"content":"import { storage } from \"../storage\";\nimport { notificationService } from \"./notificationService\";\nimport { telegramNotificationService } from \"./telegramNotification\";\nimport { strategyRegistry, initializeStrategies, StrategySignal, InstrumentData } from \"../strategies\";\nimport { fetchMultiTimeframeData } from \"../strategies/shared/multiTimeframe\";\nimport { Candle } from \"../strategies/core/types\";\nimport { getPrice } from \"../lib/priceService\";\nimport { filterTradeableInstruments, getActiveSession } from \"../lib/marketHours\";\nimport { validateSignalWithGemini, SignalToValidate, PriceData } from \"./geminiAnalysis\";\nimport { generateSignalChart, ChartCandle, ZoneInfo } from \"./chartGenerator\";\nimport * as path from \"path\";\nimport * as fs from \"fs\";\n\ninterface MultiTimeframeData {\n  d1: Candle[];\n  h4: Candle[];\n  h2: Candle[];\n  h1: Candle[];\n  m30: Candle[];\n  m15: Candle[];\n  m5: Candle[];\n  m3: Candle[];\n  m1: Candle[];\n}\n\nconst TRADEABLE_INSTRUMENTS = [\n  { symbol: 'EUR/USD', assetClass: 'forex', currentPrice: 1.0850 },\n  { symbol: 'GBP/USD', assetClass: 'forex', currentPrice: 1.2650 },\n  { symbol: 'USD/JPY', assetClass: 'forex', currentPrice: 149.50 },\n  { symbol: 'USD/CHF', assetClass: 'forex', currentPrice: 0.8750 },\n  { symbol: 'AUD/USD', assetClass: 'forex', currentPrice: 0.6580 },\n  { symbol: 'USD/CAD', assetClass: 'forex', currentPrice: 1.3550 },\n  { symbol: 'NZD/USD', assetClass: 'forex', currentPrice: 0.6150 },\n  \n  { symbol: 'EUR/GBP', assetClass: 'forex', currentPrice: 0.8580 },\n  { symbol: 'EUR/JPY', assetClass: 'forex', currentPrice: 162.00 },\n  { symbol: 'EUR/CHF', assetClass: 'forex', currentPrice: 0.9500 },\n  { symbol: 'EUR/AUD', assetClass: 'forex', currentPrice: 1.6500 },\n  { symbol: 'EUR/CAD', assetClass: 'forex', currentPrice: 1.4700 },\n  { symbol: 'EUR/NZD', assetClass: 'forex', currentPrice: 1.7650 },\n  \n  { symbol: 'GBP/JPY', assetClass: 'forex', currentPrice: 185.50 },\n  { symbol: 'GBP/CHF', assetClass: 'forex', currentPrice: 1.1050 },\n  { symbol: 'GBP/AUD', assetClass: 'forex', currentPrice: 1.9250 },\n  { symbol: 'GBP/CAD', assetClass: 'forex', currentPrice: 1.7150 },\n  { symbol: 'GBP/NZD', assetClass: 'forex', currentPrice: 2.0550 },\n  \n  { symbol: 'AUD/JPY', assetClass: 'forex', currentPrice: 98.50 },\n  { symbol: 'CAD/JPY', assetClass: 'forex', currentPrice: 110.50 },\n  { symbol: 'CHF/JPY', assetClass: 'forex', currentPrice: 170.75 },\n  { symbol: 'NZD/JPY', assetClass: 'forex', currentPrice: 92.00 },\n  \n  { symbol: 'AUD/CAD', assetClass: 'forex', currentPrice: 0.8920 },\n  { symbol: 'AUD/CHF', assetClass: 'forex', currentPrice: 0.5750 },\n  { symbol: 'AUD/NZD', assetClass: 'forex', currentPrice: 1.0700 },\n  { symbol: 'CAD/CHF', assetClass: 'forex', currentPrice: 0.6450 },\n  { symbol: 'NZD/CAD', assetClass: 'forex', currentPrice: 0.8340 },\n  { symbol: 'NZD/CHF', assetClass: 'forex', currentPrice: 0.5380 },\n  \n  { symbol: 'US100', assetClass: 'index', currentPrice: 21200.00 },\n  { symbol: 'US500', assetClass: 'index', currentPrice: 5950.00 },\n  { symbol: 'US30', assetClass: 'index', currentPrice: 43800.00 },\n  { symbol: 'RUSSELL2000', assetClass: 'index', currentPrice: 2350.00 },\n  { symbol: 'VIX', assetClass: 'index', currentPrice: 14.50 },\n  \n  { symbol: 'AAPL', assetClass: 'stock', currentPrice: 175.50 },\n  { symbol: 'MSFT', assetClass: 'stock', currentPrice: 378.25 },\n  { symbol: 'GOOGL', assetClass: 'stock', currentPrice: 140.85 },\n  { symbol: 'AMZN', assetClass: 'stock', currentPrice: 152.30 },\n  { symbol: 'NVDA', assetClass: 'stock', currentPrice: 495.75 },\n  { symbol: 'TSLA', assetClass: 'stock', currentPrice: 245.60 },\n  { symbol: 'META', assetClass: 'stock', currentPrice: 485.20 },\n  { symbol: 'NFLX', assetClass: 'stock', currentPrice: 475.80 },\n  { symbol: 'AMD', assetClass: 'stock', currentPrice: 155.40 },\n  { symbol: 'ORCL', assetClass: 'stock', currentPrice: 115.25 },\n  \n  { symbol: 'JPM', assetClass: 'stock', currentPrice: 165.70 },\n  { symbol: 'BAC', assetClass: 'stock', currentPrice: 32.85 },\n  { symbol: 'GS', assetClass: 'stock', currentPrice: 385.40 },\n  { symbol: 'V', assetClass: 'stock', currentPrice: 265.30 },\n  { symbol: 'MA', assetClass: 'stock', currentPrice: 425.60 },\n  { symbol: 'JNJ', assetClass: 'stock', currentPrice: 158.90 },\n  { symbol: 'UNH', assetClass: 'stock', currentPrice: 512.75 },\n  { symbol: 'WMT', assetClass: 'stock', currentPrice: 165.40 },\n  { symbol: 'PG', assetClass: 'stock', currentPrice: 152.30 },\n  { symbol: 'DIS', assetClass: 'stock', currentPrice: 95.85 },\n  \n  { symbol: 'XAU/USD', assetClass: 'commodity', currentPrice: 2035.00 },\n  { symbol: 'XAG/USD', assetClass: 'commodity', currentPrice: 24.50 },\n  { symbol: 'WTI', assetClass: 'commodity', currentPrice: 82.50 },\n  { symbol: 'BRENT', assetClass: 'commodity', currentPrice: 86.75 },\n  \n  { symbol: 'BTC/USD', assetClass: 'crypto', currentPrice: 43200 },\n  { symbol: 'ETH/USD', assetClass: 'crypto', currentPrice: 2280 },\n  { symbol: 'BNB/USD', assetClass: 'crypto', currentPrice: 315.50 },\n];\n\nlet strategiesInitialized = false;\n\nexport class SignalScannerService {\n  private isScanning: boolean = false;\n\n  constructor() {\n    if (!strategiesInitialized) {\n      initializeStrategies();\n      strategiesInitialized = true;\n    }\n  }\n\n  async scanMarkets(): Promise<void> {\n    if (this.isScanning) {\n      console.log('Signal scan already in progress, skipping...');\n      return;\n    }\n\n    try {\n      this.isScanning = true;\n      console.log('[SignalScanner] Starting modular market scan...');\n\n      const stats = strategyRegistry.getStats();\n      console.log(`[SignalScanner] Running ${stats.enabledStrategies} enabled strategies`);\n\n      const { tradeable, skipped } = filterTradeableInstruments(TRADEABLE_INSTRUMENTS);\n      \n      if (skipped.length > 0) {\n        const skippedByClass: Record<string, number> = {};\n        for (const { instrument } of skipped) {\n          skippedByClass[instrument.assetClass] = (skippedByClass[instrument.assetClass] || 0) + 1;\n        }\n        const skippedSummary = Object.entries(skippedByClass)\n          .map(([cls, count]) => `${count} ${cls}`)\n          .join(', ');\n        console.log(`[SignalScanner] Skipping closed markets: ${skippedSummary}`);\n      }\n      \n      console.log(`[SignalScanner] Analyzing ${tradeable.length} instruments in open markets`);\n\n      const newSignals: StrategySignal[] = [];\n      const allPendingSetups: any[] = [];\n\n      for (const instrument of tradeable) {\n        try {\n          const session = getActiveSession(instrument.assetClass);\n          const result = await this.analyzeWithStrategies(instrument);\n          newSignals.push(...result.signals);\n          allPendingSetups.push(...result.pendingSetups);\n        } catch (error) {\n          console.error(`Error analyzing ${instrument.symbol}:`, error);\n        }\n      }\n\n      if (newSignals.length > 0) {\n        console.log(`[SignalScanner] Generated ${newSignals.length} new trading signals`);\n        \n        for (const signal of newSignals) {\n          await this.saveAndNotifySignal(signal);\n        }\n      } else {\n        console.log('[SignalScanner] No high-confidence signals found in this scan');\n      }\n\n      if (allPendingSetups.length > 0) {\n        console.log(`[SignalScanner] Found ${allPendingSetups.length} pending setups for watchlist`);\n        for (const setup of allPendingSetups) {\n          await this.saveWatchlistSignal(setup);\n        }\n      }\n\n    } catch (error) {\n      console.error('[SignalScanner] Error during market scan:', error);\n    } finally {\n      this.isScanning = false;\n    }\n  }\n\n  private async analyzeWithStrategies(instrument: { symbol: string; assetClass: string; currentPrice: number }): Promise<{ signals: StrategySignal[]; pendingSetups: any[] }> {\n    const { symbol, assetClass, currentPrice } = instrument;\n\n    let livePrice = currentPrice;\n    try {\n      const validAssetClass = assetClass as 'forex' | 'stock' | 'commodity' | 'crypto';\n      const priceResult = await getPrice(symbol, validAssetClass);\n      if (priceResult && priceResult.price) {\n        livePrice = priceResult.price;\n      }\n    } catch (error) {\n    }\n\n    const data = await fetchMultiTimeframeData(symbol, assetClass, livePrice);\n\n    const instrumentData: InstrumentData = {\n      symbol,\n      assetClass,\n      currentPrice: livePrice,\n      data,\n    };\n\n    const existingActiveSignals = await storage.getTradingSignals({ \n      symbol, \n      status: 'active' \n    });\n\n    const SIGNAL_COOLDOWN_MS = 2 * 60 * 60 * 1000;\n    const now = Date.now();\n    \n    const recentActiveSignals = existingActiveSignals.filter(signal => {\n      const createdAt = signal.createdAt ? new Date(signal.createdAt).getTime() : 0;\n      return (now - createdAt) < SIGNAL_COOLDOWN_MS;\n    });\n\n    if (recentActiveSignals.length > 0) {\n      return { signals: [], pendingSetups: [] };\n    }\n\n    const result = await strategyRegistry.runAllStrategiesWithPending(instrumentData);\n\n    return result;\n  }\n\n  private async saveWatchlistSignal(setup: any): Promise<void> {\n    try {\n      const existingWatchlist = await storage.getTradingSignals({\n        symbol: setup.symbol,\n        status: 'watchlist'\n      });\n\n      if (existingWatchlist.length > 0) {\n        return;\n      }\n\n      const now = new Date();\n      const expiresAt = new Date(now.getTime() + 4 * 60 * 60 * 1000);\n\n      await storage.createTradingSignal({\n        symbol: setup.symbol,\n        assetClass: setup.assetClass || 'forex',\n        type: setup.direction || 'buy',\n        strategy: 'Smart Money Concepts',\n        primaryTimeframe: setup.timeframe || '15M',\n        confirmationTimeframe: '1M',\n        entryPrice: setup.entryZone?.midPrice?.toString() || '0',\n        stopLoss: setup.stopLoss?.toString() || '0',\n        takeProfit: setup.takeProfit?.toString() || '0',\n        riskRewardRatio: setup.riskRewardRatio?.toString() || '2',\n        overallConfidence: setup.confidence || 50,\n        trendDirection: setup.trendDirection || 'sideways',\n        trendScore: (setup.confidence || 50).toString(),\n        smcScore: (setup.confidence || 50).toString(),\n        smcFactors: setup.confirmations || [],\n        orderBlockType: setup.entryZone?.type || 'demand',\n        orderBlockLevel: setup.entryZone?.topPrice?.toString() || '0',\n        fvgDetected: false,\n        fvgLevel: null,\n        liquiditySweep: false,\n        bocChochDetected: null,\n        technicalReasons: setup.confirmations || ['Pending LTF confirmation'],\n        marketContext: `Watchlist: ${setup.symbol} - awaiting entry confirmation`,\n        strength: setup.confidence >= 60 ? 'moderate' : 'weak',\n        status: 'watchlist',\n        expiresAt,\n      });\n\n      console.log(`[SignalScanner] Added to watchlist: ${setup.symbol} (${setup.confidence}% confidence)`);\n    } catch (error) {\n      console.error(`[SignalScanner] Error saving watchlist signal:`, error);\n    }\n  }\n\n  private async saveAndNotifySignal(signal: StrategySignal): Promise<void> {\n    try {\n      // Fetch MTF data for Gemini chart verification\n      let mtfData: MultiTimeframeData | undefined;\n      try {\n        const validAssetClass = (signal.assetClass || 'forex') as 'forex' | 'stock' | 'commodity' | 'crypto';\n        const fetchedData = await fetchMultiTimeframeData(signal.symbol, validAssetClass, signal.entryPrice);\n        mtfData = fetchedData as MultiTimeframeData;\n      } catch (e) {\n        console.log(`[Gemini] Could not fetch MTF data for ${signal.symbol}, proceeding without chart`);\n      }\n      \n      // Validate signal with Gemini AI before saving (with chart image)\n      const geminiValidation = await this.validateWithGemini(signal, mtfData);\n      \n      if (geminiValidation) {\n        if (geminiValidation.recommendation === 'skip') {\n          console.log(`[Gemini] REJECTED ${signal.symbol}: ${geminiValidation.reasoning}`);\n          return; // Don't save signals that Gemini recommends skipping\n        }\n        \n        // Adjust confidence based on Gemini's assessment\n        const adjustedConfidence = Math.max(0, Math.min(100, \n          signal.confidence + geminiValidation.confidenceAdjustment\n        ));\n        signal.confidence = adjustedConfidence;\n        \n        // Log Gemini's validation\n        console.log(`[Gemini] ${geminiValidation.recommendation.toUpperCase()} ${signal.symbol}: ` +\n          `${geminiValidation.validated ? 'Validated' : 'Concerns'} ` +\n          `(Confidence: ${signal.confidence}%, Adj: ${geminiValidation.confidenceAdjustment > 0 ? '+' : ''}${geminiValidation.confidenceAdjustment})`);\n        \n        if (geminiValidation.concerns.length > 0) {\n          console.log(`[Gemini] Concerns: ${geminiValidation.concerns.join(', ')}`);\n        }\n        if (geminiValidation.strengths.length > 0) {\n          console.log(`[Gemini] Strengths: ${geminiValidation.strengths.join(', ')}`);\n        }\n      }\n      \n      const now = new Date();\n      const expiresAt = new Date(signal.expiresAt);\n\n      const dbSignal = await storage.createTradingSignal({\n        symbol: signal.symbol,\n        assetClass: signal.assetClass || 'forex',\n        type: signal.direction,\n        strategy: signal.strategyName,\n        primaryTimeframe: signal.timeframe,\n        confirmationTimeframe: '1M',\n        entryPrice: signal.entryPrice.toString(),\n        stopLoss: signal.stopLoss.toString(),\n        takeProfit: signal.takeProfit.toString(),\n        riskRewardRatio: signal.riskRewardRatio.toString(),\n        overallConfidence: signal.confidence,\n        trendDirection: signal.marketContext.h4TrendDirection,\n        trendScore: signal.confidence.toString(),\n        smcScore: signal.confidence.toString(),\n        smcFactors: signal.entrySetup.confirmations,\n        orderBlockType: signal.entrySetup.entryZone.type,\n        orderBlockLevel: signal.entrySetup.entryZone.topPrice.toString(),\n        fvgDetected: false,\n        fvgLevel: null,\n        liquiditySweep: signal.entryType === 'liquidity_sweep',\n        bocChochDetected: signal.entryType === 'choch' ? signal.direction === 'buy' ? 'bullish' : 'bearish' : null,\n        technicalReasons: signal.reasoning.slice(0, 10),\n        marketContext: `${signal.strategyName} - ${signal.entryType} entry at ${signal.timeframe} zone`,\n        strength: signal.confidence >= 80 ? 'strong' : signal.confidence >= 60 ? 'moderate' : 'weak',\n        status: 'active',\n        expiresAt,\n      });\n\n      await notificationService.createNotification({\n        type: 'trading_signal',\n        title: `${signal.direction === 'buy' ? '' : ''} ${signal.symbol} - ${signal.direction.toUpperCase()}`,\n        message: `Strategy: ${signal.strategyName} | Entry: ${signal.entryType} | Confidence: ${signal.confidence}% | R:R: 1:${signal.riskRewardRatio}`,\n        metadata: JSON.stringify({\n          ...signal,\n          dbSignalId: dbSignal.id,\n        }),\n      });\n\n      // Prepare signal with confirmed findings for Telegram\n      const extendedContext = signal.marketContext as any;\n      const telegramSignal = {\n        symbol: signal.symbol,\n        type: signal.direction,\n        strategy: signal.strategyName,\n        entryPrice: signal.entryPrice,\n        stopLoss: signal.stopLoss,\n        takeProfit: signal.takeProfit,\n        riskRewardRatio: signal.riskRewardRatio,\n        overallConfidence: signal.confidence,\n        timeframe: signal.timeframe,\n        // Confirmed findings from analysis\n        trend: extendedContext?.h4TrendDirection || 'unknown',\n        htfTimeframe: extendedContext?.contextTimeframe || '1D',\n        zoneType: signal.entrySetup?.entryZone?.type || (signal.direction === 'buy' ? 'demand' : 'supply'),\n        zoneTimeframe: extendedContext?.zoneTimeframe || 'M15',\n        refinedTimeframe: extendedContext?.refinedTimeframe || signal.timeframe,\n        entryType: signal.entryType,\n        assetClass: signal.assetClass,\n        zones: signal.entrySetup?.entryZone ? {\n          m15: [signal.entrySetup.entryZone]\n        } : undefined,\n      };\n\n      await telegramNotificationService.sendTradingSignalNotification(telegramSignal);\n\n      console.log(`[SignalScanner] Signal saved and notifications sent: ${signal.symbol} ${signal.direction}`);\n\n    } catch (error) {\n      console.error(`[SignalScanner] Error saving signal for ${signal.symbol}:`, error);\n    }\n  }\n\n  private async validateWithGemini(signal: StrategySignal, mtfData?: MultiTimeframeData): Promise<{\n    validated: boolean;\n    confidenceAdjustment: number;\n    concerns: string[];\n    strengths: string[];\n    recommendation: 'proceed' | 'caution' | 'skip';\n    reasoning: string;\n  } | null> {\n    try {\n      // Check if Gemini is available\n      if (!process.env.GOOGLE_API_KEY) {\n        console.log('[Gemini] API key not configured, skipping validation');\n        return null;\n      }\n\n      console.log(`[Gemini] Generating multi-timeframe charts for ${signal.symbol} validation...`);\n      \n      // Generate charts across ALL timeframes for Gemini to verify\n      const chartPaths: string[] = [];\n      const extendedCtx = signal.marketContext as any;\n      \n      if (mtfData) {\n        try {\n          // Prepare zones for all charts\n          const supplyZones: ZoneInfo[] = [];\n          const demandZones: ZoneInfo[] = [];\n          \n          if (signal.entrySetup?.entryZone) {\n            const zone: ZoneInfo = {\n              top: signal.entrySetup.entryZone.topPrice,\n              bottom: signal.entrySetup.entryZone.bottomPrice,\n              strength: 'strong',\n              label: signal.entrySetup.entryZone.type === 'supply' ? 'Supply Zone' : 'Demand Zone'\n            };\n            if (signal.entrySetup.entryZone.type === 'supply') {\n              supplyZones.push(zone);\n            } else {\n              demandZones.push(zone);\n            }\n          }\n\n          // 1. HTF Context Chart (Daily/H4) - shows trend direction\n          const htfData = mtfData.d1 || mtfData.h4;\n          if (htfData && htfData.length > 0) {\n            const htfCandles: ChartCandle[] = htfData.slice(-30).map((c: Candle) => ({\n              date: new Date(c.timestamp).toISOString(),\n              open: c.open, high: c.high, low: c.low, close: c.close,\n            }));\n            const htfPath = path.join('/tmp', `gemini_htf_${signal.symbol.replace('/', '_')}_${Date.now()}.png`);\n            const htfResult = await generateSignalChart({\n              symbol: signal.symbol,\n              timeframe: mtfData.d1 ? '1D' : 'H4',\n              candles: htfCandles,\n              supply_zones: supplyZones,\n              demand_zones: demandZones,\n              confirmations: [`HTF Trend: ${extendedCtx?.h4TrendDirection || 'unknown'}`],\n              trend: extendedCtx?.h4TrendDirection || 'sideways',\n              output_path: htfPath,\n            });\n            if (htfResult.success && htfResult.path) {\n              chartPaths.push(htfResult.path);\n              console.log(`[Gemini] HTF chart generated: ${htfResult.path}`);\n            }\n          }\n\n          // 2. Zone Identification Chart (M15/M30) - shows the zone\n          const zoneData = mtfData.m15 || mtfData.m30;\n          if (zoneData && zoneData.length > 0) {\n            const zoneCandles: ChartCandle[] = zoneData.slice(-50).map((c: Candle) => ({\n              date: new Date(c.timestamp).toISOString(),\n              open: c.open, high: c.high, low: c.low, close: c.close,\n            }));\n            const zonePath = path.join('/tmp', `gemini_zone_${signal.symbol.replace('/', '_')}_${Date.now()}.png`);\n            const zoneResult = await generateSignalChart({\n              symbol: signal.symbol,\n              timeframe: mtfData.m15 ? 'M15' : 'M30',\n              candles: zoneCandles,\n              supply_zones: supplyZones,\n              demand_zones: demandZones,\n              confirmations: [`Zone: ${signal.entrySetup?.entryZone?.type || 'unknown'}`],\n              trend: extendedCtx?.h4TrendDirection || 'sideways',\n              output_path: zonePath,\n            });\n            if (zoneResult.success && zoneResult.path) {\n              chartPaths.push(zoneResult.path);\n              console.log(`[Gemini] Zone chart generated: ${zoneResult.path}`);\n            }\n          }\n\n          // 3. Entry/Refinement Chart (M5/M3/M1) - shows entry trigger\n          const entryData = mtfData.m5 || mtfData.m3 || mtfData.m1;\n          if (entryData && entryData.length > 0) {\n            const entryCandles: ChartCandle[] = entryData.slice(-60).map((c: Candle) => ({\n              date: new Date(c.timestamp).toISOString(),\n              open: c.open, high: c.high, low: c.low, close: c.close,\n            }));\n            const entryPath = path.join('/tmp', `gemini_entry_${signal.symbol.replace('/', '_')}_${Date.now()}.png`);\n            const entryResult = await generateSignalChart({\n              symbol: signal.symbol,\n              timeframe: signal.timeframe,\n              candles: entryCandles,\n              signal: {\n                direction: signal.direction.toUpperCase() as 'BUY' | 'SELL',\n                entry: signal.entryPrice,\n                stopLoss: signal.stopLoss,\n                takeProfit: signal.takeProfit,\n                confidence: signal.confidence,\n              },\n              supply_zones: supplyZones,\n              demand_zones: demandZones,\n              confirmations: signal.reasoning.slice(0, 5),\n              entry_type: signal.entryType,\n              trend: extendedCtx?.h4TrendDirection || 'sideways',\n              output_path: entryPath,\n            });\n            if (entryResult.success && entryResult.path) {\n              chartPaths.push(entryResult.path);\n              console.log(`[Gemini] Entry chart generated: ${entryResult.path}`);\n            }\n          }\n        } catch (chartError) {\n          console.log(`[Gemini] Chart generation failed, proceeding without images`);\n        }\n      }\n\n      // Build detailed analysis for Gemini to verify\n      const detailedAnalysis = `\n=== OUR ANALYSIS - PLEASE VERIFY ON THE CHART ===\n\nSYMBOL: ${signal.symbol}\nTIMEFRAME: ${signal.timeframe}\nSIGNAL: ${signal.direction.toUpperCase()}\n\n1. TREND ANALYSIS:\n   - Higher timeframe trend: ${signal.marketContext?.h4TrendDirection || 'unknown'}\n   - We believe the trend is ${signal.marketContext?.h4TrendDirection || 'sideways'} based on price structure\n   - Please verify: Can you see ${signal.marketContext?.h4TrendDirection === 'bullish' ? 'higher highs and higher lows' : signal.marketContext?.h4TrendDirection === 'bearish' ? 'lower highs and lower lows' : 'ranging price action'}?\n\n2. ZONE IDENTIFICATION:\n   - Zone type: ${signal.entrySetup?.entryZone?.type || 'unknown'}\n   - Zone range: ${signal.entrySetup?.entryZone?.bottomPrice?.toFixed(5)} - ${signal.entrySetup?.entryZone?.topPrice?.toFixed(5)}\n   - Please verify: Is this zone visible as a consolidation area before an impulsive move?\n   - Is the zone still unmitigated (price hasn't fully tested it)?\n\n3. ENTRY CONDITIONS:\n   - Entry type: ${signal.entryType}\n   - Entry price: ${signal.entryPrice.toFixed(5)}\n   - Current price should be at or near the zone\n   - Please verify: Is price actually at this zone level?\n\n4. OUR CONFIRMATIONS (please verify each):\n${signal.reasoning.map((r, i) => `   ${i + 1}. ${r}`).join('\\n')}\n\n5. RISK MANAGEMENT:\n   - Stop Loss: ${signal.stopLoss.toFixed(5)}\n   - Take Profit: ${signal.takeProfit.toFixed(5)}\n   - Risk:Reward = 1:${signal.riskRewardRatio.toFixed(2)}\n\n6. CURRENT CONFIDENCE: ${signal.confidence}%\n\nQUESTION: Looking at the chart, can you confirm that:\n- The trend direction we identified is correct?\n- The zone we marked actually exists and is valid?\n- Price is currently at or near this zone?\n- Our stated confirmations are visible on the chart?\n- This is a high-probability setup worth taking?\n`;\n\n      // Prepare signal data for validation\n      const signalToValidate: SignalToValidate = {\n        symbol: signal.symbol,\n        direction: signal.direction.toUpperCase() as 'BUY' | 'SELL',\n        entryPrice: signal.entryPrice,\n        stopLoss: signal.stopLoss,\n        takeProfit: signal.takeProfit,\n        confidence: signal.confidence,\n        strategy: signal.strategyName,\n        entryType: signal.entryType,\n        reasoning: detailedAnalysis,\n        zones: signal.entrySetup?.entryZone ? [{\n          type: signal.entrySetup.entryZone.type,\n          top: signal.entrySetup.entryZone.topPrice,\n          bottom: signal.entrySetup.entryZone.bottomPrice\n        }] : undefined\n      };\n\n      // Prepare price data with actual candles\n      const priceData: PriceData[] = [];\n      if (mtfData) {\n        if (mtfData.h4) {\n          priceData.push({\n            symbol: signal.symbol,\n            timeframe: '4H',\n            candles: mtfData.h4.slice(-20).map((c: Candle) => ({\n              date: new Date(c.timestamp).toISOString(),\n              open: c.open,\n              high: c.high,\n              low: c.low,\n              close: c.close,\n            }))\n          });\n        }\n        if (mtfData.m15) {\n          priceData.push({\n            symbol: signal.symbol,\n            timeframe: '15M',\n            candles: mtfData.m15.slice(-30).map((c: Candle) => ({\n              date: new Date(c.timestamp).toISOString(),\n              open: c.open,\n              high: c.high,\n              low: c.low,\n              close: c.close,\n            }))\n          });\n        }\n      }\n\n      console.log(`[Gemini] Validating ${signal.symbol} ${signal.direction} with ${chartPaths.length} chart images...`);\n      \n      const result = await validateSignalWithGemini(signalToValidate, priceData, chartPaths);\n      \n      // Clean up temp chart files\n      for (const chartPath of chartPaths) {\n        if (fs.existsSync(chartPath)) {\n          try {\n            fs.unlinkSync(chartPath);\n          } catch (e) {}\n        }\n      }\n      \n      return result;\n    } catch (error: any) {\n      console.error(`[Gemini] Validation error for ${signal.symbol}:`, error.message || error);\n      return null; // Proceed without Gemini validation if it fails\n    }\n  }\n\n  async cleanupExpiredSignals(): Promise<void> {\n    try {\n      const allSignals = await storage.getTradingSignals({ status: 'active' });\n      const now = new Date();\n\n      for (const signal of allSignals) {\n        if (signal.expiresAt && new Date(signal.expiresAt) <= now) {\n          const timeDuration = Math.floor((now.getTime() - new Date(signal.createdAt!).getTime()) / (1000 * 60));\n          const durationText = `${Math.floor(timeDuration / 60)}h ${timeDuration % 60}m`;\n\n          await storage.createTrade({\n            userId: null,\n            symbol: signal.symbol,\n            type: signal.type,\n            strategy: signal.strategy,\n            entryPrice: signal.entryPrice,\n            exitPrice: signal.entryPrice,\n            quantity: '1',\n            pnl: '0',\n            pnlPercent: '0',\n            outcome: 'expired',\n            timeframe: signal.primaryTimeframe,\n            entryReason: signal.marketContext || `${signal.strategy} setup - ${signal.overallConfidence}% confidence`,\n            exitDate: now,\n            duration: durationText\n          });\n\n          await storage.deleteTradingSignal(signal.id);\n\n          console.log(`[SignalScanner] Expired signal archived: ${signal.symbol} - ${signal.type} (Duration: ${durationText})`);\n        }\n      }\n    } catch (error) {\n      console.error('[SignalScanner] Error cleaning up expired signals:', error);\n    }\n  }\n\n  getStrategyStats() {\n    return strategyRegistry.getStats();\n  }\n\n  enableStrategy(strategyId: string): boolean {\n    return strategyRegistry.enableStrategy(strategyId);\n  }\n\n  disableStrategy(strategyId: string): boolean {\n    return strategyRegistry.disableStrategy(strategyId);\n  }\n}\n\nexport const signalScannerService = new SignalScannerService();\n","path":null,"size_bytes":27889,"size_tokens":null},"server/services/liquiditySweepDetection.ts":{"content":"import { type Candle } from './marketData';\n\nexport interface LiquidityPool {\n  price: number;\n  type: 'high' | 'low';\n  poolType: 'equal_levels' | 'swing' | 'session' | 'daily' | 'weekly' | 'monthly';\n  sessionName?: string; // For session pools: 'Asian', 'London', 'NY'\n  occurrences?: number; // For equal levels\n  indices: number[];\n  swept: boolean;\n  sweepIndex?: number;\n  strength: 'strong' | 'moderate' | 'weak';\n}\n\n// Legacy type alias for backward compatibility\nexport type EqualLevel = LiquidityPool;\n\nexport interface SupplyDemandZone {\n  type: 'supply' | 'demand';\n  topPrice: number;\n  bottomPrice: number;\n  formationIndex: number;\n  strength: 'strong' | 'moderate' | 'weak';\n  mitigated: boolean;\n  mitigationIndex?: number;\n}\n\nexport interface LiquiditySweepResult {\n  sweepDetected: boolean;\n  sweepType?: 'bullish_sweep' | 'bearish_sweep';\n  sweptLevel?: EqualLevel;\n  supplyDemandZone?: SupplyDemandZone;\n  entryPrice?: number;\n  stopLoss?: number;\n  confidence: number;\n  reasoning: string[];\n}\n\nexport interface SwingPoint {\n  price: number;\n  index: number;\n  type: 'HH' | 'HL' | 'LH' | 'LL'; // Higher High, Higher Low, Lower High, Lower Low\n}\n\nexport interface CHoCHResult {\n  detected: boolean;\n  chochType?: 'bullish_choch' | 'bearish_choch'; // Bullish CHoCH = trend changed to bullish\n  chochIndex?: number;\n  chochPrice?: number;\n  previousTrend?: 'uptrend' | 'downtrend';\n  targetZone?: SupplyDemandZone;\n  levelsBroken?: number; // Number of levels broken without mitigation\n  entryValid: boolean;\n  confidence: number;\n  reasoning: string[];\n}\n\nexport class LiquiditySweepDetector {\n  private readonly EQUAL_LEVEL_TOLERANCE = 0.0015; // 0.15% tolerance for equal highs/lows\n  private readonly MIN_OCCURRENCES = 2; // Minimum equal highs/lows to form liquidity pool\n  private readonly SWEEP_CONFIRMATION_PIPS = 5; // Pips beyond level to confirm sweep\n  \n  /**\n   * Detect equal highs or lows that form liquidity pools\n   */\n  detectEqualLevels(candles: Candle[], lookback: number = 20): EqualLevel[] {\n    const levels: EqualLevel[] = [];\n    const recentCandles = candles.slice(-lookback);\n    const startIndex = candles.length - recentCandles.length; // Handle any size\n    \n    // Find equal highs\n    const highs = recentCandles.map((c, i) => ({ price: c.high, index: startIndex + i }));\n    const equalHighs = this.findEqualPrices(highs, 'high');\n    levels.push(...equalHighs);\n    \n    // Find equal lows\n    const lows = recentCandles.map((c, i) => ({ price: c.low, index: startIndex + i }));\n    const equalLows = this.findEqualPrices(lows, 'low');\n    levels.push(...equalLows);\n    \n    return levels.filter(level => (level.occurrences || 0) >= this.MIN_OCCURRENCES);\n  }\n  \n  /**\n   * Find prices that are equal within tolerance\n   */\n  private findEqualPrices(\n    priceData: { price: number; index: number }[],\n    type: 'high' | 'low'\n  ): EqualLevel[] {\n    const levels: Map<number, EqualLevel> = new Map();\n    \n    for (let i = 0; i < priceData.length; i++) {\n      const { price, index } = priceData[i];\n      let foundLevel = false;\n      \n      // Check if this price matches any existing level\n      for (const [key, level] of Array.from(levels.entries())) {\n        const tolerance = key * this.EQUAL_LEVEL_TOLERANCE;\n        if (Math.abs(price - key) <= tolerance) {\n          level.occurrences = (level.occurrences || 0) + 1;\n          level.indices.push(index);\n          foundLevel = true;\n          break;\n        }\n      }\n      \n      // Create new level if no match found\n      if (!foundLevel) {\n        levels.set(price, {\n          price,\n          type,\n          poolType: 'equal_levels',\n          occurrences: 1,\n          indices: [index],\n          swept: false,\n          strength: 'moderate', // Will be calculated based on occurrences later\n        });\n      }\n    }\n    \n    return Array.from(levels.values());\n  }\n  \n  /**\n   * Detect swing highs and lows (local peaks/troughs)\n   */\n  detectSwingLevels(candles: Candle[], lookback: number = 20): LiquidityPool[] {\n    const pools: LiquidityPool[] = [];\n    const recentCandles = candles.slice(-lookback);\n    const startIndex = candles.length - recentCandles.length; // Handle any size\n    \n    for (let i = 2; i < recentCandles.length - 2; i++) {\n      const current = recentCandles[i];\n      \n      // Check for swing high\n      if (current.high > recentCandles[i-1].high && \n          current.high > recentCandles[i-2].high &&\n          current.high > recentCandles[i+1].high &&\n          current.high > recentCandles[i+2].high) {\n        pools.push({\n          price: current.high,\n          type: 'high',\n          poolType: 'swing',\n          indices: [startIndex + i], //  Absolute index\n          swept: false,\n          strength: 'moderate',\n        });\n      }\n      \n      // Check for swing low\n      if (current.low < recentCandles[i-1].low && \n          current.low < recentCandles[i-2].low &&\n          current.low < recentCandles[i+1].low &&\n          current.low < recentCandles[i+2].low) {\n        pools.push({\n          price: current.low,\n          type: 'low',\n          poolType: 'swing',\n          indices: [startIndex + i], //  Absolute index\n          swept: false,\n          strength: 'moderate',\n        });\n      }\n    }\n    \n    return pools;\n  }\n\n  /**\n   * Detect session highs and lows (Asian, London, NY)\n   */\n  detectSessionLevels(candles: Candle[]): LiquidityPool[] {\n    const pools: LiquidityPool[] = [];\n    \n    // Get last 24 hours of data (or whatever is available)\n    const last24h = candles.slice(-24);\n    const startIndex = candles.length - last24h.length; // Handle < 24 candles\n    \n    // Session times in UTC\n    const sessions = [\n      { name: 'Asian', startHour: 0, endHour: 9 },\n      { name: 'London', startHour: 8, endHour: 17 },\n      { name: 'NY', startHour: 13, endHour: 22 },\n    ];\n    \n    for (const session of sessions) {\n      // Filter candles using actual timestamp UTC hours\n      const sessionCandlesWithIndex = last24h\n        .map((c, i) => ({\n          candle: c,\n          originalIndex: startIndex + i, // Correct index calculation\n        }))\n        .filter(({ candle }) => {\n          const utcHour = candle.timestamp.getUTCHours(); // Already a Date object\n          return utcHour >= session.startHour && utcHour < session.endHour;\n        });\n      \n      if (sessionCandlesWithIndex.length > 0) {\n        const sessionHigh = Math.max(...sessionCandlesWithIndex.map(s => s.candle.high));\n        const sessionLow = Math.min(...sessionCandlesWithIndex.map(s => s.candle.low));\n        \n        const highItem = sessionCandlesWithIndex.find(s => s.candle.high === sessionHigh);\n        const lowItem = sessionCandlesWithIndex.find(s => s.candle.low === sessionLow);\n        \n        if (highItem) {\n          pools.push({\n            price: sessionHigh,\n            type: 'high',\n            poolType: 'session',\n            sessionName: session.name,\n            indices: [highItem.originalIndex],\n            swept: false,\n            strength: 'strong', // Session levels are considered strong\n          });\n        }\n        \n        if (lowItem) {\n          pools.push({\n            price: sessionLow,\n            type: 'low',\n            poolType: 'session',\n            sessionName: session.name,\n            indices: [lowItem.originalIndex],\n            swept: false,\n            strength: 'strong',\n          });\n        }\n      }\n    }\n    \n    return pools;\n  }\n\n  /**\n   * Detect daily, weekly, and monthly highs/lows\n   */\n  detectTimeframeLevels(candles: Candle[]): LiquidityPool[] {\n    const pools: LiquidityPool[] = [];\n    \n    // Daily high/low (last 24 H1 candles or whatever is available)\n    const dailyCandles = candles.slice(-24);\n    if (dailyCandles.length > 0) {\n      const dailyStartIndex = candles.length - dailyCandles.length;\n      const dailyHigh = Math.max(...dailyCandles.map(c => c.high));\n      const dailyLow = Math.min(...dailyCandles.map(c => c.low));\n      const highIndex = dailyCandles.findIndex(c => c.high === dailyHigh);\n      const lowIndex = dailyCandles.findIndex(c => c.low === dailyLow);\n      \n      pools.push({\n        price: dailyHigh,\n        type: 'high',\n        poolType: 'daily',\n        indices: [dailyStartIndex + highIndex],\n        swept: false,\n        strength: 'strong',\n      });\n      \n      pools.push({\n        price: dailyLow,\n        type: 'low',\n        poolType: 'daily',\n        indices: [dailyStartIndex + lowIndex],\n        swept: false,\n        strength: 'strong',\n      });\n    }\n    \n    // Weekly high/low (last 120 H1 candles ~5 days or whatever is available)\n    const weeklyCandles = candles.slice(-120);\n    if (weeklyCandles.length > 0) {\n      const weeklyStartIndex = candles.length - weeklyCandles.length;\n      const weeklyHigh = Math.max(...weeklyCandles.map(c => c.high));\n      const weeklyLow = Math.min(...weeklyCandles.map(c => c.low));\n      const highIndex = weeklyCandles.findIndex(c => c.high === weeklyHigh);\n      const lowIndex = weeklyCandles.findIndex(c => c.low === weeklyLow);\n      \n      pools.push({\n        price: weeklyHigh,\n        type: 'high',\n        poolType: 'weekly',\n        indices: [weeklyStartIndex + highIndex],\n        swept: false,\n        strength: 'strong',\n      });\n      \n      pools.push({\n        price: weeklyLow,\n        type: 'low',\n        poolType: 'weekly',\n        indices: [weeklyStartIndex + lowIndex],\n        swept: false,\n        strength: 'strong',\n      });\n    }\n    \n    // Monthly high/low (last 500 H1 candles ~20 days or whatever is available)\n    const monthlyCandles = candles.slice(-500);\n    if (monthlyCandles.length > 0) {\n      const monthlyStartIndex = candles.length - monthlyCandles.length;\n      const monthlyHigh = Math.max(...monthlyCandles.map(c => c.high));\n      const monthlyLow = Math.min(...monthlyCandles.map(c => c.low));\n      const highIndex = monthlyCandles.findIndex(c => c.high === monthlyHigh);\n      const lowIndex = monthlyCandles.findIndex(c => c.low === monthlyLow);\n      \n      pools.push({\n        price: monthlyHigh,\n        type: 'high',\n        poolType: 'monthly',\n        indices: [monthlyStartIndex + highIndex],\n        swept: false,\n        strength: 'strong',\n      });\n      \n      pools.push({\n        price: monthlyLow,\n        type: 'low',\n        poolType: 'monthly',\n        indices: [monthlyStartIndex + lowIndex],\n        swept: false,\n        strength: 'strong',\n      });\n    }\n    \n    return pools;\n  }\n\n  /**\n   * Detect if a liquidity level has been swept\n   */\n  detectLiquiditySweep(\n    candles: Candle[],\n    equalLevels: EqualLevel[]\n  ): EqualLevel | null {\n    const latestCandles = candles.slice(-10);\n    \n    for (const level of equalLevels) {\n      if (level.swept) continue;\n      \n      for (let i = 0; i < latestCandles.length; i++) {\n        const candle = latestCandles[i];\n        \n        if (level.type === 'high') {\n          // Check if price swept above equal highs\n          if (candle.high > level.price + (this.SWEEP_CONFIRMATION_PIPS * 0.0001)) {\n            level.swept = true;\n            level.sweepIndex = candles.length - latestCandles.length + i;\n            return level;\n          }\n        } else {\n          // Check if price swept below equal lows\n          if (candle.low < level.price - (this.SWEEP_CONFIRMATION_PIPS * 0.0001)) {\n            level.swept = true;\n            level.sweepIndex = candles.length - latestCandles.length + i;\n            return level;\n          }\n        }\n      }\n    }\n    \n    return null;\n  }\n  \n  /**\n   * Identify supply and demand zones\n   * Marks zones at the BASE candle (last candle before impulse) per SMC methodology\n   */\n  identifySupplyDemandZones(candles: Candle[], lookback: number = 50): SupplyDemandZone[] {\n    const zones: SupplyDemandZone[] = [];\n    const recentCandles = candles.slice(-lookback);\n    const startIndex = candles.length - recentCandles.length;\n    \n    for (let i = 1; i < recentCandles.length - 1; i++) {\n      const base = recentCandles[i - 1]; // Last candle before impulse\n      const impulse = recentCandles[i]; // The impulse candle\n      const confirmation = recentCandles[i + 1]; // Confirmation candle\n      \n      // Detect supply zone: Mark zone on BASE candle before bearish impulse\n      // Base candle can be bullish or bearish - use FULL RANGE (high to low)\n      if (this.isSupplyZone(base, impulse, confirmation)) {\n        const zone: SupplyDemandZone = {\n          type: 'supply',\n          topPrice: base.high, // Full high of base candle\n          bottomPrice: base.low, // Full low of base candle\n          formationIndex: startIndex + (i - 1), // Index of BASE candle\n          strength: this.calculateZoneStrength(impulse, recentCandles.slice(i + 1)),\n          mitigated: false, // Fresh/unmitigated zone\n        };\n        zones.push(zone);\n      }\n      \n      // Detect demand zone: Mark zone on BASE candle before bullish impulse\n      // Base candle can be bullish or bearish - use FULL RANGE (high to low)\n      if (this.isDemandZone(base, impulse, confirmation)) {\n        const zone: SupplyDemandZone = {\n          type: 'demand',\n          topPrice: base.high, // Full high of base candle\n          bottomPrice: base.low, // Full low of base candle\n          formationIndex: startIndex + (i - 1), // Index of BASE candle\n          strength: this.calculateZoneStrength(impulse, recentCandles.slice(i + 1)),\n          mitigated: false, // Fresh/unmitigated zone\n        };\n        zones.push(zone);\n      }\n    }\n    \n    return zones;\n  }\n  \n  /**\n   * Check if pattern forms a supply zone\n   */\n  private isSupplyZone(prev: Candle, curr: Candle, next: Candle): boolean {\n    // Strong bearish candle after consolidation/bullish move\n    const isBearish = curr.close < curr.open;\n    const hasImpulse = (curr.open - curr.close) > (curr.high - curr.low) * 0.6;\n    const followThrough = next.close < curr.close;\n    \n    return isBearish && hasImpulse && followThrough;\n  }\n  \n  /**\n   * Check if pattern forms a demand zone\n   */\n  private isDemandZone(prev: Candle, curr: Candle, next: Candle): boolean {\n    // Strong bullish candle after consolidation/bearish move\n    const isBullish = curr.close > curr.open;\n    const hasImpulse = (curr.close - curr.open) > (curr.high - curr.low) * 0.6;\n    const followThrough = next.close > curr.close;\n    \n    return isBullish && hasImpulse && followThrough;\n  }\n  \n  /**\n   * Calculate zone strength based on subsequent price action\n   */\n  private calculateZoneStrength(\n    formationCandle: Candle,\n    subsequentCandles: Candle[]\n  ): 'strong' | 'moderate' | 'weak' {\n    const bodySize = Math.abs(formationCandle.close - formationCandle.open);\n    const wickSize = formationCandle.high - formationCandle.low - bodySize;\n    const bodyToWickRatio = bodySize / (bodySize + wickSize);\n    \n    // Check if zone has been respected\n    const touches = subsequentCandles.filter(c => \n      c.low <= formationCandle.high && c.high >= formationCandle.low\n    ).length;\n    \n    if (bodyToWickRatio > 0.7 && touches === 0) return 'strong';\n    if (bodyToWickRatio > 0.5 && touches <= 1) return 'moderate';\n    return 'weak';\n  }\n  \n  /**\n   * Detect zone mitigation (when price revisits supply/demand zone)\n   * Requires structural confirmation: close within zone + reaction\n   */\n  detectZoneMitigation(\n    candles: Candle[],\n    zone: SupplyDemandZone,\n    afterSweep: boolean = false\n  ): boolean {\n    const relevantCandles = afterSweep ? candles.slice(-5) : candles.slice(-10);\n    \n    for (let i = 0; i < relevantCandles.length - 1; i++) {\n      const current = relevantCandles[i];\n      const next = relevantCandles[i + 1];\n      \n      // Check if candle CLOSES within the zone (not just wicks)\n      const closeInZone = current.close >= zone.bottomPrice && current.close <= zone.topPrice;\n      \n      if (!closeInZone) continue;\n      \n      // Verify structural reaction based on zone type\n      let hasReaction = false;\n      \n      if (zone.type === 'supply') {\n        // For supply zone: next candle should move down (rejection from supply)\n        hasReaction = next.close < current.close;\n      } else {\n        // For demand zone: next candle should move up (bounce from demand)\n        hasReaction = next.close > current.close;\n      }\n      \n      // Mitigation confirmed only when close is in zone AND there's a reaction\n      if (hasReaction) {\n        zone.mitigated = true;\n        zone.mitigationIndex = candles.length - relevantCandles.length + i;\n        return true;\n      }\n    }\n    \n    return false;\n  }\n  \n  /**\n   * Detect ALL liquidity pools (equal levels, swing, session, timeframe)\n   */\n  detectAllLiquidityPools(candles: Candle[]): LiquidityPool[] {\n    const allPools: LiquidityPool[] = [];\n    \n    // 1. Equal highs/lows\n    const equalLevels = this.detectEqualLevels(candles, 30);\n    allPools.push(...equalLevels);\n    \n    // 2. Swing highs/lows\n    const swingLevels = this.detectSwingLevels(candles, 20);\n    allPools.push(...swingLevels);\n    \n    // 3. Session highs/lows\n    const sessionLevels = this.detectSessionLevels(candles);\n    allPools.push(...sessionLevels);\n    \n    // 4. Daily/Weekly/Monthly highs/lows\n    const timeframeLevels = this.detectTimeframeLevels(candles);\n    allPools.push(...timeframeLevels);\n    \n    return allPools;\n  }\n\n  /**\n   * Main function: Analyze for liquidity sweep with supply/demand entry\n   */\n  analyzeLiquiditySweep(candles: Candle[]): LiquiditySweepResult {\n    const reasoning: string[] = [];\n    \n    // Step 1: Identify ALL liquidity pools\n    const allPools = this.detectAllLiquidityPools(candles);\n    \n    if (allPools.length === 0) {\n      return {\n        sweepDetected: false,\n        confidence: 0,\n        reasoning: ['No liquidity pools detected'],\n      };\n    }\n    \n    // Count pools by type for reporting\n    const poolCounts = {\n      equal_levels: allPools.filter(p => p.poolType === 'equal_levels').length,\n      swing: allPools.filter(p => p.poolType === 'swing').length,\n      session: allPools.filter(p => p.poolType === 'session').length,\n      daily: allPools.filter(p => p.poolType === 'daily').length,\n      weekly: allPools.filter(p => p.poolType === 'weekly').length,\n      monthly: allPools.filter(p => p.poolType === 'monthly').length,\n    };\n    \n    const poolTypesSummary = Object.entries(poolCounts)\n      .filter(([_, count]) => count > 0)\n      .map(([type, count]) => `${count} ${type.replace('_', ' ')}`)\n      .join(', ');\n    \n    reasoning.push(`Identified liquidity pools: ${poolTypesSummary}`);\n    \n    // Step 2: Detect liquidity sweep\n    const sweptLevel = this.detectLiquiditySweep(candles, allPools);\n    \n    if (!sweptLevel) {\n      return {\n        sweepDetected: false,\n        confidence: 0,\n        reasoning: [...reasoning, 'No liquidity sweep detected'],\n      };\n    }\n    \n    // Create descriptive label for the swept pool\n    let poolLabel = '';\n    if (sweptLevel.poolType === 'equal_levels') {\n      poolLabel = sweptLevel.type === 'high' ? 'Equal Highs' : 'Equal Lows';\n    } else if (sweptLevel.poolType === 'swing') {\n      poolLabel = sweptLevel.type === 'high' ? 'Swing High' : 'Swing Low';\n    } else if (sweptLevel.poolType === 'session') {\n      poolLabel = `${sweptLevel.sessionName} ${sweptLevel.type === 'high' ? 'High' : 'Low'}`;\n    } else if (sweptLevel.poolType === 'daily') {\n      poolLabel = sweptLevel.type === 'high' ? 'Daily High' : 'Daily Low';\n    } else if (sweptLevel.poolType === 'weekly') {\n      poolLabel = sweptLevel.type === 'high' ? 'Weekly High' : 'Weekly Low';\n    } else if (sweptLevel.poolType === 'monthly') {\n      poolLabel = sweptLevel.type === 'high' ? 'Monthly High' : 'Monthly Low';\n    }\n    \n    reasoning.push(\n      `Liquidity sweep detected at ${sweptLevel.price.toFixed(5)} (${poolLabel})`\n    );\n    \n    // Step 3: Identify supply/demand zones\n    const zones = this.identifySupplyDemandZones(candles, 50);\n    \n    if (zones.length === 0) {\n      return {\n        sweepDetected: true,\n        sweepType: sweptLevel.type === 'high' ? 'bearish_sweep' : 'bullish_sweep',\n        sweptLevel,\n        confidence: 40,\n        reasoning: [...reasoning, 'No supply/demand zones identified for entry'],\n      };\n    }\n    \n    // Step 4: Find valid zone for entry AFTER sweep\n    const sweepType = sweptLevel.type === 'high' ? 'bearish_sweep' : 'bullish_sweep';\n    const targetZoneType = sweepType === 'bearish_sweep' ? 'supply' : 'demand';\n    \n    // Look for zones that were formed before the sweep\n    const validZones = zones.filter(z => \n      z.type === targetZoneType && \n      z.formationIndex < (sweptLevel.sweepIndex || 0) &&\n      !z.mitigated\n    );\n    \n    if (validZones.length === 0) {\n      return {\n        sweepDetected: true,\n        sweepType,\n        sweptLevel,\n        confidence: 45,\n        reasoning: [...reasoning, `No valid ${targetZoneType} zones found before sweep`],\n      };\n    }\n    \n    // Step 5: Check for zone mitigation AFTER sweep\n    const latestCandles = candles.slice(-5);\n    let mitigatedZone: SupplyDemandZone | undefined;\n    \n    for (const zone of validZones) {\n      if (this.detectZoneMitigation(candles, zone, true)) {\n        mitigatedZone = zone;\n        break;\n      }\n    }\n    \n    if (!mitigatedZone) {\n      return {\n        sweepDetected: true,\n        sweepType,\n        sweptLevel,\n        supplyDemandZone: validZones[0],\n        confidence: 55,\n        reasoning: [\n          ...reasoning,\n          `${validZones.length} ${targetZoneType} zone(s) identified`,\n          'Waiting for price to mitigate zone after sweep'\n        ],\n      };\n    }\n    \n    // Step 6: Calculate entry and stop loss based on mitigated zone\n    const latestCandle = candles[candles.length - 1];\n    let entryPrice: number;\n    let stopLoss: number;\n    \n    if (sweepType === 'bearish_sweep') {\n      // Enter short at supply zone mitigation\n      entryPrice = (mitigatedZone.topPrice + mitigatedZone.bottomPrice) / 2;\n      stopLoss = mitigatedZone.topPrice + (mitigatedZone.topPrice - mitigatedZone.bottomPrice) * 0.2;\n      \n      reasoning.push(\n        'Supply zone mitigation confirmed after liquidity sweep',\n        `Entry: ${entryPrice.toFixed(5)} (Supply zone)`,\n        `Stop: ${stopLoss.toFixed(5)} (Above supply zone)`\n      );\n    } else {\n      // Enter long at demand zone mitigation\n      entryPrice = (mitigatedZone.topPrice + mitigatedZone.bottomPrice) / 2;\n      stopLoss = mitigatedZone.bottomPrice - (mitigatedZone.topPrice - mitigatedZone.bottomPrice) * 0.2;\n      \n      reasoning.push(\n        'Demand zone mitigation confirmed after liquidity sweep',\n        `Entry: ${entryPrice.toFixed(5)} (Demand zone)`,\n        `Stop: ${stopLoss.toFixed(5)} (Below demand zone)`\n      );\n    }\n    \n    // Calculate confidence based on zone strength and sweep clarity\n    let confidence = 70;\n    if (mitigatedZone.strength === 'strong') confidence += 15;\n    else if (mitigatedZone.strength === 'moderate') confidence += 8;\n    \n    // Multiple equal levels = stronger liquidity pool\n    if (sweptLevel.poolType === 'equal_levels' && (sweptLevel.occurrences || 0) >= 3) {\n      confidence += 10;\n    }\n    \n    return {\n      sweepDetected: true,\n      sweepType,\n      sweptLevel,\n      supplyDemandZone: mitigatedZone,\n      entryPrice,\n      stopLoss,\n      confidence: Math.min(confidence, 95),\n      reasoning,\n    };\n  }\n\n  /**\n   * Identify swing points (HH, HL, LH, LL) for trend analysis\n   */\n  private identifySwingPoints(candles: Candle[], lookback: number = 30): SwingPoint[] {\n    const swingPoints: SwingPoint[] = [];\n    const recentCandles = candles.slice(-lookback);\n    const startIndex = candles.length - recentCandles.length;\n    \n    // Need at least 5 candles to identify swing points\n    if (recentCandles.length < 5) return swingPoints;\n    \n    let prevHigh: { price: number; index: number } | null = null;\n    let prevLow: { price: number; index: number } | null = null;\n    \n    for (let i = 2; i < recentCandles.length - 2; i++) {\n      const current = recentCandles[i];\n      const absoluteIndex = startIndex + i;\n      \n      // Detect swing high (local peak)\n      if (current.high > recentCandles[i-1].high && \n          current.high > recentCandles[i-2].high &&\n          current.high > recentCandles[i+1].high &&\n          current.high > recentCandles[i+2].high) {\n        \n        if (prevHigh) {\n          // Compare with previous high to determine HH or LH\n          if (current.high > prevHigh.price) {\n            swingPoints.push({\n              price: current.high,\n              index: absoluteIndex,\n              type: 'HH', // Higher High\n            });\n          } else {\n            swingPoints.push({\n              price: current.high,\n              index: absoluteIndex,\n              type: 'LH', // Lower High\n            });\n          }\n        }\n        prevHigh = { price: current.high, index: absoluteIndex };\n      }\n      \n      // Detect swing low (local trough)\n      if (current.low < recentCandles[i-1].low && \n          current.low < recentCandles[i-2].low &&\n          current.low < recentCandles[i+1].low &&\n          current.low < recentCandles[i+2].low) {\n        \n        if (prevLow) {\n          // Compare with previous low to determine HL or LL\n          if (current.low > prevLow.price) {\n            swingPoints.push({\n              price: current.low,\n              index: absoluteIndex,\n              type: 'HL', // Higher Low\n            });\n          } else {\n            swingPoints.push({\n              price: current.low,\n              index: absoluteIndex,\n              type: 'LL', // Lower Low\n            });\n          }\n        }\n        prevLow = { price: current.low, index: absoluteIndex };\n      }\n    }\n    \n    return swingPoints;\n  }\n\n  /**\n   * Detect CHoCH (Change of Character) - trend reversal signal\n   * Bullish CHoCH: Downtrend breaks (LH, LL  HH)\n   * Bearish CHoCH: Uptrend breaks (HH, HL  LL)\n   */\n  detectCHoCH(candles: Candle[], zones: SupplyDemandZone[]): CHoCHResult {\n    const reasoning: string[] = [];\n    const swingPoints = this.identifySwingPoints(candles);\n    \n    if (swingPoints.length < 3) {\n      return {\n        detected: false,\n        entryValid: false,\n        confidence: 0,\n        reasoning: ['Insufficient swing points for CHoCH detection'],\n      };\n    }\n    \n    // Analyze recent swing points to detect trend change\n    const recentSwings = swingPoints.slice(-5); // Look at last 5 swing points\n    \n    // Detect Bullish CHoCH: Downtrend (LH, LL) breaks with HH\n    const hasLH = recentSwings.some(s => s.type === 'LH');\n    const hasLL = recentSwings.some(s => s.type === 'LL');\n    const latestHH = recentSwings.filter(s => s.type === 'HH').pop();\n    \n    if (hasLH && hasLL && latestHH) {\n      reasoning.push('Bearish trend detected (LH, LL pattern)');\n      reasoning.push(`Bullish CHoCH: Price made Higher High at ${latestHH.price.toFixed(5)}`);\n      \n      return this.validateCHoCHEntry(\n        candles,\n        zones,\n        'bullish_choch',\n        latestHH.index,\n        latestHH.price,\n        'downtrend',\n        reasoning\n      );\n    }\n    \n    // Detect Bearish CHoCH: Uptrend (HH, HL) breaks with LL\n    const hasHH = recentSwings.some(s => s.type === 'HH');\n    const hasHL = recentSwings.some(s => s.type === 'HL');\n    const latestLL = recentSwings.filter(s => s.type === 'LL').pop();\n    \n    if (hasHH && hasHL && latestLL) {\n      reasoning.push('Bullish trend detected (HH, HL pattern)');\n      reasoning.push(`Bearish CHoCH: Price made Lower Low at ${latestLL.price.toFixed(5)}`);\n      \n      return this.validateCHoCHEntry(\n        candles,\n        zones,\n        'bearish_choch',\n        latestLL.index,\n        latestLL.price,\n        'uptrend',\n        reasoning\n      );\n    }\n    \n    return {\n      detected: false,\n      entryValid: false,\n      confidence: 0,\n      reasoning: ['No CHoCH pattern detected in recent price action'],\n    };\n  }\n\n  /**\n   * Validate CHoCH entry conditions\n   */\n  private validateCHoCHEntry(\n    candles: Candle[],\n    zones: SupplyDemandZone[],\n    chochType: 'bullish_choch' | 'bearish_choch',\n    chochIndex: number,\n    chochPrice: number,\n    previousTrend: 'uptrend' | 'downtrend',\n    reasoning: string[]\n  ): CHoCHResult {\n    // Determine target zone type based on CHoCH direction\n    const targetZoneType = chochType === 'bullish_choch' ? 'demand' : 'supply';\n    \n    // Find unmitigated zones BEFORE the CHoCH\n    const unmitigatedZones = zones.filter(z => \n      z.type === targetZoneType && \n      z.formationIndex < chochIndex &&\n      !z.mitigated\n    );\n    \n    if (unmitigatedZones.length === 0) {\n      reasoning.push(`No unmitigated ${targetZoneType} zones found before CHoCH`);\n      return {\n        detected: true,\n        chochType,\n        chochIndex,\n        chochPrice,\n        previousTrend,\n        entryValid: false,\n        confidence: 40,\n        levelsBroken: 0,\n        reasoning,\n      };\n    }\n    \n    // Get most recent unmitigated zone\n    const targetZone = unmitigatedZones[unmitigatedZones.length - 1];\n    \n    // Count levels broken between zone and CHoCH WITHOUT mitigation\n    const levelsBroken = this.countLevelsBrokenWithoutMitigation(\n      candles,\n      zones,\n      targetZone.formationIndex,\n      chochIndex,\n      targetZoneType\n    );\n    \n    reasoning.push(`Found unmitigated ${targetZoneType} zone from index ${targetZone.formationIndex}`);\n    reasoning.push(`Price broke ${levelsBroken} level(s) without mitigation`);\n    \n    // Entry is INVALID if price comes FROM an unmitigated zone (zone still in control)\n    if (this.priceComesFromUnmitigatedZone(candles, targetZone, chochIndex)) {\n      reasoning.push(`Entry INVALID: Price comes from unmitigated ${targetZoneType} zone (still in control)`);\n      return {\n        detected: true,\n        chochType,\n        chochIndex,\n        chochPrice,\n        previousTrend,\n        targetZone,\n        levelsBroken,\n        entryValid: false,\n        confidence: 35,\n        reasoning,\n      };\n    }\n    \n    // Entry requires 2+ levels broken\n    if (levelsBroken < 2) {\n      reasoning.push('Entry INVALID: Must break 2+ levels without mitigation');\n      return {\n        detected: true,\n        chochType,\n        chochIndex,\n        chochPrice,\n        previousTrend,\n        targetZone,\n        levelsBroken,\n        entryValid: false,\n        confidence: 45,\n        reasoning,\n      };\n    }\n    \n    // Valid CHoCH entry setup\n    reasoning.push(` Valid CHoCH entry: ${levelsBroken}+ levels broken, targeting unmitigated ${targetZoneType} zone`);\n    \n    let confidence = 75;\n    if (levelsBroken >= 3) confidence += 10;\n    if (targetZone.strength === 'strong') confidence += 10;\n    \n    return {\n      detected: true,\n      chochType,\n      chochIndex,\n      chochPrice,\n      previousTrend,\n      targetZone,\n      levelsBroken,\n      entryValid: true,\n      confidence: Math.min(confidence, 95),\n      reasoning,\n    };\n  }\n\n  /**\n   * Count demand/supply levels broken without mitigation\n   */\n  private countLevelsBrokenWithoutMitigation(\n    candles: Candle[],\n    zones: SupplyDemandZone[],\n    startIndex: number,\n    endIndex: number,\n    targetZoneType: 'demand' | 'supply'\n  ): number {\n    const relevantZones = zones.filter(z => \n      z.type === targetZoneType &&\n      z.formationIndex > startIndex &&\n      z.formationIndex < endIndex &&\n      !z.mitigated\n    );\n    \n    return relevantZones.length;\n  }\n\n  /**\n   * Check if price comes FROM an unmitigated zone (invalid entry)\n   */\n  private priceComesFromUnmitigatedZone(\n    candles: Candle[],\n    zone: SupplyDemandZone,\n    chochIndex: number\n  ): boolean {\n    // Check candles between zone formation and CHoCH\n    const relevantCandles = candles.slice(zone.formationIndex, chochIndex + 1);\n    \n    // If price was inside zone in the last 3-5 candles before CHoCH, it \"comes from\" the zone\n    const recentCandles = relevantCandles.slice(-5);\n    \n    for (const candle of recentCandles) {\n      if (candle.low <= zone.topPrice && candle.high >= zone.bottomPrice) {\n        return true; // Price was inside zone recently\n      }\n    }\n    \n    return false;\n  }\n}\n","path":null,"size_bytes":32346,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/components/Header.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Link, useLocation } from 'wouter';\nimport { Menu, X } from 'lucide-react';\nimport { SiTelegram } from 'react-icons/si';\n\nconst navLinks = [\n  { name: 'Home/Bias', path: '/' },\n  { name: 'Economic Calendar', path: '/calendar' },\n  { name: 'Major Pairs', path: '/major-pairs' },\n  { name: 'US Stocks', path: '/stocks' },\n  { name: 'Commodities', path: '/commodities' },\n  { name: 'Cryptocurrency', path: '/crypto' },\n  { name: 'History', path: '/history' },\n  { name: 'Blog', path: '/blog' },\n  { name: 'Premarket', path: '/premarket' },\n  { name: 'Stats', path: '/stats' },\n  { name: 'Charting', path: '/charting' },\n  { name: 'Research', path: '/research' },\n];\n\nconst SESSIONS = [\n  { name: 'Sydney', start: 22, end: 7, nextDayEnd: true },\n  { name: 'Tokyo', start: 0, end: 9 },\n  { name: 'London', start: 7, end: 16 },\n  { name: 'New York', start: 12, end: 21 }\n];\n\nfunction getSessionInfo(): { utcTime: string; sessionName: string | null; timeInSession: string } {\n  const now = new Date();\n  const utcHours = now.getUTCHours();\n  const utcMinutes = now.getUTCMinutes();\n  const utcSeconds = now.getUTCSeconds();\n  const utcTimeInMinutes = utcHours * 60 + utcMinutes;\n\n  const formatTime = (unit: number) => String(unit).padStart(2, '0');\n  const utcTime = `${formatTime(utcHours)}:${formatTime(utcMinutes)}:${formatTime(utcSeconds)}`;\n\n  let activeSession: string | null = null;\n  let timeInMinutes = 0;\n\n  for (const session of SESSIONS) {\n    const startTimeInMinutes = session.start * 60;\n    const endTimeInMinutes = session.end * 60;\n\n    let isActive = false;\n\n    if (session.nextDayEnd) {\n      if (utcTimeInMinutes >= startTimeInMinutes || utcTimeInMinutes < endTimeInMinutes) {\n        isActive = true;\n        if (utcTimeInMinutes >= startTimeInMinutes) {\n          timeInMinutes = utcTimeInMinutes - startTimeInMinutes;\n        } else {\n          const minutesInDay = 24 * 60;\n          timeInMinutes = (minutesInDay - startTimeInMinutes) + utcTimeInMinutes;\n        }\n      }\n    } else {\n      if (utcTimeInMinutes >= startTimeInMinutes && utcTimeInMinutes < endTimeInMinutes) {\n        isActive = true;\n        timeInMinutes = utcTimeInMinutes - startTimeInMinutes;\n      }\n    }\n\n    if (isActive) {\n      activeSession = session.name;\n      break;\n    }\n  }\n\n  let timeInSession = '';\n  if (activeSession) {\n    const hoursIn = Math.floor(timeInMinutes / 60);\n    const minutesIn = timeInMinutes % 60;\n    if (hoursIn > 0) {\n      timeInSession = `${hoursIn}h ${minutesIn}m`;\n    } else {\n      timeInSession = `${minutesIn}m`;\n    }\n  }\n\n  return { utcTime, sessionName: activeSession, timeInSession };\n}\n\nexport default function Header() {\n  const [location] = useLocation();\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const [sessionInfo, setSessionInfo] = useState(getSessionInfo());\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setSessionInfo(getSessionInfo());\n    }, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  const isActivePath = (path: string) => {\n    if (path === '/') return location === '/';\n    return location.startsWith(path);\n  };\n\n  const toggleMobileMenu = () => {\n    setMobileMenuOpen(!mobileMenuOpen);\n  };\n\n  return (\n    <header className=\"bg-white dark:bg-gray-900 shadow-md sticky top-0 z-50\" style={{ fontFamily: \"'Montserrat', sans-serif\" }}>\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"flex justify-between items-center py-4 border-b border-gray-100 dark:border-gray-800 lg:border-none\">\n          <div className=\"flex-shrink-0\">\n            <Link \n              href=\"/\" \n              className=\"text-xl sm:text-2xl font-extrabold text-gray-900 dark:text-gray-100 tracking-tight\"\n              data-testid=\"link-logo\"\n            >\n              F<span className=\"text-emerald-500\">S</span>D<span className=\"text-emerald-500\">ZONES</span>.com\n            </Link>\n          </div>\n\n          <div className=\"hidden md:flex items-center text-sm font-medium text-gray-600 dark:text-gray-400 gap-3 bg-gray-50 dark:bg-gray-800 px-4 py-2 rounded-lg shadow-inner\">\n            <span className=\"text-xs font-normal text-gray-400 dark:text-gray-500\">\n              UTC: <span className=\"font-semibold text-gray-800 dark:text-gray-200\" data-testid=\"text-utc-time\">{sessionInfo.utcTime}</span>\n            </span>\n            <span className=\"text-gray-300 dark:text-gray-600\">|</span>\n            <span data-testid=\"text-session-status\">\n              {sessionInfo.sessionName ? (\n                <>\n                  Session: <span className=\"font-bold text-emerald-600\">{sessionInfo.sessionName}</span> (<span className=\"font-bold text-emerald-600\">{sessionInfo.timeInSession}</span> In)\n                </>\n              ) : (\n                <>Session: <span className=\"font-bold text-gray-500\">Quiet</span></>\n              )}\n            </span>\n          </div>\n\n          <div className=\"hidden lg:flex items-center gap-6\">\n            <a \n              href=\"https://t.me/BuySellZonesBot\" \n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"text-sm font-medium text-blue-600 hover:text-blue-700 transition duration-150 flex items-center gap-1 p-2 rounded-full bg-blue-50 dark:bg-blue-900/30 hover:bg-blue-100 dark:hover:bg-blue-900/50\"\n              data-testid=\"link-telegram\"\n            >\n              <SiTelegram className=\"w-4 h-4\" />\n              <span>Join Telegram</span>\n            </a>\n            <Link \n              href=\"/join\" \n              className=\"text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition duration-150\"\n              data-testid=\"link-subscribe\"\n            >\n              Subscribe\n            </Link>\n            <div className=\"flex items-center gap-2\">\n              <Link \n                href=\"/login\" \n                className=\"text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 transition duration-150\"\n                data-testid=\"link-signin\"\n              >\n                Sign In\n              </Link>\n              <span className=\"text-gray-300 dark:text-gray-600\">|</span>\n              <Link \n                href=\"/signup\"\n                className=\"px-4 py-2 bg-emerald-600 text-white text-sm font-semibold rounded-lg shadow-md hover:bg-emerald-700 transition duration-200\"\n                data-testid=\"link-signup\"\n              >\n                Sign Up\n              </Link>\n            </div>\n          </div>\n\n          <button \n            className=\"lg:hidden text-gray-500 hover:text-emerald-600 focus:outline-none p-2 rounded-md transition duration-150\" \n            type=\"button\" \n            onClick={toggleMobileMenu}\n            aria-label={mobileMenuOpen ? \"Close menu\" : \"Open menu\"}\n            data-testid=\"button-mobile-menu\"\n          >\n            {mobileMenuOpen ? (\n              <X className=\"w-6 h-6\" />\n            ) : (\n              <Menu className=\"w-6 h-6\" />\n            )}\n          </button>\n        </div>\n\n        <nav className=\"hidden lg:block py-3\">\n          <div className=\"flex flex-wrap gap-x-6 gap-y-2\">\n            {navLinks.map((link) => (\n              <Link\n                key={link.path}\n                href={link.path}\n                className={`text-sm font-medium transition duration-150 relative ${\n                  isActivePath(link.path)\n                    ? 'text-emerald-600 font-semibold'\n                    : 'text-gray-600 dark:text-gray-400 hover:text-emerald-600'\n                }`}\n                data-testid={`link-nav-${link.name.toLowerCase().replace(/\\s+/g, '-').replace('/', '-')}`}\n              >\n                {link.name}\n                {isActivePath(link.path) && (\n                  <span className=\"absolute left-0 -bottom-2 w-full h-0.5 bg-emerald-600 rounded-full\" />\n                )}\n              </Link>\n            ))}\n          </div>\n        </nav>\n      </div>\n\n      <div className=\"md:hidden bg-gray-50 dark:bg-gray-800 px-4 py-2 flex items-center justify-center gap-3 text-sm border-t border-gray-100 dark:border-gray-700\">\n        <span className=\"text-xs text-gray-400\">\n          UTC: <span className=\"font-semibold text-gray-800 dark:text-gray-200\">{sessionInfo.utcTime}</span>\n        </span>\n        <span className=\"text-gray-300\">|</span>\n        <span>\n          {sessionInfo.sessionName ? (\n            <>\n              <span className=\"font-bold text-emerald-600\">{sessionInfo.sessionName}</span> (<span className=\"text-emerald-600\">{sessionInfo.timeInSession}</span>)\n            </>\n          ) : (\n            <span className=\"text-gray-500\">Quiet</span>\n          )}\n        </span>\n      </div>\n\n      {mobileMenuOpen && (\n        <div \n          className=\"lg:hidden fixed inset-y-0 right-0 w-64 bg-white dark:bg-gray-900 z-40 shadow-xl overflow-y-auto transform transition-transform duration-300\"\n          style={{ fontFamily: \"'Montserrat', sans-serif\" }}\n          data-testid=\"mobile-drawer\"\n        >\n          <div className=\"p-5\">\n            <div className=\"flex justify-between items-center mb-6\">\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">Navigation</h3>\n              <button \n                onClick={() => setMobileMenuOpen(false)}\n                className=\"text-gray-500 hover:text-emerald-600 focus:outline-none p-2 rounded-md\"\n                aria-label=\"Close menu\"\n                data-testid=\"button-close-menu\"\n              >\n                <X className=\"w-6 h-6\" />\n              </button>\n            </div>\n\n            <nav className=\"space-y-4\">\n              {navLinks.map((link) => (\n                <Link\n                  key={link.path}\n                  href={link.path}\n                  className={`block text-base font-medium pl-3 transition duration-150 ${\n                    isActivePath(link.path)\n                      ? 'text-emerald-600 font-semibold border-l-4 border-emerald-600'\n                      : 'text-gray-700 dark:text-gray-300 hover:text-emerald-600 hover:border-l-4 hover:border-emerald-600'\n                  }`}\n                  onClick={() => setMobileMenuOpen(false)}\n                  data-testid={`mobile-link-nav-${link.name.toLowerCase().replace(/\\s+/g, '-').replace('/', '-')}`}\n                >\n                  {link.name}\n                </Link>\n              ))}\n            </nav>\n\n            <hr className=\"my-6 border-gray-200 dark:border-gray-700\" />\n\n            <div className=\"space-y-4\">\n              <a \n                href=\"https://t.me/BuySellZonesBot\" \n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"w-full flex items-center justify-center gap-2 px-4 py-3 border border-blue-600 text-blue-600 text-sm font-semibold rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/30 transition duration-150\"\n                data-testid=\"mobile-link-telegram\"\n              >\n                <SiTelegram className=\"w-5 h-5\" />\n                <span>Join Telegram</span>\n              </a>\n              <Link \n                href=\"/signup\"\n                className=\"w-full flex items-center justify-center px-4 py-3 bg-emerald-600 text-white text-sm font-semibold rounded-lg shadow-lg hover:bg-emerald-700 transition duration-150\"\n                onClick={() => setMobileMenuOpen(false)}\n                data-testid=\"mobile-link-signup\"\n              >\n                Sign Up\n              </Link>\n              <Link \n                href=\"/login\"\n                className=\"w-full block text-center text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300\"\n                onClick={() => setMobileMenuOpen(false)}\n                data-testid=\"mobile-link-signin\"\n              >\n                Already have an account? <span className=\"text-emerald-600 font-semibold\">Sign In</span>\n              </Link>\n            </div>\n          </div>\n        </div>\n      )}\n    </header>\n  );\n}\n","path":null,"size_bytes":12133,"size_tokens":null},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":2263,"size_tokens":null},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { insertTradeSchema, insertEconomicEventSchema, insertTradingSignalSchema } from \"@shared/schema\";\nimport { getEconomicCalendar } from \"./services/fmp\";\nimport { cacheService } from \"./scrapers/cacheService\";\nimport { economicCalendarScraper } from \"./scrapers/economicCalendarScraper\";\nimport { analyzeEventSentiment, updateEventWithSentiment } from \"./services/sentimentAnalysis\";\nimport { telegramNotificationService } from \"./services/telegramNotification\";\nimport { notificationService } from \"./services/notificationService\";\nimport { signalDetectionService } from \"./services/signalDetection\";\nimport { getInterestRateData, getInflationData, parseCurrencyPair, generateMockTimeframeData } from \"./services/marketData\";\nimport { getCachedPrice, getCachedMultiplePrices, pingPriceService } from \"./lib/priceService\";\nimport { validateSignalWithGemini, quickMarketScan, testGeminiConnection, isGeminiConfigured, analyzeWithGemini, quickAnalyzeWithGemini } from \"./services/geminiAnalysis\";\nimport { generateTradingSignalChart, isChartGeneratorAvailable, cleanupOldCharts } from \"./services/chartGenerator\";\nimport { signalMonitor } from \"./services/signalMonitor\";\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  app.get(\"/api/trades\", async (req, res) => {\n    try {\n      const userId = req.query.userId as string | undefined;\n      const trades = await storage.getTrades(userId);\n      res.json(trades);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch trades\" });\n    }\n  });\n\n  app.get(\"/api/trades/:id\", async (req, res) => {\n    try {\n      const trade = await storage.getTradeById(req.params.id);\n      if (!trade) {\n        return res.status(404).json({ error: \"Trade not found\" });\n      }\n      res.json(trade);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch trade\" });\n    }\n  });\n\n  app.post(\"/api/trades\", async (req, res) => {\n    try {\n      const validatedData = insertTradeSchema.parse(req.body);\n      const trade = await storage.createTrade(validatedData);\n      res.status(201).json(trade);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid trade data\" });\n    }\n  });\n\n  app.put(\"/api/trades/:id\", async (req, res) => {\n    try {\n      const trade = await storage.updateTrade(req.params.id, req.body);\n      if (!trade) {\n        return res.status(404).json({ error: \"Trade not found\" });\n      }\n      res.json(trade);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update trade\" });\n    }\n  });\n\n  app.delete(\"/api/trades/:id\", async (req, res) => {\n    try {\n      const success = await storage.deleteTrade(req.params.id);\n      if (!success) {\n        return res.status(404).json({ error: \"Trade not found\" });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete trade\" });\n    }\n  });\n\n  app.get(\"/api/analytics\", async (req, res) => {\n    try {\n      const userId = req.query.userId as string | undefined;\n      const trades = await storage.getTrades(userId);\n      \n      const totalTrades = trades.length;\n      const winningTrades = trades.filter(t => t.outcome === 'win');\n      const losingTrades = trades.filter(t => t.outcome === 'loss');\n      \n      const totalPnL = trades.reduce((sum, t) => sum + parseFloat(t.pnl), 0);\n      const averagePnL = totalTrades > 0 ? totalPnL / totalTrades : 0;\n      const winRate = totalTrades > 0 ? (winningTrades.length / totalTrades) * 100 : 0;\n      \n      const averageWin = winningTrades.length > 0 \n        ? winningTrades.reduce((sum, t) => sum + parseFloat(t.pnl), 0) / winningTrades.length \n        : 0;\n      const averageLoss = losingTrades.length > 0 \n        ? losingTrades.reduce((sum, t) => sum + parseFloat(t.pnl), 0) / losingTrades.length \n        : 0;\n\n      const analytics = {\n        totalTrades,\n        winningTrades: winningTrades.length,\n        losingTrades: losingTrades.length,\n        totalPnL: totalPnL.toFixed(2),\n        averagePnL: averagePnL.toFixed(2),\n        winRate: winRate.toFixed(2),\n        averageWin: averageWin.toFixed(2),\n        averageLoss: averageLoss.toFixed(2),\n      };\n\n      res.json(analytics);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to calculate analytics\" });\n    }\n  });\n\n  app.get(\"/api/calendar/today\", async (req, res) => {\n    try {\n      const events = await cacheService.getOrFetchEvents('today', economicCalendarScraper);\n      \n      const filters = {\n        region: req.query.region as string | undefined,\n        impactLevel: req.query.impactLevel as string | undefined,\n        currency: req.query.currency as string | undefined,\n      };\n      \n      let filteredEvents = events;\n      if (filters.region) {\n        filteredEvents = filteredEvents.filter(e => e.region === filters.region);\n      }\n      if (filters.impactLevel) {\n        filteredEvents = filteredEvents.filter(e => e.impactLevel === filters.impactLevel);\n      }\n      if (filters.currency) {\n        filteredEvents = filteredEvents.filter(e => e.currency === filters.currency);\n      }\n      \n      res.json(filteredEvents);\n    } catch (error) {\n      console.error('Error in /api/calendar/today:', error);\n      res.json([]);\n    }\n  });\n\n  app.get(\"/api/calendar/week\", async (req, res) => {\n    try {\n      const events = await cacheService.getOrFetchEvents('week', economicCalendarScraper);\n      \n      const filters = {\n        region: req.query.region as string | undefined,\n        impactLevel: req.query.impactLevel as string | undefined,\n        currency: req.query.currency as string | undefined,\n      };\n      \n      let filteredEvents = events;\n      if (filters.region) {\n        filteredEvents = filteredEvents.filter(e => e.region === filters.region);\n      }\n      if (filters.impactLevel) {\n        filteredEvents = filteredEvents.filter(e => e.impactLevel === filters.impactLevel);\n      }\n      if (filters.currency) {\n        filteredEvents = filteredEvents.filter(e => e.currency === filters.currency);\n      }\n      \n      res.json(filteredEvents);\n    } catch (error) {\n      console.error('Error in /api/calendar/week:', error);\n      res.json([]);\n    }\n  });\n\n  app.get(\"/api/economic-events\", async (req, res) => {\n    try {\n      const events = await cacheService.getOrFetchEvents('upcoming', economicCalendarScraper);\n      \n      const filters = {\n        region: req.query.region as string | undefined,\n        impactLevel: req.query.impactLevel as string | undefined,\n        currency: req.query.currency as string | undefined,\n      };\n      \n      let filteredEvents = events;\n      if (filters.region) {\n        filteredEvents = filteredEvents.filter(e => e.region === filters.region);\n      }\n      if (filters.impactLevel) {\n        filteredEvents = filteredEvents.filter(e => e.impactLevel === filters.impactLevel);\n      }\n      if (filters.currency) {\n        filteredEvents = filteredEvents.filter(e => e.currency === filters.currency);\n      }\n      \n      const eventsWithSentiment = filteredEvents.map(event => updateEventWithSentiment(event));\n      \n      res.json(eventsWithSentiment);\n    } catch (error) {\n      console.error('Error in /api/economic-events:', error);\n      res.json([]);\n    }\n  });\n\n  app.get(\"/api/economic-events/:id\", async (req, res) => {\n    try {\n      const event = await cacheService.getEventById(req.params.id);\n      if (!event) {\n        return res.status(404).json({ error: \"Event not found\" });\n      }\n      const eventWithSentiment = updateEventWithSentiment(event);\n      res.json(eventWithSentiment);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch event\" });\n    }\n  });\n\n  app.get(\"/api/economic-events/:id/analysis\", async (req, res) => {\n    try {\n      const event = await cacheService.getEventById(req.params.id);\n      if (!event) {\n        return res.status(404).json({ error: \"Event not found\" });\n      }\n      const analysis = analyzeEventSentiment(event);\n      res.json({\n        event: updateEventWithSentiment(event),\n        analysis\n      });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch event analysis\" });\n    }\n  });\n\n  app.post(\"/api/economic-events\", async (req, res) => {\n    try {\n      const validatedData = insertEconomicEventSchema.parse(req.body);\n      const event = await storage.createEconomicEvent(validatedData);\n      res.status(201).json(event);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid event data\" });\n    }\n  });\n\n  app.put(\"/api/economic-events/:id\", async (req, res) => {\n    try {\n      const event = await storage.updateEconomicEvent(req.params.id, req.body);\n      if (!event) {\n        return res.status(404).json({ error: \"Event not found\" });\n      }\n      res.json(event);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update event\" });\n    }\n  });\n\n  app.delete(\"/api/economic-events/:id\", async (req, res) => {\n    try {\n      const success = await storage.deleteEconomicEvent(req.params.id);\n      if (!success) {\n        return res.status(404).json({ error: \"Event not found\" });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete event\" });\n    }\n  });\n\n  app.post(\"/api/notifications/signal\", async (req, res) => {\n    try {\n      const signal = req.body;\n      \n      if (!signal.symbol || !signal.type || !signal.entry) {\n        return res.status(400).json({ error: \"Invalid signal data\" });\n      }\n\n      const typeEmoji = signal.type === 'buy' ? '' : '';\n      const title = `${typeEmoji} ${signal.symbol} - ${signal.type.toUpperCase()}`;\n      const message = `Strategy: ${signal.strategy} | Entry: ${signal.entry} | SL: ${signal.stopLoss} | TP: ${signal.takeProfit} | R/R: 1:${signal.riskReward}`;\n      \n      await notificationService.createNotification({\n        type: 'trading_signal',\n        title,\n        message,\n        metadata: JSON.stringify(signal),\n      });\n\n      res.json({ success: true, message: \"Signal notification created\" });\n    } catch (error) {\n      console.error(\"Error creating signal notification:\", error);\n      res.status(500).json({ error: \"Failed to create signal notification\" });\n    }\n  });\n\n  app.get(\"/api/notifications/status\", async (req, res) => {\n    try {\n      const isReady = telegramNotificationService.isReady();\n      res.json({ \n        telegramBotActive: isReady,\n        message: isReady \n          ? \"Telegram notifications are active\" \n          : \"Telegram bot is not configured\"\n      });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get notification status\" });\n    }\n  });\n\n  app.get(\"/api/notifications\", async (req, res) => {\n    try {\n      const limit = req.query.limit ? parseInt(req.query.limit as string) : 50;\n      const notifications = await notificationService.getNotifications(limit);\n      res.json(notifications);\n    } catch (error) {\n      console.error(\"Error fetching notifications:\", error);\n      res.status(500).json({ error: \"Failed to fetch notifications\" });\n    }\n  });\n\n  app.get(\"/api/notifications/unread\", async (req, res) => {\n    try {\n      const notifications = await notificationService.getUnreadNotifications();\n      res.json(notifications);\n    } catch (error) {\n      console.error(\"Error fetching unread notifications:\", error);\n      res.status(500).json({ error: \"Failed to fetch unread notifications\" });\n    }\n  });\n\n  app.patch(\"/api/notifications/:id/read\", async (req, res) => {\n    try {\n      await notificationService.markAsRead(req.params.id);\n      res.json({ success: true, message: \"Notification marked as read\" });\n    } catch (error) {\n      console.error(\"Error marking notification as read:\", error);\n      res.status(500).json({ error: \"Failed to mark notification as read\" });\n    }\n  });\n\n  app.patch(\"/api/notifications/read-all\", async (req, res) => {\n    try {\n      await notificationService.markAllAsRead();\n      res.json({ success: true, message: \"All notifications marked as read\" });\n    } catch (error) {\n      console.error(\"Error marking all notifications as read:\", error);\n      res.status(500).json({ error: \"Failed to mark all notifications as read\" });\n    }\n  });\n\n  app.delete(\"/api/notifications/:id\", async (req, res) => {\n    try {\n      await notificationService.deleteNotification(req.params.id);\n      res.json({ success: true, message: \"Notification deleted\" });\n    } catch (error) {\n      console.error(\"Error deleting notification:\", error);\n      res.status(500).json({ error: \"Failed to delete notification\" });\n    }\n  });\n\n  app.delete(\"/api/notifications/clear-all\", async (req, res) => {\n    try {\n      await notificationService.clearAllNotifications();\n      res.json({ success: true, message: \"All notifications cleared\" });\n    } catch (error) {\n      console.error(\"Error clearing all notifications:\", error);\n      res.status(500).json({ error: \"Failed to clear all notifications\" });\n    }\n  });\n\n  app.get(\"/api/trading-signals\", async (req, res) => {\n    try {\n      const filters = {\n        status: req.query.status as string | undefined,\n        assetClass: req.query.assetClass as string | undefined,\n        symbol: req.query.symbol as string | undefined,\n      };\n      const signals = await storage.getTradingSignals(filters);\n      res.json(signals);\n    } catch (error) {\n      console.error(\"Error fetching trading signals:\", error);\n      res.status(500).json({ error: \"Failed to fetch trading signals\" });\n    }\n  });\n\n  app.get(\"/api/trading-signals/:id\", async (req, res) => {\n    try {\n      const signal = await storage.getTradingSignalById(req.params.id);\n      if (!signal) {\n        return res.status(404).json({ error: \"Signal not found\" });\n      }\n      res.json(signal);\n    } catch (error) {\n      console.error(\"Error fetching signal:\", error);\n      res.status(500).json({ error: \"Failed to fetch signal\" });\n    }\n  });\n\n  app.post(\"/api/trading-signals/generate\", async (req, res) => {\n    try {\n      const { symbol, assetClass, trend } = req.body;\n      \n      if (!symbol || !assetClass) {\n        return res.status(400).json({ error: \"Symbol and assetClass are required\" });\n      }\n\n      let interestRateData = undefined;\n      let inflationData = undefined;\n\n      if (assetClass === 'forex') {\n        const pair = parseCurrencyPair(symbol);\n        if (pair) {\n          const baseIR = getInterestRateData(pair.base);\n          const quoteIR = getInterestRateData(pair.quote);\n          const baseInf = getInflationData(pair.base);\n          const quoteInf = getInflationData(pair.quote);\n\n          if (baseIR && quoteIR) {\n            interestRateData = { base: baseIR, quote: quoteIR };\n          }\n          if (baseInf && quoteInf) {\n            inflationData = { base: baseInf, quote: quoteInf };\n          }\n        }\n      }\n\n      const currentPrice = req.body.currentPrice || 1.0850;\n      const trendBias = trend || 'bullish';\n\n      const dailyData = generateMockTimeframeData(currentPrice, trendBias, 30);\n      const h4Data = generateMockTimeframeData(currentPrice, trendBias, 25);\n      const h1Data = generateMockTimeframeData(currentPrice, trendBias, 20);\n      const m15Data = generateMockTimeframeData(currentPrice, trendBias, 15);\n\n      const signal = signalDetectionService.generateTradingSignal({\n        symbol,\n        assetClass,\n        interestRateData,\n        inflationData,\n        dailyData,\n        h4Data,\n        h1Data,\n        m15Data,\n      });\n\n      if (!signal) {\n        return res.status(400).json({ error: \"Could not generate signal - confidence too low\" });\n      }\n\n      const createdSignal = await storage.createTradingSignal(signal);\n\n      await notificationService.createNotification({\n        type: 'trading_signal',\n        title: `${signal.type === 'buy' ? '' : ''} ${symbol} - ${signal.type.toUpperCase()}`,\n        message: `Confidence: ${signal.overallConfidence}% | Entry: ${signal.entryPrice} | R:R: 1:${signal.riskRewardRatio}`,\n        metadata: JSON.stringify(createdSignal),\n      });\n\n      res.json(createdSignal);\n    } catch (error) {\n      console.error(\"Error generating signal:\", error);\n      res.status(500).json({ error: \"Failed to generate signal\" });\n    }\n  });\n\n  app.post(\"/api/trading-signals\", async (req, res) => {\n    try {\n      const validatedData = insertTradingSignalSchema.parse(req.body);\n      const signal = await storage.createTradingSignal(validatedData);\n      res.status(201).json(signal);\n    } catch (error) {\n      console.error(\"Error creating signal:\", error);\n      res.status(400).json({ error: \"Invalid signal data\" });\n    }\n  });\n\n  app.patch(\"/api/trading-signals/:id\", async (req, res) => {\n    try {\n      const signal = await storage.updateTradingSignal(req.params.id, req.body);\n      if (!signal) {\n        return res.status(404).json({ error: \"Signal not found\" });\n      }\n      res.json(signal);\n    } catch (error) {\n      console.error(\"Error updating signal:\", error);\n      res.status(500).json({ error: \"Failed to update signal\" });\n    }\n  });\n\n  app.delete(\"/api/trading-signals/:id\", async (req, res) => {\n    try {\n      const success = await storage.deleteTradingSignal(req.params.id);\n      if (!success) {\n        return res.status(404).json({ error: \"Signal not found\" });\n      }\n      res.status(204).send();\n    } catch (error) {\n      console.error(\"Error deleting signal:\", error);\n      res.status(500).json({ error: \"Failed to delete signal\" });\n    }\n  });\n\n  // ============================================\n  // WATCHLIST & SIGNAL MONITORING ROUTES\n  // ============================================\n\n  app.get(\"/api/signals/watchlist\", async (req, res) => {\n    try {\n      const watchlistSignals = await signalMonitor.getWatchlistSignals();\n      res.json(watchlistSignals);\n    } catch (error) {\n      console.error(\"Error fetching watchlist:\", error);\n      res.status(500).json({ error: \"Failed to fetch watchlist\" });\n    }\n  });\n\n  app.get(\"/api/signals/active\", async (req, res) => {\n    try {\n      const activeSignals = await signalMonitor.getActiveSignals();\n      res.json(activeSignals);\n    } catch (error) {\n      console.error(\"Error fetching active signals:\", error);\n      res.status(500).json({ error: \"Failed to fetch active signals\" });\n    }\n  });\n\n  app.post(\"/api/signals/:id/promote\", async (req, res) => {\n    try {\n      const signal = await signalMonitor.promoteToActive(req.params.id);\n      if (!signal) {\n        return res.status(404).json({ error: \"Signal not found\" });\n      }\n      res.json(signal);\n    } catch (error) {\n      console.error(\"Error promoting signal:\", error);\n      res.status(500).json({ error: \"Failed to promote signal\" });\n    }\n  });\n\n  app.post(\"/api/signals/:id/watchlist\", async (req, res) => {\n    try {\n      const signal = await signalMonitor.moveToWatchlist(req.params.id);\n      if (!signal) {\n        return res.status(404).json({ error: \"Signal not found\" });\n      }\n      res.json(signal);\n    } catch (error) {\n      console.error(\"Error moving signal to watchlist:\", error);\n      res.status(500).json({ error: \"Failed to move signal to watchlist\" });\n    }\n  });\n\n  app.post(\"/api/signals/check-outcomes\", async (req, res) => {\n    try {\n      const outcomes = await signalMonitor.checkAllSignals();\n      res.json({ \n        checked: outcomes.length,\n        outcomes: outcomes.filter(o => o.outcome !== 'active'),\n        message: \"Signal outcomes checked\"\n      });\n    } catch (error) {\n      console.error(\"Error checking signal outcomes:\", error);\n      res.status(500).json({ error: \"Failed to check signal outcomes\" });\n    }\n  });\n\n  app.get(\"/api/signals/monitor/status\", async (req, res) => {\n    try {\n      res.json({ \n        status: \"running\",\n        message: \"Signal monitor is active\"\n      });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get monitor status\" });\n    }\n  });\n\n  app.get(\"/api/pending-setups\", async (req, res) => {\n    try {\n      const filters = {\n        symbol: req.query.symbol as string | undefined,\n        readyForSignal: req.query.readyForSignal === 'true' ? true : undefined,\n        invalidated: req.query.invalidated === 'true' ? true : false,\n      };\n      const setups = await storage.getPendingSetups(filters);\n      res.json(setups);\n    } catch (error) {\n      console.error(\"Error fetching pending setups:\", error);\n      res.status(500).json({ error: \"Failed to fetch pending setups\" });\n    }\n  });\n\n  app.get(\"/api/pending-setups/:id\", async (req, res) => {\n    try {\n      const setup = await storage.getPendingSetupById(req.params.id);\n      if (!setup) {\n        return res.status(404).json({ error: \"Pending setup not found\" });\n      }\n      res.json(setup);\n    } catch (error) {\n      console.error(\"Error fetching pending setup:\", error);\n      res.status(500).json({ error: \"Failed to fetch pending setup\" });\n    }\n  });\n\n  // Real-time price data endpoints using Python/tessa\n  app.get(\"/api/prices/status\", async (req, res) => {\n    try {\n      const isOnline = await pingPriceService();\n      res.json({ \n        status: isOnline ? \"online\" : \"offline\",\n        message: isOnline ? \"Price service is running\" : \"Price service is not available\"\n      });\n    } catch (error) {\n      res.json({ status: \"offline\", message: \"Price service error\" });\n    }\n  });\n\n  app.get(\"/api/prices/:symbol\", async (req, res) => {\n    try {\n      const symbol = req.params.symbol;\n      const assetClass = (req.query.assetClass as string) || \"stock\";\n      \n      const validAssetClasses = [\"stock\", \"forex\", \"commodity\", \"crypto\"];\n      if (!validAssetClasses.includes(assetClass)) {\n        return res.status(400).json({ error: \"Invalid asset class\" });\n      }\n      \n      const priceData = await getCachedPrice(\n        symbol, \n        assetClass as \"stock\" | \"forex\" | \"commodity\" | \"crypto\"\n      );\n      \n      if (priceData.error) {\n        return res.status(404).json({ error: priceData.error });\n      }\n      \n      res.json(priceData);\n    } catch (error) {\n      console.error(\"Error fetching price:\", error);\n      res.status(500).json({ error: \"Failed to fetch price\" });\n    }\n  });\n\n  app.post(\"/api/prices/batch\", async (req, res) => {\n    try {\n      const { symbols } = req.body;\n      \n      if (!Array.isArray(symbols) || symbols.length === 0) {\n        return res.status(400).json({ error: \"Symbols array is required\" });\n      }\n      \n      if (symbols.length > 50) {\n        return res.status(400).json({ error: \"Maximum 50 symbols per request\" });\n      }\n      \n      const priceData = await getCachedMultiplePrices(symbols);\n      res.json(priceData);\n    } catch (error) {\n      console.error(\"Error fetching batch prices:\", error);\n      res.status(500).json({ error: \"Failed to fetch prices\" });\n    }\n  });\n\n  // ============================================\n  // GEMINI AI ANALYSIS ROUTES\n  // ============================================\n\n  // Test Gemini connection\n  app.get(\"/api/gemini/status\", async (req, res) => {\n    try {\n      const isConfigured = isGeminiConfigured();\n      if (!isConfigured) {\n        return res.json({ \n          configured: false, \n          connected: false, \n          message: \"GOOGLE_API_KEY not configured\" \n        });\n      }\n\n      const connectionTest = await testGeminiConnection();\n      res.json({\n        configured: true,\n        connected: connectionTest.success,\n        message: connectionTest.message,\n      });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to check Gemini status\" });\n    }\n  });\n\n  // Validate a signal from our SMC strategy using Gemini as assistant\n  app.post(\"/api/gemini/validate\", async (req, res) => {\n    try {\n      const { signal, priceData, chartImagePath } = req.body;\n\n      if (!signal || !priceData || !Array.isArray(priceData)) {\n        return res.status(400).json({ error: \"Signal and priceData array are required\" });\n      }\n\n      if (!isGeminiConfigured()) {\n        return res.status(503).json({ error: \"Gemini API not configured\" });\n      }\n\n      const result = await validateSignalWithGemini(signal, priceData, chartImagePath);\n      res.json(result);\n    } catch (error) {\n      console.error(\"Gemini validation error:\", error);\n      res.status(500).json({ error: \"Failed to validate signal with Gemini\" });\n    }\n  });\n\n  // Quick market scan to pre-screen instruments\n  app.post(\"/api/gemini/scan\", async (req, res) => {\n    try {\n      const { symbol, priceData } = req.body;\n\n      if (!symbol || !priceData || !Array.isArray(priceData)) {\n        return res.status(400).json({ error: \"Symbol and priceData array are required\" });\n      }\n\n      if (!isGeminiConfigured()) {\n        return res.status(503).json({ error: \"Gemini API not configured\" });\n      }\n\n      const result = await quickMarketScan(symbol, priceData);\n      res.json(result);\n    } catch (error) {\n      console.error(\"Market scan error:\", error);\n      res.status(500).json({ error: \"Failed to scan market\" });\n    }\n  });\n\n  // Legacy analyze endpoint (backward compatibility)\n  app.post(\"/api/gemini/analyze\", async (req, res) => {\n    try {\n      const { symbol, priceData, chartImagePath } = req.body;\n\n      if (!symbol || !priceData || !Array.isArray(priceData)) {\n        return res.status(400).json({ error: \"Symbol and priceData array are required\" });\n      }\n\n      if (!isGeminiConfigured()) {\n        return res.status(503).json({ error: \"Gemini API not configured\" });\n      }\n\n      const result = await analyzeWithGemini(symbol, priceData, chartImagePath);\n      res.json(result);\n    } catch (error) {\n      console.error(\"Gemini analysis error:\", error);\n      res.status(500).json({ error: \"Failed to analyze with Gemini\" });\n    }\n  });\n\n  // Legacy quick-scan endpoint (backward compatibility)\n  app.post(\"/api/gemini/quick-scan\", async (req, res) => {\n    try {\n      const { symbol, priceData } = req.body;\n\n      if (!symbol || !priceData || !Array.isArray(priceData)) {\n        return res.status(400).json({ error: \"Symbol and priceData array are required\" });\n      }\n\n      if (!isGeminiConfigured()) {\n        return res.status(503).json({ error: \"Gemini API not configured\" });\n      }\n\n      const result = await quickAnalyzeWithGemini(symbol, priceData);\n      \n      if (!result) {\n        return res.status(500).json({ error: \"Quick scan failed\" });\n      }\n\n      res.json(result);\n    } catch (error) {\n      console.error(\"Quick scan error:\", error);\n      res.status(500).json({ error: \"Failed to perform quick scan\" });\n    }\n  });\n\n  // ============================================\n  // CHART GENERATION ROUTES\n  // ============================================\n\n  // Check chart generator status\n  app.get(\"/api/charts/status\", async (req, res) => {\n    try {\n      const available = await isChartGeneratorAvailable();\n      res.json({ available });\n    } catch (error) {\n      res.json({ available: false, error: \"Failed to check chart generator status\" });\n    }\n  });\n\n  // Generate signal chart\n  app.post(\"/api/charts/generate\", async (req, res) => {\n    try {\n      const { symbol, timeframe, candles, signal, supplyZones, demandZones } = req.body;\n\n      if (!symbol || !timeframe || !candles || !Array.isArray(candles)) {\n        return res.status(400).json({ error: \"Symbol, timeframe, and candles array are required\" });\n      }\n\n      if (!signal || !signal.direction || !signal.entryPrice) {\n        return res.status(400).json({ error: \"Signal with direction and entryPrice is required\" });\n      }\n\n      const result = await generateTradingSignalChart(\n        symbol,\n        timeframe,\n        candles,\n        signal,\n        supplyZones || [],\n        demandZones || []\n      );\n\n      if (!result.success) {\n        return res.status(500).json({ error: result.error || \"Chart generation failed\" });\n      }\n\n      res.json({ success: true, path: result.path });\n    } catch (error) {\n      console.error(\"Chart generation error:\", error);\n      res.status(500).json({ error: \"Failed to generate chart\" });\n    }\n  });\n\n  // Cleanup old charts\n  app.post(\"/api/charts/cleanup\", async (req, res) => {\n    try {\n      const maxAgeMs = req.body.maxAgeMs || 3600000; // Default 1 hour\n      cleanupOldCharts(maxAgeMs);\n      res.json({ success: true, message: \"Old charts cleaned up\" });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to cleanup charts\" });\n    }\n  });\n\n  // Start the signal monitor (checks SL/TP hits every 30 seconds)\n  signalMonitor.start(30000);\n  console.log('[Server] Signal monitor started - checking SL/TP every 30 seconds');\n\n  const httpServer = createServer(app);\n\n  return httpServer;\n}\n","path":null,"size_bytes":28919,"size_tokens":null},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nconst availableEnvVars = Object.keys(process.env).filter(key => \n  key.includes('DATABASE') || key.includes('PG') || key.includes('DB') || key.includes('POSTGRES')\n);\n\nif (!process.env.DATABASE_URL) {\n  console.error('=== Database Configuration Error ===');\n  console.error('DATABASE_URL environment variable is not set.');\n  console.error('');\n  console.error('Available database-related environment variables:', availableEnvVars.length > 0 ? availableEnvVars.join(', ') : 'NONE');\n  console.error('');\n  console.error('For Coolify deployment, ensure:');\n  console.error('1. DATABASE_URL is set in Environment Variables (not Build Args)');\n  console.error('2. The value format is: postgresql://user:password@host:port/database');\n  console.error('3. No quotes around the value');\n  console.error('4. Redeploy after setting the variable');\n  console.error('=====================================');\n  \n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nconsole.log('[Database] Connecting to PostgreSQL...');\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });\nconsole.log('[Database] Database pool initialized');\n","path":null,"size_bytes":1459,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4120,"size_tokens":null},"client/src/index.css":{"content":"@import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');\n@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@100..900&display=swap');\n\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n\n  /* Automatic computation of border around primary / danger buttons */\n  --opaque-button-border-intensity: -8; /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n\n  --background: 210 15% 98%;\n\n  --foreground: 210 15% 15%;\n\n  --border: 210 10% 88%;\n\n  --card: 210 10% 95%;\n\n  --card-foreground: 210 15% 15%;\n\n  --card-border: 210 12% 90%;\n\n  --sidebar: 210 8% 92%;\n\n  --sidebar-foreground: 210 15% 15%;\n\n  --sidebar-border: 210 10% 87%;\n\n  --sidebar-primary: 210 100% 50%;\n\n  --sidebar-primary-foreground: 210 15% 98%;\n\n  --sidebar-accent: 210 12% 88%;\n\n  --sidebar-accent-foreground: 210 15% 15%;\n\n  --sidebar-ring: 210 100% 60%;\n\n  --popover: 210 8% 90%;\n\n  --popover-foreground: 210 15% 15%;\n\n  --popover-border: 210 10% 85%;\n\n  --primary: 210 100% 50%;\n\n  --primary-foreground: 210 15% 98%;\n\n  --secondary: 210 8% 87%;\n\n  --secondary-foreground: 210 15% 15%;\n\n  --muted: 210 6% 85%;\n\n  --muted-foreground: 210 10% 45%;\n\n  --accent: 210 12% 88%;\n\n  --accent-foreground: 210 15% 15%;\n\n  --destructive: 0 75% 55%;\n\n  --destructive-foreground: 0 15% 98%;\n\n  --input: 210 15% 75%;\n  --ring: 210 100% 60%;\n  --chart-1: 210 100% 45%;\n  --chart-2: 120 60% 40%;\n  --chart-3: 0 75% 50%;\n  --chart-4: 45 90% 50%;\n  --chart-5: 280 85% 55%;\n\n  --font-sans: Poppins, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: JetBrains Mono, Menlo, monospace;\n  --radius: .5rem; /* 8px */\n  --shadow-2xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 2px 4px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 4px 6px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 8px 10px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n  /* Automatically computed borders - intensity can be controlled by the user by the --opaque-button-border-intensity setting */\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n\n  --opaque-button-border-intensity: 9;  /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n\n  --background: 0 0% 69%;\n\n  --foreground: 210 15% 15%;\n\n  --border: 0 0% 55%;\n\n  --card: 0 0% 75%;\n\n  --card-foreground: 210 15% 15%;\n\n  --card-border: 0 0% 60%;\n\n  --sidebar: 0 0% 65%;\n\n  --sidebar-foreground: 210 15% 15%;\n\n  --sidebar-border: 0 0% 55%;\n\n  --sidebar-primary: 210 100% 50%;\n\n  --sidebar-primary-foreground: 210 15% 98%;\n\n  --sidebar-accent: 0 0% 60%;\n\n  --sidebar-accent-foreground: 210 15% 15%;\n\n  --sidebar-ring: 210 100% 50%;\n\n  --popover: 0 0% 65%;\n\n  --popover-foreground: 210 15% 15%;\n\n  --popover-border: 0 0% 55%;\n\n  --primary: 210 100% 50%;\n\n  --primary-foreground: 210 15% 98%;\n\n  --secondary: 0 0% 60%;\n\n  --secondary-foreground: 210 15% 15%;\n\n  --muted: 0 0% 60%;\n\n  --muted-foreground: 210 10% 30%;\n\n  --accent: 0 0% 62%;\n\n  --accent-foreground: 210 15% 15%;\n\n  --destructive: 0 75% 55%;\n\n  --destructive-foreground: 0 15% 98%;\n\n  --input: 210 15% 25%;\n  --ring: 210 100% 60%;\n  --chart-1: 210 100% 65%;\n  --chart-2: 120 60% 60%;\n  --chart-3: 0 75% 65%;\n  --chart-4: 45 90% 65%;\n  --chart-5: 280 85% 70%;\n\n  --shadow-2xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 2px 4px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 4px 6px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 8px 10px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n\n  /* Hide scrollbar utility for cleaner horizontal scrolling */\n  .scrollbar-hide {\n    -ms-overflow-style: none;\n    scrollbar-width: none;\n  }\n\n  .scrollbar-hide::-webkit-scrollbar {\n    display: none;\n  }\n\n  /* Nav Link Underline Hover Effect */\n  .nav-link {\n    transition: all 0.2s ease-in-out;\n    position: relative;\n    white-space: nowrap;\n  }\n\n  .nav-link::after {\n    content: '';\n    position: absolute;\n    bottom: -4px;\n    left: 0;\n    width: 0;\n    height: 2px;\n    background-color: #e75518;\n    transition: width 0.3s ease-in-out;\n  }\n\n  .nav-link:hover::after,\n  .active-nav-link::after {\n    width: 100%;\n  }\n\n  /* Hide scrollbar for the secondary nav bar */\n  .no-scrollbar::-webkit-scrollbar {\n    display: none;\n  }\n\n  .no-scrollbar {\n    -ms-overflow-style: none;\n    scrollbar-width: none;\n  }\n\n  /* Marquee Animation */\n  .marquee-container {\n    overflow: hidden;\n    position: relative;\n    white-space: nowrap;\n    flex-grow: 1;\n    min-width: 0;\n  }\n\n  .marquee-track {\n    display: inline-flex;\n    min-width: max-content;\n    animation: marquee 50s linear infinite;\n  }\n\n  .marquee-track:hover {\n    animation-play-state: paused;\n  }\n\n  @keyframes marquee {\n    from {\n      transform: translateX(0);\n    }\n    to {\n      transform: translateX(-50%);\n    }\n  }\n\n  /* Pulse Dot Animation */\n  .signal-pulse-container {\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    border-radius: 9999px;\n    background-color: var(--pulse-color, #10b981);\n    animation: pulse-ring 1.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) infinite;\n  }\n\n  @keyframes pulse-ring {\n    0% {\n      transform: scale(0.6);\n      opacity: 1;\n    }\n    100% {\n      transform: scale(2);\n      opacity: 0;\n    }\n  }\n\n  /* Telegram Link Styling */\n  .telegram-link {\n    transition: all 0.2s ease-in-out;\n    border-bottom: 2px solid transparent;\n    display: flex;\n    align-items: center;\n  }\n\n  .telegram-link:hover {\n    color: #1d90e6;\n    border-color: #1d90e6;\n  }\n\n  /* Footer link hover effect */\n  .footer-link:hover {\n    color: #10b981;\n  }\n\n  /* TikTok icon hover fix */\n  .tiktok-hover-fix:hover {\n    opacity: 0.85;\n  }\n\n  /* Dotted outline effect for header buttons */\n  .dotted-outline {\n    outline: 1.5px dashed #3b82f6;\n    outline-offset: 3px;\n  }\n\n  /* Hero dotted outline effect */\n  .hero-dotted-outline {\n    outline: 2px dashed white;\n    outline-offset: 4px;\n  }\n\n  /* Active sub-nav item */\n  .sub-nav-active {\n    color: #3b82f6;\n    border-bottom: 3px solid #3b82f6;\n  }\n\n  /* Scroll animations for hero signals and news */\n  @keyframes scroll-up {\n    0% {\n      transform: translateY(0);\n    }\n    100% {\n      transform: translateY(-50%);\n    }\n  }\n\n  .animate-scroll-up {\n    animation: scroll-up 20s linear infinite;\n  }\n\n  .animate-scroll-up:hover {\n    animation-play-state: paused;\n  }\n\n  .animate-scroll-up-slow {\n    animation: scroll-up 30s linear infinite;\n  }\n\n  .animate-scroll-up-slow:hover {\n    animation-play-state: paused;\n  }\n}","path":null,"size_bytes":13414,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","path":null,"size_bytes":1904,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8605,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic, log } from \"./static\";\nimport { scraperScheduler } from \"./scrapers/scheduler\";\n\nconst app = express();\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n    \n    scraperScheduler.start();\n  });\n\n  process.on('SIGTERM', () => {\n    log('SIGTERM signal received: closing HTTP server');\n    scraperScheduler.stop();\n    server.close(() => {\n      log('HTTP server closed');\n    });\n  });\n\n  process.on('SIGINT', () => {\n    log('SIGINT signal received: closing HTTP server');\n    scraperScheduler.stop();\n    server.close(() => {\n      log('HTTP server closed');\n    });\n  });\n})();\n","path":null,"size_bytes":2579,"size_tokens":null},"client/src/components/EventDetailsDialog.tsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport { Badge } from '@/components/ui/badge';\nimport { Separator } from '@/components/ui/separator';\nimport { TrendingUp, TrendingDown, Minus, Calendar, AlertTriangle } from 'lucide-react';\nimport { format } from 'date-fns';\n\ninterface CurrencyPairImpact {\n  pair: string;\n  sentiment: 'bullish' | 'bearish' | 'neutral';\n  reasoning: string;\n}\n\ninterface StockImpact {\n  sector: string;\n  sentiment: 'bullish' | 'bearish' | 'neutral';\n  reasoning: string;\n}\n\ninterface EventAnalysis {\n  expertSentiment: 'bullish' | 'bearish' | 'neutral';\n  preReleaseSentiment: 'bullish' | 'bearish' | 'neutral';\n  postReleaseSentiment: 'bullish' | 'bearish' | 'neutral' | null;\n  currencyPairImpacts: CurrencyPairImpact[];\n  stockImpacts: StockImpact[];\n  marketImpactAnalysis: string;\n  surpriseFactor: string | null;\n}\n\ninterface EventDetailsDialogProps {\n  eventId: string | null;\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\nconst getSentimentIcon = (sentiment: 'bullish' | 'bearish' | 'neutral') => {\n  if (sentiment === 'bullish') return <TrendingUp className=\"w-4 h-4 text-green-500\" />;\n  if (sentiment === 'bearish') return <TrendingDown className=\"w-4 h-4 text-red-500\" />;\n  return <Minus className=\"w-4 h-4 text-muted-foreground\" />;\n};\n\nconst getSentimentColor = (sentiment: 'bullish' | 'bearish' | 'neutral') => {\n  if (sentiment === 'bullish') return 'text-green-500';\n  if (sentiment === 'bearish') return 'text-red-500';\n  return 'text-muted-foreground';\n};\n\ninterface EventAnalysisResponse {\n  event: any;\n  analysis: EventAnalysis;\n}\n\nexport default function EventDetailsDialog({ eventId, open, onOpenChange }: EventDetailsDialogProps) {\n  const { data, isLoading } = useQuery<EventAnalysisResponse>({\n    queryKey: ['/api/economic-events', eventId, 'analysis'],\n    enabled: !!eventId && open,\n  });\n\n  if (!eventId) return null;\n\n  const event = data?.event;\n  const analysis = data?.analysis;\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-3xl max-h-[85vh] overflow-y-auto\" data-testid=\"dialog-event-details\">\n        {isLoading ? (\n          <div className=\"p-8 text-center text-muted-foreground\">Loading event details...</div>\n        ) : event && analysis ? (\n          <>\n            <DialogHeader>\n              <div className=\"flex items-start justify-between gap-4\">\n                <div className=\"flex-1\">\n                  <DialogTitle className=\"text-xl font-bold mb-2\" data-testid=\"text-event-title\">\n                    {event.title}\n                  </DialogTitle>\n                  <div className=\"flex items-center gap-2 flex-wrap\">\n                    <Badge variant=\"secondary\" data-testid=\"badge-currency\">\n                      {event.currency || event.countryCode}\n                    </Badge>\n                    <Badge \n                      variant={event.impactLevel?.toLowerCase() === 'high' ? 'default' : 'outline'}\n                      data-testid=\"badge-impact\"\n                    >\n                      {event.impactLevel?.toUpperCase()}\n                    </Badge>\n                    {event.isReleased && (\n                      <Badge variant=\"outline\" className=\"bg-blue-500/10 text-blue-500\" data-testid=\"badge-released\">\n                        Released\n                      </Badge>\n                    )}\n                    <div className=\"flex items-center gap-1 text-sm text-muted-foreground\">\n                      <Calendar className=\"w-3 h-3\" />\n                      <span data-testid=\"text-event-time\">\n                        {format(new Date(event.eventTime), 'MMM dd, yyyy HH:mm')}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n                {event.impactLevel?.toLowerCase() === 'high' && (\n                  <AlertTriangle className=\"w-6 h-6 text-destructive\" />\n                )}\n              </div>\n            </DialogHeader>\n\n            <Separator className=\"my-4\" />\n\n            <div className=\"space-y-6\">\n              <div>\n                <h3 className=\"font-semibold mb-3 flex items-center gap-2\">\n                  Market Sentiment\n                  {getSentimentIcon(event.isReleased && analysis.postReleaseSentiment \n                    ? analysis.postReleaseSentiment \n                    : analysis.preReleaseSentiment)}\n                </h3>\n                <div className=\"grid grid-cols-3 gap-4\">\n                  <div className=\"space-y-1\">\n                    <div className=\"text-sm text-muted-foreground\">Expert Sentiment</div>\n                    <div className={`font-medium capitalize ${getSentimentColor(analysis.expertSentiment)}`} data-testid=\"text-expert-sentiment\">\n                      {analysis.expertSentiment}\n                    </div>\n                  </div>\n                  <div className=\"space-y-1\">\n                    <div className=\"text-sm text-muted-foreground\">Pre-Release</div>\n                    <div className={`font-medium capitalize ${getSentimentColor(analysis.preReleaseSentiment)}`} data-testid=\"text-pre-release-sentiment\">\n                      {analysis.preReleaseSentiment}\n                    </div>\n                  </div>\n                  {event.isReleased && analysis.postReleaseSentiment && (\n                    <div className=\"space-y-1\">\n                      <div className=\"text-sm text-muted-foreground\">Post-Release</div>\n                      <div className={`font-medium capitalize ${getSentimentColor(analysis.postReleaseSentiment)}`} data-testid=\"text-post-release-sentiment\">\n                        {analysis.postReleaseSentiment}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              <Separator />\n\n              <div>\n                <h3 className=\"font-semibold mb-3\">Economic Data</h3>\n                <div className=\"grid grid-cols-3 gap-4\">\n                  {event.previousValue && (\n                    <div className=\"space-y-1\">\n                      <div className=\"text-sm text-muted-foreground\">Previous</div>\n                      <div className=\"font-mono font-medium\" data-testid=\"text-previous-value\">\n                        {event.previousValue}\n                      </div>\n                    </div>\n                  )}\n                  {event.expectedValue && (\n                    <div className=\"space-y-1\">\n                      <div className=\"text-sm text-muted-foreground\">Expected</div>\n                      <div className=\"font-mono font-medium\" data-testid=\"text-expected-value\">\n                        {event.expectedValue}\n                      </div>\n                    </div>\n                  )}\n                  {event.actualValue && (\n                    <div className=\"space-y-1\">\n                      <div className=\"text-sm text-muted-foreground\">Actual</div>\n                      <div className=\"font-mono font-medium\" data-testid=\"text-actual-value\">\n                        {event.actualValue}\n                      </div>\n                    </div>\n                  )}\n                </div>\n                {analysis.surpriseFactor && (\n                  <div className=\"mt-3 p-3 bg-muted rounded-md\">\n                    <div className=\"text-sm font-medium\" data-testid=\"text-surprise-factor\">\n                      Surprise Factor: {analysis.surpriseFactor}\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <Separator />\n\n              <div>\n                <h3 className=\"font-semibold mb-3\">Market Impact Analysis</h3>\n                <p className=\"text-sm leading-relaxed\" data-testid=\"text-market-impact\">\n                  {analysis.marketImpactAnalysis}\n                </p>\n              </div>\n\n              <Separator />\n\n              <div>\n                <h3 className=\"font-semibold mb-3\">Currency Pair Impacts</h3>\n                <div className=\"space-y-2\">\n                  {analysis.currencyPairImpacts.map((impact, index) => (\n                    <div \n                      key={index} \n                      className=\"p-3 rounded-md border border-border hover-elevate\"\n                      data-testid={`card-currency-${impact.pair}`}\n                    >\n                      <div className=\"flex items-center justify-between mb-1\">\n                        <span className=\"font-medium\" data-testid={`text-pair-${impact.pair}`}>{impact.pair}</span>\n                        <div className=\"flex items-center gap-1\">\n                          {getSentimentIcon(impact.sentiment)}\n                          <span className={`text-sm font-medium capitalize ${getSentimentColor(impact.sentiment)}`}>\n                            {impact.sentiment}\n                          </span>\n                        </div>\n                      </div>\n                      <p className=\"text-xs text-muted-foreground\">{impact.reasoning}</p>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              <Separator />\n\n              <div>\n                <h3 className=\"font-semibold mb-3\">Stock/Sector Impacts</h3>\n                <div className=\"space-y-2\">\n                  {analysis.stockImpacts.map((impact, index) => (\n                    <div \n                      key={index} \n                      className=\"p-3 rounded-md border border-border hover-elevate\"\n                      data-testid={`card-stock-${impact.sector}`}\n                    >\n                      <div className=\"flex items-center justify-between mb-1\">\n                        <span className=\"font-medium\" data-testid={`text-sector-${impact.sector}`}>{impact.sector}</span>\n                        <div className=\"flex items-center gap-1\">\n                          {getSentimentIcon(impact.sentiment)}\n                          <span className={`text-sm font-medium capitalize ${getSentimentColor(impact.sentiment)}`}>\n                            {impact.sentiment}\n                          </span>\n                        </div>\n                      </div>\n                      <p className=\"text-xs text-muted-foreground\">{impact.reasoning}</p>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n          </>\n        ) : (\n          <div className=\"p-8 text-center text-muted-foreground\">Event not found</div>\n        )}\n      </DialogContent>\n    </Dialog>\n  );\n}\n","path":null,"size_bytes":10609,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1383,"size_tokens":null},"server/services/notificationService.ts":{"content":"import { db } from '../db';\nimport { notifications, InsertNotification } from '@shared/schema';\nimport { eq, desc } from 'drizzle-orm';\n\nexport class NotificationService {\n  async createNotification(data: InsertNotification) {\n    try {\n      const [notification] = await db\n        .insert(notifications)\n        .values(data)\n        .returning();\n      \n      console.log(`Created notification: ${data.type} - ${data.title}`);\n      return notification;\n    } catch (error) {\n      console.error('Error creating notification:', error);\n      throw error;\n    }\n  }\n\n  async getNotifications(limit: number = 50) {\n    try {\n      return await db\n        .select()\n        .from(notifications)\n        .orderBy(desc(notifications.createdAt))\n        .limit(limit);\n    } catch (error) {\n      console.error('Error fetching notifications:', error);\n      throw error;\n    }\n  }\n\n  async getUnreadNotifications() {\n    try {\n      return await db\n        .select()\n        .from(notifications)\n        .where(eq(notifications.isRead, false))\n        .orderBy(desc(notifications.createdAt));\n    } catch (error) {\n      console.error('Error fetching unread notifications:', error);\n      throw error;\n    }\n  }\n\n  async markAsRead(notificationId: string) {\n    try {\n      await db\n        .update(notifications)\n        .set({ isRead: true })\n        .where(eq(notifications.id, notificationId));\n      \n      console.log(`Marked notification ${notificationId} as read`);\n    } catch (error) {\n      console.error('Error marking notification as read:', error);\n      throw error;\n    }\n  }\n\n  async markAllAsRead() {\n    try {\n      await db\n        .update(notifications)\n        .set({ isRead: true })\n        .where(eq(notifications.isRead, false));\n      \n      console.log('Marked all notifications as read');\n    } catch (error) {\n      console.error('Error marking all notifications as read:', error);\n      throw error;\n    }\n  }\n\n  async deleteNotification(notificationId: string) {\n    try {\n      await db\n        .delete(notifications)\n        .where(eq(notifications.id, notificationId));\n      \n      console.log(`Deleted notification ${notificationId}`);\n    } catch (error) {\n      console.error('Error deleting notification:', error);\n      throw error;\n    }\n  }\n\n  async clearAllNotifications() {\n    try {\n      await db.delete(notifications);\n      console.log('Cleared all notifications');\n    } catch (error) {\n      console.error('Error clearing all notifications:', error);\n      throw error;\n    }\n  }\n}\n\nexport const notificationService = new NotificationService();\n","path":null,"size_bytes":2592,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport Header from \"@/components/Header\";\nimport Footer from \"@/components/Footer\";\nimport Dashboard from \"@/pages/Dashboard\";\nimport TradeHistoryPage from \"@/pages/TradeHistoryPage\";\nimport Analytics from \"@/pages/Analytics\";\nimport EconomicCalendar from \"@/pages/EconomicCalendar\";\nimport Stocks from \"@/pages/Stocks\";\nimport MajorPairs from \"@/pages/MajorPairs\";\nimport Commodities from \"@/pages/Commodities\";\nimport Cryptocurrency from \"@/pages/Cryptocurrency\";\nimport Join from \"@/pages/Join\";\nimport Blog from \"@/pages/Blog\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Dashboard} />\n      <Route path=\"/dashboard\" component={Dashboard} />\n      <Route path=\"/history\" component={TradeHistoryPage} />\n      <Route path=\"/analytics\" component={Analytics} />\n      <Route path=\"/calendar\" component={EconomicCalendar} />\n      <Route path=\"/stocks\" component={Stocks} />\n      <Route path=\"/major-pairs\" component={MajorPairs} />\n      <Route path=\"/commodities\" component={Commodities} />\n      <Route path=\"/crypto\" component={Cryptocurrency} />\n      <Route path=\"/join\" component={Join} />\n      <Route path=\"/blog\" component={Blog} />\n      <Route path=\"/markets\" component={Stocks} />\n      <Route path=\"/signals\" component={Stocks} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nexport default function App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <div className=\"flex flex-col min-h-screen w-full\">\n          <Header />\n          <main className=\"flex-1 bg-background\">\n            <Router />\n          </main>\n          <Footer />\n        </div>\n        <Toaster />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n","path":null,"size_bytes":2042,"size_tokens":null},"client/src/components/examples/AppSidebar.tsx":{"content":"import { SidebarProvider } from '@/components/ui/sidebar';\nimport AppSidebar from '../AppSidebar';\n\nexport default function AppSidebarExample() {\n  const style = {\n    \"--sidebar-width\": \"16rem\",\n    \"--sidebar-width-icon\": \"3rem\",\n  };\n\n  return (\n    <SidebarProvider style={style as React.CSSProperties}>\n      <div className=\"flex h-64 w-full\">\n        <AppSidebar />\n        <div className=\"flex-1 p-4 bg-background\">\n          <p className=\"text-muted-foreground\">Main content area</p>\n        </div>\n      </div>\n    </SidebarProvider>\n  );\n}","path":null,"size_bytes":549,"size_tokens":null},"client/src/components/StockSignals.tsx":{"content":"import { useState } from 'react';\nimport { Badge } from '@/components/ui/badge';\nimport { TrendingUp, TrendingDown, Clock } from 'lucide-react';\nimport { format } from 'date-fns';\n\ninterface StockSignal {\n  id: string;\n  symbol: string;\n  companyName: string;\n  type: 'buy' | 'sell';\n  entry: number;\n  stopLoss: number;\n  takeProfit: number;\n  riskReward: number;\n  timeframe: string;\n  confidence: number;\n  timestamp: Date;\n  status: 'active' | 'pending';\n}\n\nexport default function StockSignals() {\n  const [selectedSignalId, setSelectedSignalId] = useState<string | null>(null);\n\n  const stockSignals: StockSignal[] = [\n    {\n      id: '1',\n      symbol: 'AAPL',\n      companyName: 'Apple Inc.',\n      type: 'buy',\n      entry: 178.50,\n      stopLoss: 175.00,\n      takeProfit: 185.00,\n      riskReward: 1.86,\n      timeframe: '1D',\n      confidence: 82,\n      timestamp: new Date(Date.now() - 10 * 60 * 1000),\n      status: 'active'\n    },\n    {\n      id: '2',\n      symbol: 'TSLA',\n      companyName: 'Tesla Inc.',\n      type: 'sell',\n      entry: 248.50,\n      stopLoss: 252.00,\n      takeProfit: 241.00,\n      riskReward: 2.1,\n      timeframe: '4H',\n      confidence: 78,\n      timestamp: new Date(Date.now() - 25 * 60 * 1000),\n      status: 'pending'\n    },\n    {\n      id: '3',\n      symbol: 'NVDA',\n      companyName: 'NVIDIA Corp.',\n      type: 'buy',\n      entry: 485.00,\n      stopLoss: 478.00,\n      takeProfit: 499.00,\n      riskReward: 2.0,\n      timeframe: '1D',\n      confidence: 88,\n      timestamp: new Date(Date.now() - 35 * 60 * 1000),\n      status: 'active'\n    },\n    {\n      id: '4',\n      symbol: 'MSFT',\n      companyName: 'Microsoft Corp.',\n      type: 'buy',\n      entry: 378.25,\n      stopLoss: 373.00,\n      takeProfit: 388.50,\n      riskReward: 1.95,\n      timeframe: '4H',\n      confidence: 75,\n      timestamp: new Date(Date.now() - 45 * 60 * 1000),\n      status: 'pending'\n    },\n    {\n      id: '5',\n      symbol: 'AMZN',\n      companyName: 'Amazon.com Inc.',\n      type: 'sell',\n      entry: 145.80,\n      stopLoss: 148.50,\n      takeProfit: 140.10,\n      riskReward: 2.1,\n      timeframe: '1D',\n      confidence: 80,\n      timestamp: new Date(Date.now() - 55 * 60 * 1000),\n      status: 'active'\n    }\n  ];\n\n  const formatTimeAgo = (timestamp: Date) => {\n    const now = new Date();\n    const diffMs = now.getTime() - timestamp.getTime();\n    const diffMins = Math.floor(diffMs / (1000 * 60));\n    \n    if (diffMins < 60) return `${diffMins}m ago`;\n    const diffHours = Math.floor(diffMins / 60);\n    if (diffHours < 24) return `${diffHours}h ago`;\n    return `${Math.floor(diffHours / 24)}d ago`;\n  };\n\n  const getSignalTypeColor = (type: string) => {\n    return type === 'buy' ? 'hsl(120 60% 50%)' : 'hsl(0 75% 60%)';\n  };\n\n  const getConfidenceColor = (confidence: number) => {\n    if (confidence >= 80) return 'text-green-500';\n    if (confidence >= 60) return 'text-yellow-500';\n    return 'text-red-500';\n  };\n\n  return (\n    <div data-testid=\"card-stock-signals\" className=\"bg-white dark:bg-background\">\n      <div className=\"pb-4 mb-4 border-b border-border/50\">\n        <div className=\"flex items-center gap-2 text-lg font-semibold\">\n          <TrendingUp className=\"w-5 h-5\" />\n          Stock Signals\n          <Badge variant=\"secondary\" className=\"ml-auto mr-2\">\n            {stockSignals.filter(s => s.status === 'active').length} Active\n          </Badge>\n        </div>\n      </div>\n      <div>\n        <div className=\"divide-y divide-border/50\">\n          {stockSignals.map((signal, index) => (\n            <div\n              key={signal.id}\n              onClick={() => setSelectedSignalId(selectedSignalId === signal.id ? null : signal.id)}\n              className={`py-4 transition-all cursor-pointer ${\n                selectedSignalId === signal.id ? 'bg-primary/5' : 'hover-elevate'\n              }`}\n              data-testid={`card-stock-${signal.id}`}\n            >\n              <div className=\"flex items-start justify-between gap-3 mb-3\">\n                <div className=\"flex items-center gap-3 flex-1 min-w-0\">\n                  <div className=\"relative\">\n                    <div className=\"absolute left-0 top-0 bottom-0 w-0.5\" style={{ backgroundColor: getSignalTypeColor(signal.type) }} />\n                    <Badge \n                      variant=\"secondary\"\n                      className=\"text-xs font-medium shrink-0 ml-3\"\n                      style={{ \n                        backgroundColor: getSignalTypeColor(signal.type) + '20', \n                        color: getSignalTypeColor(signal.type) \n                      }}\n                    >\n                      {signal.type.toUpperCase()}\n                    </Badge>\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center gap-2\">\n                      <h4 className=\"font-semibold text-sm\" data-testid={`text-symbol-${signal.id}`}>\n                        {signal.symbol}\n                      </h4>\n                      {signal.type === 'buy' ? (\n                        <TrendingUp className=\"w-3 h-3 text-green-500 shrink-0\" />\n                      ) : (\n                        <TrendingDown className=\"w-3 h-3 text-red-500 shrink-0\" />\n                      )}\n                    </div>\n                    <p className=\"text-xs text-muted-foreground truncate\">{signal.companyName}</p>\n                  </div>\n                </div>\n                \n                <div className=\"flex items-center gap-2 shrink-0 ml-2 mr-2\">\n                  <Badge \n                    variant=\"outline\"\n                    className={`text-xs ${getConfidenceColor(signal.confidence)}`}\n                  >\n                    {signal.confidence}%\n                  </Badge>\n                  <Badge variant={signal.status === 'active' ? 'default' : 'secondary'} className=\"text-xs\">\n                    {signal.status}\n                  </Badge>\n                </div>\n              </div>\n\n              <div className=\"flex items-stretch gap-0 text-xs mb-3 ml-3\">\n                <div className=\"flex-1 pr-4 border-r border-border/50\">\n                  <span className=\"text-muted-foreground\">Entry:</span>\n                  <div className=\"font-mono font-semibold\" data-testid={`text-entry-${signal.id}`}>\n                    ${signal.entry.toFixed(2)}\n                  </div>\n                </div>\n                <div className=\"flex-1 px-4 border-r border-border/50\">\n                  <span className=\"text-muted-foreground\">Stop:</span>\n                  <div className=\"font-mono font-semibold text-red-500\">\n                    ${signal.stopLoss.toFixed(2)}\n                  </div>\n                </div>\n                <div className=\"flex-1 pl-4\">\n                  <span className=\"text-muted-foreground\">Target:</span>\n                  <div className=\"font-mono font-semibold text-green-500\">\n                    ${signal.takeProfit.toFixed(2)}\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"flex items-center justify-between text-xs ml-3 pt-2 border-t border-border/30\">\n                <div className=\"flex items-center gap-2 text-muted-foreground\">\n                  <span>{signal.timeframe}</span>\n                  <span></span>\n                  <span className=\"flex items-center gap-1\">\n                    <Clock className=\"w-3 h-3\" />\n                    {formatTimeAgo(signal.timestamp)}\n                  </span>\n                </div>\n                <div className=\"text-muted-foreground\">\n                  R:R 1:{signal.riskReward}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":7758,"size_tokens":null},"client/src/components/examples/Dashboard.tsx":{"content":"import Dashboard from '../../pages/Dashboard';\n\nexport default function DashboardExample() {\n  return <Dashboard />;\n}","path":null,"size_bytes":118,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"client/src/pages/Analytics.tsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { BarChart3, TrendingUp, TrendingDown, DollarSign, Target } from 'lucide-react';\n\ninterface Analytics {\n  totalTrades: number;\n  winningTrades: number;\n  losingTrades: number;\n  totalPnL: string;\n  averagePnL: string;\n  winRate: string;\n  averageWin: string;\n  averageLoss: string;\n}\n\nexport default function Analytics() {\n  const { data: analytics, isLoading } = useQuery<Analytics>({\n    queryKey: ['/api/analytics'],\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"container mx-auto p-6\">\n        <div className=\"text-center py-8 text-muted-foreground\">\n          Loading analytics...\n        </div>\n      </div>\n    );\n  }\n\n  if (!analytics) {\n    return (\n      <div className=\"container mx-auto p-6\">\n        <div className=\"text-center py-8 text-muted-foreground\">\n          No analytics data available\n        </div>\n      </div>\n    );\n  }\n\n  const stats = [\n    {\n      title: 'Total Trades',\n      value: analytics.totalTrades,\n      icon: BarChart3,\n      color: 'text-blue-500',\n    },\n    {\n      title: 'Total P&L',\n      value: `$${analytics.totalPnL}`,\n      icon: DollarSign,\n      color: parseFloat(analytics.totalPnL) >= 0 ? 'text-green-500' : 'text-red-500',\n    },\n    {\n      title: 'Win Rate',\n      value: `${analytics.winRate}%`,\n      icon: Target,\n      color: 'text-purple-500',\n    },\n    {\n      title: 'Average Win',\n      value: `$${analytics.averageWin}`,\n      icon: TrendingUp,\n      color: 'text-green-500',\n    },\n    {\n      title: 'Average Loss',\n      value: `$${analytics.averageLoss}`,\n      icon: TrendingDown,\n      color: 'text-red-500',\n    },\n  ];\n\n  return (\n    <div className=\"container mx-auto p-6 space-y-6\" data-testid=\"page-analytics\">\n      <div className=\"flex items-center gap-2 mb-6\">\n        <BarChart3 className=\"w-8 h-8\" />\n        <h1 className=\"text-3xl font-bold\">Trading Analytics</h1>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n        {stats.map((stat) => (\n          <Card key={stat.title} data-testid={`card-${stat.title.toLowerCase().replace(' ', '-')}`}>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n                {stat.title}\n              </CardTitle>\n              <stat.icon className={`w-4 h-4 ${stat.color}`} />\n            </CardHeader>\n            <CardContent>\n              <div className={`text-2xl font-bold ${stat.color}`} data-testid={`value-${stat.title.toLowerCase().replace(' ', '-')}`}>\n                {stat.value}\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        <Card data-testid=\"card-performance-breakdown\">\n          <CardHeader>\n            <CardTitle>Performance Breakdown</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-muted-foreground\">Winning Trades</span>\n              <span className=\"font-semibold text-green-500\" data-testid=\"text-winning-trades\">\n                {analytics.winningTrades}\n              </span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-muted-foreground\">Losing Trades</span>\n              <span className=\"font-semibold text-red-500\" data-testid=\"text-losing-trades\">\n                {analytics.losingTrades}\n              </span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-muted-foreground\">Average P&L</span>\n              <span className={`font-semibold ${parseFloat(analytics.averagePnL) >= 0 ? 'text-green-500' : 'text-red-500'}`}>\n                ${analytics.averagePnL}\n              </span>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-risk-reward\">\n          <CardHeader>\n            <CardTitle>Risk/Reward Analysis</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-muted-foreground\">Win Rate</span>\n              <span className=\"font-semibold\" data-testid=\"text-win-rate\">{analytics.winRate}%</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-muted-foreground\">Avg Win</span>\n              <span className=\"font-semibold text-green-500\">${analytics.averageWin}</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-muted-foreground\">Avg Loss</span>\n              <span className=\"font-semibold text-red-500\">${analytics.averageLoss}</span>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":5126,"size_tokens":null},"server/services/signalDetection.ts":{"content":"import { type InsertTradingSignal } from \"@shared/schema\";\nimport { LiquiditySweepDetector, type LiquiditySweepResult, type CHoCHResult } from './liquiditySweepDetection';\nimport { type Candle } from './marketData';\n\nexport interface TimeframeData {\n  timeframe: string;\n  open: number;\n  high: number;\n  low: number;\n  close: number;\n  volume?: number;\n  timestamp: Date;\n}\n\nexport interface InstitutionalCandleData {\n  timeframe: string;\n  candleType: 'bullish' | 'bearish';\n  open: number;\n  close: number;\n  high: number;\n  low: number;\n  mth: number;\n  timestamp: Date;\n  structureBreak: boolean;\n  impulseMagnitude: number;\n}\n\nexport interface InterestRateData {\n  currency: string;\n  rate: number;\n  lastUpdate: Date;\n}\n\nexport interface InflationData {\n  country: string;\n  currency: string;\n  rate: number;\n  lastUpdate: Date;\n}\n\nconst SCORING_WEIGHTS = {\n  interestRateDifferential: 0.40,\n  inflation: 0.25,\n  trend: 0.20,\n  smartMoneyConcepts: 0.15,\n};\n\nconst TIMEFRAME_HIERARCHY = {\n  macroContext: ['1D'],\n  tradingIdea: ['4H', '2H', '1H'],\n  confirmation: ['30M', '15M'],\n  execution: ['5M', '1M'],\n};\n\nexport class SignalDetectionService {\n  private liquiditySweepDetector: LiquiditySweepDetector;\n\n  constructor() {\n    this.liquiditySweepDetector = new LiquiditySweepDetector();\n  }\n  \n  calculateInterestRateDifferential(\n    baseCurrency: string,\n    quoteCurrency: string,\n    baseRate: number,\n    quoteRate: number\n  ): { score: number; differential: number; notes: string } {\n    const differential = baseRate - quoteRate;\n    \n    let score = 0;\n    if (Math.abs(differential) >= 3.0) {\n      score = 100;\n    } else if (Math.abs(differential) >= 2.0) {\n      score = 85;\n    } else if (Math.abs(differential) >= 1.0) {\n      score = 70;\n    } else if (Math.abs(differential) >= 0.5) {\n      score = 50;\n    } else {\n      score = 25;\n    }\n    \n    const direction = differential > 0 ? 'favorable for long' : 'favorable for short';\n    const notes = `${baseCurrency}/${quoteCurrency}: ${differential.toFixed(2)}% differential, ${direction}`;\n    \n    return {\n      score: score * SCORING_WEIGHTS.interestRateDifferential,\n      differential,\n      notes,\n    };\n  }\n\n  calculateInflationImpact(\n    baseCurrency: string,\n    quoteCurrency: string,\n    baseInflation: number,\n    quoteInflation: number\n  ): { score: number; differential: number; notes: string } {\n    const differential = quoteInflation - baseInflation;\n    \n    let score = 0;\n    if (Math.abs(differential) >= 3.0) {\n      score = 95;\n    } else if (Math.abs(differential) >= 2.0) {\n      score = 80;\n    } else if (Math.abs(differential) >= 1.0) {\n      score = 65;\n    } else if (Math.abs(differential) >= 0.5) {\n      score = 45;\n    } else {\n      score = 20;\n    }\n    \n    const impact = differential > 0 \n      ? `Higher inflation in ${quoteCurrency} pressures depreciation` \n      : `Lower inflation in ${quoteCurrency} supports appreciation`;\n    \n    const notes = `Inflation differential: ${differential.toFixed(2)}%. ${impact}`;\n    \n    return {\n      score: score * SCORING_WEIGHTS.inflation,\n      differential,\n      notes,\n    };\n  }\n\n  detectTrend(\n    dailyData: TimeframeData[],\n    h4Data: TimeframeData[],\n    h1Data: TimeframeData[]\n  ): { score: number; direction: string; strength: string; timeframes: string[] } {\n    const trends = {\n      daily: this.analyzeSingleTimeframeTrend(dailyData),\n      h4: this.analyzeSingleTimeframeTrend(h4Data),\n      h1: this.analyzeSingleTimeframeTrend(h1Data),\n    };\n    \n    const alignedTimeframes: string[] = [];\n    let dominantDirection = trends.daily.direction;\n    \n    if (trends.daily.direction === trends.h4.direction) alignedTimeframes.push('1D', '4H');\n    if (trends.h4.direction === trends.h1.direction) alignedTimeframes.push('4H', '1H');\n    if (trends.daily.direction === trends.h1.direction) alignedTimeframes.push('1D', '1H');\n    \n    const alignmentScore = alignedTimeframes.length >= 2 ? 90 : alignedTimeframes.length === 1 ? 60 : 30;\n    \n    const strength = alignmentScore >= 80 ? 'strong' : alignmentScore >= 60 ? 'moderate' : 'weak';\n    \n    return {\n      score: alignmentScore * SCORING_WEIGHTS.trend,\n      direction: dominantDirection,\n      strength,\n      timeframes: Array.from(new Set(alignedTimeframes)),\n    };\n  }\n\n  private analyzeSingleTimeframeTrend(data: TimeframeData[]): { direction: string; strength: number } {\n    if (data.length < 3) return { direction: 'neutral', strength: 0 };\n    \n    const recentData = data.slice(-10);\n    const closes = recentData.map(d => d.close);\n    \n    let upMoves = 0;\n    let downMoves = 0;\n    \n    for (let i = 1; i < closes.length; i++) {\n      if (closes[i] > closes[i - 1]) upMoves++;\n      else if (closes[i] < closes[i - 1]) downMoves++;\n    }\n    \n    const direction = upMoves > downMoves ? 'bullish' : downMoves > upMoves ? 'bearish' : 'neutral';\n    const strength = Math.max(upMoves, downMoves) / (closes.length - 1);\n    \n    return { direction, strength };\n  }\n\n  detectInstitutionalCandle(\n    data: TimeframeData[],\n    timeframe: string\n  ): InstitutionalCandleData | null {\n    if (data.length < 3) return null;\n    \n    for (let i = data.length - 2; i >= Math.max(1, data.length - 20); i--) {\n      const oppositeCandle = data[i - 1];\n      const impulseCandle = data[i];\n      \n      const oppositeIsBearish = oppositeCandle.close < oppositeCandle.open;\n      const oppositeIsBullish = oppositeCandle.close > oppositeCandle.open;\n      \n      const impulseIsBullish = impulseCandle.close > impulseCandle.open;\n      const impulseIsBearish = impulseCandle.close < impulseCandle.open;\n      \n      const oppositeBody = Math.abs(oppositeCandle.close - oppositeCandle.open);\n      const impulseBody = Math.abs(impulseCandle.close - impulseCandle.open);\n      \n      const isStrongImpulse = impulseBody > oppositeBody * 1.5;\n      \n      if (oppositeIsBearish && impulseIsBullish && isStrongImpulse) {\n        const prevHighs = data.slice(0, i - 1).map(d => d.high);\n        const prevStructureHigh = prevHighs.length > 0 ? Math.max(...prevHighs) : 0;\n        const structureBreak = impulseCandle.close > prevStructureHigh;\n        \n        if (structureBreak) {\n          return {\n            timeframe,\n            candleType: 'bullish',\n            open: oppositeCandle.open,\n            close: oppositeCandle.close,\n            high: oppositeCandle.high,\n            low: oppositeCandle.low,\n            mth: (oppositeCandle.open + oppositeCandle.close) / 2,\n            timestamp: oppositeCandle.timestamp,\n            structureBreak: true,\n            impulseMagnitude: impulseBody,\n          };\n        }\n      }\n      \n      if (oppositeIsBullish && impulseIsBearish && isStrongImpulse) {\n        const prevLows = data.slice(0, i - 1).map(d => d.low);\n        const prevStructureLow = prevLows.length > 0 ? Math.min(...prevLows) : Infinity;\n        const structureBreak = impulseCandle.close < prevStructureLow;\n        \n        if (structureBreak) {\n          return {\n            timeframe,\n            candleType: 'bearish',\n            open: oppositeCandle.open,\n            close: oppositeCandle.close,\n            high: oppositeCandle.high,\n            low: oppositeCandle.low,\n            mth: (oppositeCandle.open + oppositeCandle.close) / 2,\n            timestamp: oppositeCandle.timestamp,\n            structureBreak: true,\n            impulseMagnitude: impulseBody,\n          };\n        }\n      }\n    }\n    \n    return null;\n  }\n\n  detectSmartMoneyFactors(\n    data: TimeframeData[],\n    institutionalCandle: InstitutionalCandleData | null\n  ): { \n    score: number; \n    factors: string[]; \n    orderBlock: any; \n    fvg: any; \n    liquiditySweep: boolean; \n    liquiditySweepData?: LiquiditySweepResult;\n    chochData?: CHoCHResult;\n  } {\n    const factors: string[] = [];\n    let score = 0;\n    let orderBlock = null;\n    let fvg = null;\n    let liquiditySweep = false;\n    \n    if (institutionalCandle) {\n      factors.push(`Institutional candle detected at ${institutionalCandle.mth.toFixed(5)}`);\n      score += 40;\n      \n      orderBlock = {\n        type: institutionalCandle.candleType,\n        level: institutionalCandle.mth,\n      };\n    }\n    \n    const recentData = data.slice(-5);\n    for (let i = 1; i < recentData.length - 1; i++) {\n      const prev = recentData[i - 1];\n      const current = recentData[i];\n      const next = recentData[i + 1];\n      \n      if (prev.low > next.high) {\n        factors.push(`FVG (Fair Value Gap) identified: ${next.high.toFixed(5)} - ${prev.low.toFixed(5)}`);\n        fvg = { level: (prev.low + next.high) / 2 };\n        score += 25;\n        break;\n      }\n      \n      if (prev.high < next.low) {\n        factors.push(`FVG (Fair Value Gap) identified: ${prev.high.toFixed(5)} - ${next.low.toFixed(5)}`);\n        fvg = { level: (prev.high + next.low) / 2 };\n        score += 25;\n        break;\n      }\n    }\n    \n    // Convert TimeframeData to Candle format for liquidity sweep detection\n    const candles: Candle[] = data.map(d => ({\n      timeframe: d.timeframe,\n      open: d.open,\n      high: d.high,\n      low: d.low,\n      close: d.close,\n      volume: d.volume || 0,\n      timestamp: d.timestamp,\n    }));\n    \n    // Use advanced liquidity sweep detection\n    const liquiditySweepResult = this.liquiditySweepDetector.analyzeLiquiditySweep(candles);\n    \n    if (liquiditySweepResult.sweepDetected) {\n      liquiditySweep = true;\n      \n      // Add liquidity sweep reasoning to factors\n      liquiditySweepResult.reasoning.forEach(reason => {\n        factors.push(reason);\n      });\n      \n      // Enhanced scoring based on sweep quality AND confirmed mitigation\n      if (liquiditySweepResult.supplyDemandZone && \n          liquiditySweepResult.supplyDemandZone.mitigated &&\n          liquiditySweepResult.entryPrice && \n          liquiditySweepResult.stopLoss) {\n        // High-quality setup: sweep + CONFIRMED zone mitigation with entry\n        score += 35;\n        if (liquiditySweepResult.supplyDemandZone.strength === 'strong') {\n          score += 15;\n        } else if (liquiditySweepResult.supplyDemandZone.strength === 'moderate') {\n          score += 8;\n        }\n      } else {\n        // Basic sweep detected, but no confirmed mitigation entry yet\n        score += 15;\n      }\n    }\n    \n    // Detect CHoCH (Change of Character) - trend reversal\n    const zones = this.liquiditySweepDetector.identifySupplyDemandZones(candles);\n    const chochResult = this.liquiditySweepDetector.detectCHoCH(candles, zones);\n    \n    if (chochResult.detected) {\n      // Add CHoCH reasoning to factors\n      chochResult.reasoning.forEach(reason => {\n        factors.push(reason);\n      });\n      \n      // Score based on CHoCH entry validity\n      if (chochResult.entryValid) {\n        // Valid CHoCH entry setup (high-probability)\n        score += 40;\n        if (chochResult.levelsBroken && chochResult.levelsBroken >= 3) {\n          score += 10;\n        }\n        if (chochResult.targetZone?.strength === 'strong') {\n          score += 10;\n        }\n      } else if (chochResult.detected) {\n        // CHoCH detected but entry not yet valid\n        score += 15;\n      }\n    }\n    \n    const finalScore = Math.min(100, score) * SCORING_WEIGHTS.smartMoneyConcepts;\n    \n    return {\n      score: finalScore,\n      factors,\n      orderBlock,\n      fvg,\n      liquiditySweep,\n      liquiditySweepData: liquiditySweepResult.sweepDetected ? liquiditySweepResult : undefined,\n      chochData: chochResult.detected ? chochResult : undefined,\n    };\n  }\n\n  calculateOverallConfidence(\n    interestRateScore: number,\n    inflationScore: number,\n    trendScore: number,\n    smcScore: number\n  ): number {\n    const totalScore = interestRateScore + inflationScore + trendScore + smcScore;\n    return Math.min(100, Math.round(totalScore));\n  }\n\n  generateTradingSignal(params: {\n    symbol: string;\n    assetClass: string;\n    interestRateData?: { base: InterestRateData; quote: InterestRateData };\n    inflationData?: { base: InflationData; quote: InflationData };\n    dailyData: TimeframeData[];\n    h4Data: TimeframeData[];\n    h1Data: TimeframeData[];\n    m15Data: TimeframeData[];\n  }): InsertTradingSignal | null {\n    const { symbol, assetClass, interestRateData, inflationData, dailyData, h4Data, h1Data, m15Data } = params;\n    \n    let interestRateScore = 0;\n    let interestRateDiff = null;\n    let interestRateNotes = null;\n    \n    if (interestRateData) {\n      const irResult = this.calculateInterestRateDifferential(\n        interestRateData.base.currency,\n        interestRateData.quote.currency,\n        interestRateData.base.rate,\n        interestRateData.quote.rate\n      );\n      interestRateScore = irResult.score;\n      interestRateDiff = irResult.differential;\n      interestRateNotes = irResult.notes;\n    } else if (assetClass === 'stock' || assetClass === 'crypto' || assetClass === 'commodity') {\n      interestRateScore = 75 * SCORING_WEIGHTS.interestRateDifferential;\n      interestRateNotes = `${assetClass.toUpperCase()} analysis uses market momentum instead of IR differential`;\n    }\n    \n    let inflationScore = 0;\n    let inflationDiff = null;\n    let inflationNotes = null;\n    \n    if (inflationData) {\n      const infResult = this.calculateInflationImpact(\n        inflationData.base.currency,\n        inflationData.quote.currency,\n        inflationData.base.rate,\n        inflationData.quote.rate\n      );\n      inflationScore = infResult.score;\n      inflationDiff = infResult.differential;\n      inflationNotes = infResult.notes;\n    } else if (assetClass === 'stock' || assetClass === 'crypto' || assetClass === 'commodity') {\n      inflationScore = 70 * SCORING_WEIGHTS.inflation;\n      inflationNotes = `${assetClass.toUpperCase()} analysis uses sector momentum instead of inflation differential`;\n    }\n    \n    const trendResult = this.detectTrend(dailyData, h4Data, h1Data);\n    \n    const institutionalCandle = this.detectInstitutionalCandle(h4Data, '4H') || \n                                 this.detectInstitutionalCandle(h1Data, '1H');\n    \n    const smcResult = this.detectSmartMoneyFactors(h4Data, institutionalCandle);\n    \n    const overallConfidence = this.calculateOverallConfidence(\n      interestRateScore,\n      inflationScore,\n      trendResult.score,\n      smcResult.score\n    );\n    \n    if (overallConfidence < 50) {\n      return null;\n    }\n    \n    const latestPrice = h1Data[h1Data.length - 1].close;\n    let type = trendResult.direction === 'bullish' ? 'buy' : 'sell';\n    let entryPrice = latestPrice;\n    let stopLoss: number;\n    let takeProfit: number;\n    let strategyType: 'liquidity_sweep_mitigation' | 'choch_reversal' | 'institutional_backbone' = 'institutional_backbone';\n    \n    // Priority 1: Check for VALID CHoCH entry (trend reversal with unmitigated zone)\n    if (smcResult.chochData?.entryValid && smcResult.chochData.targetZone) {\n      const zone = smcResult.chochData.targetZone;\n      \n      // Use CHoCH entry logic\n      entryPrice = (zone.topPrice + zone.bottomPrice) / 2;\n      \n      // Override type based on CHoCH direction\n      type = smcResult.chochData.chochType === 'bullish_choch' ? 'buy' : 'sell';\n      \n      if (type === 'buy') {\n        stopLoss = zone.bottomPrice - (zone.topPrice - zone.bottomPrice) * 0.3;\n        const risk = Math.abs(entryPrice - stopLoss);\n        takeProfit = entryPrice + (risk * 3); // 1:3 R:R for CHoCH setups\n      } else {\n        stopLoss = zone.topPrice + (zone.topPrice - zone.bottomPrice) * 0.3;\n        const risk = Math.abs(entryPrice - stopLoss);\n        takeProfit = entryPrice - (risk * 3);\n      }\n      \n      strategyType = 'choch_reversal';\n    } \n    // Priority 2: Check for CONFIRMED liquidity sweep with mitigated zone entry\n    else if (smcResult.liquiditySweepData?.supplyDemandZone && \n        smcResult.liquiditySweepData.supplyDemandZone.mitigated &&\n        smcResult.liquiditySweepData.entryPrice &&\n        smcResult.liquiditySweepData.stopLoss) {\n      // Use liquidity sweep entry logic (only when zone is mitigated)\n      entryPrice = smcResult.liquiditySweepData.entryPrice;\n      stopLoss = smcResult.liquiditySweepData.stopLoss;\n      \n      // Override type based on sweep direction\n      type = smcResult.liquiditySweepData.sweepType === 'bearish_sweep' ? 'sell' : 'buy';\n      \n      // Calculate take profit based on risk-reward\n      const risk = Math.abs(entryPrice - stopLoss);\n      takeProfit = type === 'buy' \n        ? entryPrice + (risk * 2.5) // 1:2.5 R:R for sweep setups\n        : entryPrice - (risk * 2.5);\n      \n      strategyType = 'liquidity_sweep_mitigation';\n    } \n    // Fallback: Use traditional ATR-based entry\n    else {\n      const atr = this.calculateATR(h1Data.slice(-14));\n      stopLoss = type === 'buy' \n        ? latestPrice - (atr * 1.5)\n        : latestPrice + (atr * 1.5);\n      \n      takeProfit = type === 'buy'\n        ? latestPrice + (atr * 3)\n        : latestPrice - (atr * 3);\n    }\n    \n    const riskRewardRatio = Math.abs(takeProfit - entryPrice) / Math.abs(entryPrice - stopLoss);\n    \n    const technicalReasons: string[] = [];\n    if (trendResult.timeframes.length > 0) {\n      technicalReasons.push(`Multi-timeframe trend alignment: ${trendResult.timeframes.join(', ')}`);\n    }\n    if (interestRateData) {\n      technicalReasons.push(`Interest rate differential: ${interestRateDiff?.toFixed(2)}%`);\n    }\n    if (inflationData) {\n      technicalReasons.push(`Inflation differential supports ${type} bias`);\n    }\n    \n    // Check for CHoCH entry (highest priority)\n    if (strategyType === 'choch_reversal' && smcResult.chochData) {\n      const trend = smcResult.chochData.previousTrend === 'uptrend' ? 'Uptrend' : 'Downtrend';\n      const levelsBroken = smcResult.chochData.levelsBroken || 0;\n      const zoneType = smcResult.chochData.targetZone?.type || 'zone';\n      technicalReasons.push(\n        `CHoCH (Change of Character): ${trend} reversed with ${levelsBroken}+ levels broken`,\n        `Targeting unmitigated ${zoneType} zone (High-probability reversal setup)`\n      );\n    }\n    \n    // Check if we have a confirmed liquidity sweep mitigation entry\n    const hasConfirmedSweepEntry = !!(\n      smcResult.liquiditySweepData?.supplyDemandZone && \n      smcResult.liquiditySweepData.supplyDemandZone.mitigated &&\n      smcResult.liquiditySweepData.entryPrice && \n      smcResult.liquiditySweepData.stopLoss\n    );\n    \n    // Add liquidity sweep information to technical reasons only if confirmed\n    if (hasConfirmedSweepEntry && strategyType === 'liquidity_sweep_mitigation') {\n      const zoneType = smcResult.liquiditySweepData!.supplyDemandZone!.type;\n      const zoneStrength = smcResult.liquiditySweepData!.supplyDemandZone!.strength;\n      technicalReasons.push(\n        `Liquidity sweep followed by ${zoneStrength} ${zoneType} zone mitigation (High-probability setup)`\n      );\n    }\n    \n    // Determine market context based on strategy\n    let marketContext: string;\n    if (strategyType === 'choch_reversal') {\n      const trend = smcResult.chochData?.previousTrend === 'uptrend' ? 'uptrend' : 'downtrend';\n      marketContext = `CHoCH reversal from ${trend} targeting unmitigated zone`;\n    } else if (strategyType === 'liquidity_sweep_mitigation') {\n      marketContext = `Post-liquidity sweep ${smcResult.liquiditySweepData!.supplyDemandZone!.type} zone entry`;\n    } else {\n      marketContext = `${trendResult.strength} ${trendResult.direction} trend with ${overallConfidence}% confidence`;\n    }\n    \n    const signal: InsertTradingSignal = {\n      symbol,\n      assetClass,\n      type,\n      strategy: strategyType,\n      entryPrice: entryPrice.toString(),\n      stopLoss: stopLoss.toString(),\n      takeProfit: takeProfit.toString(),\n      riskRewardRatio: riskRewardRatio.toFixed(2),\n      primaryTimeframe: institutionalCandle?.timeframe || '4H',\n      confirmationTimeframe: '15M',\n      executionTimeframe: '5M',\n      overallConfidence,\n      interestRateDiffScore: interestRateScore.toString(),\n      interestRateDiffValue: interestRateDiff?.toString() || null,\n      interestRateNotes,\n      inflationImpactScore: inflationScore.toString(),\n      inflationDifferential: inflationDiff?.toString() || null,\n      inflationNotes,\n      trendScore: trendResult.score.toString(),\n      trendDirection: trendResult.direction,\n      trendStrength: trendResult.strength,\n      trendTimeframes: trendResult.timeframes,\n      smcScore: smcResult.score.toString(),\n      institutionalCandleDetected: !!institutionalCandle,\n      institutionalCandleData: institutionalCandle,\n      orderBlockType: smcResult.orderBlock?.type || null,\n      orderBlockLevel: smcResult.orderBlock?.level?.toString() || null,\n      fvgDetected: !!smcResult.fvg,\n      fvgLevel: smcResult.fvg?.level?.toString() || null,\n      liquiditySweep: smcResult.liquiditySweep,\n      smcFactors: smcResult.factors,\n      technicalReasons,\n      marketContext,\n      status: 'active',\n      strength: overallConfidence >= 80 ? 'strong' : overallConfidence >= 60 ? 'moderate' : 'weak',\n    };\n    \n    return signal;\n  }\n\n  private calculateATR(data: TimeframeData[], period: number = 14): number {\n    if (data.length < period) return 0;\n    \n    const trueRanges: number[] = [];\n    for (let i = 1; i < data.length; i++) {\n      const high = data[i].high;\n      const low = data[i].low;\n      const prevClose = data[i - 1].close;\n      \n      const tr = Math.max(\n        high - low,\n        Math.abs(high - prevClose),\n        Math.abs(low - prevClose)\n      );\n      trueRanges.push(tr);\n    }\n    \n    const atr = trueRanges.slice(-period).reduce((sum, tr) => sum + tr, 0) / period;\n    return atr;\n  }\n}\n\nexport const signalDetectionService = new SignalDetectionService();\n","path":null,"size_bytes":21814,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1139,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"server/scrapers/config.ts":{"content":"export interface ScraperConfig {\n  name: string;\n  url: string;\n  enabled: boolean;\n  priority: number;\n  selectors: {\n    eventRow?: string;\n    eventName?: string;\n    country?: string;\n    date?: string;\n    time?: string;\n    impact?: string;\n    actual?: string;\n    forecast?: string;\n    previous?: string;\n    currency?: string;\n  };\n  dataMapping?: {\n    impactLevels?: Record<string, string>;\n    countryCodes?: Record<string, string>;\n  };\n}\n\nexport const scraperConfigs: Record<string, ScraperConfig> = {\n  myFxBook: {\n    name: 'MyFXBook',\n    url: 'https://www.myfxbook.com/forex-economic-calendar',\n    enabled: true,\n    priority: 1,\n    selectors: {\n      eventRow: 'tr.economicCalendarRow',\n      eventName: 'td.calendarToggleCell:nth-child(5)',\n      country: 'td.calendarToggleCell:nth-child(4)',\n      date: 'td.calendarToggleCell:nth-child(1)',\n      time: 'td.calendarToggleCell:nth-child(1)',\n      impact: 'td.calendarToggleCell:nth-child(6)',\n      actual: 'td.calendarToggleCell:nth-child(9)',\n      forecast: 'td.calendarToggleCell:nth-child(8)',\n      previous: 'td.calendarToggleCell:nth-child(7)',\n      currency: 'td.calendarToggleCell:nth-child(4)',\n    },\n    dataMapping: {\n      impactLevels: {\n        'None': 'None',\n        'Low': 'Low',\n        'Medium': 'Medium',\n        'High': 'High',\n      },\n      countryCodes: {\n        'USD': 'USD',\n        'EUR': 'EUR',\n        'GBP': 'GBP',\n        'JPY': 'JPY',\n        'CAD': 'CAD',\n        'AUD': 'AUD',\n        'NZD': 'NZD',\n        'CHF': 'CHF',\n        'CNY': 'CNY',\n      },\n    },\n  },\n\n  investingCom: {\n    name: 'Investing.com',\n    url: 'https://www.investing.com/economic-calendar/',\n    enabled: false,\n    priority: 2,\n    selectors: {\n      eventRow: 'tr.js-event-item',\n      eventName: 'td.event a',\n      country: 'td.flagCur',\n      date: 'td.time',\n      time: 'td.time',\n      impact: 'td.sentiment',\n      actual: 'td#actual',\n      forecast: 'td#forecast',\n      previous: 'td#previous',\n    },\n    dataMapping: {\n      impactLevels: {\n        'bull1': 'Low',\n        'bull2': 'Medium',\n        'bull3': 'High',\n        'grayFullBullishIcon': 'Holiday',\n      },\n      countryCodes: {\n        'United States': 'USD',\n        'Eurozone': 'EUR',\n        'United Kingdom': 'GBP',\n        'Japan': 'JPY',\n        'Canada': 'CAD',\n        'Australia': 'AUD',\n        'New Zealand': 'NZD',\n        'Switzerland': 'CHF',\n        'China': 'CNY',\n      },\n    },\n  },\n  \n  forexFactory: {\n    name: 'ForexFactory',\n    url: 'https://www.forexfactory.com/calendar',\n    enabled: false,\n    priority: 3,\n    selectors: {\n      eventRow: 'tr.calendar__row',\n      eventName: 'td.calendar__event span.calendar__event-title',\n      country: 'td.calendar__currency',\n      time: 'td.calendar__time',\n      impact: 'td.calendar__impact span',\n      actual: 'td.calendar__actual',\n      forecast: 'td.calendar__forecast',\n      previous: 'td.calendar__previous',\n    },\n    dataMapping: {\n      impactLevels: {\n        'icon--ff-impact-yel': 'Low',\n        'icon--ff-impact-ora': 'Medium',\n        'icon--ff-impact-red': 'High',\n        'icon--ff-impact-gra': 'Holiday',\n      },\n      countryCodes: {\n        'USD': 'USD',\n        'EUR': 'EUR',\n        'GBP': 'GBP',\n        'JPY': 'JPY',\n        'CAD': 'CAD',\n        'AUD': 'AUD',\n        'NZD': 'NZD',\n        'CHF': 'CHF',\n        'CNY': 'CNY',\n      },\n    },\n  },\n\n  fxStreet: {\n    name: 'FXStreet',\n    url: 'https://www.fxstreet.com/economic-calendar',\n    enabled: false,\n    priority: 4,\n    selectors: {\n      eventRow: 'div.fxs_calendar_row',\n      eventName: 'div.fxs_event_title',\n      country: 'div.fxs_c_currency',\n      time: 'div.fxs_c_time',\n      impact: 'div.fxs_c_volatility',\n      actual: 'div.fxs_c_actual',\n      forecast: 'div.fxs_c_consensus',\n      previous: 'div.fxs_c_previous',\n    },\n    dataMapping: {\n      impactLevels: {\n        'low': 'Low',\n        'medium': 'Medium',\n        'high': 'High',\n      },\n    },\n  },\n\n  tradingEconomics: {\n    name: 'TradingEconomics',\n    url: 'https://tradingeconomics.com/calendar',\n    enabled: false,\n    priority: 4,\n    selectors: {\n      eventRow: 'tr[data-event]',\n      eventName: 'td.calendar-event a',\n      country: 'td.calendar-country',\n      time: 'td.calendar-time',\n      impact: 'td.calendar-importance',\n      actual: 'td.calendar-actual',\n      forecast: 'td.calendar-forecast',\n      previous: 'td.calendar-previous',\n    },\n    dataMapping: {\n      impactLevels: {\n        '1': 'Low',\n        '2': 'Medium',\n        '3': 'High',\n      },\n    },\n  },\n};\n\nexport const scraperSettings = {\n  requestDelay: 3000,\n  timeout: 30000,\n  retryAttempts: 3,\n  retryDelay: 5000,\n  userAgents: [\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',\n    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',\n    'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0',\n  ],\n  cacheSettings: {\n    cacheDuration: 15 * 60 * 1000,\n    dataRetentionDays: 7,\n    cleanupInterval: 60 * 60 * 1000,\n  },\n  schedules: {\n    upcomingEventsInterval: 15 * 60 * 1000,\n    fullWeekScrapeTime: '0 0 * * *',\n  },\n};\n\nexport function getRandomUserAgent(): string {\n  return scraperSettings.userAgents[\n    Math.floor(Math.random() * scraperSettings.userAgents.length)\n  ];\n}\n\nexport function getActiveScrapers(): ScraperConfig[] {\n  return Object.values(scraperConfigs)\n    .filter(config => config.enabled)\n    .sort((a, b) => a.priority - b.priority);\n}\n","path":null,"size_bytes":5732,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7428,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2359,"size_tokens":null},"client/src/lib/tradingSessions.ts":{"content":"export interface TradingSession {\n  name: string;\n  city: string;\n  timezone: string;\n  openTime: string;\n  closeTime: string;\n  isActive: boolean;\n  color: string;\n  openUTC: number;\n  closeUTC: number;\n}\n\nconst SESSION_DEFINITIONS = [\n  {\n    name: 'Sydney',\n    city: 'Sydney',\n    timezone: 'AEDT (UTC+11)',\n    openUTC: 22,\n    closeUTC: 7,\n    color: 'hsl(280 85% 70%)',\n  },\n  {\n    name: 'Tokyo',\n    city: 'Tokyo',\n    timezone: 'JST (UTC+9)',\n    openUTC: 0,\n    closeUTC: 9,\n    color: 'hsl(45 90% 60%)',\n  },\n  {\n    name: 'London',\n    city: 'London',\n    timezone: 'BST (UTC+1)',\n    openUTC: 7,\n    closeUTC: 15.5,\n    color: 'hsl(120 60% 50%)',\n  },\n  {\n    name: 'New York',\n    city: 'New York',\n    timezone: 'EDT (UTC-4)',\n    openUTC: 12,\n    closeUTC: 21,\n    color: 'hsl(210 100% 60%)',\n  },\n];\n\nfunction formatUTCTime(hours: number): string {\n  const h = Math.floor(hours);\n  const m = Math.round((hours - h) * 60);\n  return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}`;\n}\n\nfunction isSessionActive(openUTC: number, closeUTC: number, currentUTC: number): boolean {\n  if (openUTC < closeUTC) {\n    return currentUTC >= openUTC && currentUTC < closeUTC;\n  } else {\n    return currentUTC >= openUTC || currentUTC < closeUTC;\n  }\n}\n\nexport function getActiveSessions(): TradingSession[] {\n  const now = new Date();\n  const currentUTC = now.getUTCHours() + now.getUTCMinutes() / 60;\n  const dayOfWeek = now.getUTCDay();\n  \n  const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;\n  \n  return SESSION_DEFINITIONS.map(session => {\n    const isActive = !isWeekend && isSessionActive(session.openUTC, session.closeUTC, currentUTC);\n    \n    return {\n      ...session,\n      openTime: formatUTCTime(session.openUTC),\n      closeTime: formatUTCTime(session.closeUTC),\n      isActive,\n    };\n  });\n}\n\nexport function getActiveSessionNames(): string[] {\n  return getActiveSessions()\n    .filter(s => s.isActive)\n    .map(s => s.name);\n}\n\nexport function getSessionStartTime(session: TradingSession): Date {\n  const now = new Date();\n  const sessionStart = new Date(now);\n  \n  const hours = Math.floor(session.openUTC);\n  const minutes = Math.round((session.openUTC - hours) * 60);\n  \n  sessionStart.setUTCHours(hours, minutes, 0, 0);\n  \n  if (session.openUTC > session.closeUTC && now.getUTCHours() < session.closeUTC) {\n    sessionStart.setUTCDate(sessionStart.getUTCDate() - 1);\n  }\n  \n  return sessionStart;\n}\n\nexport function getSessionTimeRemaining(session: TradingSession): number {\n  if (!session.isActive) return 0;\n  \n  const now = new Date();\n  const currentUTC = now.getUTCHours() + now.getUTCMinutes() / 60;\n  \n  let timeRemaining: number;\n  \n  if (session.openUTC < session.closeUTC) {\n    timeRemaining = session.closeUTC - currentUTC;\n  } else {\n    if (currentUTC >= session.openUTC) {\n      timeRemaining = 24 - currentUTC + session.closeUTC;\n    } else {\n      timeRemaining = session.closeUTC - currentUTC;\n    }\n  }\n  \n  return Math.max(0, Math.floor(timeRemaining * 60));\n}\n\nexport function getSessionElapsedMinutes(session: TradingSession): number {\n  if (!session.isActive) return 0;\n  \n  const sessionStart = getSessionStartTime(session);\n  const now = new Date();\n  \n  return Math.floor((now.getTime() - sessionStart.getTime()) / (1000 * 60));\n}\n\nexport function formatMinutesToHoursAndMinutes(totalMinutes: number): string {\n  const hours = Math.floor(totalMinutes / 60);\n  const minutes = totalMinutes % 60;\n  \n  if (hours === 0) {\n    return `${minutes}m`;\n  } else if (minutes === 0) {\n    return `${hours}h`;\n  } else {\n    return `${hours}h ${minutes}m`;\n  }\n}\n\nexport function getMinutesUntilSessionOpen(session: TradingSession): number {\n  if (session.isActive) return 0;\n  \n  const now = new Date();\n  const dayOfWeek = now.getUTCDay();\n  const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;\n  \n  if (isWeekend) {\n    // Calculate time until Monday 00:00 UTC, then add time to session open\n    const daysUntilMonday = dayOfWeek === 0 ? 1 : 2;\n    const hoursUntilMonday = (24 - now.getUTCHours() - 1) + (daysUntilMonday - 1) * 24;\n    const minutesUntilMonday = (60 - now.getUTCMinutes()) + hoursUntilMonday * 60;\n    \n    // Add time from Monday 00:00 to session open\n    const sessionOpenMinutes = Math.floor(session.openUTC * 60);\n    return minutesUntilMonday + sessionOpenMinutes;\n  }\n  \n  const currentUTC = now.getUTCHours() + now.getUTCMinutes() / 60;\n  let hoursUntilOpen: number;\n  \n  if (session.openUTC > currentUTC) {\n    // Session opens later today\n    hoursUntilOpen = session.openUTC - currentUTC;\n  } else {\n    // Session opens tomorrow\n    hoursUntilOpen = 24 - currentUTC + session.openUTC;\n  }\n  \n  return Math.floor(hoursUntilOpen * 60);\n}\n","path":null,"size_bytes":4731,"size_tokens":null},"server/services/fmp.ts":{"content":"import type { EconomicEvent } from '@shared/schema';\nimport { format, addDays } from 'date-fns';\n\nconst FMP_API_KEY = process.env.FMP_API_KEY;\nconst BASE_URL = 'https://financialmodelingprep.com/api/v3';\n\nfunction hashString(str: string): string {\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash;\n  }\n  return Math.abs(hash).toString(36);\n}\n\nconst countryToRegion: Record<string, string> = {\n  'US': 'Americas',\n  'CA': 'Americas',\n  'BR': 'Americas',\n  'MX': 'Americas',\n  'GB': 'Europe',\n  'DE': 'Europe',\n  'FR': 'Europe',\n  'IT': 'Europe',\n  'ES': 'Europe',\n  'CH': 'Europe',\n  'SE': 'Europe',\n  'NO': 'Europe',\n  'DK': 'Europe',\n  'PL': 'Europe',\n  'NL': 'Europe',\n  'BE': 'Europe',\n  'AT': 'Europe',\n  'FI': 'Europe',\n  'IE': 'Europe',\n  'PT': 'Europe',\n  'GR': 'Europe',\n  'CZ': 'Europe',\n  'HU': 'Europe',\n  'RO': 'Europe',\n  'JP': 'Asia',\n  'CN': 'Asia',\n  'AU': 'Asia',\n  'NZ': 'Asia',\n  'SG': 'Asia',\n  'HK': 'Asia',\n  'KR': 'Asia',\n  'IN': 'Asia',\n  'TH': 'Asia',\n  'MY': 'Asia',\n  'ID': 'Asia',\n  'PH': 'Asia',\n  'VN': 'Asia',\n  'TW': 'Asia',\n};\n\nconst countryToCurrency: Record<string, string> = {\n  'US': 'USD',\n  'GB': 'GBP',\n  'EU': 'EUR',\n  'DE': 'EUR',\n  'FR': 'EUR',\n  'IT': 'EUR',\n  'ES': 'EUR',\n  'JP': 'JPY',\n  'CN': 'CNY',\n  'AU': 'AUD',\n  'CA': 'CAD',\n  'CH': 'CHF',\n  'NZ': 'NZD',\n  'SE': 'SEK',\n  'NO': 'NOK',\n  'DK': 'DKK',\n  'PL': 'PLN',\n  'NL': 'EUR',\n  'BE': 'EUR',\n  'AT': 'EUR',\n  'FI': 'EUR',\n  'IE': 'EUR',\n  'PT': 'EUR',\n  'GR': 'EUR',\n  'SG': 'SGD',\n  'HK': 'HKD',\n  'KR': 'KRW',\n  'IN': 'INR',\n  'BR': 'BRL',\n  'MX': 'MXN',\n};\n\nfunction determineMarketImpact(event: any): string {\n  if (!event.estimate || event.actual === null) {\n    return 'Impact pending - awaiting actual data release';\n  }\n\n  const actual = parseFloat(event.actual);\n  const estimate = parseFloat(event.estimate);\n  const previous = event.previous ? parseFloat(event.previous) : null;\n\n  if (isNaN(actual) || isNaN(estimate)) {\n    return 'Market impact analysis unavailable';\n  }\n\n  const surprise = ((actual - estimate) / Math.abs(estimate)) * 100;\n  const currency = event.currency || 'currency';\n\n  if (Math.abs(surprise) < 1) {\n    return `Minimal market impact - ${currency} actual value aligned with expectations`;\n  }\n\n  if (actual > estimate) {\n    if (event.event.toLowerCase().includes('unemployment') || \n        event.event.toLowerCase().includes('inflation') ||\n        event.event.toLowerCase().includes('cpi')) {\n      return `Bearish for ${currency} - worse than expected (+${surprise.toFixed(1)}% surprise), potential pressure on currency`;\n    }\n    return `Bullish for ${currency} - beat expectations (+${surprise.toFixed(1)}% surprise), positive market sentiment`;\n  } else {\n    if (event.event.toLowerCase().includes('unemployment') || \n        event.event.toLowerCase().includes('inflation') ||\n        event.event.toLowerCase().includes('cpi')) {\n      return `Bullish for ${currency} - better than expected (${surprise.toFixed(1)}% surprise), supportive for currency`;\n    }\n    return `Bearish for ${currency} - missed expectations (${surprise.toFixed(1)}% surprise), negative pressure`;\n  }\n}\n\nexport async function getEconomicCalendar(\n  fromDate?: Date,\n  toDate?: Date\n): Promise<EconomicEvent[]> {\n  if (!FMP_API_KEY) {\n    console.error('FMP_API_KEY not configured');\n    return [];\n  }\n\n  const from = fromDate || new Date();\n  const to = toDate || addDays(new Date(), 7);\n\n  const fromStr = format(from, 'yyyy-MM-dd');\n  const toStr = format(to, 'yyyy-MM-dd');\n\n  try {\n    const url = `${BASE_URL}/economic_calendar?from=${fromStr}&to=${toStr}&apikey=${FMP_API_KEY}`;\n    \n    const response = await fetch(url);\n    \n    if (!response.ok) {\n      console.error(`FMP API error: ${response.status} ${response.statusText}`);\n      return [];\n    }\n\n    const data = await response.json();\n\n    if (!Array.isArray(data)) {\n      console.error('FMP API returned invalid data format');\n      return [];\n    }\n\n    const events: EconomicEvent[] = data\n      .filter(item => {\n        const impact = item.impact?.toLowerCase() || 'low';\n        return impact === 'high' || impact === 'medium';\n      })\n      .map(item => {\n        const eventTime = new Date(item.date);\n        const country = item.country || 'US';\n        const currency = item.currency || countryToCurrency[country] || 'USD';\n        \n        const id = hashString(`${item.date}-${item.event}-${country}`);\n\n        const marketImpact = determineMarketImpact(item);\n\n        return {\n          id,\n          title: item.event || 'Economic Event',\n          description: null,\n          eventType: item.event || 'Economic Data Release',\n          country,\n          region: countryToRegion[country] || 'Other',\n          eventTime,\n          currency,\n          impactLevel: item.impact || 'Medium',\n          previousValue: item.previous?.toString() || null,\n          expectedValue: item.estimate?.toString() || null,\n          actualValue: item.actual?.toString() || null,\n          unit: null,\n          futuresImpliedExpectation: null,\n          surpriseFactor: item.change ? item.change.toString() : null,\n          marketImpactAnalysis: marketImpact,\n          affectedCurrencies: [currency],\n          affectedStocks: [],\n          isReleased: item.actual !== null,\n          createdAt: null,\n        };\n      })\n      .sort((a, b) => new Date(a.eventTime).getTime() - new Date(b.eventTime).getTime());\n\n    return events;\n  } catch (error) {\n    console.error('Error fetching FMP economic calendar:', error);\n    return [];\n  }\n}\n","path":null,"size_bytes":5654,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","path":null,"size_bytes":1280,"size_tokens":null},"server/services/telegramNotification.ts":{"content":"import TelegramBot from 'node-telegram-bot-api';\nimport { db } from '../db';\nimport { telegramSubscribers, economicEvents } from '@shared/schema';\nimport { eq, and, lte, gte } from 'drizzle-orm';\nimport { format } from 'date-fns';\n\ninterface TradingSession {\n  name: string;\n  openUTC: number;\n  closeUTC: number;\n}\n\nconst HIGH_VOLUME_SESSIONS: TradingSession[] = [\n  { name: 'London', openUTC: 8, closeUTC: 16.5 },\n  { name: 'New York', openUTC: 13, closeUTC: 22 }\n];\n\nexport class TelegramNotificationService {\n  private bot: TelegramBot | null = null;\n  private isInitialized = false;\n  private notifiedSessions = new Set<string>();\n  private notifiedEvents = new Set<string>();\n  private pollingRetryCount = 0;\n  private maxPollingRetries = 5;\n\n  static async create(): Promise<TelegramNotificationService> {\n    const service = new TelegramNotificationService();\n    await service.initialize();\n    return service;\n  }\n\n  private constructor() {}\n\n  private async initialize(): Promise<void> {\n    try {\n      console.log('[Telegram] Initializing bot...');\n\n      let token = process.env.TELEGRAM_BOT_TOKEN_CLEAN || process.env.TELEGRAM_BOT_TOKEN;\n      \n      if (!token) {\n        console.log('[Telegram] TELEGRAM_BOT_TOKEN not found - bot disabled');\n        return;\n      }\n\n      token = token.trim().replace(/[\\r\\n\\t\\s]/g, '');\n\n      const tokenPattern = /^\\d+:[A-Za-z0-9_-]+$/;\n      if (!tokenPattern.test(token)) {\n        console.error('[Telegram] Invalid token format');\n        return;\n      }\n\n      const testBot = new TelegramBot(token, { polling: false });\n      \n      try {\n        const botInfo = await testBot.getMe();\n        console.log(`[Telegram] Bot verified: @${botInfo.username}`);\n      } catch (verifyError: any) {\n        console.error('[Telegram] Failed to verify bot:', verifyError.message);\n        return;\n      }\n\n      try {\n        console.log('[Telegram] Clearing any pending updates and releasing previous connections...');\n        \n        await (testBot as any).deleteWebHook({ drop_pending_updates: true });\n        \n        try {\n          const updates = await testBot.getUpdates({ offset: -1, limit: 1, timeout: 0 });\n          if (updates && updates.length > 0) {\n            const lastUpdateId = updates[updates.length - 1].update_id;\n            await testBot.getUpdates({ offset: lastUpdateId + 1, limit: 1, timeout: 0 });\n          }\n        } catch (updateError: any) {\n          console.log('[Telegram] Could not clear update queue:', updateError.message);\n        }\n        \n        await new Promise(resolve => setTimeout(resolve, 3000));\n      } catch (clearError: any) {\n        console.log('[Telegram] Could not clear pending updates:', clearError.message);\n      }\n\n      this.bot = new TelegramBot(token, { \n        polling: {\n          interval: 5000,\n          autoStart: false,\n          params: { \n            timeout: 30,\n            allowed_updates: ['message', 'callback_query']\n          }\n        }\n      });\n      \n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      this.bot.startPolling();\n\n      this.bot.on('polling_error', async (error: any) => {\n        if (error.code === 'ETELEGRAM' && error.response?.statusCode === 409) {\n          this.pollingRetryCount++;\n          \n          if (this.pollingRetryCount <= this.maxPollingRetries) {\n            console.log(`[Telegram] Polling conflict detected (attempt ${this.pollingRetryCount}/${this.maxPollingRetries}) - waiting before retry...`);\n            \n            if (this.bot) {\n              this.bot.stopPolling();\n            }\n            \n            const waitTime = Math.min(5000 * this.pollingRetryCount, 30000);\n            await new Promise(resolve => setTimeout(resolve, waitTime));\n            \n            try {\n              const freshBot = new TelegramBot(token!, { polling: false });\n              await (freshBot as any).deleteWebHook({ drop_pending_updates: true });\n            } catch (e) {\n            }\n            \n            if (this.bot) {\n              this.bot.startPolling();\n            }\n          } else {\n            console.log('[Telegram] Max polling retries reached - bot will operate in send-only mode');\n            this.bot?.stopPolling();\n          }\n        } else if (error.code === 'EFATAL') {\n          console.error('[Telegram] Fatal polling error - stopping polling');\n          this.bot?.stopPolling();\n        } else {\n          console.error('[Telegram] Polling error:', error.message || error.code);\n        }\n      });\n\n      this.bot.on('message', () => {\n        this.pollingRetryCount = 0;\n      });\n\n      this.isInitialized = true;\n      this.setupCommands();\n      console.log('[Telegram] Bot ready with polling enabled');\n\n    } catch (error: any) {\n      console.error('[Telegram] Init error:', error.message || error);\n    }\n  }\n\n  private setupCommands(): void {\n    if (!this.bot) return;\n\n    this.bot.onText(/\\/start/, async (msg) => {\n      const chatId = msg.chat.id;\n      const chatIdStr = chatId.toString();\n      const user = msg.from;\n\n      console.log(`[Telegram] /start from ${user?.username || chatId}`);\n\n      try {\n        const existing = await db\n          .select()\n          .from(telegramSubscribers)\n          .where(eq(telegramSubscribers.chatId, chatIdStr))\n          .limit(1);\n\n        if (existing.length === 0) {\n          await db.insert(telegramSubscribers).values({\n            chatId: chatIdStr,\n            username: user?.username || null,\n            firstName: user?.first_name || null,\n            lastName: user?.last_name || null,\n            phoneNumber: null,\n            isActive: true,\n            createdAt: new Date()\n          });\n\n          await this.bot!.sendMessage(chatId, \n            `Welcome to FSDZones Trading Alerts!\\n\\nYou are now subscribed to receive:\\n- Trading signal alerts\\n- High-impact economic news\\n- Session opening notifications\\n\\nCommands:\\n/stop - Pause notifications\\n/resume - Resume notifications\\n/status - Check subscription status`\n          );\n          console.log(`[Telegram] New subscriber: ${user?.username || chatId}`);\n\n        } else if (!existing[0].isActive) {\n          await db\n            .update(telegramSubscribers)\n            .set({ isActive: true })\n            .where(eq(telegramSubscribers.chatId, chatIdStr));\n\n          await this.bot!.sendMessage(chatId, `Welcome back! Your notifications have been resumed.`);\n          console.log(`[Telegram] Reactivated subscriber: ${user?.username || chatId}`);\n\n        } else {\n          await this.bot!.sendMessage(chatId, `You are already subscribed!\\n\\nCommands:\\n/stop - Pause notifications\\n/status - Check status`);\n        }\n\n      } catch (error: any) {\n        console.error('[Telegram] /start error:', error.message);\n        try {\n          await this.bot!.sendMessage(chatId, `Welcome to FSDZones! There was a minor issue, but your subscription is being processed. Please try /status in a moment.`);\n        } catch (sendError) {\n          console.error('[Telegram] Failed to send fallback message:', sendError);\n        }\n      }\n    });\n\n    this.bot.onText(/\\/stop/, async (msg) => {\n      const chatId = msg.chat.id;\n      const chatIdStr = chatId.toString();\n\n      try {\n        await db\n          .update(telegramSubscribers)\n          .set({ isActive: false })\n          .where(eq(telegramSubscribers.chatId, chatIdStr));\n\n        await this.bot?.sendMessage(chatId, `Notifications paused. Send /resume to restart.`);\n        console.log(`[Telegram] Subscriber paused: ${chatId}`);\n      } catch (error: any) {\n        console.error('[Telegram] /stop error:', error.message);\n        await this.bot?.sendMessage(chatId, `Your notifications have been paused.`);\n      }\n    });\n\n    this.bot.onText(/\\/resume/, async (msg) => {\n      const chatId = msg.chat.id;\n      const chatIdStr = chatId.toString();\n\n      try {\n        await db\n          .update(telegramSubscribers)\n          .set({ isActive: true })\n          .where(eq(telegramSubscribers.chatId, chatIdStr));\n\n        await this.bot?.sendMessage(chatId, `Notifications resumed! You will now receive alerts.`);\n        console.log(`[Telegram] Subscriber resumed: ${chatId}`);\n      } catch (error: any) {\n        console.error('[Telegram] /resume error:', error.message);\n        await this.bot?.sendMessage(chatId, `Your notifications have been resumed.`);\n      }\n    });\n\n    this.bot.onText(/\\/status/, async (msg) => {\n      const chatId = msg.chat.id;\n      const chatIdStr = chatId.toString();\n\n      try {\n        const subscriber = await db\n          .select()\n          .from(telegramSubscribers)\n          .where(eq(telegramSubscribers.chatId, chatIdStr))\n          .limit(1);\n\n        if (subscriber.length === 0) {\n          await this.bot?.sendMessage(chatId, `You are not subscribed. Send /start to subscribe.`);\n        } else {\n          const status = subscriber[0].isActive ? 'Active' : 'Paused';\n          const since = subscriber[0].createdAt\n            ? format(new Date(subscriber[0].createdAt), 'MMM dd, yyyy')\n            : 'Unknown';\n\n          await this.bot?.sendMessage(chatId, \n            `Subscription Status: ${status}\\nSubscribed since: ${since}\\n\\nCommands:\\n${subscriber[0].isActive ? '/stop - Pause' : '/resume - Resume'}`\n          );\n        }\n      } catch (error: any) {\n        console.error('[Telegram] /status error:', error.message);\n        await this.bot?.sendMessage(chatId, `Your subscription is active. Use /stop to pause notifications.`);\n      }\n    });\n  }\n\n  async sendMessage(chatId: string | number, message: string, options?: any): Promise<boolean> {\n    if (!this.bot) {\n      return false;\n    }\n\n    try {\n      await this.bot.sendMessage(chatId, message, options);\n      return true;\n    } catch (error: any) {\n      console.error(`[Telegram] Failed to send to ${chatId}:`, error.message);\n      return false;\n    }\n  }\n\n  async sendPhoto(chatId: string | number, photo: Buffer | string, options?: any): Promise<boolean> {\n    if (!this.bot) {\n      return false;\n    }\n\n    try {\n      await this.bot.sendPhoto(chatId, photo, options);\n      return true;\n    } catch (error: any) {\n      console.error(`[Telegram] Failed to send photo to ${chatId}:`, error.message);\n      return false;\n    }\n  }\n\n  async broadcastMessage(message: string, options?: any): Promise<{ sent: number; failed: number }> {\n    if (!this.bot) {\n      return { sent: 0, failed: 0 };\n    }\n\n    try {\n      const subscribers = await db\n        .select()\n        .from(telegramSubscribers)\n        .where(eq(telegramSubscribers.isActive, true));\n\n      let sent = 0;\n      let failed = 0;\n\n      for (const subscriber of subscribers) {\n        try {\n          await this.bot.sendMessage(subscriber.chatId, message, options);\n          sent++;\n        } catch (error) {\n          failed++;\n        }\n      }\n\n      if (sent > 0) {\n        console.log(`[Telegram] Broadcast sent to ${sent} subscribers`);\n      }\n\n      return { sent, failed };\n    } catch (error: any) {\n      console.error('[Telegram] Broadcast error:', error.message);\n      return { sent: 0, failed: 0 };\n    }\n  }\n\n  async sendTradingSignalNotification(signal: {\n    symbol: string;\n    type: 'buy' | 'sell';\n    entry: number;\n    stopLoss: number;\n    takeProfit: number;\n    confidence: number;\n    strategy?: string;\n  }): Promise<{ sent: number; failed: number }> {\n    if (!this.bot) {\n      return { sent: 0, failed: 0 };\n    }\n\n    const typeIcon = signal.type === 'buy' ? '' : '';\n    const riskReward = Math.abs((signal.takeProfit - signal.entry) / (signal.entry - signal.stopLoss)).toFixed(2);\n\n    const message = `${typeIcon} *${signal.symbol}* - ${signal.type.toUpperCase()}\n\nEntry: ${signal.entry}\nStop Loss: ${signal.stopLoss}\nTake Profit: ${signal.takeProfit}\nRisk/Reward: 1:${riskReward}\nConfidence: ${signal.confidence}%\n${signal.strategy ? `Strategy: ${signal.strategy}` : ''}`;\n\n    return this.broadcastMessage(message, { parse_mode: 'Markdown' });\n  }\n\n  getBot(): TelegramBot | null {\n    return this.bot;\n  }\n\n  isReady(): boolean {\n    return this.isInitialized;\n  }\n\n  async addSubscriber(chatId: string, username?: string, firstName?: string, lastName?: string): Promise<boolean> {\n    try {\n      const existing = await db\n        .select()\n        .from(telegramSubscribers)\n        .where(eq(telegramSubscribers.chatId, chatId))\n        .limit(1);\n\n      if (existing.length === 0) {\n        await db.insert(telegramSubscribers).values({\n          chatId,\n          username: username || null,\n          firstName: firstName || null,\n          lastName: lastName || null,\n          phoneNumber: null,\n          isActive: true,\n          createdAt: new Date()\n        });\n      } else if (!existing[0].isActive) {\n        await db\n          .update(telegramSubscribers)\n          .set({ isActive: true })\n          .where(eq(telegramSubscribers.chatId, chatId));\n      }\n      return true;\n    } catch (error: any) {\n      console.error('[Telegram] Add subscriber error:', error.message);\n      return false;\n    }\n  }\n\n  async removeSubscriber(chatId: string): Promise<boolean> {\n    try {\n      await db\n        .update(telegramSubscribers)\n        .set({ isActive: false })\n        .where(eq(telegramSubscribers.chatId, chatId));\n      return true;\n    } catch (error: any) {\n      console.error('[Telegram] Remove subscriber error:', error.message);\n      return false;\n    }\n  }\n\n  async checkAndNotifyUpcomingEvents(): Promise<void> {\n    if (!this.bot || !this.isInitialized) return;\n\n    try {\n      const now = new Date();\n      const fifteenMinutesFromNow = new Date(now.getTime() + 15 * 60 * 1000);\n\n      const upcomingEvents = await db\n        .select()\n        .from(economicEvents)\n        .where(\n          and(\n            gte(economicEvents.eventTime, now),\n            lte(economicEvents.eventTime, fifteenMinutesFromNow),\n            eq(economicEvents.impactLevel, 'high')\n          )\n        );\n\n      for (const event of upcomingEvents) {\n        const eventKey = `${event.id}-${event.eventTime}`;\n        if (this.notifiedEvents.has(eventKey)) continue;\n\n        const message = ` *HIGH IMPACT EVENT ALERT*\n\n${event.currency} - ${event.title}\nTime: ${format(new Date(event.eventTime), 'HH:mm')} UTC\nImpact: ${event.impactLevel?.toUpperCase()}\n${event.expectedValue ? `Forecast: ${event.expectedValue}` : ''}\n${event.previousValue ? `Previous: ${event.previousValue}` : ''}`;\n\n        const result = await this.broadcastMessage(message, { parse_mode: 'Markdown' });\n        if (result.sent > 0) {\n          this.notifiedEvents.add(eventKey);\n          console.log(`[Telegram] Notified ${result.sent} subscribers about ${event.title}`);\n        }\n      }\n    } catch (error: any) {\n      console.error('[Telegram] Error checking upcoming events:', error.message);\n    }\n  }\n\n  async checkAndNotifyTradingSessions(): Promise<void> {\n    if (!this.bot || !this.isInitialized) return;\n\n    try {\n      const now = new Date();\n      const currentHour = now.getUTCHours() + now.getUTCMinutes() / 60;\n      const today = format(now, 'yyyy-MM-dd');\n\n      for (const session of HIGH_VOLUME_SESSIONS) {\n        const sessionKey = `${session.name}-${today}`;\n        \n        if (this.notifiedSessions.has(sessionKey)) continue;\n\n        const minutesToOpen = (session.openUTC - currentHour) * 60;\n        \n        if (minutesToOpen > 0 && minutesToOpen <= 15) {\n          const message = ` *${session.name} Session Opening Soon*\n\nThe ${session.name} trading session opens in ~${Math.round(minutesToOpen)} minutes.\n\nSession Hours: ${session.openUTC}:00 - ${session.closeUTC}:00 UTC\nExpect increased volatility and volume.`;\n\n          const result = await this.broadcastMessage(message, { parse_mode: 'Markdown' });\n          if (result.sent > 0) {\n            this.notifiedSessions.add(sessionKey);\n            console.log(`[Telegram] Notified ${result.sent} subscribers about ${session.name} session`);\n          }\n        }\n      }\n\n      if (now.getUTCHours() === 0 && now.getUTCMinutes() < 5) {\n        this.notifiedSessions.clear();\n        this.notifiedEvents.clear();\n      }\n    } catch (error: any) {\n      console.error('[Telegram] Error checking trading sessions:', error.message);\n    }\n  }\n\n  stopPolling(): void {\n    if (this.bot) {\n      this.bot.stopPolling();\n      console.log('[Telegram] Polling stopped');\n    }\n  }\n}\n\nlet telegramNotificationService: TelegramNotificationService | null = null;\n\n(async () => {\n  try {\n    telegramNotificationService = await TelegramNotificationService.create();\n    if (telegramNotificationService?.isReady()) {\n      console.log('[Telegram] Service ready - users can subscribe via /start');\n    }\n  } catch (error) {\n    console.error('[Telegram] Failed to initialize:', error);\n  }\n})();\n\nexport { telegramNotificationService };\n","path":null,"size_bytes":16895,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2154,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10481,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/components/examples/TradeHistory.tsx":{"content":"import TradeHistory from '../TradeHistory';\n\nexport default function TradeHistoryExample() {\n  return <TradeHistory />;\n}","path":null,"size_bytes":121,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1592,"size_tokens":null},"server/scrapers/economicCalendarScraper.ts":{"content":"import axios from 'axios';\nimport * as cheerio from 'cheerio';\nimport { ScraperConfig, scraperSettings, getRandomUserAgent, getActiveScrapers } from './config';\n\nexport interface ScrapedEvent {\n  title: string;\n  country: string;\n  countryCode?: string;\n  eventTime: Date;\n  impactLevel: string;\n  expectedValue?: string;\n  previousValue?: string;\n  actualValue?: string;\n  currency?: string;\n  sourceSite: string;\n  sourceUrl: string;\n}\n\nexport class EconomicCalendarScraper {\n  private lastRequestTime = 0;\n\n  private async delay(ms: number): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n\n  private async respectRateLimit(): Promise<void> {\n    const now = Date.now();\n    const timeSinceLastRequest = now - this.lastRequestTime;\n    \n    if (timeSinceLastRequest < scraperSettings.requestDelay) {\n      await this.delay(scraperSettings.requestDelay - timeSinceLastRequest);\n    }\n    \n    this.lastRequestTime = Date.now();\n  }\n\n  private async fetchHTML(url: string): Promise<string> {\n    await this.respectRateLimit();\n\n    try {\n      const response = await axios.get(url, {\n        headers: {\n          'User-Agent': getRandomUserAgent(),\n          'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',\n          'Accept-Language': 'en-US,en;q=0.9',\n          'Accept-Encoding': 'gzip, deflate, br',\n          'Connection': 'keep-alive',\n          'Upgrade-Insecure-Requests': '1',\n        },\n        timeout: scraperSettings.timeout,\n      });\n\n      return response.data;\n    } catch (error) {\n      console.error(`Failed to fetch ${url}:`, error);\n      throw error;\n    }\n  }\n\n  private parseInvestingCom(html: string, config: ScraperConfig): ScrapedEvent[] {\n    const $ = cheerio.load(html);\n    const events: ScrapedEvent[] = [];\n    const today = new Date();\n\n    $(config.selectors.eventRow!).each((_, element) => {\n      try {\n        const $row = $(element);\n        \n        const title = $row.find(config.selectors.eventName!).text().trim();\n        if (!title) return;\n\n        const countryText = $row.find(config.selectors.country!).attr('title') || '';\n        const timeText = $row.find(config.selectors.time!).text().trim();\n        const impactClass = $row.find(config.selectors.impact!).find('i').attr('class') || '';\n        const actual = $row.find(config.selectors.actual!).text().trim();\n        const forecast = $row.find(config.selectors.forecast!).text().trim();\n        const previous = $row.find(config.selectors.previous!).text().trim();\n\n        let impactLevel = 'Low';\n        if (impactClass.includes('bull3')) impactLevel = 'High';\n        else if (impactClass.includes('bull2')) impactLevel = 'Medium';\n\n        const eventTime = this.parseTimeString(timeText, today);\n        const countryCode = config.dataMapping?.countryCodes?.[countryText];\n\n        events.push({\n          title,\n          country: countryText,\n          countryCode: countryCode || this.extractCurrencyFromCountry(countryText),\n          eventTime,\n          impactLevel,\n          expectedValue: forecast || undefined,\n          previousValue: previous || undefined,\n          actualValue: actual || undefined,\n          currency: countryCode,\n          sourceSite: config.name,\n          sourceUrl: config.url,\n        });\n      } catch (error) {\n        console.error('Error parsing event row:', error);\n      }\n    });\n\n    return events;\n  }\n\n  private parseForexFactory(html: string, config: ScraperConfig): ScrapedEvent[] {\n    const $ = cheerio.load(html);\n    const events: ScrapedEvent[] = [];\n    const today = new Date();\n\n    $(config.selectors.eventRow!).each((_, element) => {\n      try {\n        const $row = $(element);\n        \n        const title = $row.find(config.selectors.eventName!).text().trim();\n        if (!title) return;\n\n        const currency = $row.find(config.selectors.country!).text().trim();\n        const timeText = $row.find(config.selectors.time!).text().trim();\n        const impactClass = $row.find(config.selectors.impact!).attr('class') || '';\n        const actual = $row.find(config.selectors.actual!).text().trim();\n        const forecast = $row.find(config.selectors.forecast!).text().trim();\n        const previous = $row.find(config.selectors.previous!).text().trim();\n\n        let impactLevel = 'Low';\n        if (impactClass.includes('red')) impactLevel = 'High';\n        else if (impactClass.includes('ora')) impactLevel = 'Medium';\n\n        const eventTime = this.parseTimeString(timeText, today);\n\n        events.push({\n          title,\n          country: this.getCurrencyCountry(currency),\n          countryCode: currency,\n          eventTime,\n          impactLevel,\n          expectedValue: forecast || undefined,\n          previousValue: previous || undefined,\n          actualValue: actual || undefined,\n          currency,\n          sourceSite: config.name,\n          sourceUrl: config.url,\n        });\n      } catch (error) {\n        console.error('Error parsing event row:', error);\n      }\n    });\n\n    return events;\n  }\n\n  private parseMyFxBook(html: string, config: ScraperConfig): ScrapedEvent[] {\n    const $ = cheerio.load(html);\n    const events: ScrapedEvent[] = [];\n    const currentYear = new Date().getFullYear();\n\n    $('tr.economicCalendarRow').each((_, element) => {\n      try {\n        const $row = $(element);\n        const cells = $row.find('td.calendarToggleCell');\n        \n        if (cells.length < 9) return;\n\n        const dateTimeText = $(cells[0]).text().trim();\n        const timeLeftText = $(cells[1]).text().trim();\n        const currency = $(cells[3]).text().trim();\n        const title = $(cells[4]).text().trim().replace(/\\s+/g, ' ');\n        const impactText = $(cells[5]).text().trim();\n        const previous = $(cells[6]).text().trim();\n        const consensus = $(cells[7]).text().trim();\n        const actual = $(cells[8]).text().trim();\n\n        if (!title || !currency) return;\n\n        const eventTime = this.parseMyFxBookDateTime(dateTimeText, timeLeftText, currentYear);\n\n        let impactLevel = 'Low';\n        if (impactText === 'High') impactLevel = 'High';\n        else if (impactText === 'Medium') impactLevel = 'Medium';\n        else if (impactText === 'None') impactLevel = 'None';\n\n        events.push({\n          title,\n          country: this.getCurrencyCountry(currency),\n          countryCode: currency,\n          eventTime,\n          impactLevel,\n          expectedValue: consensus || undefined,\n          previousValue: previous || undefined,\n          actualValue: actual || undefined,\n          currency,\n          sourceSite: config.name,\n          sourceUrl: config.url,\n        });\n      } catch (error) {\n        console.error('Error parsing MyFXBook event row:', error);\n      }\n    });\n\n    console.log(`[MyFXBook] Parsed ${events.length} events`);\n    return events;\n  }\n\n  private parseMyFxBookDateTime(dateTimeStr: string, timeLeftStr: string, currentYear: number): Date {\n    try {\n      const parts = dateTimeStr.split(',');\n      \n      let monthDay: string;\n      let timeStr: string;\n\n      if (parts.length >= 2) {\n        monthDay = parts[0].trim();\n        timeStr = parts[1].trim();\n      } else {\n        monthDay = dateTimeStr.trim();\n        const timeMatch = timeLeftStr.match(/(\\d{1,2}):(\\d{2})/);\n        if (timeMatch) {\n          timeStr = `${timeMatch[1]}:${timeMatch[2]}`;\n        } else {\n          const hoursMatch = timeLeftStr.match(/(\\d+)h\\s*(\\d+)?m?/);\n          if (hoursMatch) {\n            const hoursToAdd = parseInt(hoursMatch[1], 10) || 0;\n            const minutesToAdd = parseInt(hoursMatch[2], 10) || 0;\n            const futureTime = new Date(Date.now() + (hoursToAdd * 60 + minutesToAdd) * 60000);\n            return futureTime;\n          }\n          timeStr = '00:00';\n        }\n      }\n\n      const monthDayParts = monthDay.split(' ').filter(p => p);\n      const monthStr = monthDayParts[0] || 'Jan';\n      const dayStr = monthDayParts[1] || '1';\n      \n      const monthMap: Record<string, number> = {\n        'Jan': 0, 'Feb': 1, 'Mar': 2, 'Apr': 3, 'May': 4, 'Jun': 5,\n        'Jul': 6, 'Aug': 7, 'Sep': 8, 'Oct': 9, 'Nov': 10, 'Dec': 11\n      };\n\n      const month = monthMap[monthStr] ?? 0;\n      const day = parseInt(dayStr, 10) || 1;\n\n      const timeParts = timeStr.split(':');\n      const hours = parseInt(timeParts[0], 10) || 0;\n      const minutes = parseInt(timeParts[1], 10) || 0;\n\n      let eventDate = new Date(Date.UTC(currentYear, month, day, hours, minutes, 0, 0));\n\n      if (eventDate.getTime() < Date.now() - 86400000 * 7) {\n        eventDate = new Date(Date.UTC(currentYear + 1, month, day, hours, minutes, 0, 0));\n      }\n\n      return eventDate;\n    } catch (error) {\n      console.error('Error parsing MyFXBook date:', dateTimeStr, error);\n      return new Date();\n    }\n  }\n\n  private parseTimeString(timeStr: string, baseDate: Date): Date {\n    const time = new Date(baseDate);\n    \n    const timeMatch = timeStr.match(/(\\d{1,2}):(\\d{2})\\s*(AM|PM)?/i);\n    if (timeMatch) {\n      let hours = parseInt(timeMatch[1]);\n      const minutes = parseInt(timeMatch[2]);\n      const isPM = timeMatch[3]?.toUpperCase() === 'PM';\n      \n      if (isPM && hours < 12) hours += 12;\n      if (!isPM && hours === 12) hours = 0;\n      \n      time.setHours(hours, minutes, 0, 0);\n    }\n    \n    return time;\n  }\n\n  private extractCurrencyFromCountry(country: string): string {\n    const currencyMap: Record<string, string> = {\n      'United States': 'USD',\n      'Eurozone': 'EUR',\n      'Euro Zone': 'EUR',\n      'United Kingdom': 'GBP',\n      'Japan': 'JPY',\n      'Canada': 'CAD',\n      'Australia': 'AUD',\n      'New Zealand': 'NZD',\n      'Switzerland': 'CHF',\n      'China': 'CNY',\n    };\n    \n    return currencyMap[country] || 'USD';\n  }\n\n  private getCurrencyCountry(currency: string): string {\n    const countryMap: Record<string, string> = {\n      'USD': 'United States',\n      'EUR': 'Eurozone',\n      'GBP': 'United Kingdom',\n      'JPY': 'Japan',\n      'CAD': 'Canada',\n      'AUD': 'Australia',\n      'NZD': 'New Zealand',\n      'CHF': 'Switzerland',\n      'CNY': 'China',\n    };\n    \n    return countryMap[currency] || currency;\n  }\n\n  private parseEvents(html: string, config: ScraperConfig): ScrapedEvent[] {\n    switch (config.name) {\n      case 'MyFXBook':\n        return this.parseMyFxBook(html, config);\n      case 'Investing.com':\n        return this.parseInvestingCom(html, config);\n      case 'ForexFactory':\n        return this.parseForexFactory(html, config);\n      default:\n        console.warn(`No parser implemented for ${config.name}`);\n        return [];\n    }\n  }\n\n  async scrape(): Promise<ScrapedEvent[]> {\n    const scrapers = getActiveScrapers();\n    let allEvents: ScrapedEvent[] = [];\n    \n    for (const config of scrapers) {\n      try {\n        console.log(`Attempting to scrape from ${config.name}...`);\n        const html = await this.fetchHTML(config.url);\n        const events = this.parseEvents(html, config);\n        \n        console.log(`Successfully scraped ${events.length} events from ${config.name}`);\n        allEvents = allEvents.concat(events);\n        \n        if (events.length > 0) {\n          break;\n        }\n      } catch (error) {\n        console.error(`Failed to scrape ${config.name}:`, error);\n        \n        if (config.priority === scrapers[scrapers.length - 1].priority) {\n          console.error('All scrapers failed');\n        } else {\n          console.log('Falling back to next scraper...');\n        }\n      }\n    }\n\n    return this.deduplicateEvents(allEvents);\n  }\n\n  private deduplicateEvents(events: ScrapedEvent[]): ScrapedEvent[] {\n    const seen = new Set<string>();\n    const unique: ScrapedEvent[] = [];\n\n    for (const event of events) {\n      const key = `${event.title}-${event.eventTime.toISOString()}-${event.country}`;\n      if (!seen.has(key)) {\n        seen.add(key);\n        unique.push(event);\n      }\n    }\n\n    return unique;\n  }\n\n  async scrapeWithRetry(maxAttempts: number = scraperSettings.retryAttempts): Promise<ScrapedEvent[]> {\n    for (let attempt = 1; attempt <= maxAttempts; attempt++) {\n      try {\n        const events = await this.scrape();\n        if (events.length > 0) {\n          return events;\n        }\n      } catch (error) {\n        console.error(`Scrape attempt ${attempt} failed:`, error);\n        \n        if (attempt < maxAttempts) {\n          console.log(`Retrying in ${scraperSettings.retryDelay / 1000} seconds...`);\n          await this.delay(scraperSettings.retryDelay);\n        }\n      }\n    }\n\n    console.error('All scrape attempts failed');\n    return [];\n  }\n}\n\nexport const economicCalendarScraper = new EconomicCalendarScraper();\n","path":null,"size_bytes":12725,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1584,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"client/src/components/TradingSession.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Badge } from '@/components/ui/badge';\nimport { Clock, Timer, Calendar } from 'lucide-react';\nimport { getActiveSessions, getSessionElapsedMinutes, getSessionTimeRemaining, formatMinutesToHoursAndMinutes, getMinutesUntilSessionOpen } from '@/lib/tradingSessions';\nimport { Card } from '@/components/ui/card';\n\nexport default function TradingSession() {\n  const [currentTime, setCurrentTime] = useState(new Date());\n  const [sessions, setSessions] = useState(getActiveSessions());\n  \n  useEffect(() => {\n    const timer = setInterval(() => {\n      setCurrentTime(new Date());\n      setSessions(getActiveSessions());\n    }, 1000);\n    return () => clearInterval(timer);\n  }, []);\n\n  const activeSessions = sessions.filter(s => s.isActive);\n\n  return (\n    <Card data-testid=\"card-trading-session\" className=\"border-blue-500/50 rounded-none\" style={{ fontFamily: \"'Montserrat', sans-serif\" }}>\n      <div className=\"p-6\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-6\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"flex items-center justify-center w-10 h-10 rounded-md bg-blue-500/10\">\n              <Clock className=\"w-5 h-5 text-blue-500\" />\n            </div>\n            <div>\n              <h2 className=\"text-base font-extrabold text-foreground uppercase tracking-wide\">Trading Sessions</h2>\n              <p className=\"text-xs text-muted-foreground font-semibold tabular-nums\" data-testid=\"text-current-time\">\n                {currentTime.toLocaleTimeString('en-US', { timeZone: 'UTC', hour12: false })} UTC\n              </p>\n            </div>\n          </div>\n          \n          {activeSessions.length > 0 && (\n            <div className=\"flex gap-2 flex-wrap\">\n              {activeSessions.map(session => (\n                <Badge \n                  key={session.name}\n                  variant=\"default\" \n                  className=\"text-[10px] font-bold uppercase tracking-wider px-2 py-1\"\n                  style={{ backgroundColor: session.color }}\n                  data-testid={`badge-active-${session.name.toLowerCase()}`}\n                >\n                  {session.name}\n                </Badge>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Session Grid */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3\">\n          {sessions.map((session) => {\n            const elapsed = getSessionElapsedMinutes(session);\n            const remaining = getSessionTimeRemaining(session);\n            const total = elapsed + remaining;\n            const progress = total > 0 ? (elapsed / total) * 100 : 0;\n            const minutesUntilOpen = getMinutesUntilSessionOpen(session);\n            \n            return (\n              <div\n                key={session.name}\n                className={`relative overflow-hidden rounded-lg border-2 p-4 transition-all ${\n                  session.isActive \n                    ? 'bg-card border-border hover-elevate' \n                    : 'bg-muted/30 border-border/50 opacity-60'\n                }`}\n                style={session.isActive ? { borderLeftColor: session.color, borderLeftWidth: '4px' } : {}}\n                data-testid={`card-session-${session.name.toLowerCase()}`}\n              >\n                {/* Session Name and Status */}\n                <div className=\"mb-3\">\n                  <div className=\"flex items-center justify-between mb-1\">\n                    <h3 className=\"text-sm font-extrabold text-foreground uppercase tracking-tight\">\n                      {session.name}\n                    </h3>\n                    <Badge \n                      variant={session.isActive ? \"default\" : \"secondary\"}\n                      className=\"text-[9px] font-bold uppercase px-1.5 py-0.5\"\n                      style={session.isActive ? { backgroundColor: session.color } : {}}\n                    >\n                      {session.isActive ? 'LIVE' : 'CLOSED'}\n                    </Badge>\n                  </div>\n                  <p className=\"text-[10px] text-muted-foreground font-mono font-semibold\">\n                    {session.openTime} - {session.closeTime} UTC\n                  </p>\n                </div>\n\n                {/* Active Session Timer */}\n                {session.isActive && (\n                  <div className=\"space-y-3\" data-testid=\"card-session-details\">\n                    {/* Elapsed and Remaining Time */}\n                    <div className=\"grid grid-cols-2 gap-2\">\n                      <div className=\"bg-muted/30 rounded-md p-2\">\n                        <div className=\"flex items-center gap-1 mb-1\">\n                          <Timer className=\"w-3 h-3 text-emerald-600 dark:text-emerald-400\" />\n                          <span className=\"text-[9px] text-muted-foreground font-bold uppercase tracking-wide\">Elapsed</span>\n                        </div>\n                        <div className=\"text-xs font-extrabold text-foreground tabular-nums\" data-testid={`text-elapsed-time-${session.name.toLowerCase()}`}>\n                          {formatMinutesToHoursAndMinutes(elapsed)}\n                        </div>\n                      </div>\n                      <div className=\"bg-muted/30 rounded-md p-2\">\n                        <div className=\"flex items-center gap-1 mb-1\">\n                          <Clock className=\"w-3 h-3 text-amber-600 dark:text-amber-400\" />\n                          <span className=\"text-[9px] text-muted-foreground font-bold uppercase tracking-wide\">Remaining</span>\n                        </div>\n                        <div className=\"text-xs font-extrabold text-foreground tabular-nums\" data-testid={`text-remaining-time-${session.name.toLowerCase()}`}>\n                          {formatMinutesToHoursAndMinutes(remaining)}\n                        </div>\n                      </div>\n                    </div>\n                    \n                    {/* Progress Bar */}\n                    <div className=\"space-y-1\">\n                      <div className=\"h-1.5 bg-muted rounded-full overflow-hidden\">\n                        <div \n                          className=\"h-full transition-all duration-1000\"\n                          style={{ \n                            width: `${progress}%`,\n                            backgroundColor: session.color\n                          }}\n                        />\n                      </div>\n                      <div className=\"text-center\">\n                        <span className=\"text-[10px] font-bold text-muted-foreground\">{Math.round(progress)}% Complete</span>\n                      </div>\n                    </div>\n                  </div>\n                )}\n                \n                {/* Closed Session Timer */}\n                {!session.isActive && (\n                  <div className=\"space-y-2\" data-testid=\"card-session-closed\">\n                    <div className=\"bg-muted/30 rounded-md p-3\">\n                      <div className=\"flex items-center gap-2 mb-2\">\n                        <Calendar className=\"w-4 h-4 text-muted-foreground opacity-50\" />\n                        <span className=\"text-[9px] text-muted-foreground font-bold uppercase tracking-wide\">Opens In</span>\n                      </div>\n                      <div className=\"text-sm font-extrabold text-foreground tabular-nums\">\n                        {formatMinutesToHoursAndMinutes(minutesUntilOpen)}\n                      </div>\n                    </div>\n                  </div>\n                )}\n              </div>\n            );\n          })}\n        </div>\n      </div>\n    </Card>\n  );\n}","path":null,"size_bytes":7668,"size_tokens":null},"client/src/components/TradingSignals.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Zap, Clock, Eye, BarChart3, Timer, ListTodo, TrendingDown, TrendingUp } from 'lucide-react';\n\ninterface TradingSignal {\n  id: string;\n  symbol: string;\n  assetClass: string;\n  type: string;\n  strategy: string;\n  entryPrice: string;\n  stopLoss: string;\n  takeProfit: string;\n  riskRewardRatio: string;\n  primaryTimeframe: string;\n  overallConfidence: number;\n  interestRateDiffScore?: string;\n  inflationImpactScore?: string;\n  trendScore?: string;\n  smcScore?: string;\n  institutionalCandleDetected?: boolean;\n  smcFactors?: string[];\n  technicalReasons?: string[];\n  marketContext?: string;\n  status: string;\n  strength?: string;\n  createdAt: Date;\n  expiresAt?: Date;\n}\n\nfunction CountdownTimer({ expiresAt }: { expiresAt?: Date }) {\n  const [timeRemaining, setTimeRemaining] = useState<string>('');\n\n  useEffect(() => {\n    if (!expiresAt) return;\n\n    const updateTimer = () => {\n      const now = new Date();\n      const expiry = new Date(expiresAt);\n      const diffMs = expiry.getTime() - now.getTime();\n\n      if (diffMs <= 0) {\n        setTimeRemaining('EXPIRED');\n        return;\n      }\n\n      const hours = Math.floor(diffMs / (1000 * 60 * 60));\n      const minutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));\n      const seconds = Math.floor((diffMs % (1000 * 60)) / 1000);\n\n      setTimeRemaining(`${hours}h ${minutes}m ${seconds}s`);\n    };\n\n    updateTimer();\n    const interval = setInterval(updateTimer, 1000);\n\n    return () => clearInterval(interval);\n  }, [expiresAt]);\n\n  if (!expiresAt) return <span className=\"text-muted-foreground\">No expiry</span>;\n\n  return (\n    <span className={timeRemaining === 'EXPIRED' ? 'text-red-500 font-semibold' : 'text-foreground'}>\n      {timeRemaining}\n    </span>\n  );\n}\n\ninterface TradingSignalsProps {\n  assetClassFilter?: string;\n  title?: string;\n}\n\nexport default function TradingSignals({ assetClassFilter, title }: TradingSignalsProps = {}) {\n  const [selectedSignal, setSelectedSignal] = useState<string | null>(null);\n  \n  const { data: allSignals = [], isLoading } = useQuery<TradingSignal[]>({\n    queryKey: ['/api/trading-signals'],\n    refetchInterval: 10000,\n  });\n\n  const signals = assetClassFilter \n    ? allSignals.filter(s => s.assetClass === assetClassFilter)\n    : allSignals;\n\n  const activeSignals = signals.filter(s => s.status === 'active');\n  const watchlistSignals = signals.filter(s => s.status === 'watchlist' || s.status === 'pending');\n  const completedSignals = signals.filter(s => s.status === 'stopped_out' || s.status === 'target_hit');\n  const previousSignals = signals.filter(s => s.status === 'expired' || s.status === 'invalidated');\n\n  const displayTitle = title || 'Currency, Gold, Oil and Crypto Signals';\n\n  const getSignalTypeColor = (type: string) => {\n    return type === 'buy' ? 'hsl(120 60% 50%)' : 'hsl(0 75% 60%)';\n  };\n\n  const getConfidenceColor = (confidence: number) => {\n    if (confidence >= 80) return 'hsl(120 60% 50%)';\n    if (confidence >= 60) return 'hsl(45 90% 60%)';\n    return 'hsl(0 75% 60%)';\n  };\n\n  const formatTimeAgo = (timestamp: Date) => {\n    const now = new Date();\n    const diffMs = now.getTime() - new Date(timestamp).getTime();\n    const diffMins = Math.floor(diffMs / (1000 * 60));\n    \n    if (diffMins < 60) return `${diffMins}m ago`;\n    const diffHours = Math.floor(diffMins / 60);\n    if (diffHours < 24) return `${diffHours}h ago`;\n    return `${Math.floor(diffHours / 24)}d ago`;\n  };\n\n  if (isLoading) {\n    return (\n      <div data-testid=\"card-trading-signals\" className=\"bg-white dark:bg-background\">\n        <div className=\"pb-4 mb-4 border-b border-border/50\">\n          <div className=\"flex items-center gap-2 text-lg font-semibold\">\n            <Zap className=\"w-5 h-5\" />\n            {displayTitle}\n            <Badge variant=\"secondary\" className=\"ml-auto mr-2\">Loading...</Badge>\n          </div>\n        </div>\n        <div className=\"text-center py-8 text-muted-foreground\">Scanning markets for signals...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div data-testid=\"card-trading-signals\" className=\"bg-white dark:bg-background\">\n      <div className=\"pb-4 mb-4 border-b border-border/50\">\n        <div className=\"flex items-center gap-2 text-lg font-semibold\">\n          <Zap className=\"w-5 h-5\" />\n          {displayTitle}\n          <div className=\"flex items-center gap-2 ml-auto mr-2\">\n            <Badge variant=\"secondary\">\n              {activeSignals.length} Active\n            </Badge>\n            {watchlistSignals.length > 0 && (\n              <Badge variant=\"outline\" className=\"border-amber-500 text-amber-600 dark:text-amber-400\">\n                {watchlistSignals.length} Watchlist\n              </Badge>\n            )}\n          </div>\n        </div>\n      </div>\n      <div>\n        {activeSignals.length === 0 && previousSignals.length === 0 ? (\n          <div className=\"text-center py-8 text-muted-foreground\">\n            <p>No signals detected yet</p>\n            <p className=\"text-sm mt-2\">Scanning 62 instruments every minute...</p>\n          </div>\n        ) : (\n          <div>\n            {/* Active Signals Section */}\n            {activeSignals.length > 0 && (\n              <div>\n                <div className=\"divide-y divide-border/50\">\n                  {activeSignals.map((signal) => (\n                    <div\n                      key={signal.id}\n                      className={`py-4 transition-all ${\n                        selectedSignal === signal.id ? 'bg-primary/5' : 'hover-elevate'\n                      }`}\n                      data-testid={`card-signal-${signal.id}`}\n                    >\n                      <div className=\"flex items-start justify-between mb-3\">\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"relative\">\n                            <div className=\"absolute left-0 top-0 bottom-0 w-0.5\" style={{ backgroundColor: getSignalTypeColor(signal.type) }} />\n                            <Badge \n                              variant=\"secondary\"\n                              className=\"text-xs font-medium ml-3\"\n                              style={{ \n                                backgroundColor: getSignalTypeColor(signal.type) + '20', \n                                color: getSignalTypeColor(signal.type) \n                              }}\n                            >\n                              {signal.type.toUpperCase()}\n                            </Badge>\n                          </div>\n                          <div>\n                            <h4 className=\"font-semibold text-sm\" data-testid={`text-symbol-${signal.id}`}>\n                              {signal.symbol}\n                            </h4>\n                            <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                              <span>{signal.strategy}</span>\n                              <span></span>\n                              <span>{signal.primaryTimeframe}</span>\n                              <span></span>\n                              <span className=\"flex items-center gap-1\">\n                                <Clock className=\"w-3 h-3\" />\n                                {formatTimeAgo(signal.createdAt)}\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n                        \n                        <div className=\"flex flex-col items-end gap-1.5 mr-2\">\n                          <div className=\"flex items-center gap-2\">\n                            <Badge \n                              variant=\"outline\"\n                              className=\"text-xs\"\n                              style={{ \n                                borderColor: getConfidenceColor(signal.overallConfidence), \n                                color: getConfidenceColor(signal.overallConfidence) \n                              }}\n                            >\n                              {signal.overallConfidence}%\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center gap-1 text-xs\">\n                            <Timer className=\"w-3 h-3 text-muted-foreground\" />\n                            <CountdownTimer expiresAt={signal.expiresAt} />\n                          </div>\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-stretch gap-0 text-xs mb-3 ml-3\">\n                        <div className=\"flex-1 pr-4 border-r border-border/50\">\n                          <span className=\"text-muted-foreground\">Entry:</span>\n                          <div className=\"font-mono font-semibold\" data-testid={`text-entry-${signal.id}`}>\n                            {parseFloat(signal.entryPrice).toLocaleString()}\n                          </div>\n                        </div>\n                        <div className=\"flex-1 px-4 border-r border-border/50\">\n                          <span className=\"text-muted-foreground\">Stop Loss:</span>\n                          <div className=\"font-mono font-semibold text-red-500\">\n                            {parseFloat(signal.stopLoss).toLocaleString()}\n                          </div>\n                        </div>\n                        <div className=\"flex-1 px-4 border-r border-border/50\">\n                          <span className=\"text-muted-foreground\">Take Profit:</span>\n                          <div className=\"font-mono font-semibold text-green-500\">\n                            {parseFloat(signal.takeProfit).toLocaleString()}\n                          </div>\n                        </div>\n                        <div className=\"flex-1 pl-4\">\n                          <span className=\"text-muted-foreground\">R:R Ratio:</span>\n                          <div className=\"font-mono font-semibold\" data-testid={`text-rr-${signal.id}`}>\n                            1:{signal.riskRewardRatio}\n                          </div>\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-center justify-between ml-3 pt-3 border-t border-border/30\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => setSelectedSignal(selectedSignal === signal.id ? null : signal.id)}\n                          className=\"text-xs\"\n                          data-testid={`button-details-${signal.id}`}\n                        >\n                          <Eye className=\"w-3 h-3 mr-1\" />\n                          {selectedSignal === signal.id ? 'Hide' : 'Show'} Details\n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => console.log(`Viewing chart for ${signal.symbol}`)}\n                          className=\"text-xs\"\n                          data-testid={`button-chart-${signal.id}`}\n                        >\n                          <BarChart3 className=\"w-3 h-3 mr-1\" />\n                          View Chart\n                        </Button>\n                      </div>\n\n                      {selectedSignal === signal.id && (\n                        <div className=\"mt-4 pt-4 ml-3 border-t border-border space-y-4\" data-testid={`details-${signal.id}`}>\n                          <div className=\"grid grid-cols-2 gap-4\">\n                            <div className=\"space-y-2\">\n                              <h5 className=\"font-medium text-sm\">Scoring Breakdown</h5>\n                              <div className=\"space-y-1.5 text-xs\">\n                                {signal.interestRateDiffScore && (\n                                  <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-muted-foreground\">Interest Rate (40%):</span>\n                                    <Badge variant=\"outline\" className=\"text-xs\">\n                                      {parseFloat(signal.interestRateDiffScore).toFixed(1)}\n                                    </Badge>\n                                  </div>\n                                )}\n                                {signal.inflationImpactScore && (\n                                  <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-muted-foreground\">Inflation (25%):</span>\n                                    <Badge variant=\"outline\" className=\"text-xs\">\n                                      {parseFloat(signal.inflationImpactScore).toFixed(1)}\n                                    </Badge>\n                                  </div>\n                                )}\n                                {signal.trendScore && (\n                                  <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-muted-foreground\">Trend (20%):</span>\n                                    <Badge variant=\"outline\" className=\"text-xs\">\n                                      {parseFloat(signal.trendScore).toFixed(1)}\n                                    </Badge>\n                                  </div>\n                                )}\n                                {signal.smcScore && (\n                                  <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-muted-foreground\">SMC (15%):</span>\n                                    <Badge variant=\"outline\" className=\"text-xs\">\n                                      {parseFloat(signal.smcScore).toFixed(1)}\n                                    </Badge>\n                                  </div>\n                                )}\n                              </div>\n                            </div>\n\n                            <div className=\"space-y-2\">\n                              <h5 className=\"font-medium text-sm\">Signal Attributes</h5>\n                              <div className=\"space-y-1.5 text-xs\">\n                                {signal.strength && (\n                                  <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-muted-foreground\">Strength:</span>\n                                    <Badge variant=\"secondary\" className=\"text-xs capitalize\">\n                                      {signal.strength}\n                                    </Badge>\n                                  </div>\n                                )}\n                                {signal.institutionalCandleDetected !== undefined && (\n                                  <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-muted-foreground\">Institutional Candle:</span>\n                                    <Badge \n                                      variant={signal.institutionalCandleDetected ? \"default\" : \"outline\"} \n                                      className=\"text-xs\"\n                                    >\n                                      {signal.institutionalCandleDetected ? 'Detected' : 'None'}\n                                    </Badge>\n                                  </div>\n                                )}\n                                <div className=\"flex justify-between items-center\">\n                                  <span className=\"text-muted-foreground\">Asset Class:</span>\n                                  <Badge variant=\"outline\" className=\"text-xs capitalize\">\n                                    {signal.assetClass}\n                                  </Badge>\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n\n                          <div>\n                            <h5 className=\"font-medium text-sm mb-2\">Technical Analysis Reasoning:</h5>\n                            <ul className=\"space-y-1 text-xs\">\n                              {signal.technicalReasons?.map((reason, index) => (\n                                <li key={index} className=\"flex items-center gap-2\">\n                                  <div className=\"w-1 h-1 rounded-full bg-primary\" />\n                                  {reason}\n                                </li>\n                              ))}\n                            </ul>\n                          </div>\n                          \n                          {signal.smcFactors && signal.smcFactors.length > 0 && (\n                            <div>\n                              <h5 className=\"font-medium text-sm mb-2\">Smart Money Concepts:</h5>\n                              <ul className=\"space-y-1 text-xs\">\n                                {signal.smcFactors.map((factor, index) => (\n                                  <li key={index} className=\"flex items-center gap-2\">\n                                    <div className=\"w-1 h-1 rounded-full bg-secondary\" />\n                                    {factor}\n                                  </li>\n                                ))}\n                              </ul>\n                            </div>\n                          )}\n\n                          {signal.marketContext && (\n                            <div>\n                              <h5 className=\"font-medium text-sm mb-2\">Market Context:</h5>\n                              <p className=\"text-xs text-muted-foreground\">{signal.marketContext}</p>\n                            </div>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Watchlist Section - Signals 1 step away from confirmation */}\n            {watchlistSignals.length > 0 && (\n              <div className=\"mt-6 pt-6 border-t-2 border-amber-500/30\">\n                <h3 className=\"text-sm font-semibold mb-4 pb-2 text-amber-600 dark:text-amber-400 uppercase tracking-wide border-b-2 border-amber-500/30 flex items-center gap-2\">\n                  <ListTodo className=\"w-4 h-4\" />\n                  Watchlist\n                  <span className=\"ml-2 text-xs font-normal normal-case text-muted-foreground\">(1 step from confirmation)</span>\n                </h3>\n                <div className=\"divide-y divide-border/50\">\n                  {watchlistSignals.map((signal) => (\n                    <div\n                      key={signal.id}\n                      className=\"py-3 bg-amber-500/5 border-l-2 border-amber-500/50 pl-3\"\n                      data-testid={`card-watchlist-signal-${signal.id}`}\n                    >\n                      <div className=\"flex items-start justify-between mb-2\">\n                        <div className=\"flex items-center gap-3\">\n                          <Badge \n                            variant=\"secondary\"\n                            className=\"text-xs font-medium\"\n                            style={{ \n                              backgroundColor: getSignalTypeColor(signal.type) + '20', \n                              color: getSignalTypeColor(signal.type) \n                            }}\n                          >\n                            {signal.type.toUpperCase()}\n                          </Badge>\n                          <div>\n                            <h4 className=\"font-semibold text-sm\">{signal.symbol}</h4>\n                            <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                              <span>{signal.strategy}</span>\n                              <span></span>\n                              <span>{signal.primaryTimeframe}</span>\n                            </div>\n                          </div>\n                        </div>\n                        \n                        <Badge variant=\"outline\" className=\"text-xs border-amber-500 text-amber-600 dark:text-amber-400 mr-2\">\n                          PENDING\n                        </Badge>\n                      </div>\n\n                      <div className=\"flex items-stretch gap-0 text-xs pt-2 border-t border-border/30\">\n                        <div className=\"flex-1 pr-4 border-r border-border/50\">\n                          <span className=\"text-muted-foreground\">Entry Zone:</span>\n                          <div className=\"font-mono font-semibold\">\n                            {parseFloat(signal.entryPrice).toLocaleString()}\n                          </div>\n                        </div>\n                        <div className=\"flex-1 px-4 border-r border-border/50\">\n                          <span className=\"text-muted-foreground\">Confidence:</span>\n                          <div className=\"font-mono font-semibold\" style={{ color: getConfidenceColor(signal.overallConfidence) }}>\n                            {signal.overallConfidence}%\n                          </div>\n                        </div>\n                        <div className=\"flex-1 pl-4\">\n                          <span className=\"text-muted-foreground\">Waiting for:</span>\n                          <div className=\"font-semibold text-amber-600 dark:text-amber-400\">\n                            LTF Confirmation\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Completed Signals Section - Hit SL or TP */}\n            {completedSignals.length > 0 && (\n              <div className=\"mt-6 pt-6 border-t-2 border-border/60\">\n                <h3 className=\"text-sm font-semibold mb-4 pb-2 text-muted-foreground uppercase tracking-wide border-b-2 border-border/60 flex items-center gap-2\">\n                  Recently Closed\n                  <span className=\"ml-2 text-xs font-normal normal-case\">(Hit SL/TP)</span>\n                </h3>\n                <div className=\"divide-y divide-border/50\">\n                  {completedSignals.map((signal) => {\n                    const isWin = signal.status === 'target_hit';\n                    return (\n                      <div\n                        key={signal.id}\n                        className={`py-3 border-l-2 pl-3 ${isWin ? 'border-green-500/50 bg-green-500/5' : 'border-red-500/50 bg-red-500/5'}`}\n                        data-testid={`card-completed-signal-${signal.id}`}\n                      >\n                        <div className=\"flex items-start justify-between mb-2\">\n                          <div className=\"flex items-center gap-3\">\n                            {isWin ? (\n                              <TrendingUp className=\"w-5 h-5 text-green-500\" />\n                            ) : (\n                              <TrendingDown className=\"w-5 h-5 text-red-500\" />\n                            )}\n                            <div>\n                              <h4 className=\"font-semibold text-sm\">{signal.symbol}</h4>\n                              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                                <span>{signal.type.toUpperCase()}</span>\n                                <span></span>\n                                <span>{signal.strategy}</span>\n                              </div>\n                            </div>\n                          </div>\n                          \n                          <Badge \n                            variant={isWin ? \"default\" : \"destructive\"} \n                            className=\"text-xs mr-2\"\n                          >\n                            {isWin ? 'TARGET HIT' : 'STOPPED OUT'}\n                          </Badge>\n                        </div>\n\n                        <div className=\"flex items-stretch gap-0 text-xs pt-2 border-t border-border/30\">\n                          <div className=\"flex-1 pr-4 border-r border-border/50\">\n                            <span className=\"text-muted-foreground\">Entry:</span>\n                            <div className=\"font-mono font-semibold\">\n                              {parseFloat(signal.entryPrice).toLocaleString()}\n                            </div>\n                          </div>\n                          <div className=\"flex-1 px-4 border-r border-border/50\">\n                            <span className=\"text-muted-foreground\">{isWin ? 'Target:' : 'Stop:'}</span>\n                            <div className={`font-mono font-semibold ${isWin ? 'text-green-500' : 'text-red-500'}`}>\n                              {isWin ? parseFloat(signal.takeProfit).toLocaleString() : parseFloat(signal.stopLoss).toLocaleString()}\n                            </div>\n                          </div>\n                          <div className=\"flex-1 pl-4\">\n                            <span className=\"text-muted-foreground\">Result:</span>\n                            <div className={`font-semibold ${isWin ? 'text-green-500' : 'text-red-500'}`}>\n                              {isWin ? '+' : '-'}{signal.riskRewardRatio}R\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n            )}\n\n            {/* Previous Signals Section */}\n            {previousSignals.length > 0 && (\n              <div className=\"mt-6 pt-6 border-t-2 border-border/60\">\n                <h3 className=\"text-sm font-semibold mb-4 pb-2 text-muted-foreground uppercase tracking-wide border-b-2 border-border/60\">\n                  Recently Expired\n                  <span className=\"ml-2 text-xs font-normal normal-case\">(Before Archive)</span>\n                </h3>\n                <div className=\"divide-y divide-border/50\">\n                  {previousSignals.map((signal) => (\n                    <div\n                      key={signal.id}\n                      className=\"py-3 opacity-75\"\n                      data-testid={`card-prev-signal-${signal.id}`}\n                    >\n                      <div className=\"flex items-start justify-between mb-2\">\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"relative\">\n                            <div className=\"absolute left-0 top-0 bottom-0 w-0.5 opacity-50\" style={{ backgroundColor: getSignalTypeColor(signal.type) }} />\n                            <Badge \n                              variant=\"secondary\"\n                              className=\"text-xs font-medium opacity-75 ml-3\"\n                              style={{ \n                                backgroundColor: getSignalTypeColor(signal.type) + '20', \n                                color: getSignalTypeColor(signal.type) \n                              }}\n                            >\n                              {signal.type.toUpperCase()}\n                            </Badge>\n                          </div>\n                          <div>\n                            <h4 className=\"font-semibold text-sm\">\n                              {signal.symbol}\n                            </h4>\n                            <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                              <span>{signal.strategy}</span>\n                              <span></span>\n                              <span>{signal.primaryTimeframe}</span>\n                              <span></span>\n                              <span className=\"flex items-center gap-1\">\n                                <Clock className=\"w-3 h-3\" />\n                                {formatTimeAgo(signal.createdAt)}\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n                        \n                        <Badge variant=\"outline\" className=\"text-xs mr-2\">\n                          EXPIRED\n                        </Badge>\n                      </div>\n\n                      <div className=\"flex items-stretch gap-0 text-xs ml-3 pt-2 border-t border-border/30\">\n                        <div className=\"flex-1 pr-4 border-r border-border/50\">\n                          <span className=\"text-muted-foreground\">Entry:</span>\n                          <div className=\"font-mono font-semibold\">\n                            {parseFloat(signal.entryPrice).toLocaleString()}\n                          </div>\n                        </div>\n                        <div className=\"flex-1 px-4 border-r border-border/50\">\n                          <span className=\"text-muted-foreground\">R:R:</span>\n                          <div className=\"font-mono font-semibold\">\n                            1:{signal.riskRewardRatio}\n                          </div>\n                        </div>\n                        <div className=\"flex-1 px-4 border-r border-border/50\">\n                          <span className=\"text-muted-foreground\">Confidence:</span>\n                          <div className=\"font-mono font-semibold\">\n                            {signal.overallConfidence}%\n                          </div>\n                        </div>\n                        <div className=\"flex-1 pl-4\">\n                          <span className=\"text-muted-foreground\">Status:</span>\n                          <div className=\"font-semibold text-green-500\">\n                            {signal.status.toUpperCase()}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":29981,"size_tokens":null},"client/src/components/InstrumentsToWatch.tsx":{"content":"import { useState } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Eye, TrendingUp, TrendingDown, Target, Layers } from 'lucide-react';\n\ninterface PendingSetup {\n  id: string;\n  symbol: string;\n  assetClass: string;\n  type: string;\n  setupStage: string;\n  potentialStrategy?: string;\n  currentPrice: string;\n  primaryTimeframe: string;\n  confirmationTimeframe?: string;\n  interestRateBias?: string;\n  inflationBias?: string;\n  trendBias?: string;\n  chochDetected?: boolean;\n  chochDirection?: string;\n  liquiditySweepDetected?: boolean;\n  supplyDemandZoneTargeted?: boolean;\n  zoneLevel?: string;\n  zoneMitigated?: boolean;\n  levelsBroken?: number;\n  confirmationsPending?: string[];\n  setupNotes?: string[];\n  marketContext?: string;\n  lastCheckedAt: Date;\n  readyForSignal?: boolean;\n  createdAt: Date;\n}\n\ninterface InstrumentsToWatchProps {\n  assetClassFilter?: string;\n}\n\nexport default function InstrumentsToWatch({ assetClassFilter }: InstrumentsToWatchProps = {}) {\n  const [selectedSetupId, setSelectedSetupId] = useState<string | null>(null);\n  \n  const { data: allPendingSetups = [], isLoading } = useQuery<PendingSetup[]>({\n    queryKey: ['/api/pending-setups'],\n    refetchInterval: 15000,\n  });\n\n  const pendingSetups = assetClassFilter\n    ? allPendingSetups.filter(s => s.assetClass === assetClassFilter)\n    : allPendingSetups;\n\n  const activeSetups = pendingSetups.filter(s => !s.readyForSignal);\n\n  const getSetupTypeColor = (type: string) => {\n    return type === 'buy' ? 'hsl(120 60% 50%)' : 'hsl(0 75% 60%)';\n  };\n\n  const getStageColor = (stage: string) => {\n    if (stage === 'forming') return 'text-yellow-500';\n    if (stage === 'monitoring') return 'text-blue-500';\n    return 'text-purple-500';\n  };\n\n  const formatTimeAgo = (timestamp: Date) => {\n    const now = new Date();\n    const diffMs = now.getTime() - new Date(timestamp).getTime();\n    const diffMins = Math.floor(diffMs / (1000 * 60));\n    \n    if (diffMins < 60) return `${diffMins}m ago`;\n    const diffHours = Math.floor(diffMins / 60);\n    if (diffHours < 24) return `${diffHours}h ago`;\n    return `${Math.floor(diffHours / 24)}d ago`;\n  };\n\n  if (isLoading) {\n    return (\n      <div data-testid=\"card-instruments-watch\" className=\"bg-white dark:bg-background p-6\">\n        <div className=\"flex items-center gap-2 text-lg font-semibold mb-4\">\n          <Eye className=\"w-5 h-5\" />\n          Instruments to Watch\n        </div>\n        <div className=\"text-center py-8 text-muted-foreground\">\n          <p>Loading pending setups...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div data-testid=\"card-instruments-watch\" className=\"bg-white dark:bg-background\">\n      <div className=\"pb-4 mb-4 border-b-2 border-border/60\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2 text-lg font-semibold\">\n            <Eye className=\"w-5 h-5\" />\n            Instruments to Watch\n          </div>\n          <Badge variant=\"secondary\" className=\"mr-2\">\n            {activeSetups.length} Forming\n          </Badge>\n        </div>\n        <p className=\"text-xs text-muted-foreground mt-1\">\n          Setups pending confirmation - price action developing\n        </p>\n      </div>\n\n      <div>\n        {activeSetups.length === 0 ? (\n          <div className=\"text-center py-8 text-muted-foreground\">\n            <p>No pending setups at the moment</p>\n            <p className=\"text-sm mt-2\">Watching for potential opportunities...</p>\n          </div>\n        ) : (\n          <div className=\"divide-y divide-border/50\">\n            {activeSetups.map((setup) => (\n              <div\n                key={setup.id}\n                className=\"py-4\"\n                data-testid={`card-setup-${setup.id}`}\n              >\n                <div className=\"flex items-start justify-between mb-3\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"relative\">\n                      <div \n                        className=\"absolute left-0 top-0 bottom-0 w-0.5\" \n                        style={{ backgroundColor: getSetupTypeColor(setup.type) }} \n                      />\n                      <Badge \n                        variant=\"secondary\"\n                        className=\"text-xs font-medium ml-3\"\n                        style={{ \n                          backgroundColor: getSetupTypeColor(setup.type) + '20', \n                          color: getSetupTypeColor(setup.type) \n                        }}\n                      >\n                        {setup.type.toUpperCase()}\n                      </Badge>\n                    </div>\n                    <div>\n                      <h4 className=\"font-semibold text-sm\" data-testid={`text-symbol-${setup.id}`}>\n                        {setup.symbol}\n                      </h4>\n                      <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                        <span className={getStageColor(setup.setupStage)}>\n                          {setup.setupStage.toUpperCase()}\n                        </span>\n                        {setup.potentialStrategy && (\n                          <>\n                            <span></span>\n                            <span>{setup.potentialStrategy}</span>\n                          </>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <Badge variant=\"outline\" className=\"text-xs mr-2 capitalize\">\n                    {setup.assetClass}\n                  </Badge>\n                </div>\n\n                <div className=\"flex items-stretch gap-0 text-xs mb-3 ml-3\">\n                  <div className=\"flex-1 pr-4 border-r border-border/50\">\n                    <span className=\"text-muted-foreground\">Current:</span>\n                    <div className=\"font-mono font-semibold\">\n                      {parseFloat(setup.currentPrice).toLocaleString()}\n                    </div>\n                  </div>\n                  {setup.zoneLevel && (\n                    <div className=\"flex-1 px-4 border-r border-border/50\">\n                      <span className=\"text-muted-foreground\">Zone:</span>\n                      <div className=\"font-mono font-semibold text-blue-500\">\n                        {parseFloat(setup.zoneLevel).toLocaleString()}\n                      </div>\n                    </div>\n                  )}\n                  <div className=\"flex-1 pl-4\">\n                    <span className=\"text-muted-foreground\">TF:</span>\n                    <div className=\"font-semibold\">\n                      {setup.primaryTimeframe}\n                    </div>\n                  </div>\n                </div>\n\n                {/* SMC Indicators */}\n                <div className=\"flex items-center gap-2 text-xs ml-3 mb-3\">\n                  {setup.chochDetected && (\n                    <Badge variant=\"default\" className=\"text-xs\">\n                      <Layers className=\"w-3 h-3 mr-1\" />\n                      CHoCH {setup.chochDirection}\n                    </Badge>\n                  )}\n                  {setup.liquiditySweepDetected && (\n                    <Badge variant=\"default\" className=\"text-xs\">\n                      <Target className=\"w-3 h-3 mr-1\" />\n                      Liquidity Sweep\n                    </Badge>\n                  )}\n                  {setup.supplyDemandZoneTargeted && (\n                    <Badge variant=\"secondary\" className=\"text-xs\">\n                      S/D Zone Targeted\n                    </Badge>\n                  )}\n                  {setup.levelsBroken && setup.levelsBroken > 0 && (\n                    <Badge variant=\"outline\" className=\"text-xs\">\n                      {setup.levelsBroken} Levels Broken\n                    </Badge>\n                  )}\n                </div>\n\n                {/* Confirmations Pending */}\n                {setup.confirmationsPending && setup.confirmationsPending.length > 0 && (\n                  <div className=\"ml-3 mb-3\">\n                    <p className=\"text-xs text-muted-foreground mb-1\">Waiting for:</p>\n                    <div className=\"flex flex-wrap gap-1.5\">\n                      {setup.confirmationsPending.map((confirmation, idx) => (\n                        <Badge key={idx} variant=\"outline\" className=\"text-xs\">\n                          {confirmation}\n                        </Badge>\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                {/* Setup Notes */}\n                {setup.setupNotes && setup.setupNotes.length > 0 && (\n                  <div className=\"ml-3 pt-3 border-t border-border/30\">\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => setSelectedSetupId(selectedSetupId === setup.id ? null : setup.id)}\n                      className=\"text-xs mb-2\"\n                      data-testid={`button-details-${setup.id}`}\n                    >\n                      <Eye className=\"w-3 h-3 mr-1\" />\n                      {selectedSetupId === setup.id ? 'Hide' : 'Show'} Analysis\n                    </Button>\n\n                    {selectedSetupId === setup.id && (\n                      <div className=\"space-y-2\" data-testid={`details-${setup.id}`}>\n                        <div>\n                          <h5 className=\"font-medium text-xs mb-1\">Setup Analysis:</h5>\n                          <ul className=\"space-y-1 text-xs\">\n                            {setup.setupNotes.map((note, index) => (\n                              <li key={index} className=\"flex items-start gap-2\">\n                                <div className=\"w-1 h-1 rounded-full bg-primary mt-1.5 shrink-0\" />\n                                <span className=\"text-muted-foreground\">{note}</span>\n                              </li>\n                            ))}\n                          </ul>\n                        </div>\n\n                        {setup.marketContext && (\n                          <div>\n                            <h5 className=\"font-medium text-xs mb-1\">Market Context:</h5>\n                            <p className=\"text-xs text-muted-foreground\">{setup.marketContext}</p>\n                          </div>\n                        )}\n\n                        {/* Bias Indicators */}\n                        {(setup.trendBias || setup.interestRateBias || setup.inflationBias) && (\n                          <div>\n                            <h5 className=\"font-medium text-xs mb-1\">Bias Analysis:</h5>\n                            <div className=\"flex flex-wrap gap-2\">\n                              {setup.trendBias && (\n                                <Badge variant=\"outline\" className=\"text-xs\">\n                                  Trend: {setup.trendBias}\n                                </Badge>\n                              )}\n                              {setup.interestRateBias && (\n                                <Badge variant=\"outline\" className=\"text-xs\">\n                                  IR: {setup.interestRateBias}\n                                </Badge>\n                              )}\n                              {setup.inflationBias && (\n                                <Badge variant=\"outline\" className=\"text-xs\">\n                                  Inflation: {setup.inflationBias}\n                                </Badge>\n                              )}\n                            </div>\n                          </div>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                )}\n\n                <div className=\"text-xs text-muted-foreground ml-3 mt-2\">\n                  Last checked: {formatTimeAgo(setup.lastCheckedAt)}\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":12046,"size_tokens":null},"server/services/marketData.ts":{"content":"export interface InterestRateData {\n  currency: string;\n  rate: number;\n  lastUpdate: Date;\n}\n\nexport interface InflationData {\n  country: string;\n  currency: string;\n  rate: number;\n  lastUpdate: Date;\n}\n\nexport interface Candle {\n  timeframe: string;\n  open: number;\n  high: number;\n  low: number;\n  close: number;\n  volume: number;\n  timestamp: Date;\n}\n\nexport const CURRENT_INTEREST_RATES: Record<string, InterestRateData> = {\n  USD: { currency: 'USD', rate: 5.50, lastUpdate: new Date('2025-10-01') },\n  EUR: { currency: 'EUR', rate: 4.00, lastUpdate: new Date('2025-10-01') },\n  GBP: { currency: 'GBP', rate: 5.25, lastUpdate: new Date('2025-10-01') },\n  JPY: { currency: 'JPY', rate: 0.25, lastUpdate: new Date('2025-10-01') },\n  AUD: { currency: 'AUD', rate: 4.35, lastUpdate: new Date('2025-10-01') },\n  CAD: { currency: 'CAD', rate: 5.00, lastUpdate: new Date('2025-10-01') },\n  CHF: { currency: 'CHF', rate: 1.75, lastUpdate: new Date('2025-10-01') },\n  NZD: { currency: 'NZD', rate: 5.50, lastUpdate: new Date('2025-10-01') },\n};\n\nexport const CURRENT_INFLATION: Record<string, InflationData> = {\n  USD: { country: 'United States', currency: 'USD', rate: 3.2, lastUpdate: new Date('2025-09-01') },\n  EUR: { country: 'Eurozone', currency: 'EUR', rate: 2.4, lastUpdate: new Date('2025-09-01') },\n  GBP: { country: 'United Kingdom', currency: 'GBP', rate: 4.0, lastUpdate: new Date('2025-09-01') },\n  JPY: { country: 'Japan', currency: 'JPY', rate: 2.8, lastUpdate: new Date('2025-09-01') },\n  AUD: { country: 'Australia', currency: 'AUD', rate: 5.1, lastUpdate: new Date('2025-09-01') },\n  CAD: { country: 'Canada', currency: 'CAD', rate: 3.6, lastUpdate: new Date('2025-09-01') },\n  CHF: { country: 'Switzerland', currency: 'CHF', rate: 1.7, lastUpdate: new Date('2025-09-01') },\n  NZD: { country: 'New Zealand', currency: 'NZD', rate: 5.6, lastUpdate: new Date('2025-09-01') },\n};\n\nexport function parseCurrencyPair(symbol: string): { base: string; quote: string } | null {\n  const forexPattern = /^([A-Z]{3})\\/([A-Z]{3})$/;\n  const match = symbol.match(forexPattern);\n  \n  if (match) {\n    return { base: match[1], quote: match[2] };\n  }\n  \n  return null;\n}\n\nexport function getInterestRateData(currency: string): InterestRateData | null {\n  return CURRENT_INTEREST_RATES[currency] || null;\n}\n\nexport function getInflationData(currency: string): InflationData | null {\n  return CURRENT_INFLATION[currency] || null;\n}\n\nexport function generateMockTimeframeData(\n  currentPrice: number,\n  trend: 'bullish' | 'bearish' | 'neutral',\n  candles: number = 20\n): any[] {\n  const data = [];\n  let price = currentPrice;\n  \n  const trendBias = trend === 'bullish' ? 0.0005 : trend === 'bearish' ? -0.0005 : 0;\n  \n  for (let i = 0; i < candles; i++) {\n    const open = price;\n    const volatility = price * 0.002;\n    const direction = Math.random() > 0.5 ? 1 : -1;\n    const move = (Math.random() * volatility + trendBias * price) * direction;\n    const close = open + move;\n    const high = Math.max(open, close) + Math.random() * volatility * 0.5;\n    const low = Math.min(open, close) - Math.random() * volatility * 0.5;\n    \n    data.push({\n      timeframe: '1H',\n      open,\n      high,\n      low,\n      close,\n      volume: Math.random() * 10000,\n      timestamp: new Date(Date.now() - (candles - i) * 3600000),\n    });\n    \n    price = close;\n  }\n  \n  return data;\n}\n","path":null,"size_bytes":3376,"size_tokens":null},"client/src/components/Notifications.tsx":{"content":"import { Bell, Check, Trash2, X } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover';\nimport { Badge } from '@/components/ui/badge';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { Separator } from '@/components/ui/separator';\nimport { useQuery, useMutation } from '@tanstack/react-query';\nimport { queryClient, apiRequest } from '@/lib/queryClient';\nimport { format } from 'date-fns';\nimport type { Notification } from '@shared/schema';\n\nexport function Notifications() {\n  const { data: notifications = [], isLoading } = useQuery<Notification[]>({\n    queryKey: ['/api/notifications'],\n  });\n\n  const { data: unreadNotifications = [] } = useQuery<Notification[]>({\n    queryKey: ['/api/notifications/unread'],\n    refetchInterval: 30000,\n  });\n\n  const markAsReadMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest('PATCH', `/api/notifications/${id}/read`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications/unread'] });\n    },\n  });\n\n  const markAllAsReadMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest('PATCH', '/api/notifications/read-all');\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications/unread'] });\n    },\n  });\n\n  const deleteNotificationMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest('DELETE', `/api/notifications/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications/unread'] });\n    },\n  });\n\n  const clearAllMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest('DELETE', '/api/notifications/clear-all');\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications/unread'] });\n    },\n  });\n\n  const getNotificationColor = (notification: Notification) => {\n    if (notification.impactLevel === 'High') return 'text-red-500';\n    if (notification.impactLevel === 'Medium') return 'text-yellow-500';\n    if (notification.impactLevel === 'Low') return 'text-green-500';\n    if (notification.type === 'trading_session') return 'text-blue-500';\n    if (notification.type === 'trading_signal') return 'text-purple-500';\n    return 'text-muted-foreground';\n  };\n\n  const getTypeLabel = (type: string) => {\n    switch (type) {\n      case 'economic_event':\n        return 'Economic Event';\n      case 'trading_session':\n        return 'Trading Session';\n      case 'trading_signal':\n        return 'Trading Signal';\n      default:\n        return 'Notification';\n    }\n  };\n\n  const unreadCount = unreadNotifications.length;\n\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        <Button \n          variant=\"ghost\" \n          size=\"icon\" \n          className=\"relative\" \n          data-testid=\"button-notifications\"\n        >\n          <Bell className=\"w-5 h-5\" />\n          {unreadCount > 0 && (\n            <Badge \n              className=\"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-xs\"\n              data-testid=\"badge-notification-count\"\n            >\n              {unreadCount > 9 ? '9+' : unreadCount}\n            </Badge>\n          )}\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-96 p-0\" align=\"end\" data-testid=\"popover-notifications\">\n        <div className=\"flex items-center justify-between p-4 border-b\">\n          <h3 className=\"font-semibold text-sm\">Notifications</h3>\n          <div className=\"flex items-center gap-1\">\n            {unreadCount > 0 && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => markAllAsReadMutation.mutate()}\n                disabled={markAllAsReadMutation.isPending}\n                data-testid=\"button-mark-all-read\"\n              >\n                <Check className=\"w-4 h-4 mr-1\" />\n                Mark all read\n              </Button>\n            )}\n            {notifications.length > 0 && (\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                onClick={() => clearAllMutation.mutate()}\n                disabled={clearAllMutation.isPending}\n                data-testid=\"button-clear-all\"\n              >\n                <Trash2 className=\"w-4 h-4\" />\n              </Button>\n            )}\n          </div>\n        </div>\n\n        <ScrollArea className=\"h-96\">\n          {isLoading ? (\n            <div className=\"flex items-center justify-center p-8\">\n              <p className=\"text-sm text-muted-foreground\">Loading notifications...</p>\n            </div>\n          ) : notifications.length === 0 ? (\n            <div className=\"flex items-center justify-center p-8\">\n              <p className=\"text-sm text-muted-foreground\">No notifications</p>\n            </div>\n          ) : (\n            <div className=\"divide-y\">\n              {notifications.map((notification) => (\n                <div\n                  key={notification.id}\n                  className={`p-4 hover-elevate transition-colors ${\n                    !notification.isRead ? 'bg-accent/50' : ''\n                  }`}\n                  onClick={() => {\n                    if (!notification.isRead) {\n                      markAsReadMutation.mutate(notification.id);\n                    }\n                  }}\n                  data-testid={`notification-item-${notification.id}`}\n                >\n                  <div className=\"flex items-start justify-between gap-2\">\n                    <div className=\"flex-1 space-y-1\">\n                      <div className=\"flex items-center gap-2\">\n                        <Badge variant=\"outline\" className=\"text-xs\">\n                          {getTypeLabel(notification.type)}\n                        </Badge>\n                        {!notification.isRead && (\n                          <div className=\"w-2 h-2 rounded-full bg-primary\" data-testid=\"indicator-unread\" />\n                        )}\n                      </div>\n                      <p className={`text-sm font-medium ${getNotificationColor(notification)}`}>\n                        {notification.title}\n                      </p>\n                      <p className=\"text-xs text-muted-foreground line-clamp-2\">\n                        {notification.message}\n                      </p>\n                      <p className=\"text-xs text-muted-foreground\">\n                        {format(new Date(notification.createdAt!), 'MMM dd, HH:mm')}\n                      </p>\n                    </div>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      className=\"h-6 w-6\"\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        deleteNotificationMutation.mutate(notification.id);\n                      }}\n                      data-testid={`button-delete-${notification.id}`}\n                    >\n                      <X className=\"w-3 h-3\" />\n                    </Button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </ScrollArea>\n      </PopoverContent>\n    </Popover>\n  );\n}\n","path":null,"size_bytes":7658,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1077,"size_tokens":null},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, timestamp, decimal, boolean, integer, jsonb } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\n\nexport const trades = pgTable(\"trades\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").references(() => users.id),\n  symbol: text(\"symbol\").notNull(),\n  type: text(\"type\").notNull(),\n  strategy: text(\"strategy\").notNull(),\n  entryPrice: decimal(\"entry_price\", { precision: 12, scale: 5 }).notNull(),\n  exitPrice: decimal(\"exit_price\", { precision: 12, scale: 5 }).notNull(),\n  stopLoss: decimal(\"stop_loss\", { precision: 12, scale: 5 }),\n  takeProfit: decimal(\"take_profit\", { precision: 12, scale: 5 }),\n  quantity: decimal(\"quantity\", { precision: 10, scale: 5 }).notNull(),\n  pnl: decimal(\"pnl\", { precision: 10, scale: 2 }).notNull(),\n  pnlPercent: decimal(\"pnl_percent\", { precision: 10, scale: 2 }).notNull(),\n  riskReward: text(\"risk_reward\"),\n  outcome: text(\"outcome\").notNull(),\n  timeframe: text(\"timeframe\").notNull(),\n  entryReason: text(\"entry_reason\").notNull(),\n  lesson: text(\"lesson\"),\n  signalId: varchar(\"signal_id\"),\n  entryDate: timestamp(\"entry_date\"),\n  exitDate: timestamp(\"exit_date\").notNull(),\n  duration: text(\"duration\").notNull(),\n  assetClass: text(\"asset_class\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertTradeSchema = createInsertSchema(trades).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertTrade = z.infer<typeof insertTradeSchema>;\nexport type Trade = typeof trades.$inferSelect;\n\nexport const economicEvents = pgTable(\"economic_events\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  eventType: text(\"event_type\").notNull(),\n  country: text(\"country\").notNull(),\n  countryCode: text(\"country_code\"),\n  region: text(\"region\").notNull(),\n  currency: text(\"currency\").notNull(),\n  impactLevel: text(\"impact_level\").notNull(),\n  eventTime: timestamp(\"event_time\", { withTimezone: true }).notNull(),\n  expectedValue: text(\"expected_value\"),\n  previousValue: text(\"previous_value\"),\n  actualValue: text(\"actual_value\"),\n  unit: text(\"unit\"),\n  futuresImpliedExpectation: text(\"futures_implied_expectation\"),\n  expertSentiment: text(\"expert_sentiment\"),\n  preReleaseSentiment: text(\"pre_release_sentiment\"),\n  postReleaseSentiment: text(\"post_release_sentiment\"),\n  surpriseFactor: text(\"surprise_factor\"),\n  marketImpactAnalysis: text(\"market_impact_analysis\"),\n  currencyPairImpacts: text(\"currency_pair_impacts\"),\n  stockImpacts: text(\"stock_impacts\"),\n  affectedCurrencies: text(\"affected_currencies\").array(),\n  affectedStocks: text(\"affected_stocks\").array(),\n  isReleased: boolean(\"is_released\").default(false),\n  telegramNotified: boolean(\"telegram_notified\").default(false),\n  sourceSite: text(\"source_site\"),\n  sourceUrl: text(\"source_url\"),\n  lastScraped: timestamp(\"last_scraped\").defaultNow(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertEconomicEventSchema = createInsertSchema(economicEvents).omit({\n  id: true,\n  createdAt: true,\n  lastScraped: true,\n  telegramNotified: true,\n});\n\nexport type InsertEconomicEvent = z.infer<typeof insertEconomicEventSchema>;\nexport type EconomicEvent = typeof economicEvents.$inferSelect;\n\nexport const telegramSubscribers = pgTable(\"telegram_subscribers\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  chatId: text(\"chat_id\").notNull().unique(),\n  phoneNumber: text(\"phone_number\"),\n  username: text(\"username\"),\n  firstName: text(\"first_name\"),\n  lastName: text(\"last_name\"),\n  isActive: boolean(\"is_active\").default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertTelegramSubscriberSchema = createInsertSchema(telegramSubscribers).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertTelegramSubscriber = z.infer<typeof insertTelegramSubscriberSchema>;\nexport type TelegramSubscriber = typeof telegramSubscribers.$inferSelect;\n\nexport const notifications = pgTable(\"notifications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  type: text(\"type\").notNull(),\n  title: text(\"title\").notNull(),\n  message: text(\"message\").notNull(),\n  impactLevel: text(\"impact_level\"),\n  metadata: text(\"metadata\"),\n  isRead: boolean(\"is_read\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertNotificationSchema = createInsertSchema(notifications).omit({\n  id: true,\n  createdAt: true,\n  isRead: true,\n});\n\nexport type InsertNotification = z.infer<typeof insertNotificationSchema>;\nexport type Notification = typeof notifications.$inferSelect;\n\nexport const tradingSignals = pgTable(\"trading_signals\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  symbol: text(\"symbol\").notNull(),\n  assetClass: text(\"asset_class\").notNull(),\n  type: text(\"type\").notNull(),\n  strategy: text(\"strategy\").notNull(),\n  \n  entryPrice: decimal(\"entry_price\", { precision: 12, scale: 5 }).notNull(),\n  stopLoss: decimal(\"stop_loss\", { precision: 12, scale: 5 }).notNull(),\n  takeProfit: decimal(\"take_profit\", { precision: 12, scale: 5 }).notNull(),\n  riskRewardRatio: decimal(\"risk_reward_ratio\", { precision: 5, scale: 2 }).notNull(),\n  \n  primaryTimeframe: text(\"primary_timeframe\").notNull(),\n  confirmationTimeframe: text(\"confirmation_timeframe\"),\n  executionTimeframe: text(\"execution_timeframe\"),\n  \n  overallConfidence: integer(\"overall_confidence\").notNull(),\n  \n  interestRateDiffScore: decimal(\"interest_rate_diff_score\", { precision: 5, scale: 2 }),\n  interestRateDiffValue: decimal(\"interest_rate_diff_value\", { precision: 5, scale: 2 }),\n  interestRateNotes: text(\"interest_rate_notes\"),\n  \n  inflationImpactScore: decimal(\"inflation_impact_score\", { precision: 5, scale: 2 }),\n  inflationDifferential: decimal(\"inflation_differential\", { precision: 5, scale: 2 }),\n  inflationNotes: text(\"inflation_notes\"),\n  \n  trendScore: decimal(\"trend_score\", { precision: 5, scale: 2 }),\n  trendDirection: text(\"trend_direction\"),\n  trendStrength: text(\"trend_strength\"),\n  trendTimeframes: text(\"trend_timeframes\").array(),\n  \n  smcScore: decimal(\"smc_score\", { precision: 5, scale: 2 }),\n  institutionalCandleDetected: boolean(\"institutional_candle_detected\").default(false),\n  institutionalCandleData: jsonb(\"institutional_candle_data\"),\n  orderBlockType: text(\"order_block_type\"),\n  orderBlockLevel: decimal(\"order_block_level\", { precision: 12, scale: 5 }),\n  fvgDetected: boolean(\"fvg_detected\").default(false),\n  fvgLevel: decimal(\"fvg_level\", { precision: 12, scale: 5 }),\n  liquiditySweep: boolean(\"liquidity_sweep\").default(false),\n  liquiditySweepLevel: decimal(\"liquidity_sweep_level\", { precision: 12, scale: 5 }),\n  breakerBlockDetected: boolean(\"breaker_block_detected\").default(false),\n  bocChochDetected: text(\"boc_choch_detected\"),\n  smcFactors: text(\"smc_factors\").array(),\n  \n  technicalReasons: text(\"technical_reasons\").array(),\n  marketContext: text(\"market_context\"),\n  \n  status: text(\"status\").notNull().default('active'),\n  strength: text(\"strength\"),\n  zonesTested: integer(\"zones_tested\").default(0),\n  \n  expiresAt: timestamp(\"expires_at\"),\n  executedAt: timestamp(\"executed_at\"),\n  invalidatedAt: timestamp(\"invalidated_at\"),\n  \n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertTradingSignalSchema = createInsertSchema(tradingSignals).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertTradingSignal = z.infer<typeof insertTradingSignalSchema>;\nexport type TradingSignal = typeof tradingSignals.$inferSelect;\n\nexport const pendingSetups = pgTable(\"pending_setups\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  symbol: text(\"symbol\").notNull(),\n  assetClass: text(\"asset_class\").notNull(),\n  type: text(\"type\").notNull(),\n  \n  setupStage: text(\"setup_stage\").notNull(),\n  \n  potentialStrategy: text(\"potential_strategy\"),\n  currentPrice: decimal(\"current_price\", { precision: 12, scale: 5 }).notNull(),\n  \n  primaryTimeframe: text(\"primary_timeframe\").notNull(),\n  confirmationTimeframe: text(\"confirmation_timeframe\"),\n  \n  interestRateBias: text(\"interest_rate_bias\"),\n  inflationBias: text(\"inflation_bias\"),\n  trendBias: text(\"trend_bias\"),\n  \n  chochDetected: boolean(\"choch_detected\").default(false),\n  chochDirection: text(\"choch_direction\"),\n  liquiditySweepDetected: boolean(\"liquidity_sweep_detected\").default(false),\n  supplyDemandZoneTargeted: boolean(\"supply_demand_zone_targeted\").default(false),\n  zoneLevel: decimal(\"zone_level\", { precision: 12, scale: 5 }),\n  zoneMitigated: boolean(\"zone_mitigated\").default(false),\n  \n  levelsBroken: integer(\"levels_broken\").default(0),\n  confirmationsPending: text(\"confirmations_pending\").array(),\n  \n  setupNotes: text(\"setup_notes\").array(),\n  marketContext: text(\"market_context\"),\n  \n  lastCheckedPrice: decimal(\"last_checked_price\", { precision: 12, scale: 5 }),\n  lastCheckedAt: timestamp(\"last_checked_at\").defaultNow(),\n  \n  readyForSignal: boolean(\"ready_for_signal\").default(false),\n  invalidated: boolean(\"invalidated\").default(false),\n  invalidationReason: text(\"invalidation_reason\"),\n  \n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertPendingSetupSchema = createInsertSchema(pendingSetups).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertPendingSetup = z.infer<typeof insertPendingSetupSchema>;\nexport type PendingSetup = typeof pendingSetups.$inferSelect;\n","path":null,"size_bytes":10156,"size_tokens":null},"client/src/components/MarketOverview.tsx":{"content":"import { Badge } from '@/components/ui/badge';\nimport { TrendingUp, TrendingDown, Activity, AlertTriangle, BarChart3, Calendar } from 'lucide-react';\n\ninterface WatchlistItem {\n  symbol: string;\n  name: string;\n  price: number;\n  change: number;\n  changePercent: number;\n  category: 'forex' | 'stocks' | 'crypto';\n  watchReason: 'technical' | 'fundamental' | 'news';\n  reasoning: string;\n  priority: 'high' | 'medium' | 'low';\n  keyLevel: number;\n  timeframe: string;\n}\n\nexport default function MarketOverview() {\n  // TODO: Remove mock data - replace with real watchlist data\n  const watchlistData: WatchlistItem[] = [\n    {\n      symbol: 'EUR/USD',\n      name: 'Euro / US Dollar',\n      price: 1.0845,\n      change: 0.0012,\n      changePercent: 0.11,\n      category: 'forex',\n      watchReason: 'technical',\n      reasoning: 'Approaching key resistance at 1.0870, potential breakout setup',\n      priority: 'high',\n      keyLevel: 1.0870,\n      timeframe: '4H'\n    },\n    {\n      symbol: 'GBP/USD',\n      name: 'British Pound / US Dollar',\n      price: 1.2678,\n      change: -0.0045,\n      changePercent: -0.35,\n      category: 'forex',\n      watchReason: 'fundamental',\n      reasoning: 'BoE policy decision tomorrow, volatility expected',\n      priority: 'high',\n      keyLevel: 1.2650,\n      timeframe: '1D'\n    },\n    {\n      symbol: 'USD/JPY',\n      name: 'US Dollar / Japanese Yen',\n      price: 150.25,\n      change: 0.85,\n      changePercent: 0.57,\n      category: 'forex',\n      watchReason: 'news',\n      reasoning: 'BoJ intervention risk above 150.50 level',\n      priority: 'medium',\n      keyLevel: 150.50,\n      timeframe: '1H'\n    },\n    {\n      symbol: 'AAPL',\n      name: 'Apple Inc.',\n      price: 185.92,\n      change: 2.15,\n      changePercent: 1.17,\n      category: 'stocks',\n      watchReason: 'technical',\n      reasoning: 'Breaking above 50MA, momentum building',\n      priority: 'medium',\n      keyLevel: 188.00,\n      timeframe: '1D'\n    },\n    {\n      symbol: 'BTC/USD',\n      name: 'Bitcoin',\n      price: 43250,\n      change: 850,\n      changePercent: 2.01,\n      category: 'crypto',\n      watchReason: 'technical',\n      reasoning: 'Testing major resistance zone, high volume confirmation',\n      priority: 'high',\n      keyLevel: 44000,\n      timeframe: '4H'\n    },\n    {\n      symbol: 'GOLD',\n      name: 'Gold Spot',\n      price: 2035.50,\n      change: -12.30,\n      changePercent: -0.60,\n      category: 'forex',\n      watchReason: 'fundamental',\n      reasoning: 'Fed dovish pivot expectations, safe haven demand',\n      priority: 'medium',\n      keyLevel: 2050.00,\n      timeframe: '1D'\n    }\n  ];\n\n  const getCategoryBadgeColor = (category: string) => {\n    switch(category) {\n      case 'forex': return 'hsl(210 100% 60%)';\n      case 'stocks': return 'hsl(120 60% 50%)';\n      case 'crypto': return 'hsl(45 90% 60%)';\n      default: return '';\n    }\n  };\n\n  const getReasonIcon = (reason: string) => {\n    switch(reason) {\n      case 'technical': return <BarChart3 className=\"w-3 h-3\" />;\n      case 'fundamental': return <Activity className=\"w-3 h-3\" />;\n      case 'news': return <Calendar className=\"w-3 h-3\" />;\n      default: return null;\n    }\n  };\n\n  const getPriorityColor = (priority: string) => {\n    switch(priority) {\n      case 'high': return 'hsl(0 75% 60%)';\n      case 'medium': return 'hsl(45 90% 60%)';\n      case 'low': return 'hsl(120 60% 50%)';\n      default: return '';\n    }\n  };\n\n  const formatPrice = (price: number, symbol: string) => {\n    if (symbol.includes('/') || symbol === 'GOLD') {\n      return price < 10 ? price.toFixed(4) : price.toFixed(2);\n    }\n    return price.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });\n  };\n\n  return (\n    <div data-testid=\"card-market-overview\" className=\"bg-white dark:bg-background\">\n      <div className=\"pb-4 mb-4 border-b border-border/50\">\n        <div className=\"flex items-center gap-2 text-lg font-semibold\">\n          <Activity className=\"w-5 h-5\" />\n          Instruments to Watch\n        </div>\n      </div>\n      <div>\n        <div className=\"divide-y divide-border/50\">\n          {watchlistData.map((item) => (\n            <div\n              key={item.symbol}\n              className=\"py-4 hover-elevate transition-colors\"\n              data-testid={`card-watchlist-${item.symbol.replace('/', '-')}`}\n            >\n              <div className=\"flex items-start justify-between mb-2\">\n                <div className=\"flex items-center gap-3 ml-2\">\n                  <Badge \n                    variant=\"secondary\"\n                    className=\"text-xs font-medium\"\n                    style={{ backgroundColor: getCategoryBadgeColor(item.category) + '20', color: getCategoryBadgeColor(item.category) }}\n                  >\n                    {item.category.toUpperCase()}\n                  </Badge>\n                  <div>\n                    <div className=\"font-semibold text-sm\" data-testid={`text-symbol-${item.symbol.replace('/', '-')}`}>\n                      {item.symbol}\n                    </div>\n                    <div className=\"text-xs text-muted-foreground\">\n                      {item.timeframe}  Key: {formatPrice(item.keyLevel, item.symbol)}\n                    </div>\n                  </div>\n                </div>\n                \n                <div className=\"flex items-center gap-2 mr-2\">\n                  <Badge \n                    variant=\"outline\"\n                    className=\"text-xs\"\n                    style={{ borderColor: getPriorityColor(item.priority), color: getPriorityColor(item.priority) }}\n                  >\n                    {item.priority === 'high' && <AlertTriangle className=\"w-3 h-3 mr-1\" />}\n                    {item.priority.toUpperCase()}\n                  </Badge>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center justify-between mb-2 ml-2\">\n                <div className=\"text-left\">\n                  <div className=\"font-mono font-semibold text-sm\" data-testid={`text-price-${item.symbol.replace('/', '-')}`}>\n                    {formatPrice(item.price, item.symbol)}\n                  </div>\n                  <div className=\"flex items-center gap-1 text-xs\">\n                    {item.change > 0 ? (\n                      <TrendingUp className=\"w-3 h-3 text-green-500\" />\n                    ) : (\n                      <TrendingDown className=\"w-3 h-3 text-red-500\" />\n                    )}\n                    <span className={`font-mono ${item.change > 0 ? 'text-green-500' : 'text-red-500'}`}>\n                      {item.change > 0 ? '+' : ''}{item.changePercent.toFixed(2)}%\n                    </span>\n                  </div>\n                </div>\n              </div>\n              \n              <div className=\"flex items-start gap-2 text-xs ml-2\">\n                <div className=\"flex items-center gap-1\">\n                  {getReasonIcon(item.watchReason)}\n                  <Badge variant=\"secondary\" className=\"text-xs\">\n                    {item.watchReason.toUpperCase()}\n                  </Badge>\n                </div>\n                <div className=\"flex-1 text-muted-foreground\">\n                  {item.reasoning}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":7348,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        trading: {\n          profit: \"120 60% 50%\",\n          loss: \"0 75% 60%\",\n          warning: \"45 90% 60%\",\n          neutral: \"210 10% 70%\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n        session: {\n          london: \"120 60% 50%\",\n          newyork: \"210 100% 60%\",\n          tokyo: \"45 90% 60%\",\n          sydney: \"280 85% 70%\",\n          closed: \"210 10% 50%\",\n        },\n        \"primary-accent\": \"#e75518\",\n        \"bull-green\": \"#10b981\",\n        \"bear-red\": \"#ef4444\",\n      },\n      fontFamily: {\n        sans: [\"Poppins\", \"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"JetBrains Mono\", \"var(--font-mono)\"],\n      },\n      spacing: {\n        '18': '4.5rem',\n        '22': '5.5rem',\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","path":null,"size_bytes":4608,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":261,"size_tokens":null},"client/src/components/Footer.tsx":{"content":"import { Link } from 'wouter';\nimport { Facebook, Instagram, Send } from 'lucide-react';\n\nexport default function Footer() {\n  return (\n    <footer className=\"bg-gray-100 dark:bg-gray-900 text-gray-700 dark:text-gray-300 border-t border-gray-300 dark:border-gray-700 mt-12\" style={{ fontFamily: \"'Montserrat', sans-serif\" }}>\n      <div className=\"max-w-7xl mx-auto px-6 py-12 md:py-16\">\n\n        {/* Grid Layout for Links */}\n        <div className=\"grid grid-cols-2 gap-y-10 gap-x-6 sm:grid-cols-4 lg:grid-cols-6 xl:gap-x-8\">\n\n          {/* Column 1: Markets & Data */}\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Markets & Data</h3>\n            <ul role=\"list\" className=\"space-y-3\">\n              <li><Link href=\"/\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Major Pairs</Link></li>\n              <li><Link href=\"/stocks\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Stocks & Equities</Link></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Commodities</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Crypto Currencies</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">High Impact News</a></li>\n            </ul>\n          </div>\n\n          {/* Column 2: Platform */}\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Platform</h3>\n            <ul role=\"list\" className=\"space-y-3\">\n              <li><Link href=\"/signals\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Signals & Alerts</Link></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Trading Strategies</a></li>\n              <li><Link href=\"/analytics\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Analytics</Link></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">API Access</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Documentation</a></li>\n            </ul>\n          </div>\n\n          {/* Column 3: Company */}\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Company</h3>\n            <ul role=\"list\" className=\"space-y-3\">\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">About Us</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Careers (We're Hiring)</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Our Team</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Blog</a></li>\n            </ul>\n          </div>\n\n          {/* Column 4: Partners */}\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Partners</h3>\n            <ul role=\"list\" className=\"space-y-3\">\n              {/* Add future partner links here */}\n            </ul>\n          </div>\n\n          {/* Column 5: Legal & Support */}\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Legal & Support</h3>\n            <ul role=\"list\" className=\"space-y-3\">\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Terms of Service</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Privacy Policy</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Risk Disclaimer</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Contact Us</a></li>\n            </ul>\n          </div>\n\n          {/* Column 6: Branding & Social */}\n          <div className=\"col-span-2 sm:col-span-4 lg:col-span-1 border-t sm:border-t-0 pt-6 sm:pt-0 border-gray-300 lg:border-none\">\n            <div className=\"flex flex-wrap items-center mb-3\">\n              <span className=\"text-base font-extrabold text-gray-900\">F</span>\n              <span className=\"text-base font-extrabold text-emerald-500\">S</span>\n              <span className=\"text-base font-extrabold text-gray-900\">D</span>\n              <span className=\"text-base font-extrabold text-emerald-500\">ZONES</span>\n              <span className=\"text-base font-extrabold text-gray-900\">.com</span>\n            </div>\n            <p className=\"text-xs text-gray-500 mb-6\">Less Charting. No worries. Only precision.</p>\n            \n            {/* Social Media Icons */}\n            <div className=\"flex space-x-5 items-center\">\n              \n              {/* Facebook */}\n              <a href=\"#\" className=\"text-[#1877F2] hover:opacity-80 transition duration-150\" aria-label=\"Facebook\">\n                <Facebook className=\"w-6 h-6\" fill=\"currentColor\" />\n              </a>\n              \n              {/* Instagram */}\n              <a href=\"#\" className=\"text-[#DD2A7B] hover:opacity-80 transition duration-150\" aria-label=\"Instagram\">\n                <Instagram className=\"w-6 h-6\" />\n              </a>\n              \n              {/* Telegram */}\n              <a href=\"#\" className=\"text-[#26A5E4] hover:opacity-80 transition duration-150\" aria-label=\"Telegram\">\n                <Send className=\"w-6 h-6\" fill=\"currentColor\" />\n              </a>\n              \n              {/* TikTok */}\n              <a href=\"#\" className=\"hover:opacity-80 transition duration-150\" aria-label=\"TikTok\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                  <path fill=\"#010101\" d=\"M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z\"/>\n                </svg>\n              </a>\n            </div>\n          </div>\n\n        </div>\n\n        {/* Separator Line */}\n        <div className=\"mt-12 mb-8 border-t border-gray-300\"></div>\n\n        {/* Copyright */}\n        <div className=\"text-center\">\n          <p className=\"text-sm text-gray-600\">\n            &copy; 2025 <span className=\"font-extrabold text-gray-900\">F</span>\n            <span className=\"font-extrabold text-emerald-500\">S</span>\n            <span className=\"font-extrabold text-gray-900\">D</span>\n            <span className=\"font-extrabold text-emerald-500\">ZONES</span>\n            <span className=\"font-extrabold text-gray-900\">.com</span>. All rights reserved.\n          </p>\n        </div>\n\n      </div>\n    </footer>\n  );\n}\n","path":null,"size_bytes":7049,"size_tokens":null},"client/src/components/StockSignalCard.tsx":{"content":"import { useState } from 'react';\nimport { \n  Clock,\n  Target,\n  TrendingUp,\n  TrendingDown,\n  Shield,\n  BarChart2\n} from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\nimport type { TradingSignal } from '@shared/schema';\nimport { LivePriceWithEntry } from './LivePriceDisplay';\n\nconst formatTimeAgo = (timestamp: Date | string) => {\n  const now = new Date();\n  const created = new Date(timestamp);\n  const diffMs = now.getTime() - created.getTime();\n  const diffMins = Math.floor(diffMs / (1000 * 60));\n  \n  if (diffMins < 1) return 'Just now';\n  if (diffMins < 60) return `${diffMins}m ago`;\n  \n  const diffHours = Math.floor(diffMins / 60);\n  if (diffHours < 24) return `${diffHours}h ago`;\n  \n  const diffDays = Math.floor(diffHours / 24);\n  return `${diffDays}d ago`;\n};\n\ninterface StockSignalCardProps {\n  signal: TradingSignal;\n  isWatchlist?: boolean;\n}\n\nconst getAssetClassForSymbol = (symbol: string, assetClass?: string): 'stock' | 'forex' | 'commodity' | 'crypto' => {\n  if (assetClass === 'crypto' || assetClass === 'cryptocurrency') return 'crypto';\n  if (assetClass === 'commodity' || assetClass === 'commodities') return 'commodity';\n  if (assetClass === 'forex' || assetClass === 'currency') return 'forex';\n  if (assetClass === 'stock' || assetClass === 'stocks') return 'stock';\n  \n  if (symbol.includes('/USD') && ['BTC', 'ETH', 'BNB', 'SOL', 'XRP'].some(c => symbol.startsWith(c))) return 'crypto';\n  if (symbol.includes('/')) return 'forex';\n  if (['XAU', 'XAG', 'WTI', 'BRENT', 'GOLD', 'SILVER', 'OIL'].some(c => symbol.includes(c))) return 'commodity';\n  \n  return 'stock';\n};\n\nexport default function StockSignalCard({ signal, isWatchlist = false }: StockSignalCardProps) {\n  const [isExpanded, setIsExpanded] = useState(false);\n  \n  const isBuy = signal.type?.toLowerCase() === 'buy';\n  const assetClass = getAssetClassForSymbol(signal.symbol, signal.assetClass);\n  const TrendIcon = isBuy ? TrendingUp : TrendingDown;\n  const trendColor = isBuy ? 'text-emerald-500 dark:text-emerald-400' : 'text-rose-500 dark:text-rose-400';\n  const winRateColor = (signal.overallConfidence ?? 0) >= 90 \n    ? 'text-emerald-600 dark:text-emerald-400' \n    : (signal.overallConfidence ?? 0) >= 80 ? 'text-amber-600 dark:text-amber-400' : 'text-muted-foreground';\n\n  const entryPrice = signal.entryPrice?.toString() || '';\n  const stopLoss = signal.stopLoss?.toString() || '';\n  const takeProfit = signal.takeProfit?.toString() || '';\n  const riskRewardRatio = signal.riskRewardRatio?.toString() || '';\n  \n  const hasCompleteData = entryPrice !== '' && entryPrice !== 'N/A';\n  \n  const borderColor = isWatchlist \n    ? 'hsl(45 93% 47%)' \n    : (isBuy ? 'hsl(var(--chart-1))' : 'hsl(var(--chart-5))');\n\n  return (\n    <div \n      className={`bg-card border border-border relative transition-all ${isWatchlist ? 'opacity-90' : ''}`}\n      style={{ borderLeftWidth: '6px', borderLeftColor: borderColor }}\n      data-testid={`card-stock-${signal.id}`}\n    >\n      {/* Header Row: Badge + Symbol + Entry Price - Click to expand details */}\n      <div \n        className=\"flex items-center justify-between gap-2 p-4 pb-3 cursor-pointer hover:opacity-80 transition duration-200\"\n        onClick={() => setIsExpanded(!isExpanded)}\n        data-testid={`clickable-header-${signal.id}`}\n      >\n        <div className=\"flex items-center gap-3\">\n          <Badge \n            variant={isBuy ? 'default' : 'destructive'} \n            className=\"px-3 py-1 text-xs font-bold uppercase tracking-wider\"\n            data-testid={`badge-type-${signal.id}`}\n          >\n            {signal.type}\n          </Badge>\n          <div className=\"flex items-center gap-2 group\">\n            <h3 className=\"text-lg sm:text-xl font-extrabold text-foreground tracking-tight group-hover:underline\" data-testid={`text-symbol-${signal.id}`}>\n              {signal.symbol}\n            </h3>\n            <TrendIcon className={`w-5 h-5 ${trendColor}`} />\n          </div>\n        </div>\n        {hasCompleteData && (\n          <div className=\"text-right\">\n            <span className=\"text-[10px] uppercase text-muted-foreground block\">Entry</span>\n            <span className=\"text-sm font-bold tabular-nums\">{entryPrice}</span>\n          </div>\n        )}\n      </div>\n\n      {/* Current Price Section */}\n      {hasCompleteData ? (\n        <div className=\"px-4 pb-3\">\n          <LivePriceWithEntry \n            symbol={signal.symbol}\n            assetClass={assetClass}\n            entryPrice={signal.entryPrice}\n            signalType={signal.type}\n          />\n        </div>\n      ) : (\n        <div className=\"px-4 pb-3 text-sm font-medium text-amber-600 dark:text-amber-400\">\n          Waiting for activation price.\n        </div>\n      )}\n\n      {/* Divider */}\n      <div className=\"border-t border-border mx-4\" />\n\n      {/* Trade Levels: Stop | Target | R:R */}\n      {hasCompleteData && (\n        <div className=\"grid grid-cols-3 gap-2 px-4 py-3 text-center\">\n          <div>\n            <span className=\"text-[10px] uppercase text-muted-foreground block mb-1\">Stop</span>\n            <span className=\"text-sm font-semibold text-destructive tabular-nums\">{stopLoss}</span>\n          </div>\n          <div>\n            <span className=\"text-[10px] uppercase text-muted-foreground block mb-1\">Target</span>\n            <span className=\"text-sm font-semibold text-emerald-600 dark:text-emerald-400 tabular-nums\">{takeProfit}</span>\n          </div>\n          <div>\n            <span className=\"text-[10px] uppercase text-muted-foreground block mb-1\">R:R</span>\n            <span className=\"text-base font-extrabold tabular-nums\">{riskRewardRatio}</span>\n          </div>\n        </div>\n      )}\n\n      {/* Divider */}\n      <div className=\"border-t border-border mx-4\" />\n\n      {/* Footer: Timeframe + Time */}\n      <div className=\"px-4 py-3\">\n        <div className=\"flex items-center justify-between text-xs text-muted-foreground\">\n          <span className=\"font-bold uppercase\">{signal.primaryTimeframe || '4H'}</span>\n          {signal.createdAt && (\n            <span className=\"flex items-center gap-1\" data-testid={`time-ago-${signal.id}`}>\n              <Clock className=\"w-3 h-3\" />\n              {formatTimeAgo(signal.createdAt)}\n            </span>\n          )}\n        </div>\n      </div>\n\n      {/* Expanded Details Section */}\n      {isExpanded && (\n        <div className=\"px-4 pb-4 pt-2 border-t border-border animate-in fade-in duration-200\">\n          <div className=\"space-y-4\">\n            {/* Market Context */}\n            {signal.marketContext && (\n              <div className=\"space-y-1\">\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <TrendingUp className=\"w-3 h-3\" /> Market Context\n                </h4>\n                <p className=\"text-sm\">{signal.marketContext}</p>\n              </div>\n            )}\n\n            {/* Technical Reasons */}\n            {signal.technicalReasons && signal.technicalReasons.length > 0 && (\n              <div className=\"space-y-1\">\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <Target className=\"w-3 h-3\" /> Technical Reasons\n                </h4>\n                <ul className=\"text-sm space-y-1\">\n                  {signal.technicalReasons.map((reason: string, idx: number) => (\n                    <li key={idx} className=\"flex items-start gap-2\">\n                      <span className=\"text-blue-500\"></span>\n                      <span>{reason}</span>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            {/* SMC Factors */}\n            {signal.smcFactors && signal.smcFactors.length > 0 && (\n              <div className=\"space-y-1\">\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <Shield className=\"w-3 h-3\" /> SMC Factors\n                </h4>\n                <ul className=\"text-sm space-y-1\">\n                  {signal.smcFactors.map((factor: string, idx: number) => (\n                    <li key={idx} className=\"flex items-start gap-2\">\n                      <span className=\"text-blue-500\"></span>\n                      <span>{factor}</span>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            {/* Additional Stats */}\n            <div className=\"space-y-1\">\n              <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                <BarChart2 className=\"w-3 h-3\" /> Signal Stats\n              </h4>\n              <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                {signal.overallConfidence && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Confidence:</span>\n                    <span className={`ml-1 font-semibold ${winRateColor}`}>{signal.overallConfidence}%</span>\n                  </div>\n                )}\n                {signal.trendStrength && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Trend:</span>\n                    <span className=\"ml-1 font-semibold\">{signal.trendStrength}</span>\n                  </div>\n                )}\n                {signal.trendDirection && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Direction:</span>\n                    <span className=\"ml-1 font-semibold\">{signal.trendDirection}</span>\n                  </div>\n                )}\n                {signal.riskRewardRatio && (\n                  <div>\n                    <span className=\"text-muted-foreground\">R:R:</span>\n                    <span className=\"ml-1 font-semibold\">{signal.riskRewardRatio}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":10024,"size_tokens":null},"client/src/components/SignalCard.tsx":{"content":"import { useState } from 'react';\nimport { \n  Clock,\n  Target,\n  TrendingUp,\n  Shield,\n  BarChart2\n} from 'lucide-react';\nimport type { TradingSignal } from '@shared/schema';\nimport { LivePriceWithEntry } from './LivePriceDisplay';\n\nconst formatTimeAgo = (timestamp: Date | string): string => {\n  const now = new Date();\n  const created = new Date(timestamp);\n  const diffMs = now.getTime() - created.getTime();\n  const diffMins = Math.floor(diffMs / (1000 * 60));\n  \n  if (diffMins < 1) return 'Just now';\n  if (diffMins < 60) return `${diffMins}m ago`;\n  \n  const diffHours = Math.floor(diffMins / 60);\n  if (diffHours < 24) return `${diffHours}h ago`;\n  \n  const diffDays = Math.floor(diffHours / 24);\n  return `${diffDays}d ago`;\n};\n\nconst formatPrice = (price: number | string | null | undefined): string => {\n  if (price === null || price === undefined) return '';\n  const num = typeof price === 'string' ? parseFloat(price) : price;\n  if (isNaN(num)) return '';\n  return num.toFixed(4);\n};\n\ninterface SignalCardProps {\n  signal: TradingSignal;\n  isWatchlist?: boolean;\n}\n\nconst getAssetClassForSymbol = (symbol: string, assetClass?: string): 'stock' | 'forex' | 'commodity' | 'crypto' => {\n  if (assetClass === 'crypto' || assetClass === 'cryptocurrency') return 'crypto';\n  if (assetClass === 'commodity' || assetClass === 'commodities') return 'commodity';\n  if (assetClass === 'forex' || assetClass === 'currency') return 'forex';\n  if (assetClass === 'stock' || assetClass === 'stocks' || assetClass === 'index') return 'stock';\n  \n  if (symbol.includes('/USD') && ['BTC', 'ETH', 'BNB', 'SOL', 'XRP'].some(c => symbol.startsWith(c))) return 'crypto';\n  if (symbol.includes('/')) return 'forex';\n  if (['XAU', 'XAG', 'WTI', 'BRENT', 'GOLD', 'SILVER', 'OIL'].some(c => symbol.includes(c))) return 'commodity';\n  \n  return 'stock';\n};\n\nexport default function SignalCard({ signal, isWatchlist = false }: SignalCardProps) {\n  const [isExpanded, setIsExpanded] = useState(false);\n  \n  const isBuy = signal.type?.toLowerCase() === 'buy';\n  const assetClass = getAssetClassForSymbol(signal.symbol, signal.assetClass);\n  const winRateColor = (signal.overallConfidence ?? 0) >= 90 \n    ? 'text-emerald-600 dark:text-emerald-400' \n    : (signal.overallConfidence ?? 0) >= 80 ? 'text-amber-600 dark:text-amber-400' : 'text-muted-foreground';\n\n  const entryPrice = signal.entryPrice?.toString() || '';\n  const hasCompleteData = entryPrice !== '' && entryPrice !== 'N/A';\n\n  // P&L Calculation\n  let pnlPercentage = 0;\n  let isProfitable = false;\n  let pnlText = \"--.--\";\n\n  if (signal.entryPrice && Number(signal.entryPrice) > 0) {\n    // P&L will be calculated in real-time by LivePriceWithEntry component\n    pnlText = \"--.--\"; // Placeholder - actual P&L shown in component\n  }\n\n  // Determine styles for Net Gain based on profitability\n  const pnlBgClass = isProfitable ? 'bg-green-50/50 dark:bg-green-950/30' : 'bg-muted/50';\n  const pnlTextClass = isProfitable ? 'text-green-600 dark:text-green-400' : 'text-muted-foreground';\n  const pnlBorderClass = isProfitable ? 'border-l-4 border-green-500' : 'border-l-4 border-muted-foreground/40';\n\n  return (\n    <div \n      className={`p-6 sm:p-8 space-y-6 ${isWatchlist ? 'opacity-90' : ''}`}\n      data-testid={`card-signal-${signal.id}`}\n    >\n      {/* Header Section: Action, Pair, and Entry */}\n      <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center pb-4 gap-3\">\n        {/* Clickable Area (Action + Pair) - clicking toggles details */}\n        <div \n          id={`pair-header-${signal.id}`}\n          className=\"group flex items-center gap-3 cursor-pointer hover:opacity-80 transition duration-200\"\n          onClick={() => setIsExpanded(!isExpanded)}\n          data-testid={`clickable-header-${signal.id}`}\n        >\n          {/* Action Indicator */}\n          <span \n            className={`inline-flex items-center px-3 py-1 text-sm font-semibold text-white shadow-md ${\n              isBuy ? 'bg-emerald-600' : 'bg-red-600'\n            }`}\n            data-testid={`badge-type-${signal.id}`}\n          >\n            {signal.type}\n          </span>\n          {/* Trading Pair */}\n          <h1 \n            className=\"text-lg sm:text-xl font-extrabold text-foreground tracking-tight group-hover:underline\"\n            data-testid={`text-symbol-${signal.id}`}\n          >\n            {signal.symbol}\n          </h1>\n        </div>\n        \n        {/* Entry Status */}\n        {hasCompleteData && (\n          <div className=\"text-right\">\n            <p className=\"text-xs font-semibold text-muted-foreground uppercase\">Entry</p>\n            <p className=\"text-lg font-bold text-foreground\">{entryPrice}</p>\n          </div>\n        )}\n      </div>\n\n      {/* Current Price and Timeframe Bar */}\n      <div className=\"border-y border-border py-4 flex flex-col sm:flex-row justify-between items-start sm:items-end gap-4\">\n        {/* Current Price */}\n        <div>\n          <p className=\"text-sm font-semibold text-muted-foreground uppercase mb-1\">Current Price</p>\n          {hasCompleteData ? (\n            <LivePriceWithEntry \n              symbol={signal.symbol}\n              assetClass={assetClass}\n              entryPrice={signal.entryPrice}\n              signalType={signal.type}\n            />\n          ) : (\n            <p className=\"text-lg font-bold text-foreground\">---</p>\n          )}\n        </div>\n        {/* Timeframe and Age */}\n        <div className=\"flex items-center gap-3 text-sm font-medium text-muted-foreground\">\n          <span className=\"px-2 py-0.5 bg-muted text-foreground rounded text-xs font-mono font-semibold\">\n            {signal.primaryTimeframe || '4H'}\n          </span>\n          {signal.createdAt && (\n            <span className=\"flex items-center\" data-testid={`time-ago-${signal.id}`}>\n              <Clock className=\"w-4 h-4 mr-1 text-muted-foreground\" />\n              {formatTimeAgo(signal.createdAt)}\n            </span>\n          )}\n        </div>\n      </div>\n\n      {/* Metrics Grid: Stop, Target, R.R., Net Gain */}\n      {hasCompleteData && (\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 pt-4\">\n          {/* Stop Price */}\n          <div className=\"p-4 bg-red-50/50 dark:bg-red-950/30 rounded-lg border-l-4 border-red-500 shadow-sm\">\n            <p className=\"text-xs font-semibold text-muted-foreground uppercase mb-1\">Stop</p>\n            <p className=\"text-lg font-bold text-red-600 dark:text-red-400 truncate tabular-nums\">\n              {formatPrice(signal.stopLoss)}\n            </p>\n          </div>\n\n          {/* Target Price */}\n          <div className=\"p-4 bg-green-50/50 dark:bg-green-950/30 rounded-lg border-l-4 border-green-500 shadow-sm\">\n            <p className=\"text-xs font-semibold text-muted-foreground uppercase mb-1\">Target</p>\n            <p className=\"text-lg font-bold text-green-600 dark:text-green-400 truncate tabular-nums\">\n              {formatPrice(signal.takeProfit)}\n            </p>\n          </div>\n\n          {/* Risk/Reward Ratio */}\n          <div className=\"p-4 bg-indigo-50/50 dark:bg-indigo-950/30 rounded-lg col-span-2 md:col-span-1 border-l-4 border-indigo-500 shadow-sm\">\n            <p className=\"text-xs font-semibold text-muted-foreground uppercase mb-1\">R.R.</p>\n            <p className=\"text-2xl font-extrabold text-indigo-700 dark:text-indigo-400 tabular-nums\">\n              {signal.riskRewardRatio?.toString() || ''}\n            </p>\n          </div>\n\n          {/* Net Gain */}\n          <div className={`p-4 rounded-lg col-span-2 md:col-span-1 ${pnlBgClass} ${pnlBorderClass} shadow-sm`}>\n            <p className=\"text-xs font-semibold text-muted-foreground uppercase mb-1\">Net Gain</p>\n            <p className={`text-lg font-bold ${pnlTextClass}`}>\n              {pnlText}\n            </p>\n          </div>\n        </div>\n      )}\n\n      {/* No entry data message */}\n      {!hasCompleteData && (\n        <div className=\"text-sm font-medium text-amber-600 dark:text-amber-400 py-2\">\n          Bias awaiting confirmation or entry.\n        </div>\n      )}\n\n      {/* Expanded Details Section - shown when clicking on the instrument */}\n      {isExpanded && (\n        <div className=\"pt-4 border-t border-border animate-in fade-in duration-200\">\n          <div className=\"space-y-4\">\n            {/* Market Context */}\n            {signal.marketContext && (\n              <div className=\"space-y-1\">\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <TrendingUp className=\"w-3 h-3\" /> Market Context\n                </h4>\n                <p className=\"text-sm\">{signal.marketContext}</p>\n              </div>\n            )}\n\n            {/* Technical Reasons */}\n            {signal.technicalReasons && signal.technicalReasons.length > 0 && (\n              <div className=\"space-y-1\">\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <Target className=\"w-3 h-3\" /> Technical Reasons\n                </h4>\n                <ul className=\"text-sm space-y-1\">\n                  {signal.technicalReasons.map((reason: string, idx: number) => (\n                    <li key={idx} className=\"flex items-start gap-2\">\n                      <span className=\"text-blue-500\"></span>\n                      <span>{reason}</span>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            {/* SMC Factors */}\n            {signal.smcFactors && signal.smcFactors.length > 0 && (\n              <div className=\"space-y-1\">\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <Shield className=\"w-3 h-3\" /> SMC Factors\n                </h4>\n                <ul className=\"text-sm space-y-1\">\n                  {signal.smcFactors.map((factor: string, idx: number) => (\n                    <li key={idx} className=\"flex items-start gap-2\">\n                      <span className=\"text-blue-500\"></span>\n                      <span>{factor}</span>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            {/* Additional Stats */}\n            <div className=\"space-y-1\">\n              <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                <BarChart2 className=\"w-3 h-3\" /> Signal Stats\n              </h4>\n              <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                {signal.overallConfidence && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Confidence:</span>\n                    <span className={`ml-1 font-semibold ${winRateColor}`}>{signal.overallConfidence}%</span>\n                  </div>\n                )}\n                {signal.trendStrength && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Trend:</span>\n                    <span className=\"ml-1 font-semibold\">{signal.trendStrength}</span>\n                  </div>\n                )}\n                {signal.trendDirection && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Direction:</span>\n                    <span className=\"ml-1 font-semibold\">{signal.trendDirection}</span>\n                  </div>\n                )}\n                {signal.orderBlockType && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Order Block:</span>\n                    <span className=\"ml-1 font-semibold\">{signal.orderBlockType}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":11841,"size_tokens":null},"client/src/components/WatchlistCard.tsx":{"content":"import { useState } from 'react';\nimport { \n  Clock,\n  ChevronUp,\n  ChevronDown,\n  Target,\n  TrendingUp,\n  Shield,\n  BarChart2\n} from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\nimport type { PendingSetup } from '@shared/schema';\nimport LivePriceDisplay from './LivePriceDisplay';\n\nconst formatTimeAgo = (timestamp: Date | string) => {\n  const now = new Date();\n  const created = new Date(timestamp);\n  const diffMs = now.getTime() - created.getTime();\n  const diffMins = Math.floor(diffMs / (1000 * 60));\n  \n  if (diffMins < 1) return 'Just now';\n  if (diffMins < 60) return `${diffMins}m ago`;\n  \n  const diffHours = Math.floor(diffMins / 60);\n  if (diffHours < 24) return `${diffHours}h ago`;\n  \n  const diffDays = Math.floor(diffHours / 24);\n  return `${diffDays}d ago`;\n};\n\ninterface WatchlistCardProps {\n  item: PendingSetup;\n  showProbability?: boolean;\n}\n\nconst getAssetClassForSymbol = (symbol: string, assetClass?: string): 'stock' | 'forex' | 'commodity' | 'crypto' => {\n  if (assetClass === 'crypto' || assetClass === 'cryptocurrency') return 'crypto';\n  if (assetClass === 'commodity' || assetClass === 'commodities') return 'commodity';\n  if (assetClass === 'forex' || assetClass === 'currency') return 'forex';\n  if (assetClass === 'stock' || assetClass === 'stocks') return 'stock';\n  \n  if (symbol.includes('/USD') && ['BTC', 'ETH', 'BNB', 'SOL', 'XRP'].some(c => symbol.startsWith(c))) return 'crypto';\n  if (symbol.includes('/')) return 'forex';\n  if (['XAU', 'XAG', 'WTI', 'BRENT', 'GOLD', 'SILVER', 'OIL'].some(c => symbol.includes(c))) return 'commodity';\n  \n  return 'stock';\n};\n\nexport default function WatchlistCard({ item, showProbability = false }: WatchlistCardProps) {\n  const [isExpanded, setIsExpanded] = useState(false);\n  \n  const assetClass = getAssetClassForSymbol(item.symbol, item.assetClass);\n  \n  const priority = item.setupStage === 'ready' ? 'HIGH' : 'MEDIUM';\n  const isHighPriority = priority === 'HIGH';\n\n  return (\n    <div \n      className=\"bg-card border border-border relative transition-all\"\n      style={{ borderLeftWidth: '6px', borderLeftColor: 'hsl(45 93% 47%)' }}\n      data-testid={`card-watchlist-${item.id}`}\n    >\n      {/* Header Row: Symbol + Timeframe + Priority */}\n      <div className=\"flex items-center justify-between gap-2 p-4 pb-3\">\n        <div className=\"flex items-center gap-3\">\n          <h3 className=\"text-xl sm:text-2xl font-extrabold text-foreground tracking-tight\" data-testid={`text-symbol-${item.id}`}>\n            {item.symbol}\n          </h3>\n          <span className=\"text-xs text-muted-foreground font-medium\">\n            {item.primaryTimeframe || ''}\n          </span>\n        </div>\n        {showProbability && (\n          <Badge \n            className={`px-3 py-1 text-xs font-bold uppercase tracking-wider ${\n              isHighPriority \n                ? 'bg-destructive text-destructive-foreground' \n                : 'bg-amber-600 text-white dark:bg-amber-700'\n            }`}\n          >\n            {priority}\n          </Badge>\n        )}\n      </div>\n\n      {/* Setup Note */}\n      {(item.setupNotes && item.setupNotes.length > 0) || item.marketContext ? (\n        <div className=\"px-4 pb-3\">\n          <p className=\"text-sm text-muted-foreground italic line-clamp-2\">\n            {(item.setupNotes && item.setupNotes.length > 0) ? item.setupNotes[0] : item.marketContext}\n          </p>\n        </div>\n      ) : null}\n\n      {/* Divider */}\n      <div className=\"border-t border-border mx-4\" />\n\n      {/* Current Price Section */}\n      <div className=\"px-4 py-3\">\n        <LivePriceDisplay \n          symbol={item.symbol} \n          assetClass={assetClass}\n          size=\"md\"\n          showChange={true}\n        />\n      </div>\n\n      {/* Divider */}\n      <div className=\"border-t border-border mx-4\" />\n\n      {/* Footer: Time + Details Button */}\n      <div className=\"px-4 py-3 space-y-3\">\n        <div className=\"flex items-center justify-end text-xs text-muted-foreground\">\n          <span className=\"flex items-center gap-1\">\n            <Clock className=\"w-3 h-3\" />\n            {item.createdAt ? formatTimeAgo(item.createdAt) : 'Monitoring'}\n          </span>\n        </div>\n        \n        <button \n          className=\"w-full flex items-center justify-center gap-2 py-2.5 text-sm font-bold text-white bg-blue-600 transition-colors hover:bg-blue-700 active:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 uppercase tracking-wide\"\n          data-testid={`button-details-${item.id}`}\n          onClick={() => setIsExpanded(!isExpanded)}\n        >\n          {isExpanded ? (\n            <>\n              <ChevronUp className=\"w-4 h-4\" />\n              Hide Details\n            </>\n          ) : (\n            <>\n              <ChevronDown className=\"w-4 h-4\" />\n              Show Details\n            </>\n          )}\n        </button>\n      </div>\n\n      {/* Expanded Details Section */}\n      {isExpanded && (\n        <div className=\"px-4 pb-4 pt-2 border-t border-border animate-in fade-in duration-200\">\n          <div className=\"space-y-4\">\n            {/* Market Context */}\n            {item.marketContext && (\n              <div className=\"space-y-1\">\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <TrendingUp className=\"w-3 h-3\" /> Market Context\n                </h4>\n                <p className=\"text-sm\">{item.marketContext}</p>\n              </div>\n            )}\n\n            {/* Setup Notes */}\n            {item.setupNotes && item.setupNotes.length > 0 && (\n              <div className=\"space-y-1\">\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <Target className=\"w-3 h-3\" /> Setup Notes\n                </h4>\n                <ul className=\"text-sm space-y-1\">\n                  {item.setupNotes.map((note: string, idx: number) => (\n                    <li key={idx} className=\"flex items-start gap-2\">\n                      <span className=\"text-blue-500\"></span>\n                      <span>{note}</span>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            {/* Confirmations Pending */}\n            {item.confirmationsPending && item.confirmationsPending.length > 0 && (\n              <div className=\"space-y-1\">\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <Shield className=\"w-3 h-3\" /> Confirmations Pending\n                </h4>\n                <ul className=\"text-sm space-y-1\">\n                  {item.confirmationsPending.map((conf: string, idx: number) => (\n                    <li key={idx} className=\"flex items-start gap-2\">\n                      <span className=\"text-amber-500\"></span>\n                      <span>{conf}</span>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            {/* Setup Stats */}\n            <div className=\"space-y-1\">\n              <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                <BarChart2 className=\"w-3 h-3\" /> Setup Stats\n              </h4>\n              <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                <div>\n                  <span className=\"text-muted-foreground\">Stage:</span>\n                  <span className=\"ml-1 font-semibold capitalize\">{item.setupStage}</span>\n                </div>\n                {item.trendBias && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Trend:</span>\n                    <span className=\"ml-1 font-semibold\">{item.trendBias}</span>\n                  </div>\n                )}\n                {item.chochDetected && (\n                  <div>\n                    <span className=\"text-muted-foreground\">CHOCH:</span>\n                    <span className=\"ml-1 font-semibold text-emerald-500\">Yes</span>\n                  </div>\n                )}\n                {item.liquiditySweepDetected && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Sweep:</span>\n                    <span className=\"ml-1 font-semibold text-emerald-500\">Yes</span>\n                  </div>\n                )}\n                {item.zoneLevel && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Zone:</span>\n                    <span className=\"ml-1 font-semibold\">{item.zoneLevel}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":8736,"size_tokens":null},"client/src/pages/Cryptocurrency.tsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport SignalCard from '@/components/SignalCard';\nimport WatchlistCard from '@/components/WatchlistCard';\nimport SectionHeader from '@/components/SectionHeader';\nimport { Zap, Bookmark } from 'lucide-react';\n\nexport default function Cryptocurrency() {\n  const { data: allSignals = [], isLoading: signalsLoading } = useQuery<any[]>({\n    queryKey: ['/api/trading-signals'],\n    refetchInterval: 10000,\n  });\n\n  const { data: pendingSetups = [], isLoading: setupsLoading } = useQuery<any[]>({\n    queryKey: ['/api/pending-setups'],\n    refetchInterval: 15000,\n  });\n\n  const cryptoSignals = allSignals.filter(s => s.assetClass === 'crypto');\n  const watchlistItems = pendingSetups.filter(s => !s.readyForSignal && s.assetClass === 'crypto');\n\n  return (\n    <div className=\"min-h-screen bg-background text-foreground p-4 md:p-8\">\n      <div className=\"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8\">\n        <div className=\"lg:col-span-8 flex flex-col gap-8\">\n          <section className=\"bg-card border-t-2 border-gray-900 dark:border-foreground\">\n            <SectionHeader \n              icon={Zap} \n              title=\"Cryptocurrency Signals\" \n              countLabel={`${cryptoSignals.length} Active`}\n              variant=\"active\"\n            />\n            <div className=\"flex flex-col\">\n              {signalsLoading ? (\n                <div className=\"p-8 text-center text-muted-foreground\">Loading signals...</div>\n              ) : cryptoSignals.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">No active crypto signals</div>\n              ) : (\n                cryptoSignals.map(signal => (\n                  <SignalCard key={signal.id} signal={signal} />\n                ))\n              )}\n            </div>\n          </section>\n        </div>\n\n        <div className=\"lg:col-span-4\">\n          <section className=\"bg-card border-t-2 border-gray-900 dark:border-foreground sticky top-8\">\n            <SectionHeader \n              icon={Bookmark} \n              title=\"Crypto Watchlist\" \n              countLabel={`${watchlistItems.length} Pending`}\n              variant=\"pending\"\n            />\n            <div className=\"flex flex-col\">\n              {setupsLoading ? (\n                <div className=\"p-8 text-center text-muted-foreground\">Loading watchlist...</div>\n              ) : watchlistItems.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">No instruments being monitored</div>\n              ) : (\n                watchlistItems.map(item => (\n                  <WatchlistCard key={item.id} item={item} />\n                ))\n              )}\n            </div>\n          </section>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2796,"size_tokens":null},"client/src/components/SectionHeader.tsx":{"content":"import { LucideIcon } from 'lucide-react';\n\ninterface SectionHeaderProps {\n  icon: LucideIcon;\n  title: string;\n  countLabel?: string;\n  variant?: 'confirmed' | 'pending' | 'active';\n}\n\nexport default function SectionHeader({ icon: Icon, title, countLabel, variant = 'confirmed' }: SectionHeaderProps) {\n  const getVariantStyles = () => {\n    switch (variant) {\n      case 'confirmed':\n        return 'bg-white dark:bg-gray-800 text-indigo-600 dark:text-indigo-400 border-indigo-200 dark:border-indigo-700 shadow-md hover:shadow-indigo-500/30';\n      case 'pending':\n        return 'bg-white dark:bg-gray-800 text-amber-500 dark:text-amber-400 border-amber-200 dark:border-amber-700 shadow-md hover:shadow-amber-500/30';\n      case 'active':\n        return 'bg-white dark:bg-gray-800 text-emerald-500 dark:text-emerald-400 border-emerald-200 dark:border-emerald-700 shadow-md hover:shadow-emerald-500/30';\n      default:\n        return 'bg-white dark:bg-gray-800 text-indigo-600 dark:text-indigo-400 border-indigo-200 dark:border-indigo-700 shadow-md';\n    }\n  };\n\n  return (\n    <div className=\"flex items-center justify-between gap-4 py-4 border-b-2 border-gray-900 bg-card px-6\">\n      <div className=\"flex items-center gap-3 min-w-0\">\n        <Icon className=\"w-5 h-5 text-foreground flex-shrink-0\" />\n        <h2 className=\"text-xl font-extrabold text-foreground tracking-tight uppercase truncate\">{title}</h2>\n      </div>\n      {countLabel && (\n        <div \n          className={`px-4 py-2 rounded-lg border text-center transition-all duration-300 hover:scale-[1.03] flex-shrink-0 ${getVariantStyles()}`}\n          data-testid={`badge-${variant}`}\n        >\n          <div className=\"text-2xl font-extrabold leading-none\">\n            {countLabel.split(' ')[0]}\n          </div>\n          <div className=\"text-[10px] font-medium tracking-widest uppercase text-muted-foreground mt-0.5\">\n            {countLabel.split(' ').slice(1).join(' ')}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":2008,"size_tokens":null},"client/src/pages/Commodities.tsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport SignalCard from '@/components/SignalCard';\nimport WatchlistCard from '@/components/WatchlistCard';\nimport SectionHeader from '@/components/SectionHeader';\nimport { Zap, Bookmark } from 'lucide-react';\n\nexport default function Commodities() {\n  const { data: allSignals = [], isLoading: signalsLoading } = useQuery<any[]>({\n    queryKey: ['/api/trading-signals'],\n    refetchInterval: 10000,\n  });\n\n  const { data: pendingSetups = [], isLoading: setupsLoading } = useQuery<any[]>({\n    queryKey: ['/api/pending-setups'],\n    refetchInterval: 15000,\n  });\n\n  const commoditySignals = allSignals.filter(s => s.assetClass === 'commodity');\n  const watchlistItems = pendingSetups.filter(s => !s.readyForSignal && s.assetClass === 'commodity');\n\n  return (\n    <div className=\"min-h-screen bg-background text-foreground p-4 md:p-8\">\n      <div className=\"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8\">\n        <div className=\"lg:col-span-8 flex flex-col gap-8\">\n          <section className=\"bg-card border-t-2 border-gray-900 dark:border-foreground\">\n            <SectionHeader \n              icon={Zap} \n              title=\"Commodity Signals (Gold, Oil, Metals)\" \n              countLabel={`${commoditySignals.length} Active`}\n              variant=\"active\"\n            />\n            <div className=\"flex flex-col\">\n              {signalsLoading ? (\n                <div className=\"p-8 text-center text-muted-foreground\">Loading signals...</div>\n              ) : commoditySignals.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">No active commodity signals</div>\n              ) : (\n                commoditySignals.map(signal => (\n                  <SignalCard key={signal.id} signal={signal} />\n                ))\n              )}\n            </div>\n          </section>\n        </div>\n\n        <div className=\"lg:col-span-4\">\n          <section className=\"bg-card border-t-2 border-gray-900 dark:border-foreground sticky top-8\">\n            <SectionHeader \n              icon={Bookmark} \n              title=\"Commodity Watchlist\" \n              countLabel={`${watchlistItems.length} Pending`}\n              variant=\"pending\"\n            />\n            <div className=\"flex flex-col\">\n              {setupsLoading ? (\n                <div className=\"p-8 text-center text-muted-foreground\">Loading watchlist...</div>\n              ) : watchlistItems.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">No instruments being monitored</div>\n              ) : (\n                watchlistItems.map(item => (\n                  <WatchlistCard key={item.id} item={item} />\n                ))\n              )}\n            </div>\n          </section>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2832,"size_tokens":null},"client/src/pages/MajorPairs.tsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport SignalCard from '@/components/SignalCard';\nimport WatchlistCard from '@/components/WatchlistCard';\nimport SectionHeader from '@/components/SectionHeader';\nimport { Zap, Bookmark } from 'lucide-react';\n\nexport default function MajorPairs() {\n  const { data: allSignals = [], isLoading: signalsLoading } = useQuery<any[]>({\n    queryKey: ['/api/trading-signals'],\n    refetchInterval: 10000,\n  });\n\n  const { data: pendingSetups = [], isLoading: setupsLoading } = useQuery<any[]>({\n    queryKey: ['/api/pending-setups'],\n    refetchInterval: 15000,\n  });\n\n  const forexSignals = allSignals.filter(s => s.assetClass === 'forex');\n  const watchlistItems = pendingSetups.filter(s => !s.readyForSignal && s.assetClass === 'forex');\n\n  return (\n    <div className=\"min-h-screen bg-background text-foreground p-4 md:p-8\">\n      <div className=\"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8\">\n        <div className=\"lg:col-span-8 flex flex-col gap-8\">\n          <section className=\"bg-card border-t-2 border-gray-900 dark:border-foreground\">\n            <SectionHeader \n              icon={Zap} \n              title=\"Major Forex Pairs Signals\" \n              countLabel={`${forexSignals.length} Active`}\n              variant=\"active\"\n            />\n            <div className=\"flex flex-col\">\n              {signalsLoading ? (\n                <div className=\"p-8 text-center text-muted-foreground\">Loading signals...</div>\n              ) : forexSignals.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">No active forex signals</div>\n              ) : (\n                forexSignals.map(signal => (\n                  <SignalCard key={signal.id} signal={signal} />\n                ))\n              )}\n            </div>\n          </section>\n        </div>\n\n        <div className=\"lg:col-span-4\">\n          <section className=\"bg-card border-t-2 border-gray-900 dark:border-foreground sticky top-8\">\n            <SectionHeader \n              icon={Bookmark} \n              title=\"Forex Watchlist\" \n              countLabel={`${watchlistItems.length} Pending`}\n              variant=\"pending\"\n            />\n            <div className=\"flex flex-col\">\n              {setupsLoading ? (\n                <div className=\"p-8 text-center text-muted-foreground\">Loading watchlist...</div>\n              ) : watchlistItems.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">No instruments being monitored</div>\n              ) : (\n                watchlistItems.map(item => (\n                  <WatchlistCard key={item.id} item={item} />\n                ))\n              )}\n            </div>\n          </section>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2787,"size_tokens":null},"client/src/components/LivePriceDisplay.tsx":{"content":"import { ArrowUpRight, ArrowDownRight, Loader2 } from 'lucide-react';\nimport { usePrice, formatPrice, formatChange } from '@/hooks/usePrices';\n\ninterface LivePriceDisplayProps {\n  symbol: string;\n  assetClass: 'stock' | 'forex' | 'commodity' | 'crypto';\n  showChange?: boolean;\n  size?: 'sm' | 'md' | 'lg';\n  className?: string;\n}\n\nexport default function LivePriceDisplay({ \n  symbol, \n  assetClass, \n  showChange = true,\n  size = 'md',\n  className = ''\n}: LivePriceDisplayProps) {\n  const { data: priceData, isLoading, isError } = usePrice(symbol, assetClass);\n  \n  const sizeClasses = {\n    sm: { price: 'text-sm', change: 'text-xs', icon: 'w-3 h-3' },\n    md: { price: 'text-xl', change: 'text-sm', icon: 'w-4 h-4' },\n    lg: { price: 'text-2xl', change: 'text-base', icon: 'w-5 h-5' }\n  };\n  \n  const sizes = sizeClasses[size];\n  \n  if (isLoading) {\n    return (\n      <div className={`flex items-center gap-2 ${className}`}>\n        <Loader2 className={`${sizes.icon} animate-spin text-muted-foreground`} />\n        <span className={`${sizes.price} font-bold text-muted-foreground`}>Loading...</span>\n      </div>\n    );\n  }\n  \n  if (isError || !priceData || priceData.error) {\n    return (\n      <div className={`flex items-center gap-2 ${className}`}>\n        <span className={`${sizes.price} font-bold text-muted-foreground`}>---</span>\n      </div>\n    );\n  }\n  \n  const { text: changeText, isPositive } = formatChange(priceData.change, priceData.changePercent);\n  const priceText = formatPrice(priceData.price, assetClass === 'forex' ? 5 : 2);\n  const changeColor = isPositive ? 'text-emerald-600 dark:text-emerald-400' : 'text-rose-600 dark:text-rose-400';\n  const ChangeIcon = isPositive ? ArrowUpRight : ArrowDownRight;\n  \n  return (\n    <div className={`flex flex-col ${className}`}>\n      <div className={`${sizes.price} font-extrabold tabular-nums`} data-testid=\"live-price-value\">\n        {priceText}\n      </div>\n      {showChange && (\n        <div className={`flex items-center gap-1 ${sizes.change} ${changeColor}`} data-testid=\"live-price-change\">\n          <ChangeIcon className={sizes.icon} />\n          <span className=\"font-semibold tabular-nums\">{changeText}</span>\n        </div>\n      )}\n    </div>\n  );\n}\n\ninterface CompactLivePriceProps {\n  symbol: string;\n  assetClass: 'stock' | 'forex' | 'commodity' | 'crypto';\n  className?: string;\n}\n\nexport function CompactLivePrice({ symbol, assetClass, className = '' }: CompactLivePriceProps) {\n  const { data: priceData, isLoading, isError } = usePrice(symbol, assetClass);\n  \n  if (isLoading) {\n    return <span className={`text-muted-foreground ${className}`}>...</span>;\n  }\n  \n  if (isError || !priceData || priceData.error) {\n    return <span className={`text-muted-foreground ${className}`}>---</span>;\n  }\n  \n  const priceText = formatPrice(priceData.price, assetClass === 'forex' ? 5 : 2);\n  const { isPositive } = formatChange(priceData.change, priceData.changePercent);\n  const changeColor = isPositive ? 'text-emerald-600 dark:text-emerald-400' : 'text-rose-600 dark:text-rose-400';\n  \n  return (\n    <span className={`font-bold tabular-nums ${changeColor} ${className}`} data-testid=\"compact-live-price\">\n      {priceText}\n    </span>\n  );\n}\n\ninterface LivePriceWithEntryProps {\n  symbol: string;\n  assetClass: 'stock' | 'forex' | 'commodity' | 'crypto';\n  entryPrice?: number | string | null;\n  signalType?: 'buy' | 'sell' | string;\n  className?: string;\n}\n\nexport function LivePriceWithEntry({ \n  symbol, \n  assetClass, \n  entryPrice,\n  signalType,\n  className = '' \n}: LivePriceWithEntryProps) {\n  const { data: priceData, isLoading, isError } = usePrice(symbol, assetClass);\n  \n  const entry = typeof entryPrice === 'string' ? parseFloat(entryPrice) : entryPrice;\n  const isBuy = signalType?.toLowerCase() === 'buy';\n  \n  if (isLoading) {\n    return (\n      <div className={`flex items-center gap-2 ${className}`}>\n        <Loader2 className=\"w-4 h-4 animate-spin text-muted-foreground\" />\n        <span className=\"text-sm text-muted-foreground\">Loading price...</span>\n      </div>\n    );\n  }\n  \n  if (isError || !priceData || priceData.error) {\n    return (\n      <div className={`flex flex-col ${className}`}>\n        <span className=\"text-[10px] uppercase tracking-wider text-muted-foreground font-semibold mb-1\">\n          Current Price\n        </span>\n        <span className=\"text-sm font-extrabold text-muted-foreground\">---</span>\n      </div>\n    );\n  }\n  \n  const currentPrice = priceData.price ?? 0;\n  const priceText = formatPrice(currentPrice, assetClass === 'forex' ? 5 : 2);\n  const { text: changeText, isPositive } = formatChange(priceData.change, priceData.changePercent);\n  const marketChangeColor = isPositive ? 'text-emerald-600 dark:text-emerald-400' : 'text-rose-600 dark:text-rose-400';\n  \n  let pnlColor = 'text-foreground';\n  let pnlText = '';\n  \n  if (entry && !isNaN(entry) && entry > 0) {\n    // For BUY: profit when current > entry (positive %)\n    // For SELL: profit when current < entry (show positive % for profit)\n    const rawPnlPercent = ((currentPrice - entry) / entry) * 100;\n    // Invert the percentage for SELL signals so profit shows as positive\n    const pnlPercent = isBuy ? rawPnlPercent : -rawPnlPercent;\n    const inProfit = pnlPercent > 0;\n    pnlColor = inProfit ? 'text-emerald-600 dark:text-emerald-400' : 'text-rose-600 dark:text-rose-400';\n    const sign = pnlPercent >= 0 ? '+' : '';\n    pnlText = `${sign}${pnlPercent.toFixed(2)}% from entry`;\n  }\n  \n  return (\n    <div className={`flex flex-col ${className}`}>\n      <span className=\"text-[10px] uppercase tracking-wider text-muted-foreground font-semibold mb-1 flex items-center gap-1\">\n        Current Price\n        <span className={`${marketChangeColor}`}>({changeText})</span>\n      </span>\n      <span className=\"text-sm font-extrabold tabular-nums\" data-testid=\"live-current-price\">\n        {priceText}\n      </span>\n      {pnlText && (\n        <span className={`text-xs ${pnlColor} mt-0.5`} data-testid=\"live-pnl-from-entry\">\n          {pnlText}\n        </span>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":6095,"size_tokens":null},"attached_assets/tradebot_1764097643860.py":{"content":"import os\r\nimport time\r\nfrom dotenv import load_dotenv\r\nimport google.generativeai as genai\r\nimport re\r\n\r\n\r\nload_dotenv()\r\nGOOGLE_API_KEY = os.getenv(\"GOOGLE_API_KEY\")\r\ngenai.configure(api_key=GOOGLE_API_KEY)\r\n\r\n\r\nclass GeminiMarketAnalyzer:\r\n    def __init__(self, file_paths, mime_types):\r\n        \"\"\"\r\n        Initializes the GeminiMarketAnalyzer with file paths and their mime types.\r\n\r\n        Args:\r\n            file_paths (list): List of file paths to be uploaded.\r\n            mime_types (list): List of mime types corresponding to the file paths.\r\n        \"\"\"\r\n\r\n        if len(file_paths) != len(mime_types):\r\n            raise ValueError(\"Length of file_paths and mime_types must be the same.\")\r\n\r\n        self.file_paths = file_paths\r\n        self.mime_types = mime_types\r\n        self.files = []\r\n        self.model = self._create_model()\r\n        \r\n        os.makedirs(r\"C:\\Users\\USER\\Downloads\\gen-ai\\fx_analysis\", exist_ok=True)\r\n        \r\n        self.file_name = os.path.splitext(os.path.basename(self.file_paths[0]))[0]\r\n        self.base_name = os.path.splitext(self.file_name)[0][:7]\r\n    \r\n         # Create the output directory using the extracted name\r\n        self.directory_path = os.path.join(r\"C:\\Users\\USER\\Downloads\\gen-ai\\fx_analysis\", self.base_name)\r\n        os.makedirs(self.directory_path, exist_ok=True)\r\n        self.pre_result = self.base_name+\"_analysis.md\"\r\n        self.resultFile = os.path.join(self.directory_path, self.pre_result)\r\n        \r\n\r\n    def _create_model(self):\r\n          \"\"\"Creates the Gemini model with specified configurations.\"\"\"\r\n          generation_config = {\r\n            \"temperature\": 2,\r\n            \"top_p\": 0.95,\r\n            \"top_k\": 40,\r\n            \"max_output_tokens\": 8192,\r\n            \"response_mime_type\": \"text/plain\",\r\n          }\r\n\r\n          model = genai.GenerativeModel(\r\n            model_name=\"gemini-2.0-flash-exp\",\r\n            generation_config=generation_config,\r\n            system_instruction=\"Role: You are a technical analysis expert who excels in using Smart money concepts to predict buy or sell zones. \\\\n**input: you will be given forex data, consume the hourly, daily and weekly price action (starting from the latest datapoints) - this is very important\\nProcess: Before you do anything, state the last hourly datapoint and walking backwards from there, Follow the SMC Strategy step by step \\\\noutput: You must state the **Optimal entry around current price** the next best price to buy or sell within the next few candlesticks. around the current price; always state the suggested prices\\\\n**Strategy: ```Precision SMC Scalping Strategy: Targeting Near-Term Price Action\\n1. Introduction\\n\\nStrategy Name: Precision SMC Scalping Strategy (PSSS)\\nPurpose: To identify the most probable next price point for a buy or sell within the next 1-5 candles on a very short-term timeframe, leveraging Smart Money Concepts for high-probability scalping opportunities.\\nTarget Audience: Experienced traders with a strong understanding of Smart Money Concepts, technical analysis, and risk management principles, comfortable with fast-paced market environments.\\nDisclaimer: Trading involves substantial risk of loss. This strategy is for educational purposes and does not guarantee profits. Live trading with this strategy should only be undertaken after thorough backtesting, demo trading, and a complete understanding of its nuances and risks.\\n\\n2. Core Concepts\\n\\nSmart Money Concepts (SMC): In this context, SMC refers to the methodologies used to interpret and anticipate the actions of large institutional traders (the \\\"smart money\\\"). This involves identifying their footprints in the market through:\\n\\nInstitutional Order Flow: Observing price action patterns that suggest the accumulation or distribution of large orders.\\n\\nLiquidity Manipulation: Recognizing instances where price movements are designed to induce retail traders into taking positions before reversing to capitalize on their stop losses.\\n\\nSupply and Demand Imbalances: Pinpointing areas where there's a significant disparity between buying and selling pressure, creating zones of potential future price reaction.\\n\\nKey SMC Elements Used:\\n\\nMarket Structure: Crucial for determining the current directional bias. We will identify:\\n\\nBullish Market Structure: Characterized by higher highs (HH) and higher lows (HL). Breaks of Structure (BOS) to the upside confirm continuation.\\n\\nBearish Market Structure: Characterized by lower lows (LL) and lower highs (LH). Breaks of Structure (BOS) to the downside confirm continuation.\\n\\nChange of Character (CHoCH): A crucial signal indicating a potential shift in market direction. A bearish CHoCH occurs when price breaks a recent higher low in a bullish trend. A bullish CHoCH occurs when price breaks a recent lower high in a bearish trend. This signals a potential temporary or sustained reversal.\\n\\nOrder Blocks: Represents the last candle before a significant impulsive move. These areas are where institutional orders were likely placed, making them potential zones of future support or resistance.\\n\\nBullish Order Block: The last down-close candle before a strong bullish impulsive move. Price revisiting this area may be met with buying pressure.\\n\\nBearish Order Block: The last up-close candle before a strong bearish impulsive move. Price revisiting this area may be met with selling pressure.\\n\\nRefined Order Blocks: On lower timeframes, further refinement of the order block can be done by identifying the inefficiencies or the origin of the impulsive move within the initial order block candle.\\n\\nImbalances (Fair Value Gaps - FVG): Represent inefficiencies in the market where price has moved rapidly, leaving a gap where no trading occurred. These gaps often get filled as price revisits these areas to restore market equilibrium.\\n\\nBullish FVG: A three-candle pattern where the high of the first candle is lower than the low of the third candle.\\n\\nBearish FVG: A three-candle pattern where the low of the first candle is higher than the high of the third candle.\\n\\nLiquidity Pools: Areas in the market where a concentration of stop losses or pending orders is likely present. Smart money often targets these areas to fill their large orders or induce volatility.\\n\\nEqual Highs/Lows: Obvious levels where many traders might place stop losses.\\n\\nTrendline Breaks: Areas where breakout traders might enter positions, placing their stops behind the trendline.\\n\\nPrevious Session Highs/Lows: Psychological levels where stop losses and take profit orders may accumulate.\\n\\nPremium and Discount Zones: Based on the Fibonacci retracement tool drawn from the most recent swing high to swing low (for bullish bias) or swing low to swing high (for bearish bias).\\n\\nDiscount Zone (Below 50% Fibonacci): Considered a desirable area to look for buy opportunities when the overall bias is bullish.\\n\\nPremium Zone (Above 50% Fibonacci): Considered a desirable area to look for sell opportunities when the overall bias is bearish.\\n\\n3. Strategy Rules\\n\\nTimeframe: Primarily 1-minute or 30-second chart for entries and immediate price action. A higher timeframe (e.g., 5-minute or 15-minute) is used to determine the overall market structure and bias.\\n\\nEntry Rules:\\n\\nLong Entry:\\n\\nEstablish Bullish Bias: Identify a bullish market structure on the higher timeframe (e.g., 5-minute) with recent BOS to the upside or a clear bullish CHoCH.\\n\\nIdentify a Valid Bullish Order Block: On the entry timeframe (1-minute or 30-second), locate a bullish order block that formed after the establishment of the bullish bias. The order block should ideally:\\n\\nBe the last down-close candle before an impulsive bullish move.\\n\\nHave caused a BOS or CHoCH on the entry timeframe.\\n\\nIdeally have an unmitigated FVG associated with the impulsive move.\\n\\nPrice Retraces to the Order Block within a Discount Zone: Observe price action retracing towards the identified bullish order block. The order block should ideally be located within a discount zone (below the 50% Fibonacci retracement level drawn from the recent swing high to swing low).\\n\\nConfirmation Signal: Look for a rapid, bullish candlestick confirmation signal within or near the order block on the entry timeframe. This could be:\\n\\nA strong bullish engulfing candle.\\n\\nA wick rejection at the order block.\\n\\nA small bullish BOS or CHoCH on an even lower timeframe (e.g., tick chart if available).\\n\\nAnticipated Next Price Target: The expected next price target will be a nearby unmitigated bearish FVG or a liquidity pool (equal highs, previous session high) above the entry point.\\n\\nShort Entry:\\n\\nEstablish Bearish Bias: Identify a bearish market structure on the higher timeframe (e.g., 5-minute) with recent BOS to the downside or a clear bearish CHoCH.\\n\\nIdentify a Valid Bearish Order Block: On the entry timeframe (1-minute or 30-second), locate a bearish order block that formed after the establishment of the bearish bias. The order block should ideally:\\n\\nBe the last up-close candle before an impulsive bearish move.\\n\\nHave caused a BOS or CHoCH on the entry timeframe.\\n\\nIdeally have an unmitigated FVG associated with the impulsive move.\\n\\nPrice Retraces to the Order Block within a Premium Zone: Observe price action retracing towards the identified bearish order block. The order block should ideally be located within a premium zone (above the 50% Fibonacci retracement level drawn from the recent swing low to swing high).\\n\\nConfirmation Signal: Look for a rapid, bearish candlestick confirmation signal within or near the order block on the entry timeframe. This could be:\\n\\nA strong bearish engulfing candle.\\n\\nA wick rejection at the order block.\\n\\nA small bearish BOS or CHoCH on an even lower timeframe (e.g., tick chart if available).\\n\\nAnticipated Next Price Target: The expected next price target will be a nearby unmitigated bullish FVG or a liquidity pool (equal lows, previous session low) below the entry point.\\n\\nStop Loss:\\n\\nLong Entry: Place the stop loss just below the low of the bullish order block or a recent significant swing low on the entry timeframe. Consider a small buffer to avoid being stopped out by insignificant wicks.\\n\\nShort Entry: Place the stop loss just above the high of the bearish order block or a recent significant swing high on the entry timeframe. Consider a small buffer.\\n\\nTake Profit:\\n\\nPrimary Target: The immediate target is the next identifiable unmitigated FVG or a liquidity pool in the direction of the trade. Since this is a scalping strategy, these targets will be relatively close.\\n\\nMultiple Take Profit Levels: Consider using multiple take profit levels to secure partial profits and manage risk:\\n\\nTP1: At the nearest FVG or liquidity pool. Take a significant portion (e.g., 70-80%) of the position off.\\n\\nTP2: At the next significant FVG or liquidity pool further in the direction of the trade. Move the stop loss to breakeven or in profit after hitting TP1.\\n\\nTrade Management:\\n\\nImmediate Action: Due to the short timeframe, decisions need to be made quickly.\\n\\nMove Stop Loss to Breakeven: After TP1 is hit, immediately move the stop loss to the entry price to eliminate risk on the remaining position.\\n\\nTrailing Stop Loss (Optional): For TP2, a trailing stop loss can be used to lock in profits as price moves further in your favor. However, be cautious with tight trailing stops in volatile conditions.\\n\\nAvoid Over-Leveraging: Due to the fast-paced nature, avoid using excessive leverage that can lead to significant losses with small price fluctuations.\\n\\n4. Chart Examples\\nSynthesize the chart for:\\n\\nHigher timeframe market structure and bias.\\n\\nIdentified order blocks.\\n\\nPremium/discount zones.\\n\\nFVGs and liquidity pools.\\n\\nEntry point based on confirmation signal.\\n\\nStop loss placement.\\n\\nTake profit targets.\\n\\nAnnotation explaining the reasoning behind the trade setup.\\n\\nExamples of losing trades would illustrate instances where the setup was valid but the market moved against the prediction, emphasizing the inherent risk.)\\n\\n5. Risk Management\\n\\nPosition Sizing: Determine position size based on a fixed percentage risk per trade. A conservative approach for scalping is recommended.\\n* Calculate Position Size: (Account Balance * Risk Percentage per Trade) / Stop Loss in Pips.\\nMaximum Risk per Trade: 0.5% to 1% of trading capital per trade is highly recommended for scalping due to the increased frequency of trades.\\nMaximum Daily/Weekly Risk: Set a limit on the total percentage of capital you are willing to risk within a day or week (e.g., 2-3% daily, 5% weekly). Once this limit is reached, stop trading for the period.\\nRisk-Reward Ratio: Aim for a minimum risk-reward ratio of 1:1.5 or higher on individual trades. While scalping involves smaller profits, maintaining a positive risk-reward is crucial for long-term profitability.\\n\\n\\n8. Conclusion\\n\\nThe Precision SMC Scalping Strategy (PSSS) offers a framework for identifying high-probability short-term buy/sell opportunities based on Smart Money Concepts. By focusing on institutional order flow, liquidity manipulation, and supply/demand imbalances, traders can anticipate near-term price movements with a high degree of accuracy when setups align.\\n\\n**Example Response: \\\"Okay, let's break down USD/JPY using the provided data and the Precision SMC Scalping Strategy.\\n\\n  **Current Market State (as of the last data point)** *   **Last Price:** 1.0248001814 *   **Last Date:** 2025-01-10T22:00:00.000Z (10 Jan 2025, 10 PM GMT) \\n\\n**1. Weekly Analysis:**\\n\\n*   **Overall Trend:** The weekly chart shows a clear uptrend from Jan 2024 until August when a large drop and some choppiness set in before uptrend resuming in the final data point on Jan 2025. However,  there are very small red candle after a few candles. This shows strong upward momentum\\n*   **Key Levels**: Support would be somewhere below 146.2. Resistance could be considered around 161.9\\n*   **Bias:** Still bullish bias, considering the overall upwards momentum. We must however consider a bearish shift is very possible at the level 161.9 considering this also constitutes the last weeks high. \\n  *   For the next few days to a week a retest to weekly candle bodies is expected\\n\\n**2. Daily Analysis:**\\n*   **Overall Trend:**  Uptrend\\n*  **Key Levels**: Resistance would be around 158.5. Support lies at the last lower high 157.2. It is important to see which daily candle high/low we will take out this can confirm uptrend and a short retracement target\\n*  **Bias**: Still bullish bias. A change of character has yet to present itself on the daily\\n\\n**3. Hourly Analysis**\\n*   **Recent Price Action**: Current price 158.00 . From our higher time frame it can be said a retracement to discount is still possible to then target another leg up, the hourly data has a change of character with the break of  the low at  around 158.3, showing a short term bearish potential with the break and retracement. there was another small break below 158, creating further lower lows.\\n*  **Key Levels**: a support lies at 157.7. Our hourly bias is bearish\\n*   **FVG/Order Block:** an order block with inefficiency presents itself on the latest red candle.\\n\\n**4.  SMC Analysis and Trade Recommendation:**\\n\\nBased on the analysis, here's my recommendation using the scalping strategy:\\n\\n*   **Current Situation:** price is retracing a bearish impulsive move, the retracement has been strong, we would not short this current area with risk reward ratios being low, an optimal short position will be as stated below\\n\\n*  **Optimal Entry around current price**: Short Entry the identified bearish order block exists on the most recent red candle wick within this  hourly candle body with inefficiencies also being left unmitigated there at  around **158.09**, this price aligns with the current candle wick.\\n  \\n\\n*  **Stop Loss**: A stop loss would be placed just above the high of that bearish order block, approximately at 158.12 with a 2-3 pip buffer for safety.\\n\\n*  **Target Price:** As this is a scalp, targets should be reasonably short. next area of interest would be the hourly bullish imbalance  at **157.97** acting as a near term TP level.. It can be anticipated that the bears will want to mitigate the bullish move within a few candles with these prices and will therefore act as target point. if TP is hit move to Breakeven to anticipate the move. If this break happens our next target becomes 157.7 a key daily and hourly support level .\\n\\n*   **Risk Management:** Risk should always be small around 0.5-1%. Given the tight stop, size accordingly so that loss will remain less than your risk per trade parameter\\n\\n**5. Additional Considerations:**\\n   *  Be nimble and prepared to cut losses quickly. Scalping is high-paced trading that need fast decisions. \\n    * if bullish candle breaks and rejects off  the initial area at 158.09 before trigger short target will no longer be valid for entry\\n  \\n\\n**Summary:**\\nCurrent position not suitable for trade but upon retracement entry short position on  the specified entry of  158.09 is preferable for short with a 1-3 pip sl, targetting 157.97 initially before potential targets to 157.7.\\n\\n**Disclaimer:** This analysis is for educational purposes only and not financial advice. Always manage your risk carefully when trading. Be aware market movements can still prove against what might seem like high probability trades. The mentioned strategy has a good level of probability but will always contain inherent risks. Trading is subjective and may or may not fit individual requirements and should only be done upon through research by traders themselves.\\n\\\"\",\r\n        )\r\n          return model\r\n\r\n    def _upload_file(self, path, mime_type):\r\n        \"\"\"Uploads a file to Gemini.\"\"\"\r\n        file = genai.upload_file(path, mime_type=mime_type)\r\n        print(f\"Uploaded file '{file.display_name}' as: {file.uri}\")\r\n        return file\r\n\r\n    def _wait_for_files_active(self):\r\n        \"\"\"Waits for the uploaded files to be active.\"\"\"\r\n        print(\"Waiting for file processing...\")\r\n        for file in self.files:\r\n          while file.state.name == \"PROCESSING\":\r\n              print(\".\", end=\"\", flush=True)\r\n              time.sleep(10)\r\n              file = genai.get_file(file.name)\r\n          if file.state.name != \"ACTIVE\":\r\n              raise Exception(f\"File {file.name} failed to process\")\r\n        print(\"...all files ready\")\r\n        print()\r\n\r\n    def upload_files(self):\r\n        \"\"\"Uploads all specified files to Gemini and waits for processing.\"\"\"\r\n        for path, mime_type in zip(self.file_paths, self.mime_types):\r\n            file = self._upload_file(path, mime_type)\r\n            self.files.append(file)\r\n        self._wait_for_files_active()\r\n\r\n    def analyze_market(self):\r\n        \r\n         \"\"\"Sends the message to gemini to perform the analysis and prints the result.\"\"\"\r\n         chat_session = self.model.start_chat(\r\n            history=[\r\n             \r\n            ]\r\n        )\r\n         \r\n        #  prompt = [\"when you analyse, strongly reference the json data for accurate price and date data, the image is only for reference and contains estimations and always state the date. starting from the last datapoints because they are the lastest, now Synthesize the market structure including chart patterns, historical areas of values,  liquidity and  the last price from the hourly in json data as is, and implement the strategy. get the resistance and support values and other market values from the json files, use it to understand the images, the final signals should contain signals and the type of orders for both buy and sell and you will state the probability of each entry from 1-100 percent, also state the last price from the hourly in json data as is\"]\r\n\r\n         input_prompt = self.files\r\n        \r\n         response = chat_session.send_message(\r\n             input_prompt\r\n            )\r\n         for chunk in response:\r\n             print(chunk.text, end=\"\")\r\n             text = chunk.text\r\n             match = re.search(r\"\\*\\*summary(.*?)(?=disclaimer)\", text, re.IGNORECASE | re.DOTALL)\r\n\r\n             print(\"Extracting Details!\")\r\n             if match:\r\n                # print(\"Match Found!\")\r\n                response_text = match.group()\r\n             else:\r\n                # print(\"No match found!\")\r\n                match = re.search(r\"summary(.*)\", text, re.IGNORECASE  | re.DOTALL)\r\n                response_text = match.group()\r\n             \r\n             match2 = re.search(r\"optimal entry(.*?)(?=\\*\\*stop)\", text, re.IGNORECASE | re.DOTALL)\r\n             \r\n             response2_text = match2.group()\r\n             \r\n             print(self.directory_path)\r\n             with open(self.resultFile, \"a\", encoding=\"utf-8\") as file:\r\n                file.write( \"\\n\\n\" + \"*\" * 95 + \"\\n\\n\" + \"\\n\\n**********************SMC  ENTRY *********************\\n\\n\" + response_text  + \"\\n\" + response2_text)\r\n        \r\n        \r\n        #  print(response.text)\r\n        # #  with open(r\"C:\\Users\\USER\\Downloads\\gen-ai\\Forex-Analysis.md\", \"a\", encoding=\"utf-8\") as file:\r\n        #     # file.write(response.text)\r\n        \r\n\r\n\r\nif __name__ == \"__main__\":\r\n    # Example usage:\r\n    file_paths = ['C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_3mo_1d_processed.json', 'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_6mo_1wk_processed.json', 'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_5d_1h_processed.json', 'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_3mo_1d_chart.png', 'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_6mo_1wk_chart.png', 'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_5d_1h_chart.png']\r\n\r\n    mime_types = [\r\n        \"text/plain\",\r\n        \"text/plain\",\r\n        \"text/plain\",\r\n        \"image/png\",\r\n        \"image/png\",\r\n        \"image/png\",\r\n    ]\r\n    try:\r\n      analyzer = GeminiMarketAnalyzer(file_paths, mime_types)\r\n      analyzer.upload_files()\r\n      analyzer.analyze_market()\r\n    except Exception as e:\r\n      print(f\"An error occurred: {e}\")","path":null,"size_bytes":22363,"size_tokens":null},"attached_assets/trade_1764097643860.py":{"content":"import yfinance as yf\r\nimport pandas as pd\r\nimport os\r\nimport concurrent.futures\r\nimport time\r\n\r\nclass ForexDataProcessor:\r\n    SUPPORTED_PERIODS = [\"1d\", \"5d\", \"1mo\", \"3mo\", \"6mo\", \"1y\", \"2y\", \"5y\", \"10y\", \"ytd\", \"max\"]\r\n\r\n    def __init__(self, pairs, output_dir=\"forex_data\"):\r\n        self.forex_pairs = pairs\r\n        # self.forex_pairs = {\r\n        #     \"EUR/USD\": \"EURUSD=X\",\r\n        #     \"USD/JPY\": \"JPY=X\",\r\n        #     \"GBP/USD\": \"GBPUSD=X\",\r\n        #     \"USD/CHF\": \"CHF=X\",\r\n        #     \"USD/CAD\": \"CAD=X\",\r\n        #     \"AUD/USD\": \"AUDUSD=X\",\r\n        #     \"NZD/USD\": \"NZDUSD=X\"\r\n        # }\r\n        \r\n        # self.forex_pairs = {\r\n        #     \"BTC/USD\": \"BTC-USD\",\r\n        #     \"ETH/USD\": \"ETH-USD\",\r\n        #     \"XRP/USD\": \"XRP-USD\",\r\n        #     \"LTC/USD\": \"LTC-USD\",\r\n        #     \"ADA/USD\": \"ADA-USD\",\r\n        #     \"DOGE/USD\": \"DOGE-USD\",\r\n        #     \"BNB/USD\": \"BNB-USD\",  # Binance Coin\r\n        #     \"SOL/USD\": \"SOL-USD\", # Solana\r\n        #     \"DOT/USD\": \"DOT-USD\", # Polkadot\r\n        #     \"MATIC/USD\": \"MATIC-USD\" # Polygon\r\n        # }\r\n        \r\n        self.output_dir = output_dir\r\n        os.makedirs(self.output_dir, exist_ok=True)\r\n\r\n    def get_forex_data(self, pair_name, ticker, period, interval):\r\n        try:\r\n            if period not in self.SUPPORTED_PERIODS:\r\n                print(f\"Warning: Period '{period}' is not directly supported. Using '3mo' as fallback for {pair_name} ({period}, {interval}).\")\r\n                period = '3mo'\r\n\r\n            data = yf.download(tickers=ticker, period=period, interval=interval, progress=False)\r\n\r\n            if data.empty:\r\n                print(f\"Warning: No data found for {pair_name} ({period}, {interval}).\")\r\n                return None, pair_name, period, interval\r\n\r\n            data_json = data.to_json(date_format=\"iso\", orient=\"index\")\r\n            return data_json, pair_name, period, interval\r\n\r\n        except Exception as e:\r\n            print(f\"Error fetching data for {pair_name} ({period}, {interval}): {e}\")\r\n            return None, pair_name, period, interval\r\n\r\n    def process_timeframe(self, timeframe):\r\n        period = timeframe[\"period\"]\r\n        interval = timeframe[\"interval\"]\r\n        file_paths = []\r\n\r\n        with concurrent.futures.ProcessPoolExecutor() as executor:\r\n            futures = [\r\n                executor.submit(self.get_forex_data, pair, ticker, period, interval)\r\n                for pair, ticker in self.forex_pairs.items()\r\n            ]\r\n\r\n            for future in concurrent.futures.as_completed(futures):\r\n                data_json, pair_name, period, interval = future.result()\r\n                if data_json:\r\n                    filename = f\"{pair_name.replace('/', '-')}_{period}_{interval}.json\"\r\n                    filepath = os.path.join(self.output_dir, filename)\r\n                    try:\r\n                        with open(filepath, 'w') as f:\r\n                            f.write(data_json)\r\n                        print(f\"Data for {pair_name} ({period}, {interval}) saved to {filepath}\")\r\n                        file_paths.append(filepath)\r\n                    except Exception as e:\r\n                        print(f\"Error saving {pair_name} data ({period}, {interval}) to file: {e}\")\r\n\r\n        return file_paths\r\n\r\n    def process_all_timeframes(self, timeframes):\r\n        all_file_paths = []\r\n\r\n        with concurrent.futures.ProcessPoolExecutor() as executor:\r\n            timeframe_futures = [\r\n                executor.submit(self.process_timeframe, timeframe) for timeframe in timeframes\r\n            ]\r\n            \r\n            for future in concurrent.futures.as_completed(timeframe_futures):\r\n                all_file_paths.extend(future.result())\r\n\r\n        sorted_paths = self.sort_paths_by_currency(all_file_paths)\r\n        return sorted_paths\r\n\r\n    def sort_paths_by_currency(self, file_paths):\r\n        sorted_paths = {pair: [] for pair in self.forex_pairs.keys()}\r\n\r\n        for path in file_paths:\r\n            for pair in self.forex_pairs.keys():\r\n                if pair.replace('/', '-') in path:\r\n                    sorted_paths[pair].append(path)\r\n\r\n        return list(sorted_paths.values())\r\n\r\ndef dataRetriever(pairs):\r\n    pair_group = pairs\r\n    processor = ForexDataProcessor(pair_group)\r\n    \r\n    timeframes = [\r\n        {\"period\": \"1y\", \"interval\": \"1wk\"},\r\n        {\"period\": \"3mo\", \"interval\": \"1d\"},\r\n        {\"period\": \"5d\", \"interval\": \"1h\"},\r\n    ]\r\n\r\n    start_time = time.time()\r\n    sorted_file_paths = processor.process_all_timeframes(timeframes)\r\n    end_time = time.time()\r\n\r\n    print(\"Sorted file paths by currency:\")\r\n    for currency_paths in sorted_file_paths:\r\n        print(currency_paths)\r\n\r\n    print(f\"Finished processing all timeframes in {end_time - start_time:.2f} seconds.\")\r\n    return sorted_file_paths\r\n","path":null,"size_bytes":4852,"size_tokens":null},"attached_assets/forex_mailer_1764097643859.py":{"content":"import mistune\r\nimport os\r\nimport smtplib\r\nfrom email.mime.text import MIMEText\r\nfrom email.mime.multipart import MIMEMultipart\r\nfrom email.mime.base import MIMEBase\r\nfrom email import encoders\r\n\r\ndef markdown_to_html_email(markdown_filepath, recipient_email, sender_email, sender_password, subject=\"Markdown to HTML Email\", attachments=None):\r\n    \"\"\"\r\n    Converts a Markdown file to HTML using mistune, then sends it as an email with optional attachments.\r\n\r\n    Args:\r\n        markdown_filepath: Path to the Markdown file.\r\n        recipient_email: Email address of the recipient.\r\n        sender_email: Email address of the sender.\r\n        sender_password: Password for the sender's email account (use app passwords or environment variables).\r\n        subject: Subject of the email.\r\n        attachments: List of file paths to attach to the email (default: None).\r\n    \"\"\"\r\n    try:\r\n        # Read the Markdown file\r\n        with open(markdown_filepath, 'r', encoding='utf-8') as f:\r\n            markdown_text = f.read()\r\n\r\n        # Convert Markdown to HTML\r\n        renderer = mistune.HTMLRenderer()  # Initialize the renderer\r\n        markdown = mistune.Markdown(renderer=renderer)  # Initialize the markdown parser with the renderer\r\n        html_content = markdown(markdown_text)  # Process the markdown\r\n\r\n        # Create the email message\r\n        message = MIMEMultipart(\"alternative\")\r\n        message['Subject'] = subject\r\n        message['From'] = sender_email\r\n        message['To'] = recipient_email\r\n\r\n        # Attach plain text and HTML versions of the email\r\n        part1 = MIMEText(markdown_text, \"plain\")\r\n        part2 = MIMEText(html_content, \"html\")\r\n        message.attach(part1)\r\n        message.attach(part2)\r\n\r\n        # Attach files if provided\r\n        if attachments:\r\n            for filepath in attachments:\r\n                try:\r\n                    with open(filepath, 'rb') as attachment:\r\n                        part = MIMEBase('application', 'octet-stream')\r\n                        part.set_payload(attachment.read())\r\n                    encoders.encode_base64(part)  # Encode the attachment in base64\r\n                    filename = os.path.basename(filepath)  # Extract the filename\r\n                    part.add_header(\r\n                        'Content-Disposition',\r\n                        f'attachment; filename=\"{filename}\"'\r\n                    )\r\n                    message.attach(part)\r\n                    print(f\"Attached: {filename}\")\r\n                except FileNotFoundError:\r\n                    print(f\"Error: Attachment not found: {filepath}\")\r\n                except Exception as e:\r\n                    print(f\"Error attaching {filepath}: {e}\")\r\n\r\n        # Send the email\r\n        with smtplib.SMTP_SSL('smtp.gmail.com', 465) as server:\r\n            server.login(sender_email, sender_password)\r\n            server.sendmail(sender_email, recipient_email, message.as_string())\r\n\r\n        print(f\"Email sent successfully to {recipient_email}\")\r\n\r\n    except FileNotFoundError:\r\n        print(f\"Error: File not found: {markdown_filepath}\")\r\n    except Exception as e:\r\n        print(f\"An error occurred: {e}\")\r\n\r\n# # Example usage\r\n# if __name__ == \"__main__\":\r\n#     markdown_file = r\"C:\\Users\\USER\\Downloads\\gen-ai\\Forex-Analysis.md\"\r\n#     recipient = \"recipient@example.com\"\r\n#     sender = \"sender@gmail.com\"\r\n#     password = \"your_app_password\"  # Use an app-specific password for Gmail\r\n#     subject_line = \"Daily Forex Analysis\"\r\n#     attachments = [\r\n#         r\"C:\\Users\\USER\\Downloads\\gen-ai\\attachment1.pdf\",\r\n#         r\"C:\\Users\\USER\\Downloads\\gen-ai\\image.png\"\r\n#     ]\r\n\r\n#     markdown_to_html_email(markdown_file, recipient, sender, password, subject_line, attachments)","path":null,"size_bytes":3757,"size_tokens":null},"attached_assets/tradde_1764097643860.py":{"content":"import pandas as pd\r\nimport numpy as np\r\nimport mplfinance as mpf\r\nfrom scipy.signal import argrelextrema\r\nimport os\r\n\r\n\r\ndef process_and_plot(file_path, output_dir):\r\n    \"\"\"Processes a single file, plots the data, and saves the chart.\"\"\"\r\n\r\n    print(f\"Processing: {file_path}\")\r\n    # Load historical price data with correct format\r\n    try:\r\n        df = pd.read_json(file_path).T  # Transpose to fix structure\r\n        df.index = pd.to_datetime(df.index)  # Convert index to DateTime\r\n        df = df.sort_index()  # Sort by date\r\n        df.reset_index(inplace=True)\r\n        df.rename(columns={\"index\": \"Date\"}, inplace=True)  # Rename index to Date\r\n    except Exception as e:\r\n        print(f\"Error reading JSON file {file_path}, skipping file with error: {e}\")\r\n        return None, None\r\n\r\n    # Compute Moving Averages (50 & 200 EMA for trends)\r\n    def ema(series, period):\r\n        return series.ewm(span=period, adjust=False).mean()\r\n\r\n    df[\"EMA_50\"] = ema(df[\"Close\"], 50)\r\n    df[\"EMA_200\"] = ema(df[\"Close\"], 200)\r\n\r\n    # Detect Trends\r\n    def detect_trend(row):\r\n        if row[\"EMA_50\"] > row[\"EMA_200\"]:\r\n            return \"Uptrend\"\r\n        elif row[\"EMA_50\"] < row[\"EMA_200\"]:\r\n            return \"Downtrend\"\r\n        else:\r\n            return \"Sideways\"\r\n\r\n    df[\"Trend\"] = df.apply(detect_trend, axis=1)\r\n\r\n    # Detect Support & Resistance (Using Local Extrema)\r\n    def find_support_resistance(df, order=5):\r\n        \"\"\"Finds local highs and lows for support & resistance detection.\"\"\"\r\n        df[\"Support\"] = np.nan\r\n        df[\"Resistance\"] = np.nan\r\n\r\n        # Local minima (Support)\r\n        local_min = argrelextrema(df[\"Low\"].values, np.less, order=order)[0]\r\n        df.loc[df.index[local_min], \"Support\"] = df[\"Low\"].iloc[local_min]\r\n\r\n        # Local maxima (Resistance)\r\n        local_max = argrelextrema(df[\"High\"].values, np.greater, order=order)[0]\r\n        df.loc[df.index[local_max], \"Resistance\"] = df[\"High\"].iloc[local_max]\r\n\r\n        return df\r\n\r\n    df = find_support_resistance(df)\r\n\r\n    # Detect Breakouts\r\n    df[\"Breakout\"] = np.where((df[\"Close\"] > df[\"Resistance\"].shift(1)), \"Yes\", \"No\")\r\n    df[\"Breakdown\"] = np.where((df[\"Close\"] < df[\"Support\"].shift(1)), \"Yes\", \"No\")\r\n\r\n    # Detect Consolidation (Using Bollinger Bands & ATR)\r\n    def atr(high, low, close, period=14):\r\n        tr = np.maximum(high - low, np.maximum(abs(high - close.shift()), abs(low - close.shift())))\r\n        return tr.rolling(window=period).mean()\r\n\r\n    df[\"ATR\"] = atr(df[\"High\"], df[\"Low\"], df[\"Close\"], period=14)\r\n\r\n    def bollinger_bands(series, period=20, std_dev=2):\r\n        sma = series.rolling(window=period).mean()\r\n        std = series.rolling(window=period).std()\r\n        upper_band = sma + (std_dev * std)\r\n        lower_band = sma - (std_dev * std)\r\n        return upper_band, sma, lower_band\r\n\r\n    upper_band, middle_band, lower_band = bollinger_bands(df[\"Close\"], period=20, std_dev=2)\r\n    df[\"Bollinger_Width\"] = (upper_band - lower_band) / middle_band  # Normalize width\r\n    df[\"Consolidation\"] = np.where(df[\"Bollinger_Width\"] < 0.05, \"Yes\", \"No\")  # Threshold for consolidation\r\n\r\n    # Extract currency pair from filename (assuming filename format like \"EUR-USD_5d_1h.json\")\r\n    base_name = os.path.splitext(os.path.basename(file_path))[0]\r\n    currency_pair = base_name.split('_')[0]\r\n\r\n    # Create currency pair specific output directory\r\n    currency_output_dir = os.path.join(output_dir, currency_pair)\r\n    os.makedirs(currency_output_dir, exist_ok=True)\r\n\r\n    # Save the processed data\r\n    output_json_path = os.path.join(currency_output_dir, f\"{base_name}_processed.json\")\r\n    df.to_json(output_json_path, orient=\"records\", date_format=\"iso\")\r\n\r\n    # Set 'Date' column as the index for mplfinance plotting\r\n    df.set_index('Date', inplace=True)\r\n\r\n    # Check for missing data\r\n    print(f\"Missing values before handling for: {file_path}\")\r\n    print(df[[\"Open\", \"High\", \"Low\", \"Close\"]].isnull().sum())\r\n\r\n    # Remove rows with NaN values\r\n    df = df.dropna(subset=['Open', 'High', 'Low', 'Close'])\r\n\r\n    # Check for missing data\r\n    print(f\"Missing values after handling for: {file_path}\")\r\n    print(df[[\"Open\", \"High\", \"Low\", \"Close\"]].isnull().sum())\r\n\r\n    # Ensure correct datetime index\r\n    print(f\"DataFrame Index for: {file_path}\")\r\n    print(df.index)\r\n    print(f\"DataFrame Index dtype: {df.index.dtype}\")\r\n\r\n    # File path for the saved image\r\n    image_filename = f\"{base_name}_chart.png\"\r\n    image_path = os.path.join(currency_output_dir, image_filename)\r\n\r\n    # Plot Market Structure with Support & Resistance and save as an image\r\n    mpf.plot(\r\n        df,\r\n        type=\"candle\",\r\n        style=\"charles\",\r\n        volume=False,\r\n        title=f\"Market Structure Analysis - {base_name}\",\r\n        addplot=[\r\n            mpf.make_addplot(df[\"Support\"], scatter=True, marker=\"v\", color=\"green\"),\r\n            mpf.make_addplot(df[\"Resistance\"], scatter=True, marker=\"^\", color=\"red\")\r\n        ],\r\n        savefig=dict(fname=image_path, dpi=300, bbox_inches=\"tight\"),\r\n        warn_too_much_data=False  # Avoid warnings for gaps (e.g., weekends)\r\n    )\r\n\r\n    print(f\"\\u2705 Market structure analysis complete for {file_path}. Processed data saved as '{output_json_path}'.\")\r\n    print(f\"\\u2705 Chart saved as: {image_path}\")\r\n\r\n    return output_json_path, image_path\r\n\r\n\r\ndef process_files_by_currency(file_lists, output_dir):\r\n    \"\"\"Processes files grouped by currency pairs.\"\"\"\r\n    processed_files_by_currency = []\r\n\r\n    for currency_files in file_lists:\r\n        processed_files = []\r\n        for file_path in currency_files:\r\n            processed_json, processed_image = process_and_plot(file_path, output_dir)\r\n            if processed_json and processed_image:\r\n                processed_files.append((processed_json, processed_image))\r\n        processed_files_by_currency.append(processed_files)\r\n\r\n    return processed_files_by_currency\r\n","path":null,"size_bytes":5959,"size_tokens":null},"attached_assets/README_1764097643859.md":{"content":"\n# Forex and Crypto Market Analyzer\n\nThis project provides a comprehensive market analysis tool for both Forex and Cryptocurrency pairs, leveraging the power of AI (specifically Google's Gemini) for technical analysis and generating trading signals. It retrieves historical data, performs technical analysis using Smart Money Concepts (SMC) and Wyckoff methodology, and delivers the results via email.\n\n## Table of Contents\n\n* [Project Overview](#project-overview)\n* [Features](#features)\n* [Getting Started](#getting-started)\n    * [Prerequisites](#prerequisites)\n    * [Installation](#installation)\n    * [Configuration](#configuration)\n    * [Usage](#usage)\n    * [Arguments](#arguments)\n* [Project Structure](#project-structure)\n* [Modules and Functionality](#modules-and-functionality)\n    * [`forex_mailer.py`](#forex_mailerpy)\n    * [`forexApp.py`](#forexapppy)\n    * [`fx.py`](#fxpy)\n    * [`price_channels.py`](#price_channelspy)\n    * [`tradebot.py`](#tradebotpy)\n    * [`trade.py`](#tradepypy)\n    * [`tradde.py`](#traddepypy)\n* [Technical Analysis Strategies](#technical-analysis-strategies)\n    * [Smart Money Concepts (SMC)](#smart-money-concepts-smc)\n    * [Wyckoff Method](#wyckoff-method)\n* [Parallel Processing](#parallel-processing)\n* [Email Integration](#email-integration)\n* [Error Handling](#error-handling)\n* [Contributing](#contributing)\n* [License](#license)\n* [Disclaimer](#disclaimer)\n* [Contact](#contact)\n* [Acknowledgements](#acknowledgements)\n\n\n\n## Project Overview\n\nThis project aims to automate the process of technical analysis for Forex and Crypto markets using AI-powered insights. It combines data retrieval, technical analysis using SMC and Wyckoff strategies, signal generation, and email delivery into a single, streamlined workflow. The analysis results are presented in an easy-to-understand format, enabling traders to make more informed decisions.\n\n## Features\n\n* **Automated Data Retrieval:** Retrieves historical market data for specified Forex and Crypto pairs using `yfinance`.\n* **AI-Powered Technical Analysis:** Employs Google's Gemini AI model to perform technical analysis based on SMC and Wyckoff principles.\n* **Smart Money Concepts (SMC) Analysis:** Identifies potential buy/sell zones by analyzing order flow, liquidity manipulation, and supply/demand imbalances.\n* **Wyckoff Method Analysis:** Predicts short-term market direction based on price and volume patterns, identifying accumulation and distribution phases.\n* **Signal Generation:** Generates trading signals with entry points, stop-loss levels, and target prices.\n* **Email Notifications:** Sends analysis results and charts as HTML emails with attachments.\n* **Parallel Processing:** Utilizes multiprocessing to speed up the analysis process.\n* **Customizable Parameters:** Allows for customization of analysis parameters, such as timeframes and trading pairs.\n* **Error Handling and Logging:** Includes error handling mechanisms to ensure robustness and provides logging for debugging.\n\n## Getting Started\n\n\n### Prerequisites\n\n* **Python 3.7 or higher:** Ensure you have a compatible Python version installed.\n* **Required Libraries:** Install the necessary Python packages using:\n```bash\npip install -r requirements.txt\n```\nThe `requirements.txt` file should contain the following:\n\n```\nmistune\nyfinance\npandas\nmplfinance\nscipy\ngoogle-generativeai\npython-dotenv\n```\n\n* **Google Cloud Project and API Key:** Create a Google Cloud project, enable the Gemini API, and obtain an API key. Store the API key in an environment variable named `GOOGLE_API_KEY`.  See the [Gemini documentation](https://developers.generativeai.google/) for details.\n* **(Optional) Gmail Account for Email:** If you want to use the email notification feature, you'll need a Gmail account and an app-specific password.\n\n\n### Installation\n\n1. Clone the repository:\n```bash\ngit clone https://github.com/your-username/forex-crypto-analyzer.git  # Replace with your repository URL\n```\n\n2. Navigate to the project directory:\n```bash\ncd forex-crypto-analyzer\n```\n\n\n### Configuration\n\n1. **API Key:** Set the `GOOGLE_API_KEY` environment variable with your Gemini API key. You can do this in your shell startup file (e.g., `.bashrc`, `.zshrc`) or by setting it directly in the terminal:\n\n   ```bash\n   export GOOGLE_API_KEY=\"YOUR_API_KEY\"  # Replace with your actual API key\n   ```\n\n2. **Email Credentials (Optional):** If using the email feature, update the `sender`, `password`, and `recipient` variables in `forexApp.py` and `fx.py` with your Gmail credentials.  It is **strongly recommended** to use an app-specific password for security.\n\n3. **File Paths:** Adjust the file paths in the scripts (`forexApp.py`, `fx.py`, `price_channels.py`, `tradebot.py`, `trade.py`, `tradde.py`) if you want to store data and results in different locations.\n\n\n### Usage\n\nTo run the analysis, execute the `fx.py` script with a command-line argument:\n\n* For Forex analysis:\n```bash\npython fx.py forex\n```\n\n* For Crypto analysis:\n```bash\npython fx.py btc\n```\n\n\n### Arguments\n\nThe `fx.py` script accepts one argument:\n\n* `forex` (or any other string except \"btc\"): Runs the analysis for Forex pairs.\n* `btc`: Runs the analysis for Cryptocurrency pairs.\n\n\n## Project Structure\n\n```\nforex-crypto-analyzer/\n forex_mailer.py       # Module for sending email notifications\n forexApp.py          # Main application script for Forex/Crypto analysis\n fx.py                 # Entry point script with argument handling\n price_channels.py     # Module for Wyckoff analysis\n tradebot.py          # Module for SMC analysis\n trade.py             # Module for data retrieval and processing\n tradde.py            # Module for chart generation and support/resistance detection\n requirements.txt       # List of project dependencies\n```\n\n\n\n\n## Modules and Functionality\n\n\n\n### `forex_mailer.py`\n\nThis module handles sending email notifications with HTML content and attachments.\n\n* **`markdown_to_html_email()`:** Converts a Markdown file to HTML and sends it as an email with optional attachments.\n\n\n\n### `forexApp.py`\n\nThis script orchestrates the market analysis process.\n\n* **`sort_files()`:** Sorts file paths, prioritizing JSON files.\n* **`firstStep()`:** Executes the SMC analysis using `tradebot.py`.\n* **`secondStep()`:** Executes the Wyckoff analysis using `price_channels.py`.\n* **`analyseFile()`:** Processes a single set of files (JSON and PNG).\n* **`fx_analyser()`:** Main function that retrieves data, processes it, performs analysis, and (optionally) sends emails.\n\n\n\n### `fx.py`\n\nThis script is the main entry point for the project.\n\n* **`forex_signals()`:** Uses Gemini to generate trading signals from the analysis results.\n* **`main()`:** Handles command-line arguments, runs the analysis, and sends email notifications.\n\n\n\n\n### `price_channels.py`\n\nThis module performs technical analysis based on the Wyckoff method using Gemini.\n\n* **`PriceChannelAnalyzer` class:**\n    * **`__init__()`:** Initializes the analyzer, creates the Gemini model, and sets up file paths.\n    * **`_create_model()`:** Creates the Gemini model with specified configurations.\n    * **`_upload_file()`:** Uploads a file to Gemini.\n    * **`_wait_for_files_active()`:** Waits for uploaded files to become active.\n    * **`upload_files()`:** Uploads all specified files.\n    * **`analyze_market()`:** Performs the Wyckoff analysis using Gemini and saves the results.\n\n\n\n\n### `tradebot.py`\n\nThis module performs technical analysis based on Smart Money Concepts using Gemini.\n\n* **`GeminiMarketAnalyzer` class:**  (Similar structure and methods as `PriceChannelAnalyzer` in `price_channels.py`)\n\n\n\n### `trade.py`\n\nThis module handles data retrieval and processing using `yfinance`.\n\n* **`ForexDataProcessor` class:**\n    * **`__init__()`:** Initializes the data processor.\n    * **`get_forex_data()`:** Downloads data for a specific pair, period, and interval.\n    * **`process_timeframe()`:** Processes data for a given timeframe (period and interval).\n    * **`process_all_timeframes()`:** Processes data for all specified timeframes.\n    * **`sort_paths_by_currency()`:** Sorts file paths by currency pair.\n* **`dataRetriever()`:** Retrieves data for specified pairs and timeframes.\n\n\n\n\n\n### `tradde.py`\n\nThis module handles plotting, support/resistance detection, and saving charts as images.\n\n* **`process_and_plot()`:** Processes a single data file, generates a chart, and saves it as a PNG image.\n* **`process_files_by_currency()`:** Processes a list of files grouped by currency pair.\n\n\n\n\n## Technical Analysis Strategies\n\n### Smart Money Concepts (SMC)\n\nThis strategy focuses on identifying the actions of institutional traders (\"smart money\") by analyzing order flow, liquidity, and supply/demand imbalances. It uses concepts like market structure, order blocks, imbalances, and liquidity pools to predict near-term price movements.\n\n### Wyckoff Method\n\nThis method predicts market direction by analyzing price and volume patterns, identifying accumulation and distribution phases. It looks for specific events like Preliminary Support (PS), Selling Climax (SC), Automatic Rally (AR), Secondary Test (ST), and Spring (in accumulation) or their distribution phase equivalents to predict price movements.\n\n## Parallel Processing\n\nThe project utilizes the `concurrent.futures` module to perform data retrieval and analysis in parallel, significantly reducing processing time. The `ProcessPoolExecutor` is used for process-based parallelism, taking advantage of multiple CPU cores.\n\n## Email Integration\n\nThe `forex_mailer.py` module provides functionality to send email notifications with HTML content and attachments. This allows users to receive the analysis results and charts directly in their inbox.  Uses `smtplib` and the `email` modules.  Requires a Gmail account (or other SMTP server configuration).\n\n\n## Error Handling\n\nThe code includes error handling mechanisms (`try...except` blocks) to gracefully handle potential errors during data retrieval, processing, and analysis. Error messages are printed to the console to assist with debugging.\n\n## Contributing\n\nContributions to this project are welcome. Please follow these guidelines:\n\n1. Fork the repository.\n2. Create a new branch for your feature or bug fix.\n3. Make your changes and commit them with clear commit messages.\n4. Push your branch to your forked repository.\n5. Create a pull request to the main repository.\n\n\n## License\n\nThis project is licensed under the [MIT License](LICENSE).\n\n\n## Disclaimer\n\nThis project is for educational and informational purposes only. It should not be considered financial advice. Trading in financial markets involves substantial risk, and you should consult with a qualified financial advisor before making any investment decisions.  The AI-generated analysis and trading signals are not guaranteed to be accurate and should not be solely relied upon for making trading decisions.\n\n\n## Contact\n\nFor any inquiries or feedback, please contact braimahgifted@gmail.com.\n\n\n## Acknowledgements\n\n* **yfinance:** For providing a convenient way to retrieve financial data.\n* **mplfinance:** For creating financial charts.\n* **scipy:** For scientific computing functions used in analysis.\n* **Google Gemini:** For powering the AI-driven technical analysis.\n\n","path":null,"size_bytes":11380,"size_tokens":null},"attached_assets/price_channels_1764097643859.py":{"content":"import os\r\nimport time\r\nfrom dotenv import load_dotenv\r\nimport google.generativeai as genai\r\nimport re\r\n\r\n\r\nload_dotenv()\r\nGOOGLE_API_KEY = os.getenv(\"GOOGLE_API_KEY\")\r\ngenai.configure(api_key=GOOGLE_API_KEY)\r\n\r\n\r\nclass PriceChannelAnalyzer:\r\n    def __init__(self, file_paths, mime_types):\r\n        \"\"\"\r\n        Initializes the GeminiMarketAnalyzer with file paths and their mime types.\r\n\r\n        Args:\r\n            file_paths (list): List of file paths to be uploaded.\r\n            mime_types (list): List of mime types corresponding to the file paths.\r\n        \"\"\"\r\n\r\n        if len(file_paths) != len(mime_types):\r\n            raise ValueError(\"Length of file_paths and mime_types must be the same.\")\r\n\r\n        self.file_paths = file_paths\r\n        self.mime_types = mime_types\r\n        self.files = []\r\n        self.model = self._create_model()\r\n        \r\n        os.makedirs(r\"C:\\Users\\USER\\Downloads\\gen-ai\\fx_analysis\", exist_ok=True)\r\n        \r\n        self.file_name = os.path.splitext(os.path.basename(self.file_paths[0]))[0]\r\n        self.base_name = os.path.splitext(self.file_name)[0][:7]\r\n    \r\n         # Create the output directory using the extracted name\r\n        self.directory_path = os.path.join(r\"C:\\Users\\USER\\Downloads\\gen-ai\\fx_analysis\", self.base_name)\r\n        os.makedirs(self.directory_path, exist_ok=True)\r\n        self.pre_result = self.base_name+\"_analysis.md\"\r\n        self.resultFile = os.path.join(self.directory_path, self.pre_result)\r\n\r\n    def _create_model(self):\r\n          \"\"\"Creates the Gemini model with specified configurations.\"\"\"\r\n          generation_config = {\r\n            \"temperature\": 2,\r\n            \"top_p\": 0.95,\r\n            \"top_k\": 40,\r\n            \"max_output_tokens\": 8192,\r\n            \"response_mime_type\": \"text/plain\",\r\n          }\r\n\r\n          model = genai.GenerativeModel(\r\n            model_name=\"gemini-2.0-flash-exp\",\r\n            generation_config=generation_config,\r\n            system_instruction=\"Role: You are a technical analysis expert who excels in using wyckoff analysis to tell if the market will go up next, or go down. ensure you first state the **current market state**\\\\\\\\n**input: you will be given forex data, consume the hourly, daily and weekly price action  starting from the latest data \\\\\\\\n**output: the next scenerio the market is about to enter in the next candlesticks whether up, down or sideways or short pullback. always state the suggested pricesprices\\\\\\\\n**Strategy: ```Wyckoff Method for Short-Term Market Direction Prediction\\nI. Executive Summary:\\n\\nThis document outlines a short-term trading strategy based on the Wyckoff method of market analysis. The Wyckoff method centers on understanding the interplay of supply and demand, recognizing the influence of the \\\"Composite Man\\\" (representing informed institutional investors), and identifying predictable market cycles. The primary objective of this strategy is to forecast whether the market (or a specific asset) is likely to move up, down, or sideways within the next few trading candles by analyzing price and volume action on candlestick charts. This strategy leverages key Wyckoff events within accumulation and distribution phases, coupled with volume and price action confirmation, to identify high-probability trading opportunities. Potential benefits include identifying potential turning points early, improving entry timing, and managing risk effectively.\\n\\nII. Background on Wyckoff Analysis:\\n\\nA. The \\\"Composite Man\\\":\\n\\nThe Wyckoff method posits the existence of a hypothetical entity called the \\\"Composite Man\\\" or \\\"Composite Operator.\\\" This represents the collective actions of large, informed institutional investors who strategically accumulate positions before a significant price increase (Markup) and distribute their holdings before a significant price decrease (Markdown). Understanding the actions of the Composite Man is crucial, as their footprints are often visible on the charts through specific price and volume patterns. The Composite Man intentionally manipulates the market to induce reactions from less informed traders, buying low during periods of panic selling and selling high during periods of exuberant buying. By recognizing these manipulative tactics, traders can align themselves with the Composite Man's anticipated moves.\\n\\nB. The Three Laws of Wyckoff:\\n\\nLaw of Supply and Demand: This fundamental law states that price movements are a direct result of the balance between buying (demand) and selling (supply) pressure. When demand exceeds supply, prices rise; when supply exceeds demand, prices fall. Wyckoff analysis focuses on interpreting volume in conjunction with price action to gauge the relative strength of supply and demand. High volume during a price rise suggests strong demand, while high volume during a price fall suggests strong supply. Conversely, low volume during a price rise might indicate a lack of genuine buying interest, and low volume during a price fall might suggest limited selling pressure, potentially leading to a reversal.\\n\\nLaw of Cause and Effect: This law suggests that price movements are not random but are preceded by periods of preparation. Accumulation is the \\\"cause\\\" that leads to an eventual Markup (the \\\"effect\\\"). Conversely, Distribution is the \\\"cause\\\" that leads to a subsequent Markdown (the \\\"effect\\\"). The horizontal trading range formed during accumulation or distribution represents the \\\"cause,\\\" and the extent of this range can be used to estimate the potential magnitude of the subsequent \\\"effect\\\" (price movement). For short-term predictions, identifying the stage of accumulation or distribution helps determine the likely direction of the next move. A breakout from an accumulation range suggests an upward move, while a breakdown from a distribution range suggests a downward move.\\n\\nLaw of Effort vs. Result: This law examines the relationship between the \\\"effort\\\" exerted (volume) and the \\\"result\\\" achieved (price movement). A discrepancy between effort and result can signal a potential change in the direction of the trend. For example, if there is high volume (significant effort) but only a small price movement (weak result) during an uptrend, it might indicate that buying pressure is waning and a reversal is possible. Conversely, if there is low volume (minimal effort) but a significant price drop (strong result) during a downtrend, it could suggest a lack of strong selling pressure and a potential for a bounce. This law is particularly useful for identifying \\\"traps\\\" set by the Composite Man, where high volume and price movement in one direction are quickly reversed.\\n\\nC. The Wyckoff Market Cycle:\\n\\nThe market cycle, according to Wyckoff, progresses through four distinct phases:\\n\\nAccumulation: This is a period of sideways trading where the Composite Man is strategically accumulating a large position without significantly driving up the price. Volume tends to increase towards the end of this phase as buying interest grows. The goal is to buy low before the broader market recognizes the potential for an upward move.\\n\\nMarkup: This is the upward trending phase where demand dominates. As the Composite Man releases their accumulated holdings into the market, the price steadily increases. Volume generally increases during advances and decreases during pullbacks.\\n\\nDistribution: This is another period of sideways trading, but this time the Composite Man is strategically selling their holdings into the market as demand reaches its peak. Volume tends to be high during this phase as selling pressure increases. The goal is to sell high before the broader market realizes the potential for a downward move.\\n\\nMarkdown: This is the downward trending phase where supply dominates. As the Composite Man unloads their positions, the price steadily decreases. Volume generally increases during declines and decreases during rallies.\\n\\nFor short-term trading, identifying the current phase within a smaller timeframe cycle is crucial. Is the market currently undergoing accumulation, showing signs of breaking into a markup? Or is it in distribution, poised for a markdown? Recognizing these patterns on shorter timeframes allows for anticipating the immediate direction.\\n\\nIII. Strategy Components:\\n\\nA. Chart Setup:\\n\\nPreferred Timeframe for Analysis: This strategy is designed for short-term predictions, focusing on moves within the next few candles. Therefore, the recommended timeframes are 5-minute, 15-minute, or 30-minute charts. These timeframes provide sufficient granularity to identify Wyckoff events while capturing short-term price fluctuations. Analyzing multiple timeframes (e.g., 15-minute for primary analysis and 5-minute for refined entry) can enhance accuracy.\\n\\nCandlestick Patterns: Key candlestick patterns to be used include:\\n\\nEngulfing Patterns (Bullish and Bearish): Signal potential reversals. A bullish engulfing pattern suggests the end of a downtrend, while a bearish engulfing pattern suggests the end of an uptrend.\\n\\nHammers and Hanging Men: Single candlestick reversal patterns. A hammer at the bottom of a downtrend indicates potential buying pressure, while a hanging man at the top of an uptrend suggests potential selling pressure.\\n\\nShooting Stars and Inverted Hammers: Similar to hammers and hanging men, but appear in different contexts. A shooting star at the top of an uptrend suggests selling pressure, while an inverted hammer at the bottom of a downtrend indicates potential buying interest.\\n\\nDojis: Indicate indecision in the market and can signal potential turning points, especially when appearing after a sustained move.\\n\\nVolume Indicators: Volume is a critical component of Wyckoff analysis.\\n\\nVolume Bars: Standard volume bars displayed below the price chart. Focus on the relative size of volume bars in relation to price movements and previous volume.\\n\\nOn-Balance Volume (OBV): A cumulative indicator that adds volume on up days and subtracts volume on down days. Divergence between OBV and price can signal potential trend changes. For example, if price makes new highs but OBV does not, it suggests weakening buying pressure.\\n\\nB. Identification of Wyckoff Events:\\n\\nAccumulation Phase:\\n\\nPreliminary Support (PS): Initial buying activity emerges after a downtrend, suggesting some buyers are starting to enter the market. Volume is typically moderate to high. This often manifests as a strong bounce off a low.\\n\\nSelling Climax (SC): Intense selling pressure culminates in a sharp price decline on very high volume. This signifies capitulation as weak holders exit their positions. The large volume and wide price spread indicate a potential bottom.\\n\\nAutomatic Rally (AR): A significant rebound after the SC, driven by short covering and initial buying from informed investors. This defines the upper boundary of the trading range. Volume is usually high but less than the SC.\\n\\nSecondary Test (ST): A re-testing of the SC low to gauge the remaining selling pressure. Successful STs show decreased volume compared to the SC, indicating that sellers are becoming exhausted. Multiple STs can occur. Look for bullish candlestick patterns during STs.\\n\\nSpring: A manipulative move where price temporarily breaks below the support level of the trading range (the low of the SC or ST) before quickly reversing and closing back within the range on increased volume. This \\\"shakes out\\\" remaining weak holders and confirms the Composite Man's accumulation. This is a key signal for potential long entries.\\n\\nDistribution Phase:\\n\\nPreliminary Supply (PSY): Initial selling pressure appears after an uptrend, suggesting some informed investors are starting to take profits. Volume is typically moderate to high. This might be seen as a stalling of the uptrend.\\n\\nBuying Climax (BC): High volume buying as the uptrend reaches its peak. This signifies exuberance and the entry of less informed buyers. The large volume and wide price spread indicate a potential top.\\n\\nAutomatic Reaction (AR): A significant decline after the BC, driven by profit-taking and initial selling from informed investors. This defines the lower boundary of the trading range. Volume is usually high but less than the BC.\\n\\nSecondary Test (ST): A re-testing of the BC high to gauge the remaining buying pressure. Successful STs show decreased volume compared to the BC, indicating that buyers are becoming exhausted. Look for bearish candlestick patterns during STs.\\n\\nUpthrust: A manipulative move where price temporarily breaks above the resistance level of the trading range (the high of the BC or ST) before quickly reversing and closing back within the range on increased volume. This \\\"traps\\\" late buyers and confirms the Composite Man's distribution. This is a key signal for potential short entries.\\n\\nMarkup and Markdown Phases:\\n\\nMarkup: Characterized by sustained upward price movement with increasing volume on advances and decreasing volume on pullbacks. Look for strong bullish candlestick patterns and consistent higher highs and higher lows.\\n\\nMarkdown: Characterized by sustained downward price movement with increasing volume on declines and decreasing volume on rallies. Look for strong bearish candlestick patterns and consistent lower highs and lower lows. Absence of significant Wyckoff accumulation events prior to the markdown confirms its strength.\\n\\nC. Confirmation Signals:\\n\\nVolume Analysis: This is paramount.\\n\\nIncreased volume on breakouts: A breakout above resistance after accumulation or below support after distribution should be accompanied by a significant increase in volume to confirm the strength of the move.\\n\\nDecreased volume on tests/retests: During Secondary Tests (STs) in both accumulation and distribution, decreasing volume on the retest is a positive sign.\\n\\nDivergence between price and volume: As mentioned with OBV, discrepancies can indicate potential trend changes.\\n\\nPrice Action: Specific candlestick patterns provide additional confirmation.\\n\\nReversal patterns at key Wyckoff events: Engulfing patterns, hammers/hanging men, shooting stars at SC, ST, BC, and ST provide strong confirmation.\\n\\nBreak of trendlines: Breaking above a downtrend line after accumulation or below an uptrend line after distribution.\\n\\nSuccessful tests of support and resistance: Bouncing off support after accumulation and rejecting resistance after distribution.\\n\\nTrendlines and Support/Resistance Levels: Use these tools to define the trading range during accumulation and distribution. Breakouts and breakdowns from these levels, confirmed by volume, are significant signals. Look for confluence: when a Wyckoff event occurs near a significant support or resistance level, the signal is strengthened.\\n\\nD. Trading Rules:\\n\\nEntry Rules:\\n\\nLong Entry (Anticipating Markup):\\n\\nSpring: Enter long on the close of the candle that reverses back into the trading range after a spring, especially if accompanied by high volume.\\n\\nBreakout from Accumulation: Enter long on a confirmed breakout above the resistance level of the accumulation range, accompanied by increased volume.\\n\\nSecondary Test (ST) in Accumulation: Enter long after a successful ST showing decreased volume and bullish candlestick patterns near the support level.\\n\\nShort Entry (Anticipating Markdown):\\n\\nUpthrust: Enter short on the close of the candle that reverses back into the trading range after an upthrust, especially if accompanied by high volume.\\n\\nBreakdown from Distribution: Enter short on a confirmed breakdown below the support level of the distribution range, accompanied by increased volume.\\n\\nSecondary Test (ST) in Distribution: Enter short after a successful ST showing decreased volume and bearish candlestick patterns near the resistance level.\\n\\nAvoid entries during the initial phases (PS, SC, AR, PSY, BC, AR) as these phases are primarily for identifying the trading range. Focus on entries after confirmation of the accumulation or distribution structure.\\n\\nStop-Loss Orders: Place stop-loss orders strategically to limit potential losses.\\n\\nLong Entry: Place the stop-loss slightly below the low of the spring or the support level of the accumulation range.\\n\\nShort Entry: Place the stop-loss slightly above the high of the upthrust or the resistance level of the distribution range.\\n\\nProfit Targets: Determine potential profit targets based on the projected price movement.\\n\\nMarkup: Target potential resistance levels or use Fibonacci extensions based on the accumulation range's height.\\n\\nMarkdown: Target potential support levels or use Fibonacci extensions based on the distribution range's height.\\n\\nFor short-term trades (next few candles), consider targeting the opposite end of the identified trading range or a smaller, predetermined profit target based on volatility.\\n\\nPosition Sizing: Risk a small percentage of your trading capital on each trade (e.g., 1-2%). Adjust position size based on your stop-loss distance to maintain consistent risk per trade.\\n\\nIV. Strategy Implementation:\\n\\nStep-by-step guide:\\n\\nChart Setup: Configure your charting platform with the preferred timeframe (5, 15, or 30 minutes), candlestick charts, and volume indicators (volume bars and optionally OBV).\\n\\nIdentify Potential Trading Ranges: Scan charts for periods of sideways price action that could represent accumulation or distribution phases.\\n\\nLook for Wyckoff Events: Actively look for the specific price and volume patterns associated with Preliminary Support (PS), Selling Climax (SC), Automatic Rally (AR), Secondary Tests (ST), and Springs during potential accumulation phases. Similarly, look for Preliminary Supply (PSY), Buying Climax (BC), Automatic Reaction (AR), Secondary Tests (ST), and Upthrusts during potential distribution phases.\\n\\nConfirm with Volume and Price Action: Analyze volume during each event. Increased volume on breakouts and decreased volume on tests are key confirmations. Look for confirming candlestick patterns and trendline breaks.\\n\\nDetermine the Stage of the Cycle: Based on the identified events, assess whether the market is likely in accumulation (preparing for markup) or distribution (preparing for markdown).\\n\\nApply Trading Rules: Based on the identified Wyckoff events and confirmations, set entry orders, stop-loss orders, and potential profit targets according to the defined trading rules.\\n\\nMonitor the Trade: Observe price action and volume after entering a trade. Be prepared to adjust stop-loss levels or take profits if the market moves favorably.\\n\\nRecord and Review: Maintain a trading journal to track your trades, noting the Wyckoff events identified, entry and exit points, and the outcome of the trade. Regularly review your journal to identify areas for improvement.\\n\\nExamples:\\n\\nExample 1: Identifying a Spring and Entering Long: On a 15-minute chart, after a downtrend, you observe a PS, SC with high volume, and an AR. Price then revisits the SC low (ST) with lower volume. Subsequently, price briefly breaks below the ST low on slightly increased volume but quickly reverses back into the range, closing strong. This is a Spring. You enter a long position on the close of this bullish reversal candle with a stop-loss below the low of the spring. Your profit target is the upper resistance of the trading range.\\n\\nExample 2: Identifying an Upthrust and Entering Short: On a 15-minute chart after an uptrend, you observe a PSY, BC with high volume, and an AR. Price then revisits the BC high (ST) with lower volume. Price then briefly breaks above the ST high on slightly increased volume but quickly reverses back into the range, closing weak. This is an Upthrust. You enter a short position on the close of this bearish reversal candle with a stop-loss above the high of the upthrust. Your profit target is the lower support of the trading range.\\n\\nTools and Resources:\\n\\nCharting Software: TradingView, MetaTrader 4/5, Thinkorswim (platforms that offer advanced charting features, volume indicators, and the ability to draw trendlines and support/resistance levels).\\n\\nVolume Indicators: Standard volume bars are essential. On-Balance Volume (OBV) can be a helpful supplementary indicator.\\n\\nEducational Materials: Books and online resources dedicated to the Wyckoff method (e.g., \\\"Trading in the Zone\\\" by Mark Douglas which, while not solely focused on Wyckoff, emphasizes the psychological aspects crucial for its successful application, and resources specifically on Wyckoff principles).\\n\\nV. Risk Management:\\n\\nRisk Tolerance: Define your maximum acceptable risk per trade as a percentage of your trading capital (e.g., 1-2%). Understand your overall portfolio risk tolerance.\\n\\nPosition Sizing: Calculate your position size for each trade based on your risk tolerance and the distance between your entry point and stop-loss order. This ensures you don't risk more than your predetermined amount on any single trade.\\n\\nStop-Loss Orders: Crucially important. Always use stop-loss orders to limit potential losses. Never trade without a stop-loss. Adjust stop-loss levels as the trade progresses favorably to lock in profits (trailing stops).\\n\\nMonitoring and Review: Continuously monitor your open positions and be prepared to adjust your strategy if market conditions change. Regularly review your trading performance to identify weaknesses and areas for improvement. Keep a detailed trading journal.\\n\\nVI. Strategy Evaluation and Refinement:\\n\\nBacktesting: Use historical chart data to manually or programmatically test the strategy's effectiveness. Identify historical instances of Wyckoff events and apply the trading rules to see how the strategy would have performed. Be mindful of potential biases in backtesting.\\n\\nForward Testing: Implement the strategy on a demo account or with a very small amount of real capital to evaluate its performance in real-time market conditions without risking significant capital. This helps to identify any practical challenges in applying the strategy.\\n\\nPerformance Metrics: Track key metrics such as:\\n\\nWin Rate: Percentage of winning trades.\\n\\nAverage Profit per Winning Trade: Average profit made on successful trades.\\n\\nAverage Loss per Losing Trade: Average loss incurred on unsuccessful trades.\\n\\nProfit Factor: Ratio of total gross profit to total gross loss.\\n\\nMaximum Drawdown: The largest peak-to-trough decline in your trading account.\\n\\nContinuous Improvement: Regularly analyze your performance metrics and trading journal to identify areas where the strategy can be refined. Adapt the strategy based on changing market conditions and your own trading experience. Be prepared to modify entry and exit rules, stop-loss placement, and profit targets based on data and observation.\\n\\nVII. Conclusion:\\n\\nThis short-term trading strategy, grounded in the Wyckoff method, offers a framework for predicting near-term market direction by understanding the interplay of supply and demand, the actions of the Composite Man, and recurring market cycles. By diligently identifying Wyckoff events, confirming them with volume and price action, and adhering to strict risk management principles, traders can improve their entry timing and potentially capitalize on short-term market fluctuations. However, successful implementation requires discipline, patience to wait for high-probability setups, and a commitment to continuous learning and refinement of the strategy. **Example response:** Okay, let's analyze this EUR/USD data using the Wyckoff method.\\n\\n**Overall Market Context**\\n\\n* **Current Market State (as of the last data point)** *   **Last Price:** 1.0248001814 *   **Last Date:** 2025-01-10T22:00:00.000Z (10 Jan 2025, 10 PM GMT) \\n\\n   **Weekly Chart:** The weekly chart clearly shows a significant downtrend, confirming a market undergoing the markdown phase. \\n    * The market was trending upwards until mid-August and entered the Markdown stage with huge bearish engulfing bar. It started forming lower lows, which further solidifies the downtrend direction.  There is a notable increase in volatility recently\\n*   **Daily Chart:** The daily chart displays a very distinct and volatile downtrend structure within the markdown phase. The price broke through a significant low at the start of November and this created massive volatility towards 1.02 handle.. There have been no clear accumulation patterns visible that will lead to a markup at all. There might be small distribution range at the end of Nov. However, it did not hold. The most recent daily price action are all sharp moves toward downside which shows an imbalance of sellers in market.\\n*   **Hourly Chart:** This confirms a markdown in price. The past few candles show volatility.  Recent price action suggests potential volatility, though not always leading to clear direction, suggesting consolidation prior to markdowns in the upcoming sessions. We need a decisive breakdown or test/bounce for clear direction\\n     * From the 6th to 7th of Jan, a significant upward trend but this does not suggest change of bigger trend yet. Since, there were small upward thrusts until the 8th of Jan and we see further continuation toward downward movement which validates bearish sentiments\\n      \\n**Recent Price Action**\\n *    From the weekly time-frame.  the most recent large bars that we saw shows increase in volatility and bears still have dominance. There might be minor bull bounce before it continues further towards down\\n  *    From daily - huge downtrend that showed no retracement and it indicates it will not stop. Expect lower low.  It has made no signal of changing into a markup. Recent daily trend suggest high volatility.\\n  *  From the hourly perspective. the trend went up slightly for a bit. This looks like just short correction/pullback as it tried to retest. Then recent action shows downtrend starting the 8th to 9th  which shows further price downtrend to be valid. we now expect market to continue lower as its shows an aggressive sell off and this was confirmed by breakdown the past day\\n\\n**Wyckoff Analysis & Short-Term Prediction**\\n\\n1.  **Current Phase:** All the analysis confirms current phase is Markdown on daily time-frame . We must respect the big picture until proven otherwise. Any upward move at this point might just be short covering with an expectation that price to continue markdown as part of the larger trend,\\n2.  **Effort vs Result**:\\n   * The large sell off we saw the recent hours confirms the downward pressure\\n   * volume on hourly suggest sellers still have much in reserves\\n3. **Recent Wyckoff events**: we are seeing constant markdowns as price make lower lows consistently with volatile prices . The most recent low that we saw shows it breaking support, creating huge sell off confirming larger downtrend . the volatility seems high right now and consolidation not apparent as price still moving downward with aggressive sell off\\n\\n**Short-Term Prediction:**\\n\\nGiven the downtrend and the current position, we are still bearish with market poised for further lower low as its shown an aggressive downtrend\\n\\n*   **Next Few Candles**: I would suggest next few hours / days there will be either continuation of downtrend movement or further short bounce only for price to retest a bit then drop down again. Any rallies we will see will likely only be part of small retests in an attempt to form a short horizontal consolidation only to breakdown toward further low and to create more lower lows. Based on the aggressiveness of sell off - I think there will not even be any consolidation as there no significant buy power in market.\\n *  Based on Hourly there could be small sideways consolidation between price of  1.0256 to 1.0235 but do not hold for long since sellers aggressive so expect downward movement towards lower. It broke through the latest swing lows with huge candle so expect the 1.023 low not to hold too much. we are already bearish for a long while now, not even looking for markup signals at this stage of overall bearish price action\\n\\n*  **Suggested Price**:\\n      * We can place our stop-loss above 1.027 and any bullish attempts should only be an opportunity to short on the rally. As soon as it approaches 1.024/5  the downtrend is most likely going to reassert it. I think the trend should move down to reach the recent swing low on the 6th Jan or go much lower given aggressive sellers. we are heading below the low from  jan 6 th and could even hit the low from Dec 12 which is  1.014 if no buyers can provide the demand to fight bears off\\n**Trading Strategy**\\n\\n*  **Entry:** Look for a potential short position as price gets near any short bullish attempts toward prices around 1.027. However, do be very weary to see whether any consolidation occurs on the 5 minute and if none. Then short opportunity. if sideways consolidation forms - its better to be neutral as some spring could still be possible which is a bull trap and that also allows the smart money to position itself on short positions for later down push\\n*  **Stop-Loss:** Above 1.027 which protects against potential short squeeze and sudden moves.\\n*  **Target Prices:** Initial target will be the most recent hourly low at around 1.023-1.02. then look at price reaction after for decision of whether to extend more short target given bigger daily timeframe, or consider take profit . The market could move to below jan low on 1.0197/5 as a next possible target range to secure for future lows\\n\\n**Additional Notes**\\n   * Be nimble and fast to reduce loss on any sudden turns of market, given very high volatility\\n\\n**Disclaimer:** This analysis is based on the provided data and the Wyckoff method, and it should not be considered as a financial or trading advice. It is based on a single analysis given what is available. Further due dilligence with proper risk analysis should be practiced prior to real trade to take in effect wider market context and also your risk appetite\",\r\n        )\r\n          return model\r\n\r\n    def _upload_file(self, path, mime_type):\r\n        \"\"\"Uploads a file to Gemini.\"\"\"\r\n        file = genai.upload_file(path, mime_type=mime_type)\r\n        print(f\"Uploaded file '{file.display_name}' as: {file.uri}\")\r\n        return file\r\n\r\n    def _wait_for_files_active(self):\r\n        \"\"\"Waits for the uploaded files to be active.\"\"\"\r\n        print(\"Waiting for file processing...\")\r\n        for file in self.files:\r\n          while file.state.name == \"PROCESSING\":\r\n              print(\".\", end=\"\", flush=True)\r\n              time.sleep(10)\r\n              file = genai.get_file(file.name)\r\n          if file.state.name != \"ACTIVE\":\r\n              raise Exception(f\"File {file.name} failed to process\")\r\n        print(\"...all files ready\")\r\n        print()\r\n\r\n    def upload_files(self):\r\n        \"\"\"Uploads all specified files to Gemini and waits for processing.\"\"\"\r\n        for path, mime_type in zip(self.file_paths, self.mime_types):\r\n            file = self._upload_file(path, mime_type)\r\n            self.files.append(file)\r\n        self._wait_for_files_active()\r\n\r\n    def analyze_market(self):\r\n         \"\"\"Sends the message to gemini to perform the analysis and prints the result.\"\"\"\r\n         chat_session = self.model.start_chat(\r\n            history=[\r\n             \r\n            ]\r\n        )\r\n         \r\n\r\n         input_prompt =  [\"Start the analysis from the last datapoints. Dont forget to calculate the estimated entry prices for the signals and state them\"] + self.files\r\n        \r\n         response = chat_session.send_message(\r\n             input_prompt\r\n            )\r\n         for chunk in response:\r\n             print(chunk.text, end=\"\")\r\n             print(self.directory_path)\r\n             text = chunk.text\r\n             \r\n             match = re.search(r\"\\*\\*short-term(.*?)(?=trading strategy)\", text, re.IGNORECASE  | re.DOTALL)\r\n            \r\n             print(\"Extracting Wyckoff Analysis\")\r\n             response_text = match.group()\r\n                \r\n             with open(self.resultFile, \"a\", encoding=\"utf-8\") as file:\r\n                file.write(\"\\n\\n\" + \"-\" * 95 + \"\\n\\n\" + \"\\n\\n---------------------WYCKOFF ANALYSIS --------------------\\n\\n\" + response_text)\r\n        \r\n        \r\n        #  print(response.text)\r\n        # #  with open(r\"C:\\Users\\USER\\Downloads\\gen-ai\\Forex-Analysis.md\", \"a\", encoding=\"utf-8\") as file:\r\n        #     # file.write(response.text)\r\n        \r\n\r\n\r\nif __name__ == \"__main__\":\r\n    # Example usage:\r\n    file_paths = [r'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_3mo_1d_processed.json', r'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_1y_1wk_processed.json', r'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_5d_1h_processed.json', r'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_3mo_1d_chart.png', r'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_1y_1wk_chart.png', r'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_5d_1h_chart.png']\r\n    \r\n\r\n    mime_types = [\r\n        \"text/plain\",\r\n        \"text/plain\",\r\n        \"text/plain\",\r\n        \"image/png\",\r\n        \"image/png\",\r\n        \"image/png\",\r\n    ]\r\n    try:\r\n      analyzer = PriceChannelAnalyzer(file_paths, mime_types)\r\n      analyzer.upload_files()\r\n      analyzer.analyze_market()\r\n    except Exception as e:\r\n      print(f\"An error occurred: {e}\")","path":null,"size_bytes":33625,"size_tokens":null},"attached_assets/fx_1764097643859.py":{"content":"from datetime import datetime\r\nfrom forexApp import fx_analyser\r\nimport os\r\nimport google.generativeai as genai\r\nfrom forex_mailer import markdown_to_html_email\r\nimport sys  # Import the sys module\r\n\r\ngenai.configure(api_key=os.environ[\"GOOGLE_API_KEY\"])\r\n\r\ndef forex_signals(file, name):\r\n    result_file = file\r\n    file_name = name\r\n    generation_config = {\r\n        \"temperature\": 1,\r\n        \"top_p\": 0.95,\r\n        \"top_k\": 40,\r\n        \"max_output_tokens\": 8192,\r\n        \"response_mime_type\": \"text/plain\",\r\n    }\r\n\r\n    model = genai.GenerativeModel(\r\n        model_name=\"gemini-2.0-flash-exp\",\r\n        generation_config=generation_config,\r\n        system_instruction=\"you will be given a text containing the results of a trading analysis. there are three \\\"SMC Entries\\\" containing \\\"optimal entry price\\\" and three \\\"Wyckoff analysis\\\" containg the \\\"short term prediction\\\". you are to extract and summarize each \\\"SMC Entry\\\" and \\\"Wyckoff analysis\\\" in no more than 1 sentence, make sure to include the summary. \\n\\nexample reponse: \\\"Here are the Results of the Analysis:\\n\\n**Wyckoff Analysis:**\\n\\n*   **Wyckoff Analysis 1:** The analysis predicts continued downward movement with a small bounce near 0.6218 before a further decline towards 0.62.\\n*   **Wyckoff Analysis 2:** Expect sideways consolidation before a likely downward move towards 0.613, with short entries on rejections of a validated hourly distribution pattern.\\n*   **Wyckoff Analysis 3:** The market may move sideways with potential for a downside move, with a bearish bias unless a strong bullish breakout confirms otherwise.\\n\\\"\\n\\n**SMC Entries:**\\n\\n*   **SMC Entry 1:** A short entry is suggested around 0.6215 upon rejection with a target of 0.619, while a long entry is possible at 0.618 with a quick stop loss.\\n*   **SMC Entry 2:** A short entry is recommended at 0.6212 targeting 0.6206-0.6207 initially, potentially extending to 0.6199.\\n*   **SMC Entry 3:** A short entry is preferred at a specified zone, while a long position is only considered at 0.6197, both with tight stop losses and targets.\\n\\n**Summary:**\\n*   **Wyckoff: The first analysis predicts a continued downward movement immediately while the second and third analysis predicts a sideways movement first then downtrend\\n*   **SMC:  Preferred entries 1. Short - 0.6215     2. short - 0.6212    3. short - at specified zone\\n\",\r\n    )\r\n\r\n    chat_session = model.start_chat(\r\n        history=[\r\n        ]\r\n    )\r\n\r\n    print(\"Analysing \" + file_name)\r\n    md_content = \"\"\r\n    with open(result_file, \"r\", encoding=\"utf-8\") as file:\r\n        md_content = file.read()\r\n\r\n    response = chat_session.send_message(md_content)\r\n\r\n    with open(result_file, \"w\", encoding=\"utf-8\") as file:\r\n        file.write(response.text)\r\n\r\n    print(\"Finished Analysis for: \" + file_name)\r\n\r\nif __name__ == \"__main__\":\r\n    if len(sys.argv) < 2:\r\n        print(\"Please provide an argument ('btc' for crypto, anything else for forex).\")\r\n        sys.exit(1)\r\n\r\n    argument = sys.argv[1].lower()\r\n\r\n    forex_pairs_list = [\r\n        {\r\n            \"EUR/USD\": \"EURUSD=X\",\r\n            \"USD/JPY\": \"JPY=X\",\r\n            \"GBP/USD\": \"GBPUSD=X\",\r\n            \"USD/CHF\": \"CHF=X\",\r\n            \"USD/CAD\": \"CAD=X\"\r\n        },\r\n        {\r\n            \"AUD/USD\": \"AUDUSD=X\",\r\n            \"NZD/USD\": \"NZDUSD=X\",\r\n            \"GBP/JPY\": \"GBPJPY=X\",\r\n            \"EUR/JPY\": \"EURJPY=X\",\r\n            \"EUR/GBP\": \"EURGBP=X\"\r\n        }\r\n    ]\r\n\r\n    crypto_pairs_list = [\r\n        {\r\n            \"BTC/USD\": \"BTC-USD\",\r\n            \"BNB/USD\": \"BNB-USD\",\r\n            \"SOL/USD\": \"SOL-USD\",\r\n            \"AVAX/USD\": \"AVAX-USD\",\r\n            \"LINK/USD\": \"LINK-USD\"\r\n        },\r\n        {\r\n            \"UNI/USD\": \"UNI-USD\",\r\n            \"LTC/USD\": \"LTC-USD\",\r\n            \"DOGE/USD\": \"DOGE-USD\",\r\n            \"XRP/USD\": \"XRP-USD\",\r\n            \"ADA/USD\": \"ADA-USD\"\r\n        }\r\n    ]\r\n\r\n    if argument == \"btc\":\r\n        pairs = crypto_pairs_list\r\n    else:\r\n        pairs = forex_pairs_list\r\n\r\n    for pair_group in pairs:\r\n        for _ in range(3):  # Run fx_analyser 3 times for each pair\r\n            fx_analyser(pair_group)\r\n\r\n        print(\"Emailing Results\")\r\n\r\n        file_list = []\r\n        for root, _, files in os.walk(r\"C:\\Users\\USER\\Downloads\\gen-ai\\fx_analysis\"):\r\n            for file in files:\r\n                file_list.append(os.path.abspath(os.path.join(root, file)))\r\n        print(file_list)\r\n\r\n        for file in file_list:\r\n            file_name = os.path.splitext(os.path.basename(file))[0]\r\n\r\n            forex_signals(file, file_name)\r\n\r\n            markdown_file = file\r\n            recipient = \"braimahgifted@gmail.com\"\r\n            sender = \"braimahgifted@gmail.com\"\r\n            password = \"app-specific-password\"\r\n            subject_line = file_name\r\n            attachments = [\r\n                file,\r\n            ]\r\n\r\n            markdown_to_html_email(markdown_file, recipient, sender, password, subject_line, attachments)\r\n            os.remove(markdown_file)\r\n\r\n        print(\"All tasks have been completed and email sent\")\r\n","path":null,"size_bytes":5088,"size_tokens":null},"attached_assets/forexApp_1764097643858.py":{"content":"import os\r\nfrom tradebot import GeminiMarketAnalyzer\r\nfrom trade import dataRetriever\r\nfrom tradde import process_files_by_currency\r\nfrom datetime import datetime\r\nfrom forex_mailer import markdown_to_html_email\r\nfrom price_channels import PriceChannelAnalyzer\r\nimport time\r\nfrom threading import Lock\r\nfrom concurrent.futures import ProcessPoolExecutor  # Changed import\r\n\r\n# Paths and constants\r\nresults_file = r\"C:\\Users\\USER\\Downloads\\gen-ai\\Forex-Analysis.md\"\r\nprice_channels_file = r\"C:\\Users\\USER\\Downloads\\gen-ai\\price_channels.md\"\r\noutput_dir = r\"C:\\Users\\USER\\Downloads\\gen-ai\\output_market_analysis\"\r\nrecipient = \"braimahgifted@gmail.com\"\r\nsender = \"braimahgifted@gmail.com\"\r\npassword = \"app-specific-password\"\r\nsubject_line = \"Daily Forex Analysis\"\r\nattachments = [results_file]\r\n\r\n# Lock for thread-safe file access\r\nfile_write_lock = Lock()\r\n\r\ndef sort_files(file_paths):\r\n    \"\"\"Sorts file paths, placing JSON files before PNG files.\"\"\"\r\n    def key_function(file_path):\r\n        if isinstance(file_path, str) and file_path.endswith(\".json\"):\r\n            return 0\r\n        elif isinstance(file_path, str) and file_path.endswith(\".png\"):\r\n            return 1\r\n        else:\r\n            return 2\r\n\r\n    return sorted(file_paths, key=key_function)\r\n\r\ndef firstStep(sorted_file, mime_types):\r\n    # with file_write_lock:  # Ensure process-safe file access\r\n    #     with open(results_file, \"a\", encoding=\"utf-8\") as file:\r\n    #         file.write(\"\\n\\n\" + \"-\" * 95 + \"\\n\\n\")\r\n\r\n    try:\r\n        analyzer = GeminiMarketAnalyzer(sorted_file, mime_types)\r\n        analyzer.upload_files()\r\n        analyzer.analyze_market()\r\n    except Exception as e:\r\n        print(f\"Error in firstStep: {e}\")\r\n\r\ndef secondStep(sorted_file, mime_types):\r\n    # with file_write_lock:  # Ensure process-safe file access\r\n    #     with open(price_channels_file, \"a\", encoding=\"utf-8\") as file:\r\n    #         file.write(\"\\n\\n\" + \"-\" * 95 + \"\\n\\n\")\r\n\r\n    try:\r\n        channel = PriceChannelAnalyzer(sorted_file, mime_types)\r\n        channel.upload_files()\r\n        channel.analyze_market()\r\n    except Exception as e:\r\n        print(f\"Error in secondStep: {e}\")\r\n\r\ndef analyseFile(args):\r\n    file, mime_types = args\r\n    sorted_file = sort_files(file)\r\n    start_time = time.perf_counter()\r\n\r\n    firstStep(sorted_file, mime_types)\r\n    bot1_time = time.perf_counter() - start_time\r\n\r\n    secondStep(sorted_file, mime_types)\r\n    bot2_time = time.perf_counter() - start_time\r\n\r\n    return {\r\n        \"file\": sorted_file,\r\n        \"bot1_time\": bot1_time,\r\n        \"bot2_time\": bot2_time,\r\n    }\r\n\r\ndef fx_analyser(pairs):\r\n    pair_group=pairs\r\n    # Initialize results file\r\n    with open(results_file, \"w\", encoding=\"utf-8\") as file:\r\n        file.write(f\"FOREX ANALYSIS FOR {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\\n\")\r\n\r\n    # Retrieve and process files\r\n    files = dataRetriever(pair_group)\r\n    os.makedirs(output_dir, exist_ok=True)  # Create output directory if it doesn't exist\r\n    processed_files = process_files_by_currency(files, output_dir)\r\n\r\n    # Flatten processed files\r\n    re_processed_paths = [\r\n        ([item for item in file[0]] + [item for item in file[1]] + [item for item in file[2]])\r\n        for file in processed_files\r\n    ]\r\n\r\n    # MIME types used for analysis\r\n    mime_types = [\r\n        \"text/plain\",\r\n        \"text/plain\",\r\n        \"text/plain\",\r\n        \"image/png\",\r\n        \"image/png\",\r\n        \"image/png\",\r\n    ]\r\n\r\n    # Parallel processing with ProcessPoolExecutor\r\n    results = []\r\n    worker_count = min(len(re_processed_paths), os.cpu_count())\r\n    start_time = time.perf_counter()\r\n\r\n    with ProcessPoolExecutor(max_workers=worker_count) as executor:\r\n        # Pass mime_types to each task\r\n        tasks = [(file, mime_types) for file in re_processed_paths]\r\n        futures = [executor.submit(analyseFile, task) for task in tasks]\r\n        for future in futures:\r\n            try:\r\n                results.append(future.result())\r\n            except Exception as e:\r\n                print(f\"Error processing file: {e}\")\r\n\r\n    # Print results\r\n    for result in results:\r\n        print(f\"File: {result['file']}\")\r\n        print(f\"Bot 1 Time: {result['bot1_time']:.2f} seconds\")\r\n        print(f\"Bot 2 Time: {result['bot2_time']:.2f} seconds\")\r\n        print(\"---\")\r\n\r\n    total_time = time.perf_counter() - start_time\r\n    print(f\"Total Execution Time: {total_time:.2f} seconds\")\r\n\r\n    # Send results via email\r\n    # print(\"Emailing Results\")\r\n    # markdown_to_html_email(results_file, recipient, sender, password, subject_line, attachments)\r\n\r\nif __name__ == \"__main__\":\r\n    fx_analyser()\r\n","path":null,"size_bytes":4653,"size_tokens":null},"pyproject.toml":{"content":"[project]\nname = \"repl-nix-workspace\"\nversion = \"0.1.0\"\ndescription = \"Add your description here\"\nrequires-python = \">=3.11\"\ndependencies = [\n    \"matplotlib>=3.10.7\",\n    \"mplfinance>=0.12.10b0\",\n    \"pandas>=2.3.3\",\n    \"pycoingecko>=3.2.0\",\n    \"requests>=2.32.5\",\n    \"scipy>=1.16.3\",\n    \"tessa>=0.9.0\",\n    \"yfinance>=0.2.66\",\n]\n","path":null,"size_bytes":335,"size_tokens":null},"server/python/chart_generator.py":{"content":"#!/usr/bin/env python3\n\"\"\"\nChart Generator - Creates trading signal charts with zones, markers, and reasoning\nEnhanced version with detailed zone annotations and entry confirmations\n\"\"\"\n\nimport sys\nimport json\nimport os\nimport pandas as pd\nimport numpy as np\nimport mplfinance as mpf\nfrom datetime import datetime\nimport matplotlib.pyplot as plt\nimport matplotlib.patches as mpatches\nfrom matplotlib.lines import Line2D\n\nimport matplotlib\nmatplotlib.use('Agg')\n\ndef generate_signal_chart(input_data: dict) -> dict:\n    \"\"\"\n    Generate a professional trading signal chart with zones and reasoning.\n    \n    Args:\n        input_data: Dictionary containing:\n            - symbol: Trading symbol\n            - timeframe: Timeframe (e.g., \"1H\", \"4H\")\n            - candles: List of OHLCV data\n            - signal: Entry signal info (direction, entry, sl, tp, confidence)\n            - supply_zones: List of {top, bottom, strength, label} dicts\n            - demand_zones: List of {top, bottom, strength, label} dicts\n            - confirmations: List of confirmation reasons\n            - entry_type: Type of entry (choch, continuation, ds_sd_flip)\n            - trend: Market trend direction\n            - output_path: Where to save the PNG\n    \n    Returns:\n        Dictionary with success status and file path\n    \"\"\"\n    try:\n        symbol = input_data.get('symbol', 'UNKNOWN')\n        timeframe = input_data.get('timeframe', '')\n        candles = input_data.get('candles', [])\n        signal = input_data.get('signal', {})\n        supply_zones = input_data.get('supply_zones', [])\n        demand_zones = input_data.get('demand_zones', [])\n        confirmations = input_data.get('confirmations', [])\n        entry_type = input_data.get('entry_type', '')\n        trend = input_data.get('trend', '')\n        output_path = input_data.get('output_path', '/tmp/chart.png')\n        \n        if not candles:\n            return {\"success\": False, \"error\": \"No candle data provided\"}\n        \n        df = pd.DataFrame(candles)\n        df['Date'] = pd.to_datetime(df['date'])\n        df.set_index('Date', inplace=True)\n        df = df.rename(columns={\n            'open': 'Open',\n            'high': 'High', \n            'low': 'Low',\n            'close': 'Close',\n            'volume': 'Volume'\n        })\n        \n        for col in ['Open', 'High', 'Low', 'Close']:\n            df[col] = pd.to_numeric(df[col], errors='coerce')\n        \n        df = df.dropna(subset=['Open', 'High', 'Low', 'Close'])\n        \n        if len(df) < 5:\n            return {\"success\": False, \"error\": \"Not enough candle data\"}\n        \n        mc = mpf.make_marketcolors(\n            up='#22c55e',\n            down='#ef4444',\n            edge='inherit',\n            wick='inherit',\n            volume='in',\n        )\n        \n        style = mpf.make_mpf_style(\n            base_mpf_style='nightclouds',\n            marketcolors=mc,\n            gridstyle='-',\n            gridcolor='#1f2937',\n            facecolor='#0a0a0f',\n            edgecolor='#1f2937',\n            figcolor='#0a0a0f',\n            rc={\n                'axes.labelcolor': '#e5e7eb',\n                'xtick.color': '#e5e7eb',\n                'ytick.color': '#e5e7eb',\n                'font.size': 9,\n            }\n        )\n        \n        fig, axes = mpf.plot(\n            df,\n            type='candle',\n            style=style,\n            volume=False,\n            returnfig=True,\n            figsize=(16, 10),\n            warn_too_much_data=False,\n            tight_layout=False,\n        )\n        \n        ax = axes[0]\n        \n        y_min, y_max = ax.get_ylim()\n        x_min, x_max = ax.get_xlim()\n        \n        for zone in supply_zones:\n            top = float(zone.get('top', 0))\n            bottom = float(zone.get('bottom', 0))\n            strength = zone.get('strength', 'moderate')\n            label = zone.get('label', 'Supply')\n            \n            if top > 0 and bottom > 0:\n                alpha = 0.35 if strength == 'strong' else 0.25\n                linewidth = 2 if strength == 'strong' else 1\n                \n                rect = mpatches.Rectangle(\n                    (x_min, bottom),\n                    x_max - x_min,\n                    top - bottom,\n                    linewidth=linewidth,\n                    edgecolor='#ef4444',\n                    facecolor=f'#ef4444{hex(int(alpha * 255))[2:].zfill(2)}',\n                    linestyle='--' if strength != 'strong' else '-',\n                    zorder=1\n                )\n                ax.add_patch(rect)\n                \n                zone_mid = (top + bottom) / 2\n                if y_min <= zone_mid <= y_max:\n                    ax.annotate(\n                        f'{label}',\n                        xy=(x_min + 0.5, zone_mid),\n                        fontsize=8,\n                        color='#ef4444',\n                        fontweight='bold' if strength == 'strong' else 'normal',\n                        va='center',\n                        ha='left',\n                        zorder=10\n                    )\n        \n        for zone in demand_zones:\n            top = float(zone.get('top', 0))\n            bottom = float(zone.get('bottom', 0))\n            strength = zone.get('strength', 'moderate')\n            label = zone.get('label', 'Demand')\n            \n            if top > 0 and bottom > 0:\n                alpha = 0.35 if strength == 'strong' else 0.25\n                linewidth = 2 if strength == 'strong' else 1\n                \n                rect = mpatches.Rectangle(\n                    (x_min, bottom),\n                    x_max - x_min,\n                    top - bottom,\n                    linewidth=linewidth,\n                    edgecolor='#22c55e',\n                    facecolor=f'#22c55e{hex(int(alpha * 255))[2:].zfill(2)}',\n                    linestyle='--' if strength != 'strong' else '-',\n                    zorder=1\n                )\n                ax.add_patch(rect)\n                \n                zone_mid = (top + bottom) / 2\n                if y_min <= zone_mid <= y_max:\n                    ax.annotate(\n                        f'{label}',\n                        xy=(x_min + 0.5, zone_mid),\n                        fontsize=8,\n                        color='#22c55e',\n                        fontweight='bold' if strength == 'strong' else 'normal',\n                        va='center',\n                        ha='left',\n                        zorder=10\n                    )\n        \n        if signal:\n            direction = signal.get('direction', '')\n            entry = float(signal.get('entry', 0))\n            sl = float(signal.get('stopLoss', 0))\n            tp = float(signal.get('takeProfit', 0))\n            confidence = signal.get('confidence', 0)\n            \n            if entry > 0:\n                color = '#22c55e' if direction == 'BUY' else '#ef4444'\n                ax.axhline(y=entry, color=color, linestyle='-', linewidth=2.5, alpha=0.9, zorder=5)\n                \n                entry_label = f' ENTRY: {entry:.5f}'\n                ax.annotate(\n                    entry_label,\n                    xy=(x_max, entry),\n                    fontsize=11,\n                    color=color,\n                    fontweight='bold',\n                    va='center',\n                    ha='left',\n                    zorder=10,\n                    bbox=dict(boxstyle='round,pad=0.3', facecolor='#0a0a0f', edgecolor=color, alpha=0.9)\n                )\n            \n            if sl > 0:\n                ax.axhline(y=sl, color='#f59e0b', linestyle='--', linewidth=2, alpha=0.8, zorder=5)\n                ax.annotate(\n                    f' SL: {sl:.5f}',\n                    xy=(x_max, sl),\n                    fontsize=10,\n                    color='#f59e0b',\n                    fontweight='bold',\n                    va='center',\n                    ha='left',\n                    zorder=10,\n                    bbox=dict(boxstyle='round,pad=0.2', facecolor='#0a0a0f', edgecolor='#f59e0b', alpha=0.8)\n                )\n                \n                if entry > 0:\n                    sl_fill_color = '#f59e0b22'\n                    if direction == 'BUY':\n                        ax.fill_between([x_min, x_max], sl, entry, color=sl_fill_color, alpha=0.3, zorder=0)\n                    else:\n                        ax.fill_between([x_min, x_max], entry, sl, color=sl_fill_color, alpha=0.3, zorder=0)\n            \n            if tp > 0:\n                ax.axhline(y=tp, color='#3b82f6', linestyle='--', linewidth=2, alpha=0.8, zorder=5)\n                ax.annotate(\n                    f' TP: {tp:.5f}',\n                    xy=(x_max, tp),\n                    fontsize=10,\n                    color='#3b82f6',\n                    fontweight='bold',\n                    va='center',\n                    ha='left',\n                    zorder=10,\n                    bbox=dict(boxstyle='round,pad=0.2', facecolor='#0a0a0f', edgecolor='#3b82f6', alpha=0.8)\n                )\n                \n                if entry > 0:\n                    tp_fill_color = '#3b82f622'\n                    if direction == 'BUY':\n                        ax.fill_between([x_min, x_max], entry, tp, color=tp_fill_color, alpha=0.3, zorder=0)\n                    else:\n                        ax.fill_between([x_min, x_max], tp, entry, color=tp_fill_color, alpha=0.3, zorder=0)\n        \n        timestamp = datetime.utcnow().strftime('%Y-%m-%d %H:%M UTC')\n        direction_text = signal.get('direction', 'SIGNAL') if signal else 'ANALYSIS'\n        confidence_text = f\" ({signal.get('confidence', 0)}%)\" if signal and signal.get('confidence') else ''\n        \n        title_color = '#22c55e' if direction_text == 'BUY' else '#ef4444' if direction_text == 'SELL' else '#e5e7eb'\n        \n        main_title = f'{symbol} - {timeframe} | {direction_text}{confidence_text}'\n        ax.set_title(main_title, fontsize=16, fontweight='bold', color=title_color, pad=15, loc='left')\n        \n        ax.text(\n            0.99, 1.02,\n            timestamp,\n            transform=ax.transAxes,\n            fontsize=9,\n            color='#9ca3af',\n            ha='right',\n            va='bottom'\n        )\n        \n        info_text_parts = []\n        \n        if trend:\n            trend_icon = 'Bullish' if trend.lower() == 'bullish' else 'Bearish' if trend.lower() == 'bearish' else 'Sideways'\n            info_text_parts.append(f'Trend: {trend_icon}')\n        \n        if entry_type:\n            entry_type_display = {\n                'choch': 'CHoCH (Change of Character)',\n                'continuation': 'Trend Continuation',\n                'ds_sd_flip': 'Zone Flip (D/S to S/D)',\n            }.get(entry_type, entry_type.upper())\n            info_text_parts.append(f'Entry: {entry_type_display}')\n        \n        if info_text_parts:\n            info_text = ' | '.join(info_text_parts)\n            ax.text(\n                0.01, -0.08,\n                info_text,\n                transform=ax.transAxes,\n                fontsize=10,\n                color='#d1d5db',\n                ha='left',\n                va='top',\n                fontweight='bold'\n            )\n        \n        if confirmations and len(confirmations) > 0:\n            conf_text = 'Confirmations:\\n' + '\\n'.join([f'  - {c}' for c in confirmations[:5]])\n            ax.text(\n                0.01, -0.12,\n                conf_text,\n                transform=ax.transAxes,\n                fontsize=9,\n                color='#9ca3af',\n                ha='left',\n                va='top',\n                linespacing=1.4\n            )\n        \n        legend_elements = [\n            mpatches.Patch(facecolor='#ef444440', edgecolor='#ef4444', label='Supply Zone'),\n            mpatches.Patch(facecolor='#22c55e40', edgecolor='#22c55e', label='Demand Zone'),\n            Line2D([0], [0], color='#f59e0b', linewidth=2, linestyle='--', label='Stop Loss'),\n            Line2D([0], [0], color='#3b82f6', linewidth=2, linestyle='--', label='Take Profit'),\n        ]\n        \n        ax.legend(\n            handles=legend_elements,\n            loc='upper right',\n            fontsize=9,\n            facecolor='#1f2937',\n            edgecolor='#374151',\n            labelcolor='#e5e7eb',\n            framealpha=0.9\n        )\n        \n        ax.text(\n            0.99, -0.08,\n            'www.FindBuyAndSellZones.com',\n            transform=ax.transAxes,\n            fontsize=9,\n            color='#6b7280',\n            ha='right',\n            va='top',\n            style='italic'\n        )\n        \n        plt.subplots_adjust(bottom=0.25, top=0.92, left=0.08, right=0.85)\n        \n        os.makedirs(os.path.dirname(output_path) if os.path.dirname(output_path) else '.', exist_ok=True)\n        \n        fig.savefig(output_path, dpi=150, bbox_inches='tight', facecolor='#0a0a0f', edgecolor='none')\n        plt.close(fig)\n        \n        return {\"success\": True, \"path\": output_path}\n        \n    except Exception as e:\n        import traceback\n        return {\"success\": False, \"error\": str(e), \"traceback\": traceback.format_exc()}\n\n\ndef main():\n    \"\"\"Main entry point - reads JSON from stdin, outputs JSON to stdout\"\"\"\n    try:\n        input_str = sys.stdin.read()\n        if not input_str.strip():\n            print(json.dumps({\"success\": False, \"error\": \"No input provided\"}))\n            return\n        \n        input_data = json.loads(input_str)\n        result = generate_signal_chart(input_data)\n        print(json.dumps(result))\n        \n    except json.JSONDecodeError as e:\n        print(json.dumps({\"success\": False, \"error\": f\"Invalid JSON: {e}\"}))\n    except Exception as e:\n        print(json.dumps({\"success\": False, \"error\": str(e)}))\n\n\nif __name__ == \"__main__\":\n    main()\n","path":null,"size_bytes":13739,"size_tokens":null},"server/services/geminiAnalysis.ts":{"content":"import { GoogleGenAI } from \"@google/genai\";\nimport * as fs from \"fs\";\n\n// Initialize Gemini AI with user's API key\nconst ai = new GoogleGenAI({ apiKey: process.env.GOOGLE_API_KEY || \"\" });\n\n// Gemini as ASSISTANT to our SMC Strategy - validates and verifies signals with chart analysis\nconst SIGNAL_VALIDATION_INSTRUCTION = `Role: You are an expert Smart Money Concepts (SMC) analyst validating trading signals. You will receive:\n1. A chart image showing price action with marked zones\n2. Our analysis explaining what we observed\n3. The signal we generated\n\nYOUR TASK: Verify our observations on the chart and confirm if our analysis is accurate.\n\nVERIFICATION CHECKLIST - Confirm each item exists on the chart:\n1. TREND DIRECTION: Is the trend we identified (bullish/bearish/sideways) visible on the chart?\n2. SUPPLY/DEMAND ZONES: Are the zones we marked actually visible as consolidation areas before strong moves?\n3. PRICE LOCATION: Is current price actually at or near the zone we identified?\n4. STRUCTURE: Can you see the higher highs/higher lows (uptrend) or lower highs/lower lows (downtrend)?\n5. ENTRY CONDITIONS: Are the confirmations we listed (CHoCH, BOS, zone test) actually visible?\n\nCRITICAL VALIDATION RULES:\n1. TREND ALIGNMENT: Signal direction MUST align with the higher timeframe trend\n   - Bullish trend = Only validate BUY signals\n   - Bearish trend = Only validate SELL signals\n   - EXCEPTION: Counter-trend ONLY if clear CHoCH is visible on chart\n\n2. ZONE QUALITY: The zone must be:\n   - Clearly visible as a consolidation area\n   - Followed by a strong impulsive move away\n   - Currently unmitigated (price hasn't returned to it yet, or just returned)\n\n3. REJECT IF:\n   - The chart looks choppy/ranging with no clear direction\n   - Our identified zone doesn't exist or looks weak\n   - Price is nowhere near the zone\n   - Structure is messy/unclear\n   - Our stated confirmations are NOT visible on the chart\n\nBE STRICT: Only validate if you can VISUALLY CONFIRM our observations on the chart.\n\nOutput Format (JSON only):\n{\n  \"validated\": true/false,\n  \"chartObservations\": {\n    \"trendVisible\": true/false,\n    \"zoneExists\": true/false,\n    \"priceAtZone\": true/false,\n    \"structureClear\": true/false,\n    \"confirmationsVisible\": true/false\n  },\n  \"confidenceAdjustment\": number (-20 to +20),\n  \"concerns\": [\"list of any concerns or observations that don't match\"],\n  \"strengths\": [\"list of verified observations\"],\n  \"recommendation\": \"proceed\" | \"caution\" | \"skip\",\n  \"reasoning\": \"explain what you see on the chart and whether it matches our analysis\"\n}`;\n\n// Quick market scan instruction for screening\nconst MARKET_SCAN_INSTRUCTION = `Role: You are a quick market scanner for Smart Money Concepts.\nAnalyze the price data and identify if there are potential SMC setups forming.\nLook for: supply/demand zones, liquidity pools, potential CHoCH, FVGs.\n\nCRITICAL RULES:\n1. Only identify setups that ALIGN with the trend direction\n2. Counter-trend setups require CONFIRMED CHoCH (Change of Character)\n3. If the market is unclear/choppy/ranging, set hasSetup to false\n4. Do not identify setups in messy or conflicting market structures\n\nOutput Format (JSON only):\n{\n  \"hasSetup\": true/false,\n  \"direction\": \"BUY\" | \"SELL\" | \"NEUTRAL\",\n  \"setupType\": \"zone_entry\" | \"choch\" | \"liquidity_sweep\" | \"none\",\n  \"keyLevel\": number or null,\n  \"trendDirection\": \"bullish\" | \"bearish\" | \"unclear\",\n  \"marketClarity\": \"clear\" | \"moderate\" | \"unclear\",\n  \"reasoning\": \"brief explanation\"\n}`;\n\nexport interface SignalValidationResult {\n  validated: boolean;\n  confidenceAdjustment: number;\n  concerns: string[];\n  strengths: string[];\n  recommendation: 'proceed' | 'caution' | 'skip';\n  reasoning: string;\n  error?: string;\n  isFallback?: boolean; // True ONLY when Gemini is unavailable and we use strategy signal as-is\n}\n\nexport interface MarketScanResult {\n  hasSetup: boolean;\n  direction: 'BUY' | 'SELL' | 'NEUTRAL';\n  setupType: 'zone_entry' | 'choch' | 'liquidity_sweep' | 'none';\n  keyLevel: number | null;\n  trendDirection: 'bullish' | 'bearish' | 'unclear';\n  marketClarity: 'clear' | 'moderate' | 'unclear';\n  reasoning: string;\n  error?: string;\n}\n\nexport interface PriceData {\n  symbol: string;\n  timeframe: string;\n  candles: CandleData[];\n}\n\nexport interface CandleData {\n  date: string;\n  open: number;\n  high: number;\n  low: number;\n  close: number;\n  volume?: number;\n}\n\nexport interface SignalToValidate {\n  symbol: string;\n  direction: 'BUY' | 'SELL';\n  entryPrice: number;\n  stopLoss: number;\n  takeProfit: number;\n  confidence: number;\n  strategy: string;\n  entryType: string;\n  reasoning: string;\n  zones?: { type: string; top: number; bottom: number }[];\n}\n\n// Format price data for Gemini\nfunction formatPriceDataForGemini(priceData: PriceData[]): string {\n  return priceData.map(data => {\n    const recentCandles = data.candles.slice(-30); // Last 30 candles\n    const lastCandle = recentCandles[recentCandles.length - 1];\n    return `\n=== ${data.symbol} - ${data.timeframe} ===\nCurrent Price: ${lastCandle?.close || 'N/A'}\nLast Update: ${lastCandle?.date || 'N/A'}\n\nRecent Candles (newest first):\n${recentCandles.reverse().slice(0, 15).map(c => \n  `${c.date}: O:${c.open.toFixed(5)} H:${c.high.toFixed(5)} L:${c.low.toFixed(5)} C:${c.close.toFixed(5)}`\n).join('\\n')}\n`;\n  }).join('\\n\\n');\n}\n\n// Format signal for validation\nfunction formatSignalForValidation(signal: SignalToValidate): string {\n  let zonesText = '';\n  if (signal.zones && signal.zones.length > 0) {\n    zonesText = `\\nIdentified Zones:\\n${signal.zones.map(z => \n      `- ${z.type}: ${z.bottom.toFixed(5)} - ${z.top.toFixed(5)}`\n    ).join('\\n')}`;\n  }\n\n  return `\n=== SIGNAL TO VALIDATE ===\nSymbol: ${signal.symbol}\nDirection: ${signal.direction}\nEntry: ${signal.entryPrice.toFixed(5)}\nStop Loss: ${signal.stopLoss.toFixed(5)}\nTake Profit: ${signal.takeProfit.toFixed(5)}\nCurrent Confidence: ${signal.confidence}%\nStrategy: ${signal.strategy}\nEntry Type: ${signal.entryType}\nReasoning: ${signal.reasoning}\n${zonesText}\n`;\n}\n\n/**\n * Validate a signal generated by our SMC strategy\n * Gemini acts as a second opinion to enhance accuracy\n * Receives multiple timeframe charts for verification\n */\nexport async function validateSignalWithGemini(\n  signal: SignalToValidate,\n  priceData: PriceData[],\n  chartImagePaths?: string[]\n): Promise<SignalValidationResult> {\n  try {\n    const formattedData = formatPriceDataForGemini(priceData);\n    const formattedSignal = formatSignalForValidation(signal);\n    \n    // Build content array\n    const contents: any[] = [];\n    \n    // Add all chart images (multi-timeframe) if provided\n    if (chartImagePaths && chartImagePaths.length > 0) {\n      const chartLabels = ['HTF Context (1D/H4)', 'Zone Identification (M15/M30)', 'Entry Confirmation (M5/M1)'];\n      for (let i = 0; i < chartImagePaths.length; i++) {\n        const chartPath = chartImagePaths[i];\n        if (fs.existsSync(chartPath)) {\n          const imageBytes = fs.readFileSync(chartPath);\n          const mimeType = chartPath.endsWith('.png') ? 'image/png' : 'image/jpeg';\n          contents.push({\n            inlineData: {\n              data: imageBytes.toString('base64'),\n              mimeType,\n            },\n          });\n          contents.push(`Chart ${i + 1}: ${chartLabels[i] || `Timeframe ${i + 1}`}`);\n        }\n      }\n    }\n    \n    contents.push(`\nPlease validate this trading signal by verifying ALL the charts above:\n\n${formattedSignal}\n\nVERIFICATION ACROSS TIMEFRAMES:\n1. HTF Chart: Verify the trend direction we identified\n2. Zone Chart: Verify the supply/demand zone exists and is valid\n3. Entry Chart: Verify the entry trigger and price location\n\nPrice Data Context:\n${formattedData}\n\nProvide your validation in the exact JSON format specified.\n`);\n\n    const response = await ai.models.generateContent({\n      model: \"gemini-2.5-flash\",\n      config: {\n        systemInstruction: SIGNAL_VALIDATION_INSTRUCTION,\n        responseMimeType: \"application/json\",\n        temperature: 0.3,\n        maxOutputTokens: 1024,\n      },\n      contents,\n    });\n\n    const text = response.text;\n    if (text) {\n      try {\n        const result = JSON.parse(text);\n        return {\n          validated: result.validated ?? false,\n          confidenceAdjustment: Math.max(-20, Math.min(20, result.confidenceAdjustment || 0)),\n          concerns: result.concerns || [],\n          strengths: result.strengths || [],\n          recommendation: result.recommendation || 'caution',\n          reasoning: result.reasoning || '',\n        };\n      } catch (parseError) {\n        return {\n          validated: true,\n          confidenceAdjustment: 0,\n          concerns: ['Could not parse Gemini response'],\n          strengths: [],\n          recommendation: 'caution',\n          reasoning: 'Validation response was not in expected format',\n        };\n      }\n    }\n    \n    return {\n      validated: false,\n      confidenceAdjustment: 0,\n      concerns: ['Empty response from Gemini'],\n      strengths: [],\n      recommendation: 'skip',\n      reasoning: 'No validation response received',\n    };\n  } catch (error) {\n    console.error('Gemini validation error:', error);\n    // ONLY when Gemini is unavailable (error): fallback to strategy signal as-is\n    return {\n      validated: true,\n      confidenceAdjustment: 0,\n      concerns: ['Gemini validation unavailable - using strategy signal as fallback'],\n      strengths: [],\n      recommendation: 'proceed', // Fallback: proceed with strategy signal\n      reasoning: 'Gemini service unavailable - FALLBACK: using strategy signal as-is',\n      error: error instanceof Error ? error.message : 'Unknown error',\n      isFallback: true, // Flag to indicate this is a fallback response\n    };\n  }\n}\n\n/**\n * Quick market scan to pre-screen instruments\n * Helps identify which markets have potential setups\n */\nexport async function quickMarketScan(\n  symbol: string,\n  priceData: PriceData[]\n): Promise<MarketScanResult> {\n  try {\n    const formattedData = formatPriceDataForGemini(priceData);\n    \n    const response = await ai.models.generateContent({\n      model: \"gemini-2.5-flash\",\n      config: {\n        systemInstruction: MARKET_SCAN_INSTRUCTION,\n        responseMimeType: \"application/json\",\n        temperature: 0.3,\n        maxOutputTokens: 512,\n      },\n      contents: `Quick scan for ${symbol}:\\n${formattedData}`,\n    });\n\n    const text = response.text;\n    if (text) {\n      try {\n        const result = JSON.parse(text);\n        return {\n          hasSetup: result.hasSetup ?? false,\n          direction: result.direction || 'NEUTRAL',\n          setupType: result.setupType || 'none',\n          keyLevel: result.keyLevel || null,\n          trendDirection: result.trendDirection || 'unclear',\n          marketClarity: result.marketClarity || 'unclear',\n          reasoning: result.reasoning || '',\n        };\n      } catch {\n        return {\n          hasSetup: false,\n          direction: 'NEUTRAL',\n          setupType: 'none',\n          keyLevel: null,\n          trendDirection: 'unclear',\n          marketClarity: 'unclear',\n          reasoning: 'Could not parse scan response',\n        };\n      }\n    }\n    \n    return {\n      hasSetup: false,\n      direction: 'NEUTRAL',\n      setupType: 'none',\n      keyLevel: null,\n      trendDirection: 'unclear',\n      marketClarity: 'unclear',\n      reasoning: 'Empty scan response',\n    };\n  } catch (error) {\n    console.error('Quick scan error:', error);\n    return {\n      hasSetup: false,\n      direction: 'NEUTRAL',\n      setupType: 'none',\n      keyLevel: null,\n      trendDirection: 'unclear',\n      marketClarity: 'unclear',\n      reasoning: 'Scan failed',\n      error: error instanceof Error ? error.message : 'Unknown error',\n    };\n  }\n}\n\n// Check if Gemini API is configured\nexport function isGeminiConfigured(): boolean {\n  return !!process.env.GOOGLE_API_KEY;\n}\n\n// Test Gemini connection\nexport async function testGeminiConnection(): Promise<{ success: boolean; message: string }> {\n  if (!isGeminiConfigured()) {\n    return { success: false, message: 'GOOGLE_API_KEY not configured' };\n  }\n\n  try {\n    const response = await ai.models.generateContent({\n      model: \"gemini-2.5-flash\",\n      contents: \"Respond with exactly: 'SMC validation ready'\",\n    });\n    \n    const text = response.text || '';\n    if (text.toLowerCase().includes('ready')) {\n      return { success: true, message: 'Gemini API connected successfully' };\n    }\n    return { success: true, message: `Gemini responded: ${text.slice(0, 50)}...` };\n  } catch (error) {\n    return { \n      success: false, \n      message: error instanceof Error ? error.message : 'Connection failed' \n    };\n  }\n}\n\n// Legacy exports for backward compatibility with routes\nexport async function analyzeWithGemini(\n  symbol: string,\n  priceData: PriceData[],\n  chartImagePath?: string\n): Promise<any> {\n  // Convert to validation format\n  const dummySignal: SignalToValidate = {\n    symbol,\n    direction: 'BUY',\n    entryPrice: 0,\n    stopLoss: 0,\n    takeProfit: 0,\n    confidence: 50,\n    strategy: 'smc',\n    entryType: 'analysis_request',\n    reasoning: 'Full analysis requested',\n  };\n  \n  // Wrap single path in array for new signature\n  const chartPaths = chartImagePath ? [chartImagePath] : undefined;\n  const validation = await validateSignalWithGemini(dummySignal, priceData, chartPaths);\n  const scan = await quickMarketScan(symbol, priceData);\n  \n  return {\n    validation,\n    marketScan: scan,\n    note: 'Use validateSignalWithGemini() to validate specific signals from our SMC strategy',\n  };\n}\n\nexport async function quickAnalyzeWithGemini(\n  symbol: string,\n  priceData: PriceData[]\n): Promise<{ direction: 'BUY' | 'SELL' | 'HOLD'; confidence: number; reasoning: string } | null> {\n  const scan = await quickMarketScan(symbol, priceData);\n  \n  if (scan.error) return null;\n  \n  return {\n    direction: scan.direction === 'NEUTRAL' ? 'HOLD' : scan.direction,\n    confidence: scan.hasSetup ? 60 : 30,\n    reasoning: scan.reasoning,\n  };\n}\n","path":null,"size_bytes":14031,"size_tokens":null},"server/services/chartGenerator.ts":{"content":"import { spawn } from 'child_process';\nimport * as path from 'path';\nimport * as fs from 'fs';\n\nexport interface ChartCandle {\n  date: string;\n  open: number;\n  high: number;\n  low: number;\n  close: number;\n  volume?: number;\n}\n\nexport interface SignalInfo {\n  direction: 'BUY' | 'SELL';\n  entry: number;\n  stopLoss: number;\n  takeProfit: number;\n  confidence: number;\n}\n\nexport interface ZoneInfo {\n  top: number;\n  bottom: number;\n  strength?: 'strong' | 'moderate' | 'weak';\n  label?: string;\n}\n\nexport interface ChartGeneratorInput {\n  symbol: string;\n  timeframe: string;\n  candles: ChartCandle[];\n  signal?: SignalInfo;\n  supply_zones?: ZoneInfo[];\n  demand_zones?: ZoneInfo[];\n  confirmations?: string[];\n  entry_type?: string;\n  trend?: string;\n  output_path: string;\n}\n\nexport interface ChartGeneratorResult {\n  success: boolean;\n  path?: string;\n  error?: string;\n}\n\n// Generate chart using Python script\nexport async function generateSignalChart(input: ChartGeneratorInput): Promise<ChartGeneratorResult> {\n  return new Promise((resolve) => {\n    // Use absolute path to ensure script is found regardless of working directory\n    const pythonScript = path.resolve(process.cwd(), 'server/python/chart_generator.py');\n    \n    // Check if Python script exists\n    if (!fs.existsSync(pythonScript)) {\n      resolve({ success: false, error: 'Chart generator script not found' });\n      return;\n    }\n    \n    const python = spawn('python3', [pythonScript]);\n    let stdout = '';\n    let stderr = '';\n    \n    python.stdout.on('data', (data) => {\n      stdout += data.toString();\n    });\n    \n    python.stderr.on('data', (data) => {\n      stderr += data.toString();\n    });\n    \n    python.on('close', (code) => {\n      if (code !== 0) {\n        console.error('Chart generation stderr:', stderr);\n        resolve({ success: false, error: stderr || `Process exited with code ${code}` });\n        return;\n      }\n      \n      try {\n        const result = JSON.parse(stdout);\n        resolve(result);\n      } catch (e) {\n        resolve({ success: false, error: `Failed to parse result: ${stdout}` });\n      }\n    });\n    \n    python.on('error', (err) => {\n      resolve({ success: false, error: err.message });\n    });\n    \n    // Send input data as JSON\n    python.stdin.write(JSON.stringify(input));\n    python.stdin.end();\n  });\n}\n\n// Generate a trading signal chart (simplified interface)\nexport async function generateTradingSignalChart(\n  symbol: string,\n  timeframe: string,\n  candles: ChartCandle[],\n  signal: {\n    direction: 'BUY' | 'SELL';\n    entryPrice: number;\n    stopLoss: number;\n    takeProfit: number;\n    confidence: number;\n  },\n  supplyZones: ZoneInfo[] = [],\n  demandZones: ZoneInfo[] = [],\n  options: {\n    confirmations?: string[];\n    entryType?: string;\n    trend?: string;\n  } = {}\n): Promise<ChartGeneratorResult> {\n  const timestamp = Date.now();\n  const safeSymbol = symbol.replace(/[^a-zA-Z0-9]/g, '_');\n  const filename = `signal_${safeSymbol}_${timeframe}_${timestamp}.png`;\n  const outputPath = path.join('/tmp/charts', filename);\n  \n  const dir = path.dirname(outputPath);\n  if (!fs.existsSync(dir)) {\n    fs.mkdirSync(dir, { recursive: true });\n  }\n  \n  const input: ChartGeneratorInput = {\n    symbol,\n    timeframe,\n    candles,\n    signal: {\n      direction: signal.direction,\n      entry: signal.entryPrice,\n      stopLoss: signal.stopLoss,\n      takeProfit: signal.takeProfit,\n      confidence: signal.confidence,\n    },\n    supply_zones: supplyZones,\n    demand_zones: demandZones,\n    confirmations: options.confirmations || [],\n    entry_type: options.entryType || '',\n    trend: options.trend || '',\n    output_path: outputPath,\n  };\n  \n  return generateSignalChart(input);\n}\n\n// Check if chart generation is available\nexport async function isChartGeneratorAvailable(): Promise<boolean> {\n  try {\n    const testInput: ChartGeneratorInput = {\n      symbol: 'TEST',\n      timeframe: '1H',\n      candles: [\n        { date: '2024-01-01T00:00:00Z', open: 1.0, high: 1.1, low: 0.9, close: 1.05 },\n        { date: '2024-01-01T01:00:00Z', open: 1.05, high: 1.15, low: 1.0, close: 1.10 },\n        { date: '2024-01-01T02:00:00Z', open: 1.10, high: 1.12, low: 1.05, close: 1.08 },\n        { date: '2024-01-01T03:00:00Z', open: 1.08, high: 1.15, low: 1.06, close: 1.12 },\n        { date: '2024-01-01T04:00:00Z', open: 1.12, high: 1.18, low: 1.10, close: 1.15 },\n      ],\n      output_path: '/tmp/test_chart.png',\n    };\n    \n    const result = await generateSignalChart(testInput);\n    \n    // Clean up test file\n    if (result.success && result.path && fs.existsSync(result.path)) {\n      fs.unlinkSync(result.path);\n    }\n    \n    return result.success;\n  } catch {\n    return false;\n  }\n}\n\n// Read chart as buffer for sending via Telegram\nexport function readChartAsBuffer(chartPath: string): Buffer | null {\n  try {\n    if (fs.existsSync(chartPath)) {\n      return fs.readFileSync(chartPath);\n    }\n    return null;\n  } catch {\n    return null;\n  }\n}\n\n// Clean up old chart files\nexport function cleanupOldCharts(maxAgeMs: number = 3600000): void {\n  const chartsDir = '/tmp/charts';\n  \n  if (!fs.existsSync(chartsDir)) {\n    return;\n  }\n  \n  const now = Date.now();\n  const files = fs.readdirSync(chartsDir);\n  \n  for (const file of files) {\n    const filePath = path.join(chartsDir, file);\n    try {\n      const stats = fs.statSync(filePath);\n      if (now - stats.mtimeMs > maxAgeMs) {\n        fs.unlinkSync(filePath);\n      }\n    } catch {\n      // Ignore errors\n    }\n  }\n}\n","path":null,"size_bytes":5522,"size_tokens":null},"server/services/signalMonitor.ts":{"content":"import { storage } from \"../storage\";\nimport { getCachedPrice } from \"../lib/priceService\";\nimport type { TradingSignal, InsertTrade } from \"@shared/schema\";\n\nexport interface SignalOutcome {\n  signalId: string;\n  symbol: string;\n  outcome: 'hit_sl' | 'hit_tp' | 'expired' | 'active';\n  currentPrice: number;\n  entryPrice: number;\n  exitPrice?: number;\n  pnlPercent?: number;\n}\n\nexport class SignalMonitorService {\n  private monitoringInterval: NodeJS.Timeout | null = null;\n  private isRunning = false;\n\n  async start(intervalMs: number = 30000) {\n    if (this.isRunning) {\n      console.log('[SignalMonitor] Already running');\n      return;\n    }\n\n    this.isRunning = true;\n    console.log('[SignalMonitor] Starting signal monitoring...');\n    \n    await this.checkAllSignals();\n    \n    this.monitoringInterval = setInterval(async () => {\n      await this.checkAllSignals();\n    }, intervalMs);\n  }\n\n  stop() {\n    if (this.monitoringInterval) {\n      clearInterval(this.monitoringInterval);\n      this.monitoringInterval = null;\n    }\n    this.isRunning = false;\n    console.log('[SignalMonitor] Stopped');\n  }\n\n  async checkAllSignals(): Promise<SignalOutcome[]> {\n    try {\n      const allSignals = await storage.getTradingSignals();\n      const outcomes: SignalOutcome[] = [];\n\n      for (const signal of allSignals) {\n        if (signal.status === 'watchlist') {\n          await this.checkWatchlistSignal(signal);\n          continue;\n        }\n        \n        if (signal.status !== 'active') continue;\n\n        const outcome = await this.checkSignal(signal);\n        outcomes.push(outcome);\n\n        if (outcome.outcome === 'hit_sl' || outcome.outcome === 'hit_tp') {\n          await this.archiveSignalToTrades(signal, outcome);\n        } else if (outcome.outcome === 'expired') {\n          await this.expireSignal(signal);\n        }\n      }\n\n      return outcomes;\n    } catch (error) {\n      console.error('[SignalMonitor] Error checking signals:', error);\n      return [];\n    }\n  }\n\n  private async checkWatchlistSignal(signal: TradingSignal): Promise<void> {\n    try {\n      const entryPrice = parseFloat(signal.entryPrice?.toString() || '0');\n      const stopLoss = parseFloat(signal.stopLoss?.toString() || '0');\n      \n      if (entryPrice === 0 || stopLoss === 0) return;\n\n      const assetClass = this.mapAssetClass(signal.assetClass);\n      const priceResult = await getCachedPrice(signal.symbol, assetClass);\n      \n      if (!priceResult || priceResult.error || !priceResult.price) return;\n\n      const currentPrice = priceResult.price;\n      const isBuy = signal.type.toLowerCase() === 'buy';\n\n      const riskDistance = Math.abs(entryPrice - stopLoss);\n      const invalidationThreshold = riskDistance * 1.5;\n\n      let isInvalidated = false;\n\n      if (isBuy) {\n        if (currentPrice <= entryPrice - invalidationThreshold) {\n          isInvalidated = true;\n          console.log(`[SignalMonitor] Watchlist signal ${signal.symbol} invalidated: price dropped too far below entry zone`);\n        }\n      } else {\n        if (currentPrice >= entryPrice + invalidationThreshold) {\n          isInvalidated = true;\n          console.log(`[SignalMonitor] Watchlist signal ${signal.symbol} invalidated: price rose too far above entry zone`);\n        }\n      }\n\n      if (isInvalidated) {\n        await storage.updateTradingSignal(signal.id, {\n          status: 'invalidated',\n          invalidatedAt: new Date(),\n        });\n        console.log(`[SignalMonitor] Removed invalidated watchlist signal: ${signal.symbol}`);\n      }\n\n      if (signal.expiresAt && new Date() > new Date(signal.expiresAt)) {\n        await storage.updateTradingSignal(signal.id, {\n          status: 'expired',\n          invalidatedAt: new Date(),\n        });\n        console.log(`[SignalMonitor] Expired watchlist signal: ${signal.symbol}`);\n      }\n    } catch (error) {\n      console.error(`[SignalMonitor] Error checking watchlist signal ${signal.symbol}:`, error);\n    }\n  }\n\n  async checkSignal(signal: TradingSignal): Promise<SignalOutcome> {\n    const entryPrice = parseFloat(signal.entryPrice?.toString() || '0');\n    const stopLoss = parseFloat(signal.stopLoss?.toString() || '0');\n    const takeProfit = parseFloat(signal.takeProfit?.toString() || '0');\n\n    const assetClass = this.mapAssetClass(signal.assetClass);\n    const priceResult = await getCachedPrice(signal.symbol, assetClass);\n    \n    if (!priceResult || priceResult.error) {\n      return {\n        signalId: signal.id,\n        symbol: signal.symbol,\n        outcome: 'active',\n        currentPrice: 0,\n        entryPrice,\n      };\n    }\n\n    const currentPrice = priceResult.price ?? 0;\n    const isBuy = signal.type.toLowerCase() === 'buy';\n\n    let outcome: SignalOutcome['outcome'] = 'active';\n    let exitPrice: number | undefined;\n    let pnlPercent: number | undefined;\n\n    if (currentPrice > 0) {\n      if (isBuy) {\n        if (currentPrice <= stopLoss) {\n          outcome = 'hit_sl';\n          exitPrice = stopLoss;\n          pnlPercent = ((stopLoss - entryPrice) / entryPrice) * 100;\n        } else if (currentPrice >= takeProfit) {\n          outcome = 'hit_tp';\n          exitPrice = takeProfit;\n          pnlPercent = ((takeProfit - entryPrice) / entryPrice) * 100;\n        }\n      } else {\n        if (currentPrice >= stopLoss) {\n          outcome = 'hit_sl';\n          exitPrice = stopLoss;\n          pnlPercent = ((entryPrice - stopLoss) / entryPrice) * 100;\n        } else if (currentPrice <= takeProfit) {\n          outcome = 'hit_tp';\n          exitPrice = takeProfit;\n          pnlPercent = ((entryPrice - takeProfit) / entryPrice) * 100;\n        }\n      }\n    }\n\n    if (signal.expiresAt && new Date() > new Date(signal.expiresAt)) {\n      outcome = 'expired';\n    }\n\n    return {\n      signalId: signal.id,\n      symbol: signal.symbol,\n      outcome,\n      currentPrice,\n      entryPrice,\n      exitPrice,\n      pnlPercent,\n    };\n  }\n\n  private mapAssetClass(assetClass: string): 'stock' | 'forex' | 'crypto' | 'commodity' {\n    const normalized = assetClass.toLowerCase();\n    if (normalized.includes('forex') || normalized.includes('fx')) return 'forex';\n    if (normalized.includes('crypto')) return 'crypto';\n    if (normalized.includes('commodity') || normalized.includes('commodities')) return 'commodity';\n    return 'stock';\n  }\n\n  private async archiveSignalToTrades(signal: TradingSignal, outcome: SignalOutcome): Promise<void> {\n    try {\n      const entryPrice = parseFloat(signal.entryPrice?.toString() || '0');\n      const stopLoss = parseFloat(signal.stopLoss?.toString() || '0');\n      const takeProfit = parseFloat(signal.takeProfit?.toString() || '0');\n      const exitPrice = outcome.exitPrice || outcome.currentPrice;\n      const pnlPercent = outcome.pnlPercent || 0;\n      \n      const isBuy = signal.type.toLowerCase() === 'buy';\n      const pnl = isBuy \n        ? (exitPrice - entryPrice) * 1\n        : (entryPrice - exitPrice) * 1;\n\n      const duration = this.calculateDuration(signal.createdAt || new Date());\n      \n      const riskReward = this.calculateRiskReward(entryPrice, stopLoss, takeProfit, isBuy);\n\n      const trade: InsertTrade = {\n        userId: null,\n        symbol: signal.symbol,\n        type: signal.type,\n        strategy: signal.strategy,\n        entryPrice: entryPrice.toString(),\n        exitPrice: exitPrice.toString(),\n        stopLoss: stopLoss > 0 ? stopLoss.toString() : null,\n        takeProfit: takeProfit > 0 ? takeProfit.toString() : null,\n        quantity: \"1\",\n        pnl: pnl.toFixed(2),\n        pnlPercent: pnlPercent.toFixed(2),\n        riskReward: riskReward || null,\n        outcome: outcome.outcome === 'hit_sl' ? 'loss' : 'win',\n        timeframe: signal.primaryTimeframe,\n        entryReason: signal.technicalReasons?.join(', ') || signal.marketContext || 'SMC Signal',\n        lesson: outcome.outcome === 'hit_sl' \n          ? 'Stop loss hit - review entry timing and zone quality' \n          : 'Take profit hit - successful trade execution',\n        signalId: signal.id || null,\n        entryDate: signal.createdAt || null,\n        exitDate: new Date(),\n        duration,\n        assetClass: signal.assetClass || null,\n      };\n\n      await storage.createTrade(trade);\n      \n      await storage.updateTradingSignal(signal.id, {\n        status: outcome.outcome === 'hit_sl' ? 'stopped_out' : 'target_hit',\n        invalidatedAt: new Date(),\n      });\n\n      console.log(`[SignalMonitor] Archived ${signal.symbol} signal to journal: ${outcome.outcome}`);\n    } catch (error) {\n      console.error('[SignalMonitor] Error archiving signal:', error);\n    }\n  }\n\n  private calculateRiskReward(entry: number, sl: number, tp: number, isBuy: boolean): string {\n    if (!sl || !tp || sl === 0 || tp === 0) return 'N/A';\n    \n    const risk = Math.abs(entry - sl);\n    const reward = Math.abs(tp - entry);\n    \n    if (risk === 0) return 'N/A';\n    \n    const rr = reward / risk;\n    return `1:${rr.toFixed(1)}`;\n  }\n\n  private async expireSignal(signal: TradingSignal): Promise<void> {\n    try {\n      await storage.updateTradingSignal(signal.id, {\n        status: 'expired',\n        invalidatedAt: new Date(),\n      });\n      console.log(`[SignalMonitor] Expired ${signal.symbol} signal`);\n    } catch (error) {\n      console.error('[SignalMonitor] Error expiring signal:', error);\n    }\n  }\n\n  private calculateDuration(startDate: Date): string {\n    const now = new Date();\n    const diffMs = now.getTime() - startDate.getTime();\n    const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n    const diffMins = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));\n\n    if (diffHours < 1) {\n      return `${diffMins}m`;\n    } else if (diffHours < 24) {\n      return `${diffHours}h ${diffMins}m`;\n    } else {\n      const diffDays = Math.floor(diffHours / 24);\n      return `${diffDays}d ${diffHours % 24}h`;\n    }\n  }\n\n  async getWatchlistSignals(): Promise<TradingSignal[]> {\n    const allSignals = await storage.getTradingSignals();\n    return allSignals.filter(s => s.status === 'watchlist' || s.status === 'pending');\n  }\n\n  async getActiveSignals(): Promise<TradingSignal[]> {\n    const allSignals = await storage.getTradingSignals();\n    return allSignals.filter(s => s.status === 'active');\n  }\n\n  async promoteToActive(signalId: string): Promise<TradingSignal | undefined> {\n    return storage.updateTradingSignal(signalId, { status: 'active' });\n  }\n\n  async moveToWatchlist(signalId: string): Promise<TradingSignal | undefined> {\n    return storage.updateTradingSignal(signalId, { status: 'watchlist' });\n  }\n}\n\nexport const signalMonitor = new SignalMonitorService();\n","path":null,"size_bytes":10640,"size_tokens":null},"server/strategies/core/strategyRegistry.ts":{"content":"import { BaseStrategy } from './baseStrategy';\nimport { StrategyResult, InstrumentData, StrategySignal } from './types';\n\ninterface RegistryEntry {\n  strategy: BaseStrategy;\n  lastResult: StrategyResult | null;\n  lastError: Error | null;\n  lastRunTime: number;\n}\n\nexport class StrategyRegistry {\n  private strategies: Map<string, RegistryEntry> = new Map();\n  private static instance: StrategyRegistry | null = null;\n\n  private constructor() {}\n\n  static getInstance(): StrategyRegistry {\n    if (!StrategyRegistry.instance) {\n      StrategyRegistry.instance = new StrategyRegistry();\n    }\n    return StrategyRegistry.instance;\n  }\n\n  register(strategy: BaseStrategy): void {\n    if (this.strategies.has(strategy.id)) {\n      console.warn(`Strategy ${strategy.id} already registered. Updating...`);\n    }\n\n    this.strategies.set(strategy.id, {\n      strategy,\n      lastResult: null,\n      lastError: null,\n      lastRunTime: 0,\n    });\n\n    console.log(`[StrategyRegistry] Registered strategy: ${strategy.name} (${strategy.id})`);\n  }\n\n  unregister(strategyId: string): boolean {\n    const removed = this.strategies.delete(strategyId);\n    if (removed) {\n      console.log(`[StrategyRegistry] Unregistered strategy: ${strategyId}`);\n    }\n    return removed;\n  }\n\n  getStrategy(strategyId: string): BaseStrategy | undefined {\n    return this.strategies.get(strategyId)?.strategy;\n  }\n\n  getAllStrategies(): BaseStrategy[] {\n    return Array.from(this.strategies.values()).map(entry => entry.strategy);\n  }\n\n  getEnabledStrategies(): BaseStrategy[] {\n    return this.getAllStrategies().filter(s => s.isEnabled);\n  }\n\n  async runStrategy(strategyId: string, instrument: InstrumentData): Promise<StrategyResult | null> {\n    const entry = this.strategies.get(strategyId);\n    if (!entry) {\n      console.error(`[StrategyRegistry] Strategy not found: ${strategyId}`);\n      return null;\n    }\n\n    if (!entry.strategy.isEnabled) {\n      return null;\n    }\n\n    const startTime = Date.now();\n\n    try {\n      const result = await entry.strategy.analyze(instrument);\n      entry.lastResult = result;\n      entry.lastError = null;\n      entry.lastRunTime = Date.now() - startTime;\n\n      return result;\n    } catch (error) {\n      entry.lastError = error as Error;\n      entry.lastResult = {\n        strategyId,\n        signals: [],\n        pendingSetups: [],\n        errors: [(error as Error).message],\n        analysisTimeMs: Date.now() - startTime,\n      };\n\n      console.error(`[StrategyRegistry] Error running ${strategyId}:`, (error as Error).message);\n      return entry.lastResult;\n    }\n  }\n\n  async runAllStrategies(instrument: InstrumentData): Promise<StrategySignal[]> {\n    const result = await this.runAllStrategiesWithPending(instrument);\n    return result.signals;\n  }\n\n  async runAllStrategiesWithPending(instrument: InstrumentData): Promise<{ signals: StrategySignal[]; pendingSetups: any[] }> {\n    const enabledStrategies = this.getEnabledStrategies();\n    const allSignals: StrategySignal[] = [];\n    const allPendingSetups: any[] = [];\n\n    const results = await Promise.allSettled(\n      enabledStrategies.map(strategy => this.runStrategy(strategy.id, instrument))\n    );\n\n    for (const result of results) {\n      if (result.status === 'fulfilled' && result.value) {\n        allSignals.push(...result.value.signals);\n        if (result.value.pendingSetups && result.value.pendingSetups.length > 0) {\n          allPendingSetups.push(...result.value.pendingSetups.map(setup => ({\n            ...setup,\n            symbol: instrument.symbol,\n            assetClass: instrument.assetClass,\n          })));\n        }\n      }\n    }\n\n    return { signals: allSignals, pendingSetups: allPendingSetups };\n  }\n\n  async runAllStrategiesForMultipleInstruments(\n    instruments: InstrumentData[]\n  ): Promise<Map<string, StrategySignal[]>> {\n    const signalsBySymbol = new Map<string, StrategySignal[]>();\n\n    for (const instrument of instruments) {\n      try {\n        const signals = await this.runAllStrategies(instrument);\n        signalsBySymbol.set(instrument.symbol, signals);\n      } catch (error) {\n        console.error(`[StrategyRegistry] Error analyzing ${instrument.symbol}:`, (error as Error).message);\n        signalsBySymbol.set(instrument.symbol, []);\n      }\n    }\n\n    return signalsBySymbol;\n  }\n\n  getLastResult(strategyId: string): StrategyResult | null {\n    return this.strategies.get(strategyId)?.lastResult || null;\n  }\n\n  getLastError(strategyId: string): Error | null {\n    return this.strategies.get(strategyId)?.lastError || null;\n  }\n\n  getStats(): {\n    totalStrategies: number;\n    enabledStrategies: number;\n    strategiesWithErrors: number;\n  } {\n    const entries = Array.from(this.strategies.values());\n    return {\n      totalStrategies: entries.length,\n      enabledStrategies: entries.filter(e => e.strategy.isEnabled).length,\n      strategiesWithErrors: entries.filter(e => e.lastError !== null).length,\n    };\n  }\n\n  enableStrategy(strategyId: string): boolean {\n    const entry = this.strategies.get(strategyId);\n    if (entry) {\n      entry.strategy.enable();\n      return true;\n    }\n    return false;\n  }\n\n  disableStrategy(strategyId: string): boolean {\n    const entry = this.strategies.get(strategyId);\n    if (entry) {\n      entry.strategy.disable();\n      return true;\n    }\n    return false;\n  }\n}\n\nexport const strategyRegistry = StrategyRegistry.getInstance();\n","path":null,"size_bytes":5425,"size_tokens":null},"server/strategies/smc/index.ts":{"content":"import { BaseStrategy } from '../core/baseStrategy';\nimport {\n  StrategyResult,\n  StrategySignal,\n  InstrumentData,\n  EntrySetup,\n  MultiTimeframeData,\n  SignalDirection,\n  Candle,\n  Timeframe,\n} from '../core/types';\nimport { SMC_STRATEGY_CONFIG, SMC_ENTRY_CONFIG } from './config';\nimport { analyzeH4Context, buildMarketContext, H4AnalysisResult } from './h4Context';\nimport { analyzeM15Zones, M15ZoneResult, findNearestUnmitigatedZone } from './m15Zones';\nimport { refineZoneToLowerTimeframe, RefinementResult } from './zoneRefinement';\nimport { detectEntry, EntryDetectionResult } from './entryDetection';\nimport { \n  selectBestTimeframes, \n  isMarketClear, \n  getMarketClarityStatus,\n  TimeframeSelection,\n  ClarityResult,\n} from './clarityAnalysis';\nimport { analyzeVolatility, hasCleanPriceAction, VolatilityAnalysis } from '../shared/candlePatterns';\n\nexport class SMCStrategy extends BaseStrategy {\n  constructor() {\n    super(SMC_STRATEGY_CONFIG);\n  }\n\n  async analyze(instrument: InstrumentData): Promise<StrategyResult> {\n    const startTime = Date.now();\n    const signals: StrategySignal[] = [];\n    const pendingSetups: EntrySetup[] = [];\n    const errors: string[] = [];\n\n    try {\n      this.logAnalysis(`Analyzing ${instrument.symbol}...`);\n\n      const { data, currentPrice, symbol, assetClass } = instrument;\n\n      const tfSelection = selectBestTimeframes(\n        data.h4,\n        data.h2,\n        data.m30,\n        data.m15,\n        data.m5,\n        data.m3,\n        data.m1,\n        data.d1,\n        data.h1\n      );\n\n      this.logAnalysis(`TF Selection: ${tfSelection.dailyContextTf}/${tfSelection.majorZoneTf}/${tfSelection.zoneIdentificationTf}/${tfSelection.entryRefinementTf}`);\n      tfSelection.reasoning.forEach(r => this.logAnalysis(`  - ${r}`));\n\n      if (!isMarketClear(tfSelection)) {\n        this.logAnalysis(`Skipping ${symbol}: ${getMarketClarityStatus(tfSelection)}`);\n        return {\n          strategyId: this.id,\n          signals: [],\n          pendingSetups: [],\n          errors: [],\n          analysisTimeMs: Date.now() - startTime,\n        };\n      }\n\n      const volatilityCheck = this.checkVolatility(data);\n      if (volatilityCheck.isVolatile) {\n        this.logAnalysis(`Skipping ${symbol}: ${volatilityCheck.reasons.join(', ')}`);\n        return {\n          strategyId: this.id,\n          signals: [],\n          pendingSetups: [],\n          errors: [],\n          analysisTimeMs: Date.now() - startTime,\n        };\n      }\n\n      const contextCandles = this.getContextCandles(data);\n      const dailyContext = analyzeH4Context(contextCandles, currentPrice);\n      this.logAnalysis(`1D Context: ${dailyContext.control}, Trend: ${dailyContext.trend}`);\n\n      const majorZoneCandles = this.getMajorZoneCandles(data, tfSelection.majorZoneTf);\n      const majorZonesResult = analyzeM15Zones(majorZoneCandles, dailyContext.control, currentPrice);\n      this.logAnalysis(`${tfSelection.majorZoneTf} Major Zones: ${majorZonesResult.tradableZones.length} zones found`);\n\n      if (majorZonesResult.tradableZones.length === 0) {\n        this.logAnalysis('No major zones found, skipping...');\n        return {\n          strategyId: this.id,\n          signals: [],\n          pendingSetups: [],\n          errors: [],\n          analysisTimeMs: Date.now() - startTime,\n        };\n      }\n\n      for (const majorZone of majorZonesResult.tradableZones.slice(0, 3)) {\n        const zoneIdCandles = this.getZoneIdentificationCandles(data, tfSelection.zoneIdentificationTf);\n        const unmitigatedZonesResult = analyzeM15Zones(zoneIdCandles, dailyContext.control, currentPrice);\n        this.logAnalysis(`${tfSelection.zoneIdentificationTf}: ${unmitigatedZonesResult.tradableZones.length} unmitigated zones`);\n\n        const refinementCandles = this.getEntryRefinementCandles(data, tfSelection.entryRefinementTf);\n        const refinementResult = refineZoneToLowerTimeframe(\n          majorZone,\n          zoneIdCandles,\n          refinementCandles\n        );\n\n        const zoneToUse = refinementResult.refinedZone || majorZone;\n        \n        if (refinementResult.refinedZone) {\n          this.logAnalysis(`Zone refined on ${tfSelection.entryRefinementTf}`);\n        } else {\n          this.logAnalysis(`Using ${tfSelection.zoneIdentificationTf} zone (refinement unclear)`);\n        }\n\n        const direction: SignalDirection = majorZone.type === 'demand' ? 'buy' : 'sell';\n\n        const nearestTarget = direction === 'buy'\n          ? findNearestUnmitigatedZone(unmitigatedZonesResult.unmitigatedSupply, currentPrice, 'above')\n            || dailyContext.nearestSupplyTarget\n          : findNearestUnmitigatedZone(unmitigatedZonesResult.unmitigatedDemand, currentPrice, 'below')\n            || dailyContext.nearestDemandTarget;\n\n        const entryResult = detectEntry(\n          refinementCandles,\n          zoneToUse,\n          direction,\n          nearestTarget,\n          [...unmitigatedZonesResult.allZones]\n        );\n\n        if (!entryResult.hasValidEntry) {\n          if (entryResult.setup && entryResult.setup.confidence >= 40) {\n            const pendingSetup = {\n              ...entryResult.setup,\n              symbol: instrument.symbol,\n              assetClass: instrument.assetClass,\n              direction: direction,\n              timeframe: tfSelection.zoneIdentificationTf,\n            };\n            pendingSetups.push(pendingSetup);\n            this.logAnalysis(`Zone monitoring: ${direction} (${entryResult.setup.confidence}% confidence, awaiting entry trigger)`);\n          }\n          continue;\n        }\n\n        if (entryResult.hasValidEntry && entryResult.setup) {\n          const entryConfirmation = this.confirmEntryTrigger(\n            data,\n            tfSelection.entryRefinementTf,\n            entryResult,\n            direction\n          );\n\n          if (!entryConfirmation.confirmed) {\n            this.logAnalysis(`Entry trigger not confirmed on ${tfSelection.entryRefinementTf}: ${entryConfirmation.confirmations.join(', ')}`);\n            if (entryResult.setup.confidence >= 50) {\n              const pendingSetup = {\n                ...entryResult.setup,\n                symbol: instrument.symbol,\n                assetClass: instrument.assetClass,\n                direction: direction,\n                timeframe: tfSelection.zoneIdentificationTf,\n              };\n              pendingSetups.push(pendingSetup);\n              this.logAnalysis(`Added to watchlist: ${direction} (${entryResult.setup.confidence}%)`);\n            }\n            continue;\n          }\n\n          this.logAnalysis(`Entry confirmed: ${entryConfirmation.confirmations.join(', ')}`);\n          \n          entryResult.setup.confirmations = [\n            ...entryResult.setup.confirmations,\n            ...entryConfirmation.confirmations\n          ];\n\n          const confidence = entryResult.setup.confidence;\n\n          if (confidence >= this.minConfidence) {\n            const signal = this.buildSignal(\n              instrument,\n              entryResult,\n              dailyContext,\n              unmitigatedZonesResult,\n              refinementResult,\n              tfSelection,\n              data\n            );\n            signals.push(signal);\n            this.logAnalysis(`Signal generated: ${signal.direction} @ ${signal.entryPrice.toFixed(5)} (${confidence}% confidence)`);\n          } else if (confidence >= 50) {\n            pendingSetups.push(entryResult.setup);\n            this.logAnalysis(`Pending setup: ${direction} (${confidence}% confidence, needs ${this.minConfidence}%)`);\n          }\n        }\n      }\n\n    } catch (error) {\n      const err = error as Error;\n      errors.push(err.message);\n      this.logError('Analysis failed', err);\n    }\n\n    return {\n      strategyId: this.id,\n      signals,\n      pendingSetups,\n      errors,\n      analysisTimeMs: Date.now() - startTime,\n    };\n  }\n\n  private getContextCandles(data: MultiTimeframeData): Candle[] {\n    return data.d1 || data.h4;\n  }\n\n  private getMajorZoneCandles(data: MultiTimeframeData, tf: Timeframe): Candle[] {\n    switch (tf) {\n      case '4H': return data.h4;\n      case '2H': return data.h2;\n      case '1H': return data.h1 || data.h2;\n      default: return data.h4;\n    }\n  }\n\n  private getZoneIdentificationCandles(data: MultiTimeframeData, tf: Timeframe): Candle[] {\n    switch (tf) {\n      case '30M': return data.m30;\n      case '15M': return data.m15;\n      default: return data.m15;\n    }\n  }\n\n  private getEntryRefinementCandles(data: MultiTimeframeData, tf: Timeframe): Candle[] {\n    switch (tf) {\n      case '5M': return data.m5;\n      case '3M': return data.m3;\n      case '1M': return data.m1;\n      default: return data.m5;\n    }\n  }\n\n  private checkVolatility(data: MultiTimeframeData): VolatilityAnalysis {\n    const h1Volatility = data.h1 ? analyzeVolatility(data.h1, 20) : null;\n    const m15Volatility = analyzeVolatility(data.m15, 20);\n    const m5Volatility = analyzeVolatility(data.m5, 20);\n\n    const reasons: string[] = [];\n    let isVolatile = false;\n\n    if (h1Volatility?.isVolatile) {\n      isVolatile = true;\n      reasons.push(...h1Volatility.reasons.map(r => `1H: ${r}`));\n    }\n\n    if (m15Volatility.isVolatile) {\n      isVolatile = true;\n      reasons.push(...m15Volatility.reasons.map(r => `15M: ${r}`));\n    }\n\n    if (m5Volatility.isVolatile && m5Volatility.rangeMultiplier > 3) {\n      isVolatile = true;\n      reasons.push(...m5Volatility.reasons.map(r => `5M: ${r}`));\n    }\n\n    if (!hasCleanPriceAction(data.m15, 15)) {\n      if (m15Volatility.avgWickRatio > 0.70 && m15Volatility.longWickCount > 14) {\n        isVolatile = true;\n        reasons.push('15M: Choppy price action with unclear structure');\n      }\n    }\n\n    return {\n      isVolatile,\n      wickRatio: m15Volatility.wickRatio,\n      avgWickRatio: m15Volatility.avgWickRatio,\n      rangeMultiplier: m15Volatility.rangeMultiplier,\n      longWickCount: m15Volatility.longWickCount,\n      reasons,\n    };\n  }\n\n  private confirmEntryTrigger(\n    data: MultiTimeframeData,\n    entryTf: Timeframe,\n    entryResult: EntryDetectionResult,\n    direction: SignalDirection\n  ): { confirmed: boolean; confirmations: string[] } {\n    const entryCandles = this.getEntryRefinementCandles(data, entryTf);\n    if (entryCandles.length < 5) {\n      return { confirmed: false, confirmations: ['Insufficient entry candles'] };\n    }\n\n    const confirmations: string[] = [];\n    let confirmationCount = 0;\n\n    const lastCandle = entryCandles[entryCandles.length - 1];\n    const prevCandle = entryCandles[entryCandles.length - 2];\n    const prevPrevCandle = entryCandles[entryCandles.length - 3];\n\n    const lastWickRatio = (lastCandle.high - lastCandle.low) > 0\n      ? ((Math.max(lastCandle.open, lastCandle.close) - Math.min(lastCandle.open, lastCandle.close)) / \n         (lastCandle.high - lastCandle.low))\n      : 0;\n\n    if (lastWickRatio < 0.3) {\n      return { confirmed: false, confirmations: ['Entry candle has too much wick - unclear direction'] };\n    }\n\n    if (direction === 'buy') {\n      const bullishClose = lastCandle.close > lastCandle.open;\n      const strongBody = lastWickRatio >= 0.5;\n      const higherLow = lastCandle.low > prevCandle.low;\n      const higherHigh = lastCandle.high > prevCandle.high;\n      const breakPrevHigh = lastCandle.close > prevCandle.high;\n      const consecutiveBullish = prevCandle.close > prevCandle.open && bullishClose;\n\n      if (bullishClose && strongBody) {\n        confirmations.push('Strong bullish candle with clean body');\n        confirmationCount++;\n      }\n\n      if (higherLow && higherHigh) {\n        confirmations.push('Higher high and higher low formed');\n        confirmationCount++;\n      }\n\n      if (breakPrevHigh) {\n        confirmations.push('Closed above previous high - momentum confirmed');\n        confirmationCount++;\n      }\n\n      if (consecutiveBullish) {\n        confirmations.push('Consecutive bullish candles');\n        confirmationCount++;\n      }\n\n      const lowerWick = Math.min(lastCandle.open, lastCandle.close) - lastCandle.low;\n      const totalRange = lastCandle.high - lastCandle.low;\n      if (totalRange > 0 && lowerWick / totalRange > 0.5) {\n        confirmations.push('Bullish rejection wick from zone');\n        confirmationCount++;\n      }\n\n    } else {\n      const bearishClose = lastCandle.close < lastCandle.open;\n      const strongBody = lastWickRatio >= 0.5;\n      const lowerHigh = lastCandle.high < prevCandle.high;\n      const lowerLow = lastCandle.low < prevCandle.low;\n      const breakPrevLow = lastCandle.close < prevCandle.low;\n      const consecutiveBearish = prevCandle.close < prevCandle.open && bearishClose;\n\n      if (bearishClose && strongBody) {\n        confirmations.push('Strong bearish candle with clean body');\n        confirmationCount++;\n      }\n\n      if (lowerHigh && lowerLow) {\n        confirmations.push('Lower high and lower low formed');\n        confirmationCount++;\n      }\n\n      if (breakPrevLow) {\n        confirmations.push('Closed below previous low - momentum confirmed');\n        confirmationCount++;\n      }\n\n      if (consecutiveBearish) {\n        confirmations.push('Consecutive bearish candles');\n        confirmationCount++;\n      }\n\n      const upperWick = lastCandle.high - Math.max(lastCandle.open, lastCandle.close);\n      const totalRange = lastCandle.high - lastCandle.low;\n      if (totalRange > 0 && upperWick / totalRange > 0.5) {\n        confirmations.push('Bearish rejection wick from zone');\n        confirmationCount++;\n      }\n    }\n\n    const confirmed = confirmationCount >= 2;\n\n    return { confirmed, confirmations };\n  }\n\n  validateSetup(setup: EntrySetup, data: MultiTimeframeData): boolean {\n    if (setup.riskRewardRatio < SMC_ENTRY_CONFIG.minimumRiskReward) {\n      return false;\n    }\n\n    if (setup.confidence < this.minConfidence) {\n      return false;\n    }\n\n    const latestM1 = data.m1[data.m1.length - 1];\n    if (!latestM1) return false;\n\n    const currentPrice = latestM1.close;\n    const entryZone = setup.entryZone;\n\n    const isStillValid = currentPrice >= entryZone.bottomPrice * 0.995 &&\n                         currentPrice <= entryZone.topPrice * 1.005;\n\n    return isStillValid;\n  }\n\n  private buildSignal(\n    instrument: InstrumentData,\n    entryResult: EntryDetectionResult,\n    dailyContext: H4AnalysisResult,\n    zonesResult: M15ZoneResult,\n    refinementResult: RefinementResult,\n    tfSelection: TimeframeSelection,\n    data: MultiTimeframeData\n  ): StrategySignal {\n    const setup = entryResult.setup!;\n    const marketContext = buildMarketContext(dailyContext, dailyContext.swingPoints);\n\n    const allReasoning = [\n      `1D Context: trend ${dailyContext.trend} (clarity: ${tfSelection.dailyContextClarity.score}%)`,\n      `Major Zones: ${tfSelection.majorZoneTf} (clarity: ${tfSelection.majorZoneClarity.score}%)`,\n      `Zone ID: ${tfSelection.zoneIdentificationTf} (clarity: ${tfSelection.zoneIdentificationClarity.score}%)`,\n      `Entry/Refinement: ${tfSelection.entryRefinementTf} (clarity: ${tfSelection.entryRefinementClarity.score}%)`,\n      ...tfSelection.reasoning,\n      ...dailyContext.reasoning,\n      ...zonesResult.reasoning,\n      ...refinementResult.reasoning,\n      ...entryResult.reasoning,\n    ];\n\n    // Extend marketContext with confirmed timeframes\n    const extendedContext = {\n      ...marketContext,\n      contextTimeframe: '1D',\n      majorZoneTimeframe: tfSelection.majorZoneTf,\n      zoneTimeframe: tfSelection.zoneIdentificationTf,\n      refinedTimeframe: tfSelection.entryRefinementTf,\n    };\n\n    return {\n      id: this.createSignalId(),\n      strategyId: this.id,\n      strategyName: this.name,\n      symbol: instrument.symbol,\n      assetClass: instrument.assetClass,\n      direction: setup.direction,\n      entryType: setup.entryType,\n      entryPrice: setup.entryPrice,\n      stopLoss: setup.stopLoss,\n      takeProfit: setup.takeProfit,\n      riskRewardRatio: setup.riskRewardRatio,\n      confidence: setup.confidence,\n      timeframe: tfSelection.entryRefinementTf,\n      marketContext: extendedContext as any,\n      entrySetup: setup,\n      zones: {\n        h4: [...dailyContext.unmitigatedSupply, ...dailyContext.unmitigatedDemand],\n        m15: zonesResult.allZones,\n        m5: [],\n        m1: [],\n      },\n      reasoning: allReasoning,\n      createdAt: Date.now(),\n      expiresAt: this.calculateExpiryTime(),\n    };\n  }\n}\n\nexport const smcStrategy = new SMCStrategy();\n","path":null,"size_bytes":16456,"size_tokens":null},"server/services/eodhd.ts":{"content":"import axios from 'axios';\nimport { db } from '../db';\nimport { economicEvents, InsertEconomicEvent } from '@shared/schema';\nimport { gte, and, eq } from 'drizzle-orm';\n\ninterface EODHDEvent {\n  date: string;\n  country: string;\n  actual: string | null;\n  previous: string | null;\n  estimate: string | null;\n  event: string;\n  impact: string;\n  change: string | null;\n  change_percentage: string | null;\n  unit: string | null;\n}\n\ninterface APICallLog {\n  timestamp: Date;\n  success: boolean;\n}\n\nclass EODHDService {\n  private apiKey: string | undefined;\n  private baseUrl = 'https://eodhd.com/api/economic-events';\n  private dailyCallLimit = 20;\n  private callsToday: APICallLog[] = [];\n  private lastResetDate: string = '';\n\n  constructor() {\n    this.apiKey = process.env.EODHD_API_KEY;\n  }\n\n  private resetDailyCounterIfNeeded(): void {\n    const today = new Date().toISOString().split('T')[0];\n    if (this.lastResetDate !== today) {\n      this.callsToday = [];\n      this.lastResetDate = today;\n      console.log('[EODHD] Daily API call counter reset');\n    }\n  }\n\n  getCallsRemaining(): number {\n    this.resetDailyCounterIfNeeded();\n    return this.dailyCallLimit - this.callsToday.length;\n  }\n\n  getCallsMadeToday(): number {\n    this.resetDailyCounterIfNeeded();\n    return this.callsToday.length;\n  }\n\n  canMakeCall(): boolean {\n    return this.getCallsRemaining() > 0 && !!this.apiKey;\n  }\n\n  private countryToCode(country: string): string {\n    const mapping: Record<string, string> = {\n      'USA': 'USD',\n      'United States': 'USD',\n      'Eurozone': 'EUR',\n      'Euro Area': 'EUR',\n      'Germany': 'EUR',\n      'France': 'EUR',\n      'Italy': 'EUR',\n      'Spain': 'EUR',\n      'United Kingdom': 'GBP',\n      'UK': 'GBP',\n      'Japan': 'JPY',\n      'Canada': 'CAD',\n      'Australia': 'AUD',\n      'New Zealand': 'NZD',\n      'Switzerland': 'CHF',\n      'China': 'CNY',\n    };\n    return mapping[country] || 'USD';\n  }\n\n  private getRegionFromCountry(country: string): string {\n    const regionMapping: Record<string, string> = {\n      'USA': 'Americas',\n      'United States': 'Americas',\n      'Canada': 'Americas',\n      'Eurozone': 'Europe',\n      'Euro Area': 'Europe',\n      'Germany': 'Europe',\n      'France': 'Europe',\n      'Italy': 'Europe',\n      'Spain': 'Europe',\n      'United Kingdom': 'Europe',\n      'UK': 'Europe',\n      'Switzerland': 'Europe',\n      'Japan': 'Asia',\n      'China': 'Asia',\n      'Australia': 'Asia-Pacific',\n      'New Zealand': 'Asia-Pacific',\n    };\n    return regionMapping[country] || 'Other';\n  }\n\n  private mapImpact(impact: string): 'High' | 'Medium' | 'Low' {\n    const impactLower = impact?.toLowerCase() || '';\n    if (impactLower === 'high' || impactLower === '3') return 'High';\n    if (impactLower === 'medium' || impactLower === '2') return 'Medium';\n    return 'Low';\n  }\n\n  async fetchEvents(fromDate?: string, toDate?: string): Promise<EODHDEvent[]> {\n    if (!this.apiKey) {\n      console.log('[EODHD] No API key configured');\n      return [];\n    }\n\n    if (!this.canMakeCall()) {\n      console.log(`[EODHD] Daily limit reached (${this.dailyCallLimit} calls). Using scraper fallback.`);\n      return [];\n    }\n\n    try {\n      const params: Record<string, string> = {\n        api_token: this.apiKey,\n        fmt: 'json',\n      };\n\n      if (fromDate) params.from = fromDate;\n      if (toDate) params.to = toDate;\n\n      console.log(`[EODHD] Fetching events (call ${this.callsToday.length + 1}/${this.dailyCallLimit})`);\n      \n      const response = await axios.get<EODHDEvent[]>(this.baseUrl, { \n        params,\n        timeout: 10000 \n      });\n\n      this.callsToday.push({ timestamp: new Date(), success: true });\n      \n      console.log(`[EODHD] Fetched ${response.data.length} events. Calls remaining: ${this.getCallsRemaining()}`);\n      \n      return response.data;\n    } catch (error) {\n      console.error('[EODHD] API error:', error);\n      this.callsToday.push({ timestamp: new Date(), success: false });\n      return [];\n    }\n  }\n\n  async fetchAndStoreEvents(): Promise<number> {\n    const today = new Date();\n    const nextWeek = new Date(today);\n    nextWeek.setDate(nextWeek.getDate() + 7);\n\n    const fromDate = today.toISOString().split('T')[0];\n    const toDate = nextWeek.toISOString().split('T')[0];\n\n    const events = await this.fetchEvents(fromDate, toDate);\n    \n    if (events.length === 0) {\n      return 0;\n    }\n\n    try {\n      const eventsToInsert: InsertEconomicEvent[] = events.map(event => {\n        const eventTime = new Date(event.date);\n        const currency = this.countryToCode(event.country);\n        \n        return {\n          title: event.event,\n          description: null,\n          eventType: 'economic',\n          country: event.country,\n          countryCode: currency,\n          region: this.getRegionFromCountry(event.country),\n          currency: currency,\n          impactLevel: this.mapImpact(event.impact),\n          eventTime: eventTime,\n          expectedValue: event.estimate || null,\n          previousValue: event.previous || null,\n          actualValue: event.actual || null,\n          unit: event.unit || null,\n          futuresImpliedExpectation: null,\n          surpriseFactor: event.change_percentage || null,\n          marketImpactAnalysis: null,\n          affectedCurrencies: [currency],\n          affectedStocks: null,\n          isReleased: !!event.actual,\n          sourceSite: 'EODHD',\n          sourceUrl: 'https://eodhd.com/api/economic-events',\n        };\n      });\n\n      await db.delete(economicEvents).where(\n        and(\n          gte(economicEvents.eventTime, new Date()),\n          eq(economicEvents.sourceSite, 'EODHD')\n        )\n      );\n\n      if (eventsToInsert.length > 0) {\n        await db.insert(economicEvents).values(eventsToInsert);\n      }\n\n      console.log(`[EODHD] Stored ${eventsToInsert.length} events in database`);\n      return eventsToInsert.length;\n    } catch (error) {\n      console.error('[EODHD] Error storing events:', error);\n      return 0;\n    }\n  }\n\n  getStatus(): { available: boolean; callsRemaining: number; callsMade: number } {\n    return {\n      available: !!this.apiKey,\n      callsRemaining: this.getCallsRemaining(),\n      callsMade: this.getCallsMadeToday(),\n    };\n  }\n}\n\nexport const eodhdService = new EODHDService();\n","path":null,"size_bytes":6318,"size_tokens":null},"server/services/eodhdScheduler.ts":{"content":"import cron, { ScheduledTask } from 'node-cron';\nimport { eodhdService } from './eodhd';\nimport { EconomicCalendarScraper } from '../scrapers/economicCalendarScraper';\nimport { CacheService } from '../scrapers/cacheService';\n\nclass EODHDScheduler {\n  private scraper: EconomicCalendarScraper;\n  private cacheService: CacheService;\n  private scheduledJobs: ScheduledTask[] = [];\n\n  constructor() {\n    this.scraper = new EconomicCalendarScraper();\n    this.cacheService = new CacheService();\n  }\n\n  async fetchWithFallback(): Promise<void> {\n    const status = eodhdService.getStatus();\n    \n    if (status.available && status.callsRemaining > 0) {\n      console.log(`[Scheduler] Using EODHD API (${status.callsRemaining} calls remaining)`);\n      const count = await eodhdService.fetchAndStoreEvents();\n      \n      if (count > 0) {\n        console.log(`[Scheduler] EODHD fetched ${count} events successfully`);\n        return;\n      }\n    }\n\n    console.log('[Scheduler] Falling back to web scraper');\n    try {\n      await this.cacheService.getOrFetchEvents('week', this.scraper);\n      console.log('[Scheduler] Scraper fallback completed');\n    } catch (error) {\n      console.error('[Scheduler] Scraper fallback failed:', error);\n    }\n  }\n\n  start(): void {\n    console.log('[EODHD Scheduler] Initializing smart API call distribution...');\n    \n    this.scheduledJobs.forEach(job => job.stop());\n    this.scheduledJobs = [];\n\n    this.scheduledJobs.push(\n      cron.schedule('50 7 * * 1-5', async () => {\n        console.log('[EODHD] Pre-London fetch #1 (10 min before open)');\n        await this.fetchWithFallback();\n      }, { timezone: 'Europe/London' })\n    );\n\n    this.scheduledJobs.push(\n      cron.schedule('55 7 * * 1-5', async () => {\n        console.log('[EODHD] Pre-London fetch #2 (5 min before open)');\n        await this.fetchWithFallback();\n      }, { timezone: 'Europe/London' })\n    );\n\n    this.scheduledJobs.push(\n      cron.schedule('20 9 * * 1-5', async () => {\n        console.log('[EODHD] Pre-NY fetch #1 (10 min before open)');\n        await this.fetchWithFallback();\n      }, { timezone: 'America/New_York' })\n    );\n\n    this.scheduledJobs.push(\n      cron.schedule('25 9 * * 1-5', async () => {\n        console.log('[EODHD] Pre-NY fetch #2 (5 min before open)');\n        await this.fetchWithFallback();\n      }, { timezone: 'America/New_York' })\n    );\n\n    const londonHours = [9, 10, 12, 14, 16];\n    londonHours.forEach((hour, index) => {\n      this.scheduledJobs.push(\n        cron.schedule(`0 ${hour} * * 1-5`, async () => {\n          console.log(`[EODHD] London session fetch #${index + 1}`);\n          await this.fetchWithFallback();\n        }, { timezone: 'Europe/London' })\n      );\n    });\n\n    const nyHours = [10, 11, 13, 14, 15];\n    nyHours.forEach((hour, index) => {\n      this.scheduledJobs.push(\n        cron.schedule(`30 ${hour} * * 1-5`, async () => {\n          console.log(`[EODHD] NY session fetch #${index + 1}`);\n          await this.fetchWithFallback();\n        }, { timezone: 'America/New_York' })\n      );\n    });\n\n    const offHours = [6, 18, 21];\n    offHours.forEach((hour, index) => {\n      this.scheduledJobs.push(\n        cron.schedule(`0 ${hour} * * 1-5`, async () => {\n          console.log(`[EODHD] Off-hours fetch #${index + 1}`);\n          await this.fetchWithFallback();\n        }, { timezone: 'UTC' })\n      );\n    });\n\n    this.scheduledJobs.push(\n      cron.schedule('0 12 * * 0,6', async () => {\n        console.log('[EODHD] Weekend maintenance fetch');\n        await this.fetchWithFallback();\n      }, { timezone: 'UTC' })\n    );\n\n    console.log('[EODHD Scheduler] Scheduled 20 strategic API calls:');\n    console.log('  - 2 calls: 10 & 5 min before London open (7:50, 7:55 GMT)');\n    console.log('  - 2 calls: 10 & 5 min before NY open (9:20, 9:25 EST)');\n    console.log('  - 5 calls: During London session (9, 10, 12, 14, 16 GMT)');\n    console.log('  - 5 calls: During NY session (10:30, 11:30, 13:30, 14:30, 15:30 EST)');\n    console.log('  - 3 calls: Off-hours coverage (6, 18, 21 UTC)');\n    console.log('  - 1 call: Weekend maintenance (12:00 UTC Sat/Sun)');\n    console.log('  - Fallback: Web scraper when API limit reached');\n\n    this.fetchWithFallback().then(() => {\n      console.log('[EODHD Scheduler] Initial fetch completed');\n    });\n  }\n\n  stop(): void {\n    this.scheduledJobs.forEach(job => job.stop());\n    this.scheduledJobs = [];\n    console.log('[EODHD Scheduler] Stopped all scheduled jobs');\n  }\n\n  getStatus(): {\n    apiStatus: { available: boolean; callsRemaining: number; callsMade: number };\n    scheduledJobs: number;\n  } {\n    return {\n      apiStatus: eodhdService.getStatus(),\n      scheduledJobs: this.scheduledJobs.length,\n    };\n  }\n}\n\nexport const eodhdScheduler = new EODHDScheduler();\n","path":null,"size_bytes":4803,"size_tokens":null},"server/static.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":777,"size_tokens":null},"server/index.prod.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic, log } from \"./static\";\nimport { scraperScheduler } from \"./scrapers/scheduler\";\n\nconst app = express();\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // Production mode: serve static files only\n  serveStatic(app);\n\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n    \n    scraperScheduler.start();\n  });\n\n  process.on('SIGTERM', () => {\n    log('SIGTERM signal received: closing HTTP server');\n    scraperScheduler.stop();\n    server.close(() => {\n      log('HTTP server closed');\n    });\n  });\n\n  process.on('SIGINT', () => {\n    log('SIGINT signal received: closing HTTP server');\n    scraperScheduler.stop();\n    server.close(() => {\n      log('HTTP server closed');\n    });\n  });\n})();\n","path":null,"size_bytes":2076,"size_tokens":null},"server/strategies/shared/candlePatterns.ts":{"content":"import { Candle } from '../core/types';\n\nexport interface InstitutionalCandle {\n  index: number;\n  candle: Candle;\n  type: 'bullish' | 'bearish';\n  bodyRatio: number;\n  impulseMagnitude: number;\n}\n\nexport function isBullishCandle(candle: Candle): boolean {\n  return candle.close > candle.open;\n}\n\nexport function isBearishCandle(candle: Candle): boolean {\n  return candle.close < candle.open;\n}\n\nexport function getCandleBody(candle: Candle): number {\n  return Math.abs(candle.close - candle.open);\n}\n\nexport function getCandleRange(candle: Candle): number {\n  return candle.high - candle.low;\n}\n\nexport function getBodyToRangeRatio(candle: Candle): number {\n  const range = getCandleRange(candle);\n  if (range === 0) return 0;\n  return getCandleBody(candle) / range;\n}\n\nexport function getUpperWick(candle: Candle): number {\n  const bodyTop = Math.max(candle.open, candle.close);\n  return candle.high - bodyTop;\n}\n\nexport function getLowerWick(candle: Candle): number {\n  const bodyBottom = Math.min(candle.open, candle.close);\n  return bodyBottom - candle.low;\n}\n\nexport function isImpulseCandle(candle: Candle, threshold: number = 0.6): boolean {\n  return getBodyToRangeRatio(candle) >= threshold;\n}\n\nexport function detectInstitutionalCandle(\n  candles: Candle[],\n  lookback: number = 20\n): InstitutionalCandle | null {\n  if (candles.length < lookback) return null;\n\n  const recentCandles = candles.slice(-lookback);\n  const avgRange = recentCandles.reduce((sum, c) => sum + getCandleRange(c), 0) / recentCandles.length;\n\n  for (let i = recentCandles.length - 1; i >= 0; i--) {\n    const candle = recentCandles[i];\n    const range = getCandleRange(candle);\n    const bodyRatio = getBodyToRangeRatio(candle);\n\n    if (range > avgRange * 1.5 && bodyRatio > 0.6) {\n      return {\n        index: candles.length - lookback + i,\n        candle,\n        type: isBullishCandle(candle) ? 'bullish' : 'bearish',\n        bodyRatio,\n        impulseMagnitude: range / avgRange,\n      };\n    }\n  }\n\n  return null;\n}\n\nexport function isEngulfingPattern(prev: Candle, curr: Candle): 'bullish' | 'bearish' | null {\n  const prevBody = getCandleBody(prev);\n  const currBody = getCandleBody(curr);\n\n  if (isBearishCandle(prev) && isBullishCandle(curr)) {\n    if (curr.open <= prev.close && curr.close >= prev.open && currBody > prevBody) {\n      return 'bullish';\n    }\n  }\n\n  if (isBullishCandle(prev) && isBearishCandle(curr)) {\n    if (curr.open >= prev.close && curr.close <= prev.open && currBody > prevBody) {\n      return 'bearish';\n    }\n  }\n\n  return null;\n}\n\nexport function isPinBar(candle: Candle, threshold: number = 0.3): 'bullish' | 'bearish' | null {\n  const range = getCandleRange(candle);\n  const body = getCandleBody(candle);\n  const upperWick = getUpperWick(candle);\n  const lowerWick = getLowerWick(candle);\n\n  if (range === 0) return null;\n\n  const bodyRatio = body / range;\n\n  if (bodyRatio <= threshold) {\n    if (lowerWick > range * 0.6 && upperWick < range * 0.2) {\n      return 'bullish';\n    }\n    if (upperWick > range * 0.6 && lowerWick < range * 0.2) {\n      return 'bearish';\n    }\n  }\n\n  return null;\n}\n\nexport function getAverageRange(candles: Candle[], lookback: number = 14): number {\n  const recent = candles.slice(-lookback);\n  if (recent.length === 0) return 0;\n  return recent.reduce((sum, c) => sum + getCandleRange(c), 0) / recent.length;\n}\n\nexport function getAverageBody(candles: Candle[], lookback: number = 14): number {\n  const recent = candles.slice(-lookback);\n  if (recent.length === 0) return 0;\n  return recent.reduce((sum, c) => sum + getCandleBody(c), 0) / recent.length;\n}\n\nexport function isRejectionCandle(candle: Candle, threshold: number = 0.4): boolean {\n  const range = getCandleRange(candle);\n  const body = getCandleBody(candle);\n  const upperWick = getUpperWick(candle);\n  const lowerWick = getLowerWick(candle);\n\n  if (range === 0) return false;\n\n  const bodyRatio = body / range;\n  const maxWick = Math.max(upperWick, lowerWick);\n\n  return bodyRatio <= threshold && maxWick >= range * 0.5;\n}\n\nexport function isDoji(candle: Candle, threshold: number = 0.1): boolean {\n  const range = getCandleRange(candle);\n  const body = getCandleBody(candle);\n\n  if (range === 0) return false;\n\n  return body / range <= threshold;\n}\n\nexport function detectMomentumShift(candles: Candle[], lookback: number = 5): 'bullish' | 'bearish' | null {\n  if (candles.length < lookback + 1) return null;\n\n  const recent = candles.slice(-lookback);\n  const prev = candles.slice(-lookback - 3, -lookback);\n\n  const recentBullish = recent.filter(isBullishCandle).length;\n  const recentBearish = recent.filter(isBearishCandle).length;\n  const prevBullish = prev.filter(isBullishCandle).length;\n  const prevBearish = prev.filter(isBearishCandle).length;\n\n  if (prevBearish >= 2 && recentBullish >= 3) {\n    return 'bullish';\n  }\n\n  if (prevBullish >= 2 && recentBearish >= 3) {\n    return 'bearish';\n  }\n\n  return null;\n}\n\nexport interface VolatilityAnalysis {\n  isVolatile: boolean;\n  wickRatio: number;\n  avgWickRatio: number;\n  rangeMultiplier: number;\n  longWickCount: number;\n  reasons: string[];\n}\n\nexport function analyzeVolatility(candles: Candle[], lookback: number = 20): VolatilityAnalysis {\n  if (candles.length < lookback) {\n    return {\n      isVolatile: false,\n      wickRatio: 0,\n      avgWickRatio: 0,\n      rangeMultiplier: 1,\n      longWickCount: 0,\n      reasons: ['Insufficient data for volatility analysis'],\n    };\n  }\n\n  const recentCandles = candles.slice(-lookback);\n  const reasons: string[] = [];\n\n  const avgRange = recentCandles.reduce((sum, c) => sum + getCandleRange(c), 0) / recentCandles.length;\n  const avgBody = recentCandles.reduce((sum, c) => sum + getCandleBody(c), 0) / recentCandles.length;\n\n  let totalWickRatio = 0;\n  let longWickCount = 0;\n\n  for (const candle of recentCandles) {\n    const range = getCandleRange(candle);\n    const body = getCandleBody(candle);\n    const upperWick = getUpperWick(candle);\n    const lowerWick = getLowerWick(candle);\n    const totalWick = upperWick + lowerWick;\n\n    if (range > 0) {\n      const wickRatio = totalWick / range;\n      totalWickRatio += wickRatio;\n\n      if (wickRatio > 0.6) {\n        longWickCount++;\n      }\n    }\n  }\n\n  const avgWickRatio = totalWickRatio / recentCandles.length;\n  const lastCandle = recentCandles[recentCandles.length - 1];\n  const lastRange = getCandleRange(lastCandle);\n  const rangeMultiplier = avgRange > 0 ? lastRange / avgRange : 1;\n\n  let isVolatile = false;\n\n  let impulseCount = 0;\n  for (const candle of recentCandles) {\n    const bodyRatio = getBodyToRangeRatio(candle);\n    if (bodyRatio >= 0.45) {\n      impulseCount++;\n    }\n  }\n  const hasStrongImpulse = impulseCount >= lookback * 0.25;\n\n  if (avgWickRatio > 0.75 && !hasStrongImpulse) {\n    isVolatile = true;\n    reasons.push(`High wick ratio: ${(avgWickRatio * 100).toFixed(0)}% (market indecision)`);\n  }\n\n  if (longWickCount > lookback * 0.7 && !hasStrongImpulse) {\n    isVolatile = true;\n    reasons.push(`Too many long wick candles: ${longWickCount}/${lookback}`);\n  }\n\n  if (rangeMultiplier > 3.5) {\n    isVolatile = true;\n    reasons.push(`Abnormal range expansion: ${rangeMultiplier.toFixed(1)}x average`);\n  }\n\n  const lastWickRatio = getCandleRange(lastCandle) > 0 \n    ? (getUpperWick(lastCandle) + getLowerWick(lastCandle)) / getCandleRange(lastCandle)\n    : 0;\n\n  if (lastWickRatio > 0.90 && !hasStrongImpulse) {\n    isVolatile = true;\n    reasons.push(`Current candle has extreme wicks: ${(lastWickRatio * 100).toFixed(0)}%`);\n  }\n\n  return {\n    isVolatile,\n    wickRatio: lastWickRatio,\n    avgWickRatio,\n    rangeMultiplier,\n    longWickCount,\n    reasons,\n  };\n}\n\nexport function hasCleanPriceAction(candles: Candle[], lookback: number = 10): boolean {\n  if (candles.length < lookback) return false;\n\n  const recent = candles.slice(-lookback);\n  let cleanCandles = 0;\n\n  for (const candle of recent) {\n    const bodyRatio = getBodyToRangeRatio(candle);\n    if (bodyRatio >= 0.4) {\n      cleanCandles++;\n    }\n  }\n\n  return cleanCandles >= lookback * 0.6;\n}\n\nexport function getWickToBodyRatio(candle: Candle): number {\n  const body = getCandleBody(candle);\n  const upperWick = getUpperWick(candle);\n  const lowerWick = getLowerWick(candle);\n\n  if (body === 0) return Infinity;\n  return (upperWick + lowerWick) / body;\n}\n","path":null,"size_bytes":8340,"size_tokens":null},"server/lib/marketHours.ts":{"content":"export type MarketType = 'forex' | 'stock' | 'crypto' | 'commodity' | 'index';\n\ninterface TradingSession {\n  name: string;\n  openHour: number;\n  openMinute: number;\n  closeHour: number;\n  closeMinute: number;\n  timezone: string;\n  daysOpen: number[];\n}\n\ninterface MarketHoursConfig {\n  sessions: TradingSession[];\n  is24_7: boolean;\n  is24_5: boolean;\n  isDSTAware?: boolean;\n}\n\nfunction isUSInDST(date: Date): boolean {\n  const year = date.getUTCFullYear();\n  \n  const marchSecondSunday = new Date(Date.UTC(year, 2, 1));\n  marchSecondSunday.setUTCDate(1 + ((7 - marchSecondSunday.getUTCDay()) % 7) + 7);\n  marchSecondSunday.setUTCHours(7, 0, 0, 0);\n  \n  const novFirstSunday = new Date(Date.UTC(year, 10, 1));\n  novFirstSunday.setUTCDate(1 + ((7 - novFirstSunday.getUTCDay()) % 7));\n  novFirstSunday.setUTCHours(6, 0, 0, 0);\n  \n  return date >= marchSecondSunday && date < novFirstSunday;\n}\n\nfunction getUSMarketHours(date: Date): { openHour: number; openMinute: number; closeHour: number; closeMinute: number } {\n  const isDST = isUSInDST(date);\n  \n  if (isDST) {\n    return { openHour: 13, openMinute: 30, closeHour: 20, closeMinute: 0 };\n  } else {\n    return { openHour: 14, openMinute: 30, closeHour: 21, closeMinute: 0 };\n  }\n}\n\nconst MARKET_HOURS: Record<MarketType, MarketHoursConfig> = {\n  forex: {\n    sessions: [\n      { name: 'Sydney', openHour: 22, openMinute: 0, closeHour: 7, closeMinute: 0, timezone: 'UTC', daysOpen: [0, 1, 2, 3, 4] },\n      { name: 'Tokyo', openHour: 0, openMinute: 0, closeHour: 9, closeMinute: 0, timezone: 'UTC', daysOpen: [1, 2, 3, 4, 5] },\n      { name: 'London', openHour: 8, openMinute: 0, closeHour: 17, closeMinute: 0, timezone: 'UTC', daysOpen: [1, 2, 3, 4, 5] },\n      { name: 'New York', openHour: 13, openMinute: 0, closeHour: 22, closeMinute: 0, timezone: 'UTC', daysOpen: [1, 2, 3, 4, 5] },\n    ],\n    is24_7: false,\n    is24_5: true,\n  },\n  \n  stock: {\n    sessions: [\n      { name: 'US Market', openHour: 14, openMinute: 30, closeHour: 21, closeMinute: 0, timezone: 'America/New_York', daysOpen: [1, 2, 3, 4, 5] },\n    ],\n    is24_7: false,\n    is24_5: false,\n    isDSTAware: true,\n  },\n  \n  crypto: {\n    sessions: [],\n    is24_7: true,\n    is24_5: false,\n  },\n  \n  commodity: {\n    sessions: [\n      { name: 'COMEX Gold/Silver', openHour: 23, openMinute: 0, closeHour: 22, closeMinute: 0, timezone: 'UTC', daysOpen: [0, 1, 2, 3, 4] },\n      { name: 'Oil NYMEX', openHour: 23, openMinute: 0, closeHour: 22, closeMinute: 0, timezone: 'UTC', daysOpen: [0, 1, 2, 3, 4] },\n    ],\n    is24_7: false,\n    is24_5: true,\n  },\n  \n  index: {\n    sessions: [\n      { name: 'US Index Futures', openHour: 23, openMinute: 0, closeHour: 22, closeMinute: 0, timezone: 'UTC', daysOpen: [0, 1, 2, 3, 4] },\n    ],\n    is24_7: false,\n    is24_5: true,\n  },\n};\n\nexport function isMarketOpen(assetClass: string, now: Date = new Date()): { isOpen: boolean; reason: string; nextOpen?: Date } {\n  const marketType = assetClass as MarketType;\n  const config = MARKET_HOURS[marketType];\n  \n  if (!config) {\n    return { isOpen: true, reason: 'Unknown asset class - assuming open' };\n  }\n  \n  if (config.is24_7) {\n    return { isOpen: true, reason: 'Crypto markets trade 24/7' };\n  }\n  \n  const utcHour = now.getUTCHours();\n  const utcMinute = now.getUTCMinutes();\n  const utcDay = now.getUTCDay();\n  \n  if (config.is24_5) {\n    const isFridayAfterClose = utcDay === 5 && utcHour >= 22;\n    const isSaturday = utcDay === 6;\n    const isSundayBeforeOpen = utcDay === 0 && utcHour < 22;\n    \n    if (isFridayAfterClose || isSaturday || isSundayBeforeOpen) {\n      const nextSunday = new Date(now);\n      if (utcDay === 5) {\n        nextSunday.setUTCDate(nextSunday.getUTCDate() + 2);\n      } else if (utcDay === 6) {\n        nextSunday.setUTCDate(nextSunday.getUTCDate() + 1);\n      }\n      nextSunday.setUTCHours(22, 0, 0, 0);\n      \n      return { \n        isOpen: false, \n        reason: 'Weekend - markets closed Friday 10PM to Sunday 10PM UTC',\n        nextOpen: nextSunday\n      };\n    }\n    \n    return { isOpen: true, reason: `${assetClass} markets open (24/5)` };\n  }\n  \n  if (config.isDSTAware && marketType === 'stock') {\n    const { openHour, openMinute, closeHour, closeMinute } = getUSMarketHours(now);\n    \n    if (!config.sessions[0].daysOpen.includes(utcDay)) {\n      const nextOpen = findNextUSMarketOpen(now);\n      return { \n        isOpen: false, \n        reason: 'US stock market closed - weekend',\n        nextOpen\n      };\n    }\n    \n    const currentMinutes = utcHour * 60 + utcMinute;\n    const openMinutes = openHour * 60 + openMinute;\n    const closeMinutes = closeHour * 60 + closeMinute;\n    \n    if (currentMinutes >= openMinutes && currentMinutes < closeMinutes) {\n      const isDST = isUSInDST(now);\n      return { isOpen: true, reason: `US Market session active (${isDST ? 'EDT' : 'EST'})` };\n    }\n    \n    const nextOpen = findNextUSMarketOpen(now);\n    const isDST = isUSInDST(now);\n    return { \n      isOpen: false, \n      reason: `US stock market closed - outside ${isDST ? '9:30 AM - 4:00 PM EDT' : '9:30 AM - 4:00 PM EST'}`,\n      nextOpen\n    };\n  }\n  \n  for (const session of config.sessions) {\n    if (!session.daysOpen.includes(utcDay)) {\n      continue;\n    }\n    \n    const currentMinutes = utcHour * 60 + utcMinute;\n    const openMinutes = session.openHour * 60 + session.openMinute;\n    const closeMinutes = session.closeHour * 60 + session.closeMinute;\n    \n    if (closeMinutes > openMinutes) {\n      if (currentMinutes >= openMinutes && currentMinutes < closeMinutes) {\n        return { isOpen: true, reason: `${session.name} session active` };\n      }\n    } else {\n      if (currentMinutes >= openMinutes || currentMinutes < closeMinutes) {\n        return { isOpen: true, reason: `${session.name} session active` };\n      }\n    }\n  }\n  \n  const nextSession = findNextSession(config, now);\n  return { \n    isOpen: false, \n    reason: `${assetClass} market closed - outside trading hours`,\n    nextOpen: nextSession\n  };\n}\n\nfunction findNextUSMarketOpen(now: Date): Date {\n  const nextOpen = new Date(now);\n  const { openHour, openMinute } = getUSMarketHours(now);\n  \n  nextOpen.setUTCHours(openHour, openMinute, 0, 0);\n  \n  if (nextOpen <= now) {\n    nextOpen.setUTCDate(nextOpen.getUTCDate() + 1);\n  }\n  \n  while (nextOpen.getUTCDay() === 0 || nextOpen.getUTCDay() === 6) {\n    nextOpen.setUTCDate(nextOpen.getUTCDate() + 1);\n  }\n  \n  const futureHours = getUSMarketHours(nextOpen);\n  nextOpen.setUTCHours(futureHours.openHour, futureHours.openMinute, 0, 0);\n  \n  return nextOpen;\n}\n\nfunction findNextSession(config: MarketHoursConfig, now: Date): Date | undefined {\n  if (config.sessions.length === 0) return undefined;\n  \n  const session = config.sessions[0];\n  const nextOpen = new Date(now);\n  \n  nextOpen.setUTCHours(session.openHour, session.openMinute, 0, 0);\n  \n  if (nextOpen <= now) {\n    nextOpen.setUTCDate(nextOpen.getUTCDate() + 1);\n  }\n  \n  while (!session.daysOpen.includes(nextOpen.getUTCDay())) {\n    nextOpen.setUTCDate(nextOpen.getUTCDate() + 1);\n  }\n  \n  return nextOpen;\n}\n\nexport function getActiveSession(assetClass: string, now: Date = new Date()): string | null {\n  const marketType = assetClass as MarketType;\n  const config = MARKET_HOURS[marketType];\n  \n  if (!config) return null;\n  \n  if (config.is24_7) return 'Always Open';\n  \n  const utcHour = now.getUTCHours();\n  const utcMinute = now.getUTCMinutes();\n  const utcDay = now.getUTCDay();\n  \n  for (const session of config.sessions) {\n    if (!session.daysOpen.includes(utcDay)) continue;\n    \n    const currentMinutes = utcHour * 60 + utcMinute;\n    const openMinutes = session.openHour * 60 + session.openMinute;\n    const closeMinutes = session.closeHour * 60 + session.closeMinute;\n    \n    if (closeMinutes > openMinutes) {\n      if (currentMinutes >= openMinutes && currentMinutes < closeMinutes) {\n        return session.name;\n      }\n    } else {\n      if (currentMinutes >= openMinutes || currentMinutes < closeMinutes) {\n        return session.name;\n      }\n    }\n  }\n  \n  return null;\n}\n\nexport function getMarketStatus(assetClass: string): {\n  isOpen: boolean;\n  session: string | null;\n  reason: string;\n  nextOpen?: string;\n} {\n  const now = new Date();\n  const { isOpen, reason, nextOpen } = isMarketOpen(assetClass, now);\n  const session = getActiveSession(assetClass, now);\n  \n  return {\n    isOpen,\n    session,\n    reason,\n    nextOpen: nextOpen?.toISOString(),\n  };\n}\n\nexport function filterTradeableInstruments<T extends { assetClass: string; symbol: string }>(\n  instruments: T[],\n  now: Date = new Date()\n): { tradeable: T[]; skipped: { instrument: T; reason: string }[] } {\n  const tradeable: T[] = [];\n  const skipped: { instrument: T; reason: string }[] = [];\n  \n  for (const instrument of instruments) {\n    const { isOpen, reason } = isMarketOpen(instrument.assetClass, now);\n    \n    if (isOpen) {\n      tradeable.push(instrument);\n    } else {\n      skipped.push({ instrument, reason });\n    }\n  }\n  \n  return { tradeable, skipped };\n}\n","path":null,"size_bytes":9027,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tests/search/__init__.py":{"content":"","path":null,"size_bytes":0,"size_tokens":null},"server/python/price_service.py":{"content":"#!/usr/bin/env python3\n\"\"\"\nPrice Service - Fetches real-time price data using tessa library\nSupports Yahoo Finance (stocks, forex, commodities) and Coingecko (crypto)\n\"\"\"\n\nimport sys\nimport json\nfrom datetime import datetime\nfrom typing import Optional, Dict, Any, List\n\ntry:\n    from tessa import Symbol\n    import yfinance as yf\n    from pycoingecko import CoinGeckoAPI\nexcept ImportError as e:\n    print(json.dumps({\"error\": f\"Missing dependency: {e}\"}))\n    sys.exit(1)\n\n# Initialize CoinGecko API\ncg = CoinGeckoAPI()\n\n# Mapping of common crypto symbols to CoinGecko IDs\nCRYPTO_ID_MAP = {\n    \"BTC\": \"bitcoin\",\n    \"ETH\": \"ethereum\",\n    \"BNB\": \"binancecoin\",\n    \"XRP\": \"ripple\",\n    \"ADA\": \"cardano\",\n    \"SOL\": \"solana\",\n    \"DOGE\": \"dogecoin\",\n    \"DOT\": \"polkadot\",\n    \"MATIC\": \"matic-network\",\n    \"SHIB\": \"shiba-inu\",\n    \"LTC\": \"litecoin\",\n    \"AVAX\": \"avalanche-2\",\n    \"LINK\": \"chainlink\",\n    \"UNI\": \"uniswap\",\n    \"ATOM\": \"cosmos\",\n}\n\n# Forex pairs mapping for Yahoo Finance\nFOREX_MAP = {\n    \"EUR/USD\": \"EURUSD=X\",\n    \"GBP/USD\": \"GBPUSD=X\",\n    \"USD/JPY\": \"USDJPY=X\",\n    \"USD/CHF\": \"USDCHF=X\",\n    \"AUD/USD\": \"AUDUSD=X\",\n    \"NZD/USD\": \"NZDUSD=X\",\n    \"USD/CAD\": \"USDCAD=X\",\n    \"EUR/GBP\": \"EURGBP=X\",\n    \"EUR/JPY\": \"EURJPY=X\",\n    \"GBP/JPY\": \"GBPJPY=X\",\n    \"EUR/CHF\": \"EURCHF=X\",\n    \"GBP/CHF\": \"GBPCHF=X\",\n    \"AUD/JPY\": \"AUDJPY=X\",\n    \"NZD/JPY\": \"NZDJPY=X\",\n    \"CAD/JPY\": \"CADJPY=X\",\n    \"CHF/JPY\": \"CHFJPY=X\",\n    \"EUR/AUD\": \"EURAUD=X\",\n    \"EUR/CAD\": \"EURCAD=X\",\n    \"EUR/NZD\": \"EURNZD=X\",\n    \"GBP/AUD\": \"GBPAUD=X\",\n    \"GBP/CAD\": \"GBPCAD=X\",\n    \"GBP/NZD\": \"GBPNZD=X\",\n    \"AUD/CAD\": \"AUDCAD=X\",\n    \"AUD/CHF\": \"AUDCHF=X\",\n    \"AUD/NZD\": \"AUDNZD=X\",\n    \"NZD/CAD\": \"NZDCAD=X\",\n    \"NZD/CHF\": \"NZDCHF=X\",\n    \"CAD/CHF\": \"CADCHF=X\",\n}\n\n# Commodities mapping for Yahoo Finance\nCOMMODITIES_MAP = {\n    \"XAU/USD\": \"GC=F\",      # Gold\n    \"XAG/USD\": \"SI=F\",      # Silver\n    \"WTI\": \"CL=F\",          # WTI Crude Oil\n    \"BRENT\": \"BZ=F\",        # Brent Crude Oil\n    \"NGAS\": \"NG=F\",         # Natural Gas\n    \"COPPER\": \"HG=F\",       # Copper\n}\n\n# US Indices mapping for Yahoo Finance\nINDEX_MAP = {\n    \"US100\": \"^NDX\",        # NASDAQ 100\n    \"US500\": \"^GSPC\",       # S&P 500\n    \"US30\": \"^DJI\",         # Dow Jones Industrial Average\n    \"RUSSELL2000\": \"^RUT\",  # Russell 2000\n    \"VIX\": \"^VIX\",          # Volatility Index\n    \"NASDAQ\": \"^IXIC\",      # NASDAQ Composite\n    \"SPX\": \"^GSPC\",         # S&P 500 alternative name\n    \"DJI\": \"^DJI\",          # Dow Jones alternative name\n}\n\n\ndef get_yahoo_price(symbol: str) -> Optional[Dict[str, Any]]:\n    \"\"\"Fetch price from Yahoo Finance\"\"\"\n    try:\n        ticker = yf.Ticker(symbol)\n        info = ticker.info\n        \n        # Try different price fields\n        price = info.get('regularMarketPrice') or info.get('currentPrice') or info.get('previousClose')\n        \n        if price is None:\n            # Try to get from history\n            hist = ticker.history(period=\"1d\")\n            if not hist.empty:\n                price = float(hist['Close'].iloc[-1])\n        \n        if price is not None:\n            return {\n                \"symbol\": symbol,\n                \"price\": float(price),\n                \"change\": info.get('regularMarketChange', 0),\n                \"changePercent\": info.get('regularMarketChangePercent', 0),\n                \"high\": info.get('regularMarketDayHigh', price),\n                \"low\": info.get('regularMarketDayLow', price),\n                \"open\": info.get('regularMarketOpen', price),\n                \"previousClose\": info.get('previousClose', price),\n                \"volume\": info.get('regularMarketVolume', 0),\n                \"timestamp\": datetime.now().isoformat(),\n                \"source\": \"yahoo\"\n            }\n    except Exception as e:\n        pass\n    return None\n\n\ndef get_coingecko_price(coin_id: str) -> Optional[Dict[str, Any]]:\n    \"\"\"Fetch price from CoinGecko\"\"\"\n    try:\n        data = cg.get_price(\n            ids=coin_id,\n            vs_currencies='usd',\n            include_24hr_change=True,\n            include_24hr_vol=True,\n            include_market_cap=True\n        )\n        \n        if coin_id in data:\n            coin_data = data[coin_id]\n            return {\n                \"symbol\": coin_id,\n                \"price\": coin_data.get('usd', 0),\n                \"change\": 0,  # CoinGecko doesn't provide absolute change\n                \"changePercent\": coin_data.get('usd_24h_change', 0),\n                \"volume\": coin_data.get('usd_24h_vol', 0),\n                \"marketCap\": coin_data.get('usd_market_cap', 0),\n                \"timestamp\": datetime.now().isoformat(),\n                \"source\": \"coingecko\"\n            }\n    except Exception as e:\n        pass\n    return None\n\n\ndef get_price(symbol: str, asset_class: str = \"stock\") -> Dict[str, Any]:\n    \"\"\"\n    Get price for a symbol based on asset class\n    \n    Args:\n        symbol: The trading symbol (e.g., \"AAPL\", \"EUR/USD\", \"BTC/USD\")\n        asset_class: One of \"stock\", \"forex\", \"commodity\", \"crypto\"\n    \n    Returns:\n        Price data dictionary\n    \"\"\"\n    result = {\"symbol\": symbol, \"assetClass\": asset_class, \"error\": None}\n    \n    try:\n        if asset_class == \"crypto\":\n            # Handle crypto symbols\n            base_symbol = symbol.replace(\"/USD\", \"\").replace(\"-USD\", \"\").upper()\n            coin_id = CRYPTO_ID_MAP.get(base_symbol, base_symbol.lower())\n            price_data = get_coingecko_price(coin_id)\n            \n            if price_data:\n                result.update(price_data)\n                result[\"symbol\"] = symbol\n            else:\n                # Try Yahoo as fallback for crypto\n                yahoo_symbol = f\"{base_symbol}-USD\"\n                price_data = get_yahoo_price(yahoo_symbol)\n                if price_data:\n                    result.update(price_data)\n                    result[\"symbol\"] = symbol\n                else:\n                    result[\"error\"] = f\"Could not fetch crypto price for {symbol}\"\n                    \n        elif asset_class == \"forex\":\n            # Handle forex pairs\n            yahoo_symbol = FOREX_MAP.get(symbol)\n            if yahoo_symbol:\n                price_data = get_yahoo_price(yahoo_symbol)\n                if price_data:\n                    result.update(price_data)\n                    result[\"symbol\"] = symbol\n                else:\n                    result[\"error\"] = f\"Could not fetch forex price for {symbol}\"\n            else:\n                # Try constructing the Yahoo symbol\n                clean_symbol = symbol.replace(\"/\", \"\") + \"=X\"\n                price_data = get_yahoo_price(clean_symbol)\n                if price_data:\n                    result.update(price_data)\n                    result[\"symbol\"] = symbol\n                else:\n                    result[\"error\"] = f\"Unknown forex pair: {symbol}\"\n                    \n        elif asset_class == \"commodity\":\n            # Handle commodities\n            yahoo_symbol = COMMODITIES_MAP.get(symbol)\n            if yahoo_symbol:\n                price_data = get_yahoo_price(yahoo_symbol)\n                if price_data:\n                    result.update(price_data)\n                    result[\"symbol\"] = symbol\n                else:\n                    result[\"error\"] = f\"Could not fetch commodity price for {symbol}\"\n            else:\n                result[\"error\"] = f\"Unknown commodity: {symbol}\"\n                \n        else:  # stock\n            # Check if it's an index first\n            yahoo_symbol = INDEX_MAP.get(symbol.upper(), symbol)\n            price_data = get_yahoo_price(yahoo_symbol)\n            if price_data:\n                result.update(price_data)\n                result[\"symbol\"] = symbol  # Keep original symbol name\n            else:\n                result[\"error\"] = f\"Could not fetch stock price for {symbol}\"\n                \n    except Exception as e:\n        result[\"error\"] = str(e)\n    \n    return result\n\n\ndef get_multiple_prices(symbols: List[Dict[str, str]]) -> List[Dict[str, Any]]:\n    \"\"\"\n    Get prices for multiple symbols\n    \n    Args:\n        symbols: List of dicts with 'symbol' and 'assetClass' keys\n    \n    Returns:\n        List of price data dictionaries\n    \"\"\"\n    results = []\n    for item in symbols:\n        symbol = item.get('symbol', '')\n        asset_class = item.get('assetClass', 'stock')\n        result = get_price(symbol, asset_class)\n        results.append(result)\n    return results\n\n\ndef main():\n    \"\"\"Main entry point - reads JSON from stdin, outputs JSON to stdout\"\"\"\n    try:\n        # Read input from stdin\n        input_data = sys.stdin.read().strip()\n        \n        if not input_data:\n            print(json.dumps({\"error\": \"No input provided\"}))\n            sys.exit(1)\n        \n        request = json.loads(input_data)\n        \n        action = request.get('action', 'get_price')\n        \n        if action == 'get_price':\n            symbol = request.get('symbol', '')\n            asset_class = request.get('assetClass', 'stock')\n            result = get_price(symbol, asset_class)\n            print(json.dumps(result))\n            \n        elif action == 'get_multiple_prices':\n            symbols = request.get('symbols', [])\n            results = get_multiple_prices(symbols)\n            print(json.dumps(results))\n            \n        elif action == 'ping':\n            print(json.dumps({\"status\": \"ok\", \"timestamp\": datetime.now().isoformat()}))\n            \n        else:\n            print(json.dumps({\"error\": f\"Unknown action: {action}\"}))\n            \n    except json.JSONDecodeError as e:\n        print(json.dumps({\"error\": f\"Invalid JSON: {e}\"}))\n        sys.exit(1)\n    except Exception as e:\n        print(json.dumps({\"error\": str(e)}))\n        sys.exit(1)\n\n\nif __name__ == \"__main__\":\n    main()\n","path":null,"size_bytes":9771,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/symbol/symbol.py":{"content":"\"\"\"Symbol class.\"\"\"\n\nfrom typing import Union, Optional, ClassVar\nfrom dataclasses import dataclass, field\nimport datetime\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom ..price import price_history, price_latest, price_point, PricePoint, PriceHistory\nfrom .. import SourceType\n\npd.plotting.register_matplotlib_converters()\n\n\n@dataclass\nclass Symbol:\n    \"\"\"Symbol class. Encapsulates all the relevant information around a financial symbol\n    and some functionality to get price information, display graphs, etc.\n\n    Notes:\n    - Price-related functions rely on caching happening on lower levels to be efficient;\n      this is fulfilled thanks to the way tessa's caching works.\n    - The initializers don't hit the network -- it will only be hit when accessing the\n      price methods or related methods such as `currency`.\n    \"\"\"\n\n    name: str\n    \"\"\"Symbol's name and default query.\"\"\"\n\n    query: Optional[str] = None\n    \"\"\"Use this to use a query that is different than the name. `name` will be used as\n    the `query` if it is `None`.\n    \"\"\"\n\n    source: SourceType = \"yahoo\"\n    \"\"\"The source to query for this symbol. Defaults to \"yahoo\".\"\"\"\n\n    aliases: list[str] = field(default_factory=list)\n    \"\"\"Optional other names this symbol should be found under. (Will not be used as\n    additional queries but \"internally\" in the `matches` method.)\"\"\"\n\n    # Class variables:\n    currency_preference: ClassVar[str] = \"USD\"\n    \"\"\"Use this to set the preferred currency to get price information in.\n\n    This is no guarantee and you should always double-check the currency that gets\n    returned by any of the `price_*` methods in actuality. This is also the reason why\n    this feature is slightly hidden behind an underscore.\n\n    Since this is a class variable, you can set your preference once for all objects.\n    \"\"\"\n\n    max_date_deviation_days: ClassVar[int] = 10\n    \"\"\"The maximum number of days a date can deviate from the requested date in the\n    `price_point` method. Use `None` to disable this check.\n\n    Since this is a class variable, you can set your preference once for all objects.\n    \"\"\"\n\n    def __post_init__(self) -> None:\n        \"\"\"Re/set some attributes.\"\"\"\n        if self.query is None:\n            self.query = self.name\n\n    def __str__(self) -> str:\n        return f\"Symbol {self.name} with source {self.source}\"\n\n    def p(self) -> None:\n        \"\"\"Convenience method to print the symbol.\"\"\"\n        print(str(self))\n\n    def to_yaml(self) -> str:\n        \"\"\"Return a YAML representation of this symbol.\"\"\"\n        return f\"\"\"\n{self.name}:\n    query: {self.query}\n    aliases: [{\", \".join(self.aliases)}]\n    source: {self.source}\n\"\"\"\n\n    def currency(self) -> str:\n        \"\"\"Return currency for this symbol.\"\"\"\n        currency = self.price_latest().currency\n        return currency and currency.upper()\n\n    def _create_price_args(self) -> dict:\n        \"\"\"Create a dictionary of arguments that work with tessa's price functions.\"\"\"\n        args = {\n            \"query\": self.query,\n            \"source\": self.source,\n            \"currency_preference\": self.currency_preference,\n        }\n        return args\n\n    def price_latest(self) -> PricePoint:\n        \"\"\"Return the latest close price.\"\"\"\n        return price_latest(**self._create_price_args())\n\n    def price_history(self) -> PriceHistory:\n        \"\"\"Return a tuple of the full price history.\"\"\"\n        return price_history(**self._create_price_args())\n\n    def price_point(self, when: Union[str, pd.Timestamp]) -> PricePoint:\n        \"\"\"Look up price at given date `when`. Look for the closest point in time if the\n        exact point in time is not found.\n        \"\"\"\n        return price_point(\n            **self._create_price_args(),\n            when=when,\n            max_date_deviation_days=self.max_date_deviation_days,\n        )\n\n    def price_graph(self, monthsback: int = 6) -> tuple:\n        \"\"\"Display this symbol's price graph over the last monthsback months.\n\n        Returns from_date, fig, and ax in order for subclass functions to add to the\n        information and even the graph displayed here.\n        \"\"\"\n        fig, ax = plt.subplots(figsize=(16, 8))\n        hist = self.price_history().df\n\n        # Calc start date:\n        from_date = datetime.date.today() - pd.offsets.DateOffset(months=monthsback)\n        from_date = from_date.strftime(\"%Y-%m-%d\")\n\n        # Plot the prices:\n        sns.lineplot(ax=ax, data=hist.loc[from_date:, \"close\"], marker=\"o\").set(\n            title=self.name\n        )\n\n        return from_date, fig, ax\n\n    def matches(self, what: str) -> bool:\n        \"\"\"Check if `what` matches this symbol's name or aliases. Also tries to match\n        things like SPICHA if SPICHA.SW is in the aliases. Ignores case.\n        \"\"\"\n        candidates = [c.lower() for c in [self.name] + self.aliases]\n        candidates += [c.split(\".\")[0] for c in candidates]\n        return what.lower() in candidates\n","path":null,"size_bytes":4986,"size_tokens":null},"client/src/hooks/usePrices.ts":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\ninterface PriceData {\n  symbol: string;\n  assetClass?: string;\n  price?: number;\n  change?: number;\n  changePercent?: number;\n  high?: number;\n  low?: number;\n  open?: number;\n  previousClose?: number;\n  volume?: number;\n  marketCap?: number;\n  timestamp?: string;\n  source?: string;\n  error?: string;\n}\n\ninterface PriceServiceStatus {\n  status: \"online\" | \"offline\";\n  message: string;\n}\n\nexport function usePriceServiceStatus() {\n  return useQuery<PriceServiceStatus>({\n    queryKey: [\"/api/prices/status\"],\n    refetchInterval: 60000, // Check every minute\n    staleTime: 30000,\n  });\n}\n\nexport function usePrice(symbol: string, assetClass: \"stock\" | \"forex\" | \"commodity\" | \"crypto\" = \"stock\") {\n  return useQuery<PriceData>({\n    queryKey: [\"/api/prices\", symbol, assetClass],\n    queryFn: async () => {\n      const response = await fetch(`/api/prices/${encodeURIComponent(symbol)}?assetClass=${assetClass}`);\n      if (!response.ok) {\n        throw new Error(\"Failed to fetch price\");\n      }\n      return response.json();\n    },\n    enabled: !!symbol,\n    refetchInterval: 30000, // Refresh every 30 seconds\n    staleTime: 15000,\n  });\n}\n\nexport function useBatchPrices() {\n  return useMutation({\n    mutationFn: async (symbols: Array<{ symbol: string; assetClass: string }>) => {\n      const response = await apiRequest(\"POST\", \"/api/prices/batch\", { symbols });\n      return response.json() as Promise<PriceData[]>;\n    },\n  });\n}\n\nexport function useWatchlistPrices(watchlist: Array<{ symbol: string; assetClass: string }>) {\n  return useQuery<PriceData[]>({\n    queryKey: [\"/api/prices/batch\", watchlist.map(w => `${w.symbol}-${w.assetClass}`).join(\",\")],\n    queryFn: async () => {\n      if (watchlist.length === 0) return [];\n      const response = await apiRequest(\"POST\", \"/api/prices/batch\", { symbols: watchlist });\n      return response.json();\n    },\n    enabled: watchlist.length > 0,\n    refetchInterval: 30000, // Refresh every 30 seconds\n    staleTime: 15000,\n  });\n}\n\nexport function formatPrice(price: number | undefined, decimals: number = 2): string {\n  if (price === undefined || price === null) return \"---\";\n  \n  if (price >= 1000) {\n    return price.toLocaleString(\"en-US\", { minimumFractionDigits: 2, maximumFractionDigits: 2 });\n  } else if (price >= 1) {\n    return price.toFixed(decimals);\n  } else {\n    // For small prices like forex pairs\n    return price.toFixed(Math.max(decimals, 4));\n  }\n}\n\nexport function formatChange(change: number | undefined, changePercent: number | undefined): { text: string; isPositive: boolean } {\n  if (change === undefined && changePercent === undefined) {\n    return { text: \"---\", isPositive: true };\n  }\n  \n  const percent = changePercent ?? 0;\n  const isPositive = percent >= 0;\n  const sign = isPositive ? \"+\" : \"\";\n  \n  return {\n    text: `${sign}${percent.toFixed(2)}%`,\n    isPositive,\n  };\n}\n","path":null,"size_bytes":2983,"size_tokens":null},"server/strategies/smc/config.ts":{"content":"import { StrategyConfig, Timeframe } from '../core/types';\n\nexport const SMC_STRATEGY_CONFIG: StrategyConfig = {\n  id: 'smc-v1',\n  name: 'Smart Money Concepts',\n  enabled: true,\n  minConfidence: 70,\n  scanIntervalMs: 60000,\n  expiryMinutes: 240,\n};\n\nexport const SMC_ZONE_CONFIG = {\n  d1LookbackCandles: 60,\n  h4LookbackCandles: 100,\n  h2LookbackCandles: 100,\n  h1LookbackCandles: 100,\n  m30LookbackCandles: 100,\n  m15LookbackCandles: 100,\n  m5LookbackCandles: 100,\n  m3LookbackCandles: 80,\n  m1LookbackCandles: 60,\n  minImpulseRatio: 0.6,\n  maxRefinedZonePips: 3,\n  maxRefinedZoneMultiplier: 0.5,\n};\n\nexport const SMC_ENTRY_CONFIG = {\n  chochConfidence: 40,\n  dsSdFlipConfidence: 35,\n  continuationConfidence: 30,\n  liquidityConfirmationBonus: 15,\n  strongZoneBonus: 10,\n  multipleConfirmationsBonus: 10,\n  minimumRiskReward: 2,\n  defaultRiskReward: 3,\n};\n\nexport const SMC_CLARITY_CONFIG = {\n  minClarityScore: 60,\n  minZonesRequired: 1,\n  maxZonesForClarity: 5,\n  minSwingPointsRequired: 4,\n  minTrendConsistency: 0.6,\n};\n\nexport interface TimeframePair {\n  context: Timeframe;\n  zone: Timeframe;\n}\n\nexport const CONTEXT_TIMEFRAME: Timeframe = '1D';\n\nexport const MAJOR_ZONE_TIMEFRAMES: Timeframe[] = ['4H', '2H', '1H'];\n\nexport const ZONE_IDENTIFICATION_TIMEFRAMES: Timeframe[] = ['30M', '15M'];\n\nexport const ENTRY_REFINEMENT_TIMEFRAMES: Timeframe[] = ['5M', '3M', '1M'];\n\nexport const PRIMARY_TIMEFRAMES: TimeframePair = {\n  context: '4H',\n  zone: '15M',\n};\n\nexport const ALTERNATIVE_TIMEFRAMES: TimeframePair = {\n  context: '2H',\n  zone: '30M',\n};\n\nexport const SMC_TIMEFRAME_PRIORITY = ['1D', '4H', '2H', '1H', '30M', '15M', '5M', '3M', '1M'] as const;\n","path":null,"size_bytes":1661,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/sources/rate_limiter.py":{"content":"\"\"\"Rate Limiter -- makes sure we don't hit the APIs too often by making sure a minimum\namount of time has elapsed between calls to an API.\n\nThe goal is to never run into errors in the first place, b/c some sites take substantial\ntime until it allow-lists a blocked IP address again. That is also why we can't use a\nlibrary such das Tenacity here.\n\"\"\"\n\nfrom dataclasses import dataclass\nimport datetime\nimport time\nimport pendulum\n\n\nVERY_LONG_AGO = pendulum.parse(\"1900\")\nINITIAL_BACK_OFF_TIME = 10\n\n\n@dataclass\nclass RateLimiter:\n    \"\"\"Encapsulates state and stats of a rate limiter object.\"\"\"\n\n    wait_seconds: float\n    \"\"\"Enforce this amount of seconds between subsequent calls.\"\"\"\n\n    last_call: datetime.datetime = VERY_LONG_AGO\n    \"\"\"Keeps track of last call's timestamp.\"\"\"\n\n    count_all_calls: int = 0\n    \"\"\"Number of total calls.\"\"\"\n\n    count_limited_calls: int = 0\n    \"\"\"Number of calls that triggered some waiting.\"\"\"\n\n    back_off_time: int = INITIAL_BACK_OFF_TIME\n    \"\"\"Number of seconds to wait after a rate limit hit.\"\"\"\n\n    def reset_back_off(self):\n        \"\"\"Reset back-off time to initial value.\"\"\"\n        self.back_off_time = INITIAL_BACK_OFF_TIME\n\n    def reset(self):\n        \"\"\"Reset state and stats.\"\"\"\n        self.last_call = VERY_LONG_AGO\n        self.count_all_calls = self.count_limited_calls = 0\n        self.reset_back_off()\n\n    def rate_limit(self):\n        \"\"\"Enforce the minimum wait time as specified in `wait_seconds`.\"\"\"\n        diff = (pendulum.now() - self.last_call).total_seconds()\n        if diff < self.wait_seconds:\n            time.sleep(self.wait_seconds - diff)\n            self.count_limited_calls += 1\n        self.last_call = pendulum.now()\n        self.count_all_calls += 1\n\n    def back_off(self):\n        \"\"\"Back off exponentially.\"\"\"\n        time.sleep(self.back_off_time)\n        self.back_off_time *= 2\n","path":null,"size_bytes":1871,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tests/symbols/test_symbolcollection.py":{"content":"\"\"\"SymbolCollection-related tests.\"\"\"\n\n# pylint: disable=missing-function-docstring,invalid-name\n\nimport pytest\nfrom tessa.symbol import SymbolCollection, Symbol\n\n\ndef test_initializer():\n    sc = SymbolCollection()\n    assert sc.symbols == []\n\n\ndef test_load_yaml(tmp_path):\n    file = tmp_path / \"symbols.yaml\"\n    file.write_text(\n        \"\"\"\nA:\nB:\n    aliases: [BB, BBB]\n    source: coingecko\n    query: p\nC:\n\"\"\"\n    )\n    sc = SymbolCollection()\n    sc.load_yaml(file)\n    assert sc.find_one(\"A\")\n    b = sc.find_one(\"B\")\n    assert b\n    assert b.source == \"coingecko\"\n    assert b.query == \"p\"\n    assert sc.find_one(\"BB\")\n    assert sc.find_one(\"BBB\")\n    assert sc.find_one(\"C\")\n    assert sc.find_one(\"D\") is None\n    assert len(sc.symbols) == 3\n\n\ndef test_add():\n    sc = SymbolCollection()\n    sc.add(Symbol(\"A\"))\n    sc.add([Symbol(\"B\"), Symbol(\"C\")])\n    assert sc.symbols == [Symbol(\"A\"), Symbol(\"B\"), Symbol(\"C\")]\n\n\ndef test_add_with_wrong_type():\n    sc = SymbolCollection()\n    with pytest.raises(ValueError):\n        sc.add(1)  # type: ignore\n\n\ndef test_add_with_duplicate_names_in_new_symbols():\n    sc = SymbolCollection()\n    with pytest.raises(ValueError):\n        sc.add([Symbol(\"A\"), Symbol(\"A\")])\n\n\ndef test_add_with_duplicate_names_in_existing_plus_new_symbols():\n    sc = SymbolCollection([Symbol(\"A\")])\n    with pytest.raises(ValueError):\n        sc.add(Symbol(\"A\"))\n\n\ndef test_find_and_find_one(tmp_path):\n    file = tmp_path / \"symbols.yaml\"\n    file.write_text(\n        \"\"\"\nA:\nB:\n    aliases: [X]\nBB:\nC:  # Will be overwritten by the second C\nb:  # This, however, will be separate from the earlier B, because it's lower-case\nC:\n    aliases: [X]\n\"\"\"\n    )\n    sc = SymbolCollection()\n    sc.load_yaml(file)\n\n    # find:\n    assert sc.find(\"Z\") == []\n    assert len(sc.find(\"X\")) == 2\n    # There will only be 1 C name bc yaml expects unique keys and pyyaml silently\n    # overwrites the first entry when it encounters the second by the same name:\n    assert len(sc.find(\"C\")) == 1\n    # There will, however, be two B/b symbols because B and b qualify as different keys\n    # in the load_yaml method but the `matches` method in `Symbol` ignores case:\n    assert len(sc.find(\"B\")) == 2\n    assert len(sc.find(\"b\")) == 2\n\n    # find_one:\n    assert sc.find_one(\"A\")\n    assert sc.find_one(\"A\") == sc.find_one(\"a\")  # find ignores case\n    assert sc.find_one(\"BB\")\n    with pytest.raises(ValueError):\n        sc.find_one(\"X\")\n\n\ndef test_to_and_save_yaml(tmp_path):\n    # Test to_yaml:\n    sc1 = SymbolCollection()\n    sc1.add([Symbol(\"A\"), Symbol(\"B\")])\n    assert sc1.to_yaml() == Symbol(\"A\").to_yaml() + Symbol(\"B\").to_yaml()\n    # Test save_yaml:\n    file = tmp_path / \"symbols.yaml\"\n    sc1.save_yaml(file)\n    sc2 = SymbolCollection()\n    sc2.load_yaml(file)\n    assert sc2.symbols == sc1.symbols\n","path":null,"size_bytes":2829,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tests/symbols/test_symbol.py":{"content":"\"\"\"Symbol-related tests.\"\"\"\n\nimport ast\nimport re\nimport pytest\nimport pandas as pd\nimport yaml\nfrom tessa.price import PricePoint\nfrom tessa.symbol import Symbol\n\n# pylint: disable=missing-function-docstring\n\n\ndef test_initializer():\n    s = Symbol(name=\"x\", source=\"coingecko\", query=\"qq\")\n    assert s.name == \"x\"\n    assert s.source == \"coingecko\"\n    assert s.query == \"qq\"\n\n\ndef test_initializer_with_defaults():\n    s = Symbol(name=\"AAPL\")\n    assert s.source == \"yahoo\"\n    assert s.query == \"AAPL\"\n\n\ndef test_repr_can_be_transformed_back_into_symbol():\n    s = Symbol(name=\"x\")\n    params = re.findall(r\"Symbol\\((.*)\\)\", repr(s))[0]\n    params_as_dict = \"{\" + re.sub(r\"(^|, )((\\w+)=)\", r\"\\1'\\3':\", params) + \"}\"\n    assert Symbol(**ast.literal_eval(params_as_dict)) == s\n\n\ndef test_matches():\n    s = Symbol(name=\"X\", aliases=[\"X\", \"Y\", \"Z.DE\"])\n    assert s.matches(\"X\")\n    assert s.matches(\"Y\")\n    assert s.matches(\"Z.DE\")\n    assert s.matches(\"Z\")\n    assert not s.matches(\"A\")\n\n\ndef test_to_yaml():\n    s = Symbol(name=\"X\", aliases=[\"X\", \"Y\", \"Z\"])\n    k, v = list(yaml.safe_load(s.to_yaml()).items())[0]\n    assert Symbol(k, **v) == s\n\n\n@pytest.mark.net\ndef test_price_functions():\n    s = Symbol(name=\"MSFT\")\n    df, crncy = s.price_history()\n    assert isinstance(df, pd.DataFrame)\n    assert crncy == \"USD\"\n    assert isinstance(s.price_latest(), PricePoint)\n    assert round(s.price_latest().price) == round(float(df.iloc[-1][\"close\"]))\n    assert s.price_latest().when == df.iloc[-1].name\n    assert s.currency() == crncy\n    assert round(s.price_point(\"2020-01-10\").price) == round(\n        float(df.loc[\"2020-01-10\"][\"close\"].iloc[0])\n    )\n    # Check that the method returns the nearest price if necessary:\n    assert s.price_point(\"2020-01-01\").when == pd.Timestamp(\n        \"2019-12-31 05:00:00+0000\", tz=\"UTC\"\n    )\n\n\n@pytest.mark.net\ndef test_currency_preference():\n    for check_currency in [\"USD\", \"CHF\"]:\n        Symbol.currency_preference = check_currency\n        assert Symbol(\"bitcoin\", source=\"coingecko\").currency() == check_currency\n","path":null,"size_bytes":2071,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/symbol/__init__.py":{"content":"\"\"\"\n\n# Working with Symbols\n\nThe main class is `tessa.symbol.symbol.Symbol`, which encapsulates all the information\nand functionality around symbols. A `tessa.symbol.symbolcollection.SymbolCollection`\nmanages a collection of symbols including save and load functionality.\n\nExample use:\n\n```python\nfrom tessa import Symbol, SymbolCollection\ns1 = Symbol(\"MSFT\")                 # will use \"yahoo\" as the default source\ns1.price_latest()                   # get latest price\nsc = SymbolCollection([s1])         # create collection\nsc.add(Symbol(\"ethereum\", source=\"coingecko\"))       # add another symbol\nsc.find_one(\"ethereum\").price_graph(monthsback=6)    # graph of 6 past months\nsc.save_yaml(\"my_symbols.yaml\")     # save\n```\n\n`tessa.symbol.extended_symbol.ExtendedSymbol` shows how the `Symbol` class can be\nextended.\n\n\"\"\"\n\nfrom .symbol import Symbol\nfrom .extended_symbol import ExtendedSymbol\nfrom .symbolcollection import SymbolCollection\n","path":null,"size_bytes":944,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/sources/__init__.py":{"content":"\"\"\"\n\n# Managing different data sources\n\nA `tessa.sources.sources.Source` ties together all the functionality and state related\nto a source such as Yahoo or Coingecko.\n\n`tessa.sources.rate_limiter.RateLimiter` takes care of rate limiting for a source.\n\nAll known sources are specified in `tessa.sources.sources_directory`.\n\n\"\"\"\n\nfrom .sourcetype import SourceType\nfrom .sources import Source, get_source, get_all_sources, reset_rate_limiters\n","path":null,"size_bytes":441,"size_tokens":null},"server/strategies/smc/entryDetection.ts":{"content":"import {\n  Candle,\n  SupplyDemandZone,\n  SwingPoint,\n  EntrySetup,\n  EntryType,\n  SignalDirection,\n} from '../core/types';\nimport {\n  detectSwingPoints,\n  findBrokenStructure,\n} from '../shared/swingPoints';\nimport {\n  isBullishCandle,\n  isBearishCandle,\n  isImpulseCandle,\n  isRejectionCandle,\n} from '../shared/candlePatterns';\nimport { isPriceInZone, getUnmitigatedZones } from '../shared/zoneDetection';\nimport { SMC_ENTRY_CONFIG } from './config';\nimport { calculateOptimalEntry, calculateStopLoss } from './zoneRefinement';\n\nexport interface EntryDetectionResult {\n  hasValidEntry: boolean;\n  entryType: EntryType | null;\n  setup: EntrySetup | null;\n  reasoning: string[];\n}\n\nexport function detectEntry(\n  m1Candles: Candle[],\n  targetZone: SupplyDemandZone,\n  targetDirection: SignalDirection,\n  nearestTarget: SupplyDemandZone | null,\n  allZones: SupplyDemandZone[]\n): EntryDetectionResult {\n  const reasoning: string[] = [];\n\n  if (m1Candles.length < 10) {\n    return {\n      hasValidEntry: false,\n      entryType: null,\n      setup: null,\n      reasoning: ['Insufficient M1 data for entry detection'],\n    };\n  }\n\n  const currentPrice = m1Candles[m1Candles.length - 1].close;\n  const swingPoints = detectSwingPoints(m1Candles, { lookback: 3 });\n\n  const chochResult = detectCHoCH(m1Candles, swingPoints, targetZone, targetDirection);\n  if (chochResult.detected) {\n    reasoning.push(...chochResult.reasoning);\n    return buildEntrySetup(\n      'choch',\n      targetZone,\n      targetDirection,\n      nearestTarget,\n      chochResult.confidence,\n      chochResult.confirmations,\n      reasoning\n    );\n  }\n\n  const flipResult = detectDSSDFlip(m1Candles, targetZone, targetDirection, allZones);\n  if (flipResult.detected) {\n    reasoning.push(...flipResult.reasoning);\n    return buildEntrySetup(\n      'ds_sd_flip',\n      targetZone,\n      targetDirection,\n      nearestTarget,\n      flipResult.confidence,\n      flipResult.confirmations,\n      reasoning\n    );\n  }\n\n  const contResult = detectContinuation(m1Candles, targetZone, targetDirection, swingPoints);\n  if (contResult.detected) {\n    reasoning.push(...contResult.reasoning);\n    return buildEntrySetup(\n      'continuation',\n      targetZone,\n      targetDirection,\n      nearestTarget,\n      contResult.confidence,\n      contResult.confirmations,\n      reasoning\n    );\n  }\n\n  reasoning.push('No valid entry trigger detected on M1');\n  return {\n    hasValidEntry: false,\n    entryType: null,\n    setup: null,\n    reasoning,\n  };\n}\n\ninterface DetectionResult {\n  detected: boolean;\n  confidence: number;\n  confirmations: string[];\n  reasoning: string[];\n}\n\nfunction detectCHoCH(\n  candles: Candle[],\n  swingPoints: SwingPoint[],\n  targetZone: SupplyDemandZone,\n  direction: SignalDirection\n): DetectionResult {\n  const reasoning: string[] = [];\n  const confirmations: string[] = [];\n  let confidence = 0;\n\n  if (swingPoints.length < 4) {\n    return { detected: false, confidence: 0, confirmations: [], reasoning: ['Not enough swing points'] };\n  }\n\n  const currentPrice = candles[candles.length - 1].close;\n  const recentSwings = swingPoints.slice(-8);\n\n  const bosResult = findBrokenStructure(swingPoints, currentPrice);\n\n  if (direction === 'buy') {\n    const llSequence = recentSwings.filter(s => s.type === 'LL' || s.type === 'LH');\n    const hasDowntrendStructure = llSequence.length >= 2;\n\n    const latestHH = recentSwings.filter(s => s.type === 'HH').pop();\n    const hasBullishBreak = bosResult.type === 'bullish_bos' || (latestHH && currentPrice > latestHH.price);\n\n    if (hasDowntrendStructure && hasBullishBreak) {\n      reasoning.push('Bullish CHoCH: Downtrend structure broken by HH');\n      confirmations.push('CHoCH: Bearish to Bullish transition');\n      confidence = SMC_ENTRY_CONFIG.chochConfidence;\n\n      if (isPriceInZone(currentPrice, targetZone)) {\n        confirmations.push('Price currently in demand zone');\n        confidence += 20;\n      } else if (wasRecentlyInZone(candles, targetZone)) {\n        confirmations.push('Price reacted from demand zone');\n        confidence += 15;\n      }\n\n      if (hasReactionCandle(candles, 'bullish')) {\n        confirmations.push('Strong bullish reaction candle');\n        confidence += 10;\n      }\n\n      if (hasRejectionFromZone(candles, targetZone, 'bullish')) {\n        confirmations.push('Bullish rejection from zone');\n        confidence += 10;\n      }\n\n      return { detected: true, confidence, confirmations, reasoning };\n    }\n  } else {\n    const hhSequence = recentSwings.filter(s => s.type === 'HH' || s.type === 'HL');\n    const hasUptrendStructure = hhSequence.length >= 2;\n\n    const latestLL = recentSwings.filter(s => s.type === 'LL').pop();\n    const hasBearishBreak = bosResult.type === 'bearish_bos' || (latestLL && currentPrice < latestLL.price);\n\n    if (hasUptrendStructure && hasBearishBreak) {\n      reasoning.push('Bearish CHoCH: Uptrend structure broken by LL');\n      confirmations.push('CHoCH: Bullish to Bearish transition');\n      confidence = SMC_ENTRY_CONFIG.chochConfidence;\n\n      if (isPriceInZone(currentPrice, targetZone)) {\n        confirmations.push('Price currently in supply zone');\n        confidence += 20;\n      } else if (wasRecentlyInZone(candles, targetZone)) {\n        confirmations.push('Price reacted from supply zone');\n        confidence += 15;\n      }\n\n      if (hasReactionCandle(candles, 'bearish')) {\n        confirmations.push('Strong bearish reaction candle');\n        confidence += 10;\n      }\n\n      if (hasRejectionFromZone(candles, targetZone, 'bearish')) {\n        confirmations.push('Bearish rejection from zone');\n        confidence += 10;\n      }\n\n      return { detected: true, confidence, confirmations, reasoning };\n    }\n  }\n\n  return { detected: false, confidence: 0, confirmations: [], reasoning: ['No CHoCH pattern'] };\n}\n\nfunction hasRejectionFromZone(\n  candles: Candle[],\n  zone: SupplyDemandZone,\n  direction: 'bullish' | 'bearish'\n): boolean {\n  const recent = candles.slice(-5);\n\n  for (const candle of recent) {\n    const inZone = candle.low <= zone.topPrice && candle.high >= zone.bottomPrice;\n    if (!inZone) continue;\n\n    if (isRejectionCandle(candle)) {\n      if (direction === 'bullish' && isBullishCandle(candle)) {\n        return true;\n      }\n      if (direction === 'bearish' && isBearishCandle(candle)) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction detectDSSDFlip(\n  candles: Candle[],\n  targetZone: SupplyDemandZone,\n  direction: SignalDirection,\n  allZones: SupplyDemandZone[]\n): DetectionResult {\n  const reasoning: string[] = [];\n  const confirmations: string[] = [];\n  let confidence = 0;\n\n  const currentPrice = candles[candles.length - 1].close;\n\n  const oppositeType = targetZone.type === 'demand' ? 'supply' : 'demand';\n  const nearbyOpposite = allZones.filter(z => \n    z.type === oppositeType &&\n    Math.abs(((z.topPrice + z.bottomPrice) / 2) - ((targetZone.topPrice + targetZone.bottomPrice) / 2)) < (targetZone.topPrice - targetZone.bottomPrice) * 3\n  );\n\n  if (nearbyOpposite.length > 0 && isPriceInZone(currentPrice, targetZone)) {\n    if (direction === 'buy' && targetZone.type === 'demand') {\n      reasoning.push('D/S to S/D Flip: Supply zone converted to demand, price in demand zone');\n      confirmations.push('Zone flip detected');\n      confidence = SMC_ENTRY_CONFIG.dsSdFlipConfidence;\n\n      if (hasReactionCandle(candles, 'bullish')) {\n        confirmations.push('Bullish reaction from flipped zone');\n        confidence += 15;\n      }\n\n      return { detected: true, confidence, confirmations, reasoning };\n    }\n\n    if (direction === 'sell' && targetZone.type === 'supply') {\n      reasoning.push('S/D to D/S Flip: Demand zone converted to supply, price in supply zone');\n      confirmations.push('Zone flip detected');\n      confidence = SMC_ENTRY_CONFIG.dsSdFlipConfidence;\n\n      if (hasReactionCandle(candles, 'bearish')) {\n        confirmations.push('Bearish reaction from flipped zone');\n        confidence += 15;\n      }\n\n      return { detected: true, confidence, confirmations, reasoning };\n    }\n  }\n\n  return { detected: false, confidence: 0, confirmations: [], reasoning: ['No D/S-S/D flip'] };\n}\n\nfunction detectContinuation(\n  candles: Candle[],\n  targetZone: SupplyDemandZone,\n  direction: SignalDirection,\n  swingPoints: SwingPoint[]\n): DetectionResult {\n  const reasoning: string[] = [];\n  const confirmations: string[] = [];\n  let confidence = 0;\n\n  const currentPrice = candles[candles.length - 1].close;\n  const recentSwings = swingPoints.slice(-4);\n\n  if (direction === 'buy') {\n    const hasHL = recentSwings.some(s => s.type === 'HL');\n    const hasHH = recentSwings.some(s => s.type === 'HH');\n\n    if (hasHL && hasHH) {\n      if (isPriceInZone(currentPrice, targetZone) || wasRecentlyInZone(candles, targetZone)) {\n        reasoning.push('Bullish continuation: HL formed, price at demand zone');\n        confirmations.push('Trend continuation with pullback to zone');\n        confidence = SMC_ENTRY_CONFIG.continuationConfidence;\n\n        if (hasReactionCandle(candles, 'bullish')) {\n          confirmations.push('Bullish reaction candle');\n          confidence += 10;\n        }\n\n        return { detected: true, confidence, confirmations, reasoning };\n      }\n    }\n  } else {\n    const hasLH = recentSwings.some(s => s.type === 'LH');\n    const hasLL = recentSwings.some(s => s.type === 'LL');\n\n    if (hasLH && hasLL) {\n      if (isPriceInZone(currentPrice, targetZone) || wasRecentlyInZone(candles, targetZone)) {\n        reasoning.push('Bearish continuation: LH formed, price at supply zone');\n        confirmations.push('Trend continuation with pullback to zone');\n        confidence = SMC_ENTRY_CONFIG.continuationConfidence;\n\n        if (hasReactionCandle(candles, 'bearish')) {\n          confirmations.push('Bearish reaction candle');\n          confidence += 10;\n        }\n\n        return { detected: true, confidence, confirmations, reasoning };\n      }\n    }\n  }\n\n  return { detected: false, confidence: 0, confirmations: [], reasoning: ['No continuation pattern'] };\n}\n\nfunction wasRecentlyInZone(candles: Candle[], zone: SupplyDemandZone, lookback: number = 5): boolean {\n  const recent = candles.slice(-lookback);\n  return recent.some(c => \n    c.low <= zone.topPrice && c.high >= zone.bottomPrice\n  );\n}\n\nfunction hasReactionCandle(candles: Candle[], type: 'bullish' | 'bearish'): boolean {\n  const recent = candles.slice(-3);\n  \n  for (const candle of recent) {\n    if (type === 'bullish' && isBullishCandle(candle) && isImpulseCandle(candle, 0.5)) {\n      return true;\n    }\n    if (type === 'bearish' && isBearishCandle(candle) && isImpulseCandle(candle, 0.5)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction buildEntrySetup(\n  entryType: EntryType,\n  targetZone: SupplyDemandZone,\n  direction: SignalDirection,\n  nearestTarget: SupplyDemandZone | null,\n  baseConfidence: number,\n  confirmations: string[],\n  reasoning: string[]\n): EntryDetectionResult {\n  const entryPrice = calculateOptimalEntry(targetZone, direction);\n  const stopLoss = calculateStopLoss(targetZone, direction);\n\n  let takeProfit: number;\n  if (nearestTarget) {\n    takeProfit = direction === 'buy' \n      ? nearestTarget.bottomPrice \n      : nearestTarget.topPrice;\n  } else {\n    const risk = Math.abs(entryPrice - stopLoss);\n    takeProfit = direction === 'buy'\n      ? entryPrice + risk * SMC_ENTRY_CONFIG.defaultRiskReward\n      : entryPrice - risk * SMC_ENTRY_CONFIG.defaultRiskReward;\n  }\n\n  const risk = Math.abs(entryPrice - stopLoss);\n  const reward = Math.abs(takeProfit - entryPrice);\n  const riskRewardRatio = reward / risk;\n\n  let finalConfidence = baseConfidence;\n\n  if (targetZone.strength === 'strong') {\n    finalConfidence += SMC_ENTRY_CONFIG.strongZoneBonus;\n    confirmations.push('Strong zone strength');\n  }\n\n  if (confirmations.length >= 3) {\n    finalConfidence += SMC_ENTRY_CONFIG.multipleConfirmationsBonus;\n  }\n\n  finalConfidence = Math.min(finalConfidence, 95);\n\n  const setup: EntrySetup = {\n    entryType,\n    direction,\n    entryZone: targetZone,\n    entryPrice,\n    stopLoss,\n    takeProfit,\n    riskRewardRatio: Math.round(riskRewardRatio * 10) / 10,\n    confidence: finalConfidence,\n    confirmations,\n    reasoning,\n  };\n\n  return {\n    hasValidEntry: true,\n    entryType,\n    setup,\n    reasoning,\n  };\n}\n","path":null,"size_bytes":12352,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/search/__init__.py":{"content":"\"\"\"\n# Searching symbols\n\nMain function is `tessa.search.search.search`, which will return a\n`tessa.search.search_result.SearchResult`, offering all kinds of useful functionality.\n\nExample use:\n\n```python\nfrom tessa import search\n\n>>> r = search(\"botto\")\n>>> r.filter(source=\"coingecko\").symbols\n```\n\n(Note that the filter currently doesn't make much sense because coingecko is the only\nsearch source currently with Yahoo Finance disabled.)\n\n\"\"\"\n\nfrom .search_result import SearchResult\nfrom .search import search\n","path":null,"size_bytes":513,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/sources/sources.py":{"content":"\"\"\"Source class and related functions.\"\"\"\n\nfrom __future__ import annotations\nfrom dataclasses import dataclass\nfrom typing import Callable, Generator, TYPE_CHECKING\nimport warnings\nimport requests\nfrom .sourcetype import SourceType\nfrom .rate_limiter import RateLimiter\nfrom ..price.types import RateLimitHitError\n\nif TYPE_CHECKING:\n    from ..price import PriceHistory\n\n\n@dataclass\nclass Source:\n    \"\"\"A `Source` encapsulates everything related to a source such as Yahoo or\n    Coingecko.\n    \"\"\"\n\n    get_price_history: Callable\n    \"\"\"Callback to retrieve price history.\"\"\"\n\n    get_search_results: Callable\n    \"\"\"Callback to retrieve search results.\"\"\"\n\n    rate_limiter: RateLimiter\n    \"\"\"Rate limiter object.\"\"\"\n\n    def get_price_history_bruteforcefully(\n        self, query: str, currency_preference: str = \"USD\"\n    ) -> PriceHistory:\n        \"\"\"Variant of `get_price_history` that will ignore some server-side errors\n        (which often seem to be intermittent, at least on Coingecko) and just\n        retries.\n        \"\"\"\n        max_tries = 100\n        tries = 0\n        while True:\n            tries += 1\n            try:\n                res = self.get_price_history(query, currency_preference)\n                self.rate_limiter.reset_back_off()\n                return res\n            except requests.HTTPError as exc:\n                if exc.response.status_code not in [504, 503, 502]:\n                    raise exc\n                if tries > max_tries:\n                    raise ConnectionError(\n                        f\"Cannot access source, even after {max_tries} tries. \"\n                        \"(Reraising from latest exception, there might have been \"\n                        \"several.)\"\n                    ) from exc\n                warnings.warn(\n                    f\"Latest request raised for status code {exc.response.status_code}.\"\n                    f\" Retrying ({tries}/{max_tries}).\",\n                    RuntimeWarning,\n                )\n            except RateLimitHitError:\n                warnings.warn(\n                    \"Rate limit hit (429). \"\n                    f\"Backing off {self.rate_limiter.back_off_time} seconds.\"\n                )\n                self.rate_limiter.back_off()\n\n\ndef get_source(name: SourceType) -> Source:\n    \"\"\"Get a specific source.\"\"\"\n    # Prevent circular dependencies -- pylint: disable=import-outside-toplevel\n    from .sources_directory import SOURCES_DIRECTORY\n\n    try:\n        return SOURCES_DIRECTORY[name]\n    except KeyError as exc:\n        raise ValueError(\n            f\"Unknown source '{name}'. Supported source are: {SOURCES_DIRECTORY.keys()}\"\n        ) from exc\n\n\ndef get_all_sources() -> Generator:\n    \"\"\"Get all the known sources.\"\"\"\n    # Prevent circular dependencies -- pylint: disable=import-outside-toplevel\n    from .sources_directory import SOURCES_DIRECTORY\n\n    for source in SOURCES_DIRECTORY.values():\n        yield source\n\n\ndef reset_rate_limiters() -> None:\n    \"\"\"Reset the rate limiters of all sources.\"\"\"\n    for source in get_all_sources():\n        source.rate_limiter.reset()\n","path":null,"size_bytes":3089,"size_tokens":null},"server/strategies/shared/zoneDetection.ts":{"content":"import {\n  Candle,\n  SupplyDemandZone,\n  ZoneType,\n  ZoneStatus,\n  ZoneStrength,\n  Timeframe,\n} from '../core/types';\nimport {\n  isBullishCandle,\n  isBearishCandle,\n  getCandleBody,\n  getCandleRange,\n  getBodyToRangeRatio,\n  isImpulseCandle,\n} from './candlePatterns';\n\nexport interface ZoneDetectionOptions {\n  minImpulseRatio: number;\n  lookback: number;\n  minZoneSize: number;\n}\n\nconst DEFAULT_OPTIONS: ZoneDetectionOptions = {\n  minImpulseRatio: 0.6,\n  lookback: 50,\n  minZoneSize: 0,\n};\n\nfunction generateZoneId(): string {\n  return `zone-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n}\n\nfunction calculateZoneStrength(\n  impulseCandle: Candle,\n  subsequentCandles: Candle[]\n): ZoneStrength {\n  const impulseBody = getCandleBody(impulseCandle);\n  const impulseRange = getCandleRange(impulseCandle);\n  const bodyRatio = impulseBody / impulseRange;\n\n  let touches = 0;\n  const zoneTop = Math.max(impulseCandle.open, impulseCandle.close);\n  const zoneBottom = Math.min(impulseCandle.open, impulseCandle.close);\n\n  for (const candle of subsequentCandles.slice(0, 10)) {\n    if (candle.low <= zoneTop && candle.high >= zoneBottom) {\n      touches++;\n    }\n  }\n\n  if (bodyRatio > 0.7 && touches === 0) return 'strong';\n  if (bodyRatio > 0.5 && touches <= 1) return 'moderate';\n  return 'weak';\n}\n\nexport function isSupplyZonePattern(\n  base: Candle,\n  impulse: Candle,\n  confirmation: Candle\n): boolean {\n  const isBearishImpulse = isBearishCandle(impulse);\n  const hasImpulse = isImpulseCandle(impulse, 0.6);\n  const followThrough = confirmation.close < impulse.close;\n\n  return isBearishImpulse && hasImpulse && followThrough;\n}\n\nexport function isDemandZonePattern(\n  base: Candle,\n  impulse: Candle,\n  confirmation: Candle\n): boolean {\n  const isBullishImpulse = isBullishCandle(impulse);\n  const hasImpulse = isImpulseCandle(impulse, 0.6);\n  const followThrough = confirmation.close > impulse.close;\n\n  return isBullishImpulse && hasImpulse && followThrough;\n}\n\nexport function detectSupplyDemandZones(\n  candles: Candle[],\n  timeframe: Timeframe,\n  options: Partial<ZoneDetectionOptions> = {}\n): SupplyDemandZone[] {\n  const opts = { ...DEFAULT_OPTIONS, ...options };\n  const zones: SupplyDemandZone[] = [];\n\n  if (candles.length < 3) return zones;\n\n  const recentCandles = candles.slice(-opts.lookback);\n  const startIndex = candles.length - recentCandles.length;\n\n  for (let i = 1; i < recentCandles.length - 1; i++) {\n    const base = recentCandles[i - 1];\n    const impulse = recentCandles[i];\n    const confirmation = recentCandles[i + 1];\n\n    if (isSupplyZonePattern(base, impulse, confirmation)) {\n      const zone: SupplyDemandZone = {\n        id: generateZoneId(),\n        type: 'supply',\n        status: 'unmitigated',\n        strength: calculateZoneStrength(impulse, recentCandles.slice(i + 1)),\n        topPrice: base.high,\n        bottomPrice: base.low,\n        formationTime: base.timestamp,\n        formationIndex: startIndex + (i - 1),\n        timeframe,\n        pipSize: base.high - base.low,\n      };\n      zones.push(zone);\n    }\n\n    if (isDemandZonePattern(base, impulse, confirmation)) {\n      const zone: SupplyDemandZone = {\n        id: generateZoneId(),\n        type: 'demand',\n        status: 'unmitigated',\n        strength: calculateZoneStrength(impulse, recentCandles.slice(i + 1)),\n        topPrice: base.high,\n        bottomPrice: base.low,\n        formationTime: base.timestamp,\n        formationIndex: startIndex + (i - 1),\n        timeframe,\n        pipSize: base.high - base.low,\n      };\n      zones.push(zone);\n    }\n  }\n\n  return zones;\n}\n\nexport function updateZoneMitigation(\n  zones: SupplyDemandZone[],\n  currentCandle: Candle\n): SupplyDemandZone[] {\n  return zones.map(zone => {\n    if (zone.status === 'mitigated') return zone;\n\n    const isTouched =\n      currentCandle.low <= zone.topPrice && currentCandle.high >= zone.bottomPrice;\n\n    if (isTouched) {\n      return {\n        ...zone,\n        status: 'mitigated' as ZoneStatus,\n        mitigatedAt: currentCandle.timestamp,\n      };\n    }\n\n    return zone;\n  });\n}\n\nexport function getUnmitigatedZones(zones: SupplyDemandZone[]): SupplyDemandZone[] {\n  return zones.filter(z => z.status === 'unmitigated');\n}\n\nexport function getMitigatedZones(zones: SupplyDemandZone[]): SupplyDemandZone[] {\n  return zones.filter(z => z.status === 'mitigated');\n}\n\nexport function getZonesByType(zones: SupplyDemandZone[], type: ZoneType): SupplyDemandZone[] {\n  return zones.filter(z => z.type === type);\n}\n\nexport function getNearestZone(\n  zones: SupplyDemandZone[],\n  currentPrice: number,\n  direction: 'above' | 'below'\n): SupplyDemandZone | null {\n  const filteredZones = zones.filter(z => {\n    const zoneMiddle = (z.topPrice + z.bottomPrice) / 2;\n    return direction === 'above' ? zoneMiddle > currentPrice : zoneMiddle < currentPrice;\n  });\n\n  if (filteredZones.length === 0) return null;\n\n  return filteredZones.reduce((nearest, zone) => {\n    const zoneMiddle = (zone.topPrice + zone.bottomPrice) / 2;\n    const nearestMiddle = (nearest.topPrice + nearest.bottomPrice) / 2;\n    const zoneDist = Math.abs(zoneMiddle - currentPrice);\n    const nearestDist = Math.abs(nearestMiddle - currentPrice);\n    return zoneDist < nearestDist ? zone : nearest;\n  });\n}\n\nexport function isPriceInZone(price: number, zone: SupplyDemandZone): boolean {\n  return price >= zone.bottomPrice && price <= zone.topPrice;\n}\n\nexport function getZoneSize(zone: SupplyDemandZone): number {\n  return zone.topPrice - zone.bottomPrice;\n}\n\nexport function refineZone(\n  parentZone: SupplyDemandZone,\n  lowerTfCandles: Candle[],\n  lowerTimeframe: Timeframe\n): SupplyDemandZone | null {\n  const zonesInRange = lowerTfCandles.filter(\n    c => c.low <= parentZone.topPrice && c.high >= parentZone.bottomPrice\n  );\n\n  if (zonesInRange.length < 3) return null;\n\n  const refinedZones = detectSupplyDemandZones(zonesInRange, lowerTimeframe);\n\n  const matchingZones = refinedZones.filter(z => z.type === parentZone.type);\n\n  if (matchingZones.length === 0) return null;\n\n  if (matchingZones.length > 1) {\n    const unmitigated = matchingZones.filter(z => z.status === 'unmitigated');\n    if (unmitigated.length === 1) {\n      return {\n        ...unmitigated[0],\n        refinedFrom: parentZone.id,\n      };\n    }\n    return null;\n  }\n\n  return {\n    ...matchingZones[0],\n    refinedFrom: parentZone.id,\n  };\n}\n","path":null,"size_bytes":6385,"size_tokens":null},"server/strategies/shared/swingPoints.ts":{"content":"import { Candle, SwingPoint, SwingPointType } from '../core/types';\n\nexport interface SwingPointDetectionOptions {\n  lookback: number;\n  minSwingSize: number;\n}\n\nconst DEFAULT_OPTIONS: SwingPointDetectionOptions = {\n  lookback: 5,\n  minSwingSize: 0,\n};\n\nexport function isSwingHigh(candles: Candle[], index: number, lookback: number = 2): boolean {\n  if (index < lookback || index >= candles.length - lookback) return false;\n\n  const current = candles[index];\n\n  for (let i = 1; i <= lookback; i++) {\n    if (candles[index - i].high >= current.high) return false;\n    if (candles[index + i].high >= current.high) return false;\n  }\n\n  return true;\n}\n\nexport function isSwingLow(candles: Candle[], index: number, lookback: number = 2): boolean {\n  if (index < lookback || index >= candles.length - lookback) return false;\n\n  const current = candles[index];\n\n  for (let i = 1; i <= lookback; i++) {\n    if (candles[index - i].low <= current.low) return false;\n    if (candles[index + i].low <= current.low) return false;\n  }\n\n  return true;\n}\n\nexport function detectSwingPoints(\n  candles: Candle[],\n  options: Partial<SwingPointDetectionOptions> = {}\n): SwingPoint[] {\n  const opts = { ...DEFAULT_OPTIONS, ...options };\n  const swingPoints: SwingPoint[] = [];\n\n  const highs: { price: number; index: number; timestamp: number }[] = [];\n  const lows: { price: number; index: number; timestamp: number }[] = [];\n\n  for (let i = opts.lookback; i < candles.length - opts.lookback; i++) {\n    if (isSwingHigh(candles, i, opts.lookback)) {\n      highs.push({\n        price: candles[i].high,\n        index: i,\n        timestamp: candles[i].timestamp,\n      });\n    }\n    if (isSwingLow(candles, i, opts.lookback)) {\n      lows.push({\n        price: candles[i].low,\n        index: i,\n        timestamp: candles[i].timestamp,\n      });\n    }\n  }\n\n  const allPoints = [...highs.map(h => ({ ...h, isHigh: true })), ...lows.map(l => ({ ...l, isHigh: false }))];\n  allPoints.sort((a, b) => a.index - b.index);\n\n  let lastHigherHigh = -Infinity;\n  let lastLowerLow = Infinity;\n  let lastHigherLow = -Infinity;\n  let lastLowerHigh = Infinity;\n\n  for (const point of allPoints) {\n    let type: SwingPointType;\n\n    if (point.isHigh) {\n      if (point.price > lastHigherHigh) {\n        type = 'HH';\n        lastHigherHigh = point.price;\n        lastLowerHigh = point.price;\n      } else if (point.price < lastLowerHigh) {\n        type = 'LH';\n        lastLowerHigh = point.price;\n      } else {\n        type = 'LH';\n      }\n    } else {\n      if (point.price < lastLowerLow) {\n        type = 'LL';\n        lastLowerLow = point.price;\n        lastHigherLow = point.price;\n      } else if (point.price > lastHigherLow) {\n        type = 'HL';\n        lastHigherLow = point.price;\n      } else {\n        type = 'HL';\n      }\n    }\n\n    swingPoints.push({\n      type,\n      price: point.price,\n      index: point.index,\n      timestamp: point.timestamp,\n    });\n  }\n\n  return swingPoints;\n}\n\nexport function getRecentSwingPoints(swingPoints: SwingPoint[], count: number = 5): SwingPoint[] {\n  return swingPoints.slice(-count);\n}\n\nexport function detectTrendFromSwings(swingPoints: SwingPoint[]): 'bullish' | 'bearish' | 'sideways' {\n  if (swingPoints.length < 4) return 'sideways';\n\n  const recent = swingPoints.slice(-6);\n\n  const highs = recent.filter(s => s.type === 'HH' || s.type === 'LH');\n  const lows = recent.filter(s => s.type === 'HL' || s.type === 'LL');\n\n  const hhCount = recent.filter(s => s.type === 'HH').length;\n  const hlCount = recent.filter(s => s.type === 'HL').length;\n  const lhCount = recent.filter(s => s.type === 'LH').length;\n  const llCount = recent.filter(s => s.type === 'LL').length;\n\n  if (hhCount >= 1 && hlCount >= 1 && hhCount + hlCount > lhCount + llCount) {\n    return 'bullish';\n  }\n\n  if (llCount >= 1 && lhCount >= 1 && llCount + lhCount > hhCount + hlCount) {\n    return 'bearish';\n  }\n\n  return 'sideways';\n}\n\nexport function findBrokenStructure(\n  swingPoints: SwingPoint[],\n  currentPrice: number\n): { type: 'bullish_bos' | 'bearish_bos' | null; level: number | null } {\n  if (swingPoints.length < 2) {\n    return { type: null, level: null };\n  }\n\n  const recentHighs = swingPoints.filter(s => s.type === 'HH' || s.type === 'LH');\n  const recentLows = swingPoints.filter(s => s.type === 'HL' || s.type === 'LL');\n\n  if (recentHighs.length > 0) {\n    const lastHigh = recentHighs[recentHighs.length - 1];\n    if (currentPrice > lastHigh.price) {\n      return { type: 'bullish_bos', level: lastHigh.price };\n    }\n  }\n\n  if (recentLows.length > 0) {\n    const lastLow = recentLows[recentLows.length - 1];\n    if (currentPrice < lastLow.price) {\n      return { type: 'bearish_bos', level: lastLow.price };\n    }\n  }\n\n  return { type: null, level: null };\n}\n","path":null,"size_bytes":4775,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/docs/example_symbols.yaml":{"content":"SPICHA:\n    query: SPICHA.SW\n    source: yahoo\nMSFT:\n    # query will be set to \"MSFT\"\n    # source can also be left out because default source is \"yahoo\"\nPINS:\nCHINAFUND:\n    aliases:\n        [\n            UECOPMD:LX,\n            Ubs-ChinaOppoPU,\n            CHINAOPPOPU,\n            Ubs-LuxEquiFuAU,\n            Ubs-LuxEquiFuAT,\n            lu1152091168,\n        ]\n    query: 0P000159H2 # this is the ticker Yahoo Finance uses\n    source: yahoo\nETH:\n    query: ethereum\n    source: coingecko\nETH-USD:\n    source: yahoo\n","path":null,"size_bytes":521,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tests/search/test_search.py":{"content":"\"\"\"Tests relating to `tessa.search`.\"\"\"\n\n# pylint: disable=missing-function-docstring\n\nimport pytest\nfrom tessa import search\nfrom tessa.symbol import Symbol\nfrom tessa.search import SearchResult\n\n\n@pytest.mark.parametrize(\n    \"source, symbol\",\n    [\n        # Old investpy searches:\n        # # These test the results returned by investpy's direct searches:\n        # (\"certificate\", \"NL0006454928\"),\n        # (\"commodity\", \"Palladium\"),\n        # (\"bond\", \"Argentina 1Y\"),\n        # (\"currency_cross\", \"USD/AED\"),\n        # (\"index\", \"BKART\"),\n        # (\"etf\", \"AAA\"),\n        # (\"stock\", \"AAPL\"),\n        # (\"fund\", \"0P0000A29Q\"),\n        # # These test the results returned by investpy's searchobj-based search:\n        # (\"searchobj\", \"PINS\"),\n        # These test the results returned by coingecko's direct searches:\n        (\"coingecko\", \"ETH\"),\n    ],\n)\n@pytest.mark.net\ndef test_working_symbols_are_returned_by_search(source: str, symbol: str):\n    \"\"\"For each possible source of symbol, will we get a working `Symbol` object?\"\"\"\n    res = search(symbol)\n    assert isinstance(res, SearchResult)\n    s = [s for s in res.symbols if s.source == source][0]\n    assert isinstance(s, Symbol)\n","path":null,"size_bytes":1199,"size_tokens":null},"server/strategies/core/types.ts":{"content":"export type Timeframe = '1M' | '3M' | '5M' | '15M' | '30M' | '1H' | '2H' | '4H' | '1D' | '1W';\n\nexport type ZoneType = 'supply' | 'demand';\n\nexport type ZoneStatus = 'unmitigated' | 'mitigated';\n\nexport type ZoneStrength = 'strong' | 'moderate' | 'weak';\n\nexport type TrendDirection = 'bullish' | 'bearish' | 'sideways';\n\nexport type MarketControl = 'supply' | 'demand' | 'neutral';\n\nexport type SwingPointType = 'HH' | 'HL' | 'LH' | 'LL';\n\nexport type EntryType = 'choch' | 'ds_sd_flip' | 'continuation' | 'liquidity_sweep';\n\nexport type SignalDirection = 'buy' | 'sell';\n\nexport interface Candle {\n  timestamp: number;\n  open: number;\n  high: number;\n  low: number;\n  close: number;\n  volume: number;\n  timeframe: Timeframe;\n}\n\nexport interface SupplyDemandZone {\n  id: string;\n  type: ZoneType;\n  status: ZoneStatus;\n  strength: ZoneStrength;\n  topPrice: number;\n  bottomPrice: number;\n  formationTime: number;\n  formationIndex: number;\n  timeframe: Timeframe;\n  mitigatedAt?: number;\n  refinedFrom?: string;\n  pipSize: number;\n}\n\nexport interface SwingPoint {\n  type: SwingPointType;\n  price: number;\n  index: number;\n  timestamp: number;\n}\n\nexport interface MarketContext {\n  h4Control: MarketControl;\n  h4TrendDirection: TrendDirection;\n  h4SupplyZones: SupplyDemandZone[];\n  h4DemandZones: SupplyDemandZone[];\n  nearestH4Target: SupplyDemandZone | null;\n  swingPoints: SwingPoint[];\n}\n\nexport interface EntrySetup {\n  entryType: EntryType;\n  direction: SignalDirection;\n  entryZone: SupplyDemandZone;\n  entryPrice: number;\n  stopLoss: number;\n  takeProfit: number;\n  riskRewardRatio: number;\n  confidence: number;\n  confirmations: string[];\n  reasoning: string[];\n}\n\nexport interface StrategySignal {\n  id: string;\n  strategyId: string;\n  strategyName: string;\n  symbol: string;\n  assetClass: string;\n  direction: SignalDirection;\n  entryType: EntryType;\n  entryPrice: number;\n  stopLoss: number;\n  takeProfit: number;\n  riskRewardRatio: number;\n  confidence: number;\n  timeframe: Timeframe;\n  marketContext: MarketContext;\n  entrySetup: EntrySetup;\n  zones: {\n    h4: SupplyDemandZone[];\n    m15: SupplyDemandZone[];\n    m5: SupplyDemandZone[];\n    m1: SupplyDemandZone[];\n  };\n  reasoning: string[];\n  createdAt: number;\n  expiresAt: number;\n}\n\nexport interface MultiTimeframeData {\n  d1?: Candle[];\n  h4: Candle[];\n  h2: Candle[];\n  h1?: Candle[];\n  m30: Candle[];\n  m15: Candle[];\n  m5: Candle[];\n  m3: Candle[];\n  m1: Candle[];\n}\n\nexport interface StrategyConfig {\n  id: string;\n  name: string;\n  enabled: boolean;\n  minConfidence: number;\n  scanIntervalMs: number;\n  expiryMinutes: number;\n}\n\nexport interface StrategyResult {\n  strategyId: string;\n  signals: StrategySignal[];\n  pendingSetups: EntrySetup[];\n  errors: string[];\n  analysisTimeMs: number;\n}\n\nexport interface InstrumentData {\n  symbol: string;\n  assetClass: string;\n  currentPrice: number;\n  data: MultiTimeframeData;\n}\n","path":null,"size_bytes":2899,"size_tokens":null},"main.py":{"content":"def main():\n    print(\"Hello from repl-nix-workspace!\")\n\n\nif __name__ == \"__main__\":\n    main()\n","path":null,"size_bytes":96,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tests/symbols/__init__.py":{"content":"","path":null,"size_bytes":0,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/price/types.py":{"content":"\"\"\"Price-related types.\"\"\"\n\nfrom __future__ import annotations\nfrom typing import NamedTuple, TYPE_CHECKING\nimport pandas as pd\n\nif TYPE_CHECKING:\n    from ..sources.sourcetype import SourceType\n\nPriceHistory = NamedTuple(\"PriceHistory\", [(\"df\", pd.DataFrame), (\"currency\", str)])\nPricePoint = NamedTuple(\n    \"PricePoint\", [(\"when\", pd.Timestamp), (\"price\", float), (\"currency\", str)]\n)\n\n\nclass SymbolNotFoundError(Exception):\n    def __init__(self, source: SourceType, query: str, *args, **kwargs):\n        msg = f\"No symbol found on source '{source}' for query '{query}'.\"\n        super().__init__(msg, *args, **kwargs)\n\n\nclass CurrencyPreferenceNotFoundError(Exception):\n    def __init__(self, source: SourceType, cur_pref: str, *args, **kwargs):\n        msg = f\"No currency preference found on source '{source}' for '{cur_pref}'.\"\n        super().__init__(msg, *args, **kwargs)\n\n\nclass RateLimitHitError(Exception):\n    def __init__(self, source: SourceType, *args, **kwargs):\n        msg = f\"Rate limit hit on source '{source}'.\"\n        super().__init__(msg, *args, **kwargs)\n","path":null,"size_bytes":1083,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tests/search/test_coingecko_search.py":{"content":"\"\"\"Test coingecko search.\n\nNote that tests will hit the network and therefore will take a while to run.\n\"\"\"\n\n# pylint: disable=missing-function-docstring\n\nimport pytest\nfrom tessa.search.coingecko import coingecko_search\nfrom tessa.search import SearchResult\n\n\n@pytest.mark.net\ndef test_coingecko_search_returns_plausible_results():\n    res = coingecko_search(\"whale\")\n    assert isinstance(res, SearchResult)\n    assert len(res.buckets[0].symbols) > 1\n\n\n@pytest.mark.net\ndef test_coingecko_search_returns_empty_result_for_non_existent_query():\n    assert coingecko_search(\"non_existent_query\").symbols == []\n","path":null,"size_bytes":609,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/symbol/geo/countrynames.py":{"content":"\"\"\"`CountryName` type.\"\"\"\n\nfrom typing import Literal\n\nCountryName = Literal[\n    \"andorra\",\n    \"united arab emirates\",\n    \"afghanistan\",\n    \"antigua and barbuda\",\n    \"anguilla\",\n    \"albania\",\n    \"armenia\",\n    \"angola\",\n    \"antarctica\",\n    \"argentina\",\n    \"american samoa\",\n    \"austria\",\n    \"australia\",\n    \"aruba\",\n    \"land\",\n    \"azerbaijan\",\n    \"bosnia and herzegovina\",\n    \"barbados\",\n    \"bangladesh\",\n    \"belgium\",\n    \"burkina faso\",\n    \"bulgaria\",\n    \"bahrain\",\n    \"burundi\",\n    \"benin\",\n    \"saint barthlemy\",\n    \"bermuda\",\n    \"brunei\",\n    \"bolivia\",\n    \"bonaire\",\n    \"brazil\",\n    \"bahamas\",\n    \"bhutan\",\n    \"bouvet island\",\n    \"botswana\",\n    \"belarus\",\n    \"belize\",\n    \"canada\",\n    \"cocos [keeling] islands\",\n    \"democratic republic of the congo\",\n    \"central african republic\",\n    \"republic of the congo\",\n    \"switzerland\",\n    \"ivory coast\",\n    \"cook islands\",\n    \"chile\",\n    \"cameroon\",\n    \"china\",\n    \"colombia\",\n    \"costa rica\",\n    \"cuba\",\n    \"cape verde\",\n    \"curacao\",\n    \"christmas island\",\n    \"cyprus\",\n    \"czech republic\",\n    \"germany\",\n    \"djibouti\",\n    \"denmark\",\n    \"dominica\",\n    \"dominican republic\",\n    \"algeria\",\n    \"ecuador\",\n    \"estonia\",\n    \"egypt\",\n    \"western sahara\",\n    \"eritrea\",\n    \"spain\",\n    \"ethiopia\",\n    \"finland\",\n    \"fiji\",\n    \"falkland islands\",\n    \"micronesia\",\n    \"faroe islands\",\n    \"france\",\n    \"gabon\",\n    \"united kingdom\",\n    \"grenada\",\n    \"georgia\",\n    \"french guiana\",\n    \"guernsey\",\n    \"ghana\",\n    \"gibraltar\",\n    \"greenland\",\n    \"gambia\",\n    \"guinea\",\n    \"guadeloupe\",\n    \"equatorial guinea\",\n    \"greece\",\n    \"south georgia and the south sandwich islands\",\n    \"guatemala\",\n    \"guam\",\n    \"guinea-bissau\",\n    \"guyana\",\n    \"hong kong\",\n    \"heard island and mcdonald islands\",\n    \"honduras\",\n    \"croatia\",\n    \"haiti\",\n    \"hungary\",\n    \"indonesia\",\n    \"ireland\",\n    \"israel\",\n    \"isle of man\",\n    \"india\",\n    \"british indian ocean territory\",\n    \"iraq\",\n    \"iran\",\n    \"iceland\",\n    \"italy\",\n    \"jersey\",\n    \"jamaica\",\n    \"jordan\",\n    \"japan\",\n    \"kenya\",\n    \"kyrgyzstan\",\n    \"cambodia\",\n    \"kiribati\",\n    \"comoros\",\n    \"saint kitts and nevis\",\n    \"north korea\",\n    \"south korea\",\n    \"kuwait\",\n    \"cayman islands\",\n    \"kazakhstan\",\n    \"laos\",\n    \"lebanon\",\n    \"saint lucia\",\n    \"liechtenstein\",\n    \"sri lanka\",\n    \"liberia\",\n    \"lesotho\",\n    \"lithuania\",\n    \"luxembourg\",\n    \"latvia\",\n    \"libya\",\n    \"morocco\",\n    \"monaco\",\n    \"moldova\",\n    \"montenegro\",\n    \"saint martin\",\n    \"madagascar\",\n    \"marshall islands\",\n    \"north macedonia\",\n    \"mali\",\n    \"myanmar [burma]\",\n    \"mongolia\",\n    \"macao\",\n    \"northern mariana islands\",\n    \"martinique\",\n    \"mauritania\",\n    \"montserrat\",\n    \"malta\",\n    \"mauritius\",\n    \"maldives\",\n    \"malawi\",\n    \"mexico\",\n    \"malaysia\",\n    \"mozambique\",\n    \"namibia\",\n    \"new caledonia\",\n    \"niger\",\n    \"norfolk island\",\n    \"nigeria\",\n    \"nicaragua\",\n    \"netherlands\",\n    \"norway\",\n    \"nepal\",\n    \"nauru\",\n    \"niue\",\n    \"new zealand\",\n    \"oman\",\n    \"panama\",\n    \"peru\",\n    \"french polynesia\",\n    \"papua new guinea\",\n    \"philippines\",\n    \"pakistan\",\n    \"poland\",\n    \"saint pierre and miquelon\",\n    \"pitcairn islands\",\n    \"puerto rico\",\n    \"palestine\",\n    \"portugal\",\n    \"palau\",\n    \"paraguay\",\n    \"qatar\",\n    \"runion\",\n    \"romania\",\n    \"serbia\",\n    \"russia\",\n    \"rwanda\",\n    \"saudi arabia\",\n    \"solomon islands\",\n    \"seychelles\",\n    \"sudan\",\n    \"sweden\",\n    \"singapore\",\n    \"saint helena\",\n    \"slovenia\",\n    \"svalbard and jan mayen\",\n    \"slovakia\",\n    \"sierra leone\",\n    \"san marino\",\n    \"senegal\",\n    \"somalia\",\n    \"suriname\",\n    \"south sudan\",\n    \"so tom and prncipe\",\n    \"el salvador\",\n    \"sint maarten\",\n    \"syria\",\n    \"swaziland\",\n    \"turks and caicos islands\",\n    \"chad\",\n    \"french southern territories\",\n    \"togo\",\n    \"thailand\",\n    \"tajikistan\",\n    \"tokelau\",\n    \"east timor\",\n    \"turkmenistan\",\n    \"tunisia\",\n    \"tonga\",\n    \"turkey\",\n    \"trinidad and tobago\",\n    \"tuvalu\",\n    \"taiwan\",\n    \"tanzania\",\n    \"ukraine\",\n    \"uganda\",\n    \"u.s. minor outlying islands\",\n    \"united states\",\n    \"uruguay\",\n    \"uzbekistan\",\n    \"vatican city\",\n    \"saint vincent and the grenadines\",\n    \"venezuela\",\n    \"british virgin islands\",\n    \"u.s. virgin islands\",\n    \"vietnam\",\n    \"vanuatu\",\n    \"wallis and futuna\",\n    \"samoa\",\n    \"kosovo\",\n    \"yemen\",\n    \"mayotte\",\n    \"south africa\",\n    \"zambia\",\n    \"zimbabwe\",\n]\n","path":null,"size_bytes":4532,"size_tokens":null},"server/strategies/shared/multiTimeframe.ts":{"content":"import { Candle, MultiTimeframeData, Timeframe } from '../core/types';\n\nexport interface TimeframeConfig {\n  timeframe: Timeframe;\n  period: string;\n  interval: string;\n  candleCount: number;\n}\n\nexport const TIMEFRAME_CONFIGS: Record<Timeframe, TimeframeConfig> = {\n  '1M': { timeframe: '1M', period: '1d', interval: '1m', candleCount: 60 },\n  '3M': { timeframe: '3M', period: '2d', interval: '3m', candleCount: 80 },\n  '5M': { timeframe: '5M', period: '5d', interval: '5m', candleCount: 100 },\n  '15M': { timeframe: '15M', period: '5d', interval: '15m', candleCount: 100 },\n  '30M': { timeframe: '30M', period: '10d', interval: '30m', candleCount: 100 },\n  '1H': { timeframe: '1H', period: '1mo', interval: '1h', candleCount: 100 },\n  '2H': { timeframe: '2H', period: '2mo', interval: '2h', candleCount: 100 },\n  '4H': { timeframe: '4H', period: '3mo', interval: '4h', candleCount: 100 },\n  '1D': { timeframe: '1D', period: '1y', interval: '1d', candleCount: 252 },\n  '1W': { timeframe: '1W', period: '2y', interval: '1wk', candleCount: 104 },\n};\n\nexport function generateMockCandles(\n  basePrice: number,\n  timeframe: Timeframe,\n  count: number,\n  volatility: number = 0.002,\n  trend: 'bullish' | 'bearish' | 'sideways' = 'sideways'\n): Candle[] {\n  const candles: Candle[] = [];\n  let currentPrice = basePrice;\n  const now = Date.now();\n\n  const timeframeMs: Record<Timeframe, number> = {\n    '1M': 60 * 1000,\n    '3M': 3 * 60 * 1000,\n    '5M': 5 * 60 * 1000,\n    '15M': 15 * 60 * 1000,\n    '30M': 30 * 60 * 1000,\n    '1H': 60 * 60 * 1000,\n    '2H': 2 * 60 * 60 * 1000,\n    '4H': 4 * 60 * 60 * 1000,\n    '1D': 24 * 60 * 60 * 1000,\n    '1W': 7 * 24 * 60 * 60 * 1000,\n  };\n\n  const intervalMs = timeframeMs[timeframe];\n\n  for (let i = count - 1; i >= 0; i--) {\n    const trendBias = trend === 'bullish' ? 0.0003 : trend === 'bearish' ? -0.0003 : 0;\n    const randomChange = (Math.random() - 0.5) * 2 * volatility + trendBias;\n\n    const open = currentPrice;\n    const closeChange = randomChange * currentPrice;\n    const close = open + closeChange;\n\n    const highExtra = Math.random() * volatility * currentPrice;\n    const lowExtra = Math.random() * volatility * currentPrice;\n\n    const high = Math.max(open, close) + highExtra;\n    const low = Math.min(open, close) - lowExtra;\n\n    candles.push({\n      timestamp: now - i * intervalMs,\n      open,\n      high,\n      low,\n      close,\n      volume: Math.floor(Math.random() * 1000000) + 100000,\n      timeframe,\n    });\n\n    currentPrice = close;\n  }\n\n  return candles;\n}\n\nexport async function fetchMultiTimeframeData(\n  symbol: string,\n  assetClass: string,\n  currentPrice: number\n): Promise<MultiTimeframeData> {\n  const trendBias = determineTrendBias(symbol, currentPrice);\n\n  const volatility = getVolatilityForAsset(assetClass);\n\n  const [d1Data, h4Data, h2Data, h1Data, m30Data, m15Data, m5Data, m3Data, m1Data] = await Promise.all([\n    generateMockCandles(currentPrice, '1D', 60, volatility, trendBias),\n    generateMockCandles(currentPrice, '4H', 100, volatility, trendBias),\n    generateMockCandles(currentPrice, '2H', 100, volatility, trendBias),\n    generateMockCandles(currentPrice, '1H', 100, volatility, trendBias),\n    generateMockCandles(currentPrice, '30M', 100, volatility, trendBias),\n    generateMockCandles(currentPrice, '15M', 100, volatility, trendBias),\n    generateMockCandles(currentPrice, '5M', 100, volatility, trendBias),\n    generateMockCandles(currentPrice, '3M', 80, volatility, trendBias),\n    generateMockCandles(currentPrice, '1M', 60, volatility, trendBias),\n  ]);\n\n  return {\n    d1: d1Data,\n    h4: h4Data,\n    h2: h2Data,\n    h1: h1Data,\n    m30: m30Data,\n    m15: m15Data,\n    m5: m5Data,\n    m3: m3Data,\n    m1: m1Data,\n  };\n}\n\nfunction determineTrendBias(symbol: string, price: number): 'bullish' | 'bearish' | 'sideways' {\n  const hash = symbol.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);\n  const dayOfWeek = new Date().getDay();\n  const combined = (hash + dayOfWeek + Math.floor(price)) % 3;\n\n  if (combined === 0) return 'bullish';\n  if (combined === 1) return 'bearish';\n  return 'sideways';\n}\n\nfunction getVolatilityForAsset(assetClass: string): number {\n  switch (assetClass) {\n    case 'crypto':\n      return 0.01;\n    case 'forex':\n      return 0.002;\n    case 'stock':\n      return 0.005;\n    case 'commodity':\n      return 0.008;\n    case 'index':\n      return 0.004;\n    default:\n      return 0.003;\n  }\n}\n\nexport function alignCandles(\n  higherTf: Candle[],\n  lowerTf: Candle[],\n  startTime: number,\n  endTime: number\n): Candle[] {\n  return lowerTf.filter(c => c.timestamp >= startTime && c.timestamp <= endTime);\n}\n\nexport function getCurrentPrice(candles: Candle[]): number {\n  if (candles.length === 0) return 0;\n  return candles[candles.length - 1].close;\n}\n\nexport function getLatestCandle(candles: Candle[]): Candle | null {\n  if (candles.length === 0) return null;\n  return candles[candles.length - 1];\n}\n","path":null,"size_bytes":4940,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/search/search_result.py":{"content":"\"\"\"Everything related to search results, especially the `SearchResult` class.\"\"\"\n\nfrom __future__ import annotations\nimport functools\nfrom typing import List, NamedTuple, Callable\nimport itertools\nimport re\nfrom ..symbol import Symbol\n\n# ----- The predicates used to sort and bucketize results based on a query -----\n\n# Each matches_* function takes a `query` and a `Symbol` and returns an int denoting the\n# match, where lower numbers signify better matches but 0 (=falsy) signifies not match.\n\n\ndef matches_entire_name_or_alias(query: str, symbol: Symbol) -> int:\n    \"\"\"Try to match the complete name or one of the aliases completely. E.g.:\n    `matches_entire_name_or_alias(\"eth\", Symbol(\"ETH\")) > 0`.\n    \"\"\"\n    query = query.lower()\n    if query == symbol.name.lower():\n        return 1\n    if any(query == x.lower() for x in symbol.aliases if x):\n        return 2\n    return 0\n\n\ndef matches_word_boundary(query: str, symbol: Symbol) -> int:\n    \"\"\"Try to match a complete word in name, aliases, or query. E.g.:\n    `matches_word_boundary(\"eth\", Symbol(\"ETHW\", aliases=[\"PoW ETH\"])) > 0`.\n    \"\"\"\n    query = query.lower()\n    pattern = re.compile(rf\"(^|[^a-z0-9]){query}([^a-z0-9]|$)\", re.IGNORECASE)\n    if re.search(pattern, symbol.name):\n        return 1\n    if re.search(pattern, \"|\".join(symbol.aliases)):\n        return 2\n    if re.search(pattern, str(symbol.query)):\n        return 3\n    return 0\n\n\ndef matches_inanyway(query: str, symbol: Symbol) -> int:\n    \"\"\"Try to match anywhere in name, aliases, or query. E.g.:\n    `matches_inanyway(\"eth\", Symbol(\"TOGETHER\")) > 0`.\n    \"\"\"\n    query = query.lower()\n    if query in symbol.name.lower():\n        return 1\n    if query in (\"|\".join(symbol.aliases)).lower():\n        return 2\n    if query in str(symbol.query).lower():\n        return 3\n    return 0\n\n\n# ----- Everything related to bucketizing symbols -----\n\nBucket = NamedTuple(\"Bucket\", [(\"name\", str), (\"symbols\", List[Symbol])])\n\"\"\"A bucket is a set of results of a certain quality level in a larger search result. A\nbucket has a name and a list of symbols that belong into that bucket.\n\"\"\"\n\n\nBUCKET_SPEC = [\n    (\"Matches entire name or alias \", matches_entire_name_or_alias),\n    (\"Matches word boundary\", matches_word_boundary),\n    (\"Matches in any way\", matches_inanyway),\n    # A bucket with the non-matches will be added by `bucketize`.\n]\n\n\ndef bucketize(query: str, symbols: List[Symbol]) -> List[Bucket]:\n    \"\"\"Split a list of `Symbol`s into buckets based on how well a symbol matches the\n    `query`.\n\n    (We're not using `itertools.groupby` here bc we need empty lists for empty buckets,\n    which `groupby` doesn't provide.)\n    \"\"\"\n    buckets = []\n    rest = symbols\n    for name, matches_predicate in BUCKET_SPEC:\n        matches_query_predicate = functools.partial(matches_predicate, query)\n        hits = list(filter(matches_query_predicate, rest))\n        rest = list(itertools.filterfalse(matches_query_predicate, rest))\n        buckets.append(Bucket(name, hits))\n    buckets.append(Bucket(\"Matches not (but was somehow still returned) \", rest))\n    return buckets\n\n\n# ----- Sorting and removing duplicates -----\n\n\ndef create_sort_key_for_query(query: str) -> Callable:\n    \"\"\"Create a sort key function that classifies a `Symbol` based on `query`.\"\"\"\n\n    def symbol_sort_key(symbol: Symbol) -> int:\n        \"\"\"Cycle through the predicates in `BUCKET_SPEC` and use an offset to return an\n        int based on the matching quality.\n        \"\"\"\n        offset = 10\n        for _, pred in BUCKET_SPEC:\n            score = pred(query, symbol)\n            if score > 0:\n                return offset + score\n            offset += 10\n        return 999\n\n    return symbol_sort_key\n\n\ndef remove_duplicates(symbols: List[Symbol]) -> List[Symbol]:\n    \"\"\"Return a list in which every symbol is unique. Two symbols are considered\n    equivalent if they match in `query` and `source`. Regardless of whether their names\n    are the same or different.\n\n    Note further that several symbols can have the same name but still be considered\n    different if they differ in any of `query` or `source`.\n    \"\"\"\n    equality_key = lambda symbol: str((symbol.source, symbol.query))\n    return [k for k, _ in itertools.groupby(sorted(symbols, key=equality_key))]\n\n\n# ----- The SearchResult class -----\n\n\nclass SearchResult:\n    \"\"\"Manages a search result consisting of a list of `Symbol`s. Removes duplicates,\n    bucketizes, sorts and offers methods to filter and print statistics.\n\n    (Design note 1: `SearchResult` has no relationship with `SymbolCollection` because\n    the purposes of the two classes are very different and because they have different\n    equality definitions for symbols.\n\n    Design note 2: `SearchResult` and `SymbolCollection` have different definitions of\n    equality between symbols: `SearchResult` considers 2 symbols to be equal if they are\n    equal in `query` and `source`, regardless of whether they have the same name or not.\n    A `SymbolCollection` does not have a definition of equality, but it does enforce\n    that names are unique.)\n\n    Example use:\n\n    ```python\n    from tessa import search\n    r = search(\"harmony\")\n\n    # Review results:\n    r.p()\n\n    # Get the 1 symbol from source \"coingecko\" in the best bucket (i.e., bucket 0):\n    s = r.filter(source=\"coingecko\").buckets[0].symbols[0]\n    s.price_latest()\n    ```\n    \"\"\"\n\n    query: str\n    \"\"\"The query that produced the results here.\"\"\"\n\n    symbols: List[Symbol]\n    \"\"\"List of symbols in this result. Always deduplicated and sorted.\"\"\"\n\n    buckets: List[Bucket]\n    \"\"\"List of buckets after bucketizing the symbols.\"\"\"\n\n    filter_history: List[str]\n    \"\"\"The filters that have been applied to get to this result.\"\"\"\n\n    def __init__(self, query: str, symbols: List[Symbol]):\n        self.query = query\n        self.buckets = []\n        self.filter_history = []\n        self.symbols = []\n        self.add_symbols(symbols)\n\n    def add_symbols(self, symbols: List[Symbol]) -> SearchResult:\n        \"\"\"Add symbols. Removes duplicates, sorts, and bucketizes after adding.\"\"\"\n        self.symbols.extend(symbols)\n        self.symbols = remove_duplicates(self.symbols)\n        self.symbols.sort(key=create_sort_key_for_query(self.query))\n        self.buckets = bucketize(self.query, self.symbols)\n        return self\n\n    def filter(self, **kwargs) -> SearchResult:\n        \"\"\"Filter for arbitrary attribute-value-pairs (e.g., `source=\"coingecko\"` or\n        `exchange=\"ebs\"`) and return a new `SearchResult` with the results after the\n        filtering. Also updates the filter history.\n        \"\"\"\n        symbols = []\n        for s in self.symbols:\n            if all(getattr(s, k, \"DOESNOTEXISTEVER\") == v for k, v in kwargs.items()):\n                symbols.append(s)\n        newres = SearchResult(self.query, symbols)\n        newres.filter_history = self.filter_history + [\n            f\"{k}={v}\" for k, v in kwargs.items()\n        ]\n        return newres\n\n    def __str__(self) -> str:\n        \"\"\"Return summary.\"\"\"\n        out = \"\"\n\n        def s(line: str = \"\", indent=False) -> None:\n            nonlocal out\n            indent_str = \"  \" if indent else \"\"\n            out += indent_str + line + \"\\n\"\n\n        s(f\"Search results for query '{self.query}'\")\n        if len(self.filter_history) > 0:\n            s(\"With filters: \" + \", \".join(self.filter_history))\n        s()\n        for i, b in enumerate(self.buckets):\n            s(f\"Bucket {i}: {b.name}\")\n            sources = set(s.source for s in b.symbols)\n\n            if len(b.symbols) == 0:\n                s(\"No hits\", indent=True)\n            else:\n                s(\n                    f\"{len(b.symbols)} hits, {len(sources)} sources\",\n                    indent=True,\n                )\n                if len(b.symbols) in range(1, 6):\n                    s(\"Hits: \" + \", \".join([s.name for s in b.symbols]), indent=True)\n                if len(sources) in range(1, 6):\n                    s(\"Sources: \" + \", \".join(sources), indent=True)\n            s()\n        return out\n\n    def p(self) -> None:\n        \"\"\"Convenience method to print str rep.\"\"\"\n        print(self)\n","path":null,"size_bytes":8184,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/pyproject.toml":{"content":"[tool.poetry]\nname = \"tessa\"\nversion = \"0.9.0\"\ndescription = \"Find financial assets and get their price history without worrying about different APIs or rate limiting.\"\nauthors = [\"ymyke\"]\nlicense = \"MIT\"\nrepository = \"https://github.com/ymyke/tessa\"\nhomepage = \"https://github.com/ymyke/tessa\"\ndocumentation = \"https://ymyke.github.io/tessa/tessa.html\"\nreadme = \"README.md\"\nkeywords = [\"python\", \"finance\", \"investing\", \"financial-analysis\", \"investment-analysis\", \"financial-data\", \"coingecko\", \"pycoingecko\", \"yahoo\", \"yahoo-finance\", \"yfinance\"]\n\n[tool.poetry.dependencies]\n# General:\npython = \">=3.9\"\npendulum = \">=2.1\"\n# price- and search-specific:\npycoingecko = \">=2.2\"\nyfinance = \"^0.2.3\"\n# symbol-specific:\nseaborn = \">=0.11\"\nmatplotlib = \">=3.5\"\nPyYAML = \">=6\"\n\n[poetry.group.dev.dependencies]\npytest = \"*\"\npytest-mock = \"*\"\npytest-random-order = \"*\"\nblack = \"*\"\npdoc = \"*\"\n\n[build-system]\nrequires = [\"poetry-core>=1.0.0\"]\nbuild-backend = \"poetry.core.masonry.api\"\n","path":null,"size_bytes":976,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/search/search.py":{"content":"\"\"\"Unified search.\"\"\"\n\nfrom . import SearchResult\nfrom .. import sources\n\n\ndef search(query: str, silent: bool = False) -> SearchResult:\n    \"\"\"Unified search function. Returns a `tessa.search.SearchResult`.\n\n    - `query`: The string to search for. (Note that this query attribute has a different\n      semantics to the query attribute in the `Symbol` class.)\n    - `silent`: No print output if True.\n    \"\"\"\n    res = SearchResult(query, [])\n    for source in sources.get_all_sources():\n        res.add_symbols(source.get_search_results(query).symbols)\n    if not silent:\n        res.p()\n    return res\n","path":null,"size_bytes":605,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/search/coingecko.py":{"content":"\"\"\"Everything related to searching via coingecko.\"\"\"\n\nimport functools\nfrom pycoingecko import CoinGeckoAPI\nfrom ..symbol import Symbol\nfrom . import SearchResult\n\n\n@functools.lru_cache(maxsize=None)\ndef get_symbol_map() -> list:\n    \"\"\"Get the symbol map. Separate function to use caching, so the API doesn't get\n    hit too often.\n    \"\"\"\n    return CoinGeckoAPI().get_coins_list()\n\n\ndef _matches_to_symbols(matches: list) -> list:\n    \"\"\"Convert a list of Coingecko matches to a list of `Symbol`s.\"\"\"\n    return [\n        Symbol(\n            name=x[\"symbol\"],\n            source=\"coingecko\",\n            query=x[\"id\"],\n            aliases=[x[\"id\"], x[\"name\"]],\n        )\n        for x in matches\n    ]\n\n\ndef coingecko_search(query: str) -> SearchResult:\n    \"\"\"Find coingecko ids that match `query` somehow. Returns `SearchResult`.\"\"\"\n    # Note: No rate limiting here because search is simply a lookup in the symbol map,\n    # which gets cached in the first retrieval.\n    matches = [\n        entry\n        for entry in get_symbol_map()\n        if query.lower() in entry[\"name\"].lower()\n        or query.lower() in entry[\"symbol\"].lower()\n    ]\n    return SearchResult(query=query, symbols=_matches_to_symbols(matches))\n","path":null,"size_bytes":1224,"size_tokens":null},"client/src/pages/Blog.tsx":{"content":"import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { BookOpen, Clock, ArrowRight } from 'lucide-react';\n\nconst blogPosts = [\n  {\n    id: 1,\n    title: 'Understanding Smart Money Concepts in Forex Trading',\n    excerpt: 'Learn how institutional traders move the markets and how to identify their footprints using SMC methodology.',\n    category: 'Education',\n    date: 'Nov 24, 2025',\n    readTime: '8 min read',\n  },\n  {\n    id: 2,\n    title: 'Top 5 Currency Pairs to Watch This Week',\n    excerpt: 'Our analysis of the most promising forex pairs based on interest rate differentials and technical setups.',\n    category: 'Analysis',\n    date: 'Nov 23, 2025',\n    readTime: '5 min read',\n  },\n  {\n    id: 3,\n    title: 'How to Use the Economic Calendar for Better Trades',\n    excerpt: 'A comprehensive guide to trading around high-impact economic events and news releases.',\n    category: 'Strategy',\n    date: 'Nov 22, 2025',\n    readTime: '6 min read',\n  },\n  {\n    id: 4,\n    title: 'Risk Management: The Key to Long-Term Success',\n    excerpt: 'Why proper position sizing and risk-reward ratios matter more than win rate.',\n    category: 'Education',\n    date: 'Nov 21, 2025',\n    readTime: '7 min read',\n  },\n];\n\nconst SectionHeader = ({ icon: Icon, title }: any) => (\n  <div className=\"flex items-center justify-between py-4 border-b-2 border-gray-900 bg-white dark:bg-background px-6\">\n    <div className=\"flex items-center gap-3\">\n      <Icon className=\"w-5 h-5 text-gray-900 dark:text-foreground\" />\n      <h2 className=\"text-xl font-extrabold text-gray-900 dark:text-foreground tracking-tight uppercase\">{title}</h2>\n    </div>\n  </div>\n);\n\nexport default function Blog() {\n  return (\n    <div className=\"min-h-screen bg-[#f7f7f7] dark:bg-background text-gray-800 dark:text-foreground p-4 md:p-8\">\n      <div className=\"max-w-5xl mx-auto\">\n        <section className=\"bg-white dark:bg-background border-t-2 border-gray-900 dark:border-foreground\">\n          <SectionHeader icon={BookOpen} title=\"Trading Insights Blog\" />\n          \n          <div className=\"p-6 grid gap-6\">\n            {blogPosts.map((post) => (\n              <Card key={post.id} className=\"hover-elevate transition-all\" data-testid={`card-blog-${post.id}`}>\n                <CardHeader>\n                  <div className=\"flex items-center gap-3 mb-2\">\n                    <Badge variant=\"secondary\" className=\"text-xs\">\n                      {post.category}\n                    </Badge>\n                    <span className=\"text-xs text-muted-foreground flex items-center gap-1\">\n                      <Clock className=\"w-3 h-3\" />\n                      {post.readTime}\n                    </span>\n                  </div>\n                  <CardTitle className=\"text-xl\">{post.title}</CardTitle>\n                  <CardDescription className=\"text-sm\">{post.date}</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground mb-4\">{post.excerpt}</p>\n                  <Button variant=\"outline\" size=\"sm\" data-testid={`button-read-${post.id}`}>\n                    Read More\n                    <ArrowRight className=\"w-4 h-4 ml-2\" />\n                  </Button>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </section>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":3500,"size_tokens":null},"server/strategies/index.ts":{"content":"import { strategyRegistry } from './core/strategyRegistry';\nimport { smcStrategy } from './smc';\n\nexport function initializeStrategies(): void {\n  console.log('[Strategies] Initializing trading strategies...');\n\n  strategyRegistry.register(smcStrategy);\n\n  const stats = strategyRegistry.getStats();\n  console.log(`[Strategies] Registered ${stats.totalStrategies} strategies (${stats.enabledStrategies} enabled)`);\n}\n\nexport { strategyRegistry } from './core/strategyRegistry';\nexport { BaseStrategy } from './core/baseStrategy';\nexport * from './core/types';\n\nexport { smcStrategy } from './smc';\n","path":null,"size_bytes":598,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/docs/pdoc-dark-mode/syntax-highlighting.css":{"content":"/* monokai color scheme, see pdoc/template/README.md */\npre { line-height: 125%; }\nspan.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 20px; }\n.pdoc-code .hll { background-color: #49483e }\n.pdoc-code { background: #272822; color: #f8f8f2 }\n.pdoc-code .c { color: #75715e } /* Comment */\n.pdoc-code .err { color: #960050; background-color: #1e0010 } /* Error */\n.pdoc-code .esc { color: #f8f8f2 } /* Escape */\n.pdoc-code .g { color: #f8f8f2 } /* Generic */\n.pdoc-code .k { color: #66d9ef } /* Keyword */\n.pdoc-code .l { color: #ae81ff } /* Literal */\n.pdoc-code .n { color: #f8f8f2 } /* Name */\n.pdoc-code .o { color: #f92672 } /* Operator */\n.pdoc-code .x { color: #f8f8f2 } /* Other */\n.pdoc-code .p { color: #f8f8f2 } /* Punctuation */\n.pdoc-code .ch { color: #75715e } /* Comment.Hashbang */\n.pdoc-code .cm { color: #75715e } /* Comment.Multiline */\n.pdoc-code .cp { color: #75715e } /* Comment.Preproc */\n.pdoc-code .cpf { color: #75715e } /* Comment.PreprocFile */\n.pdoc-code .c1 { color: #75715e } /* Comment.Single */\n.pdoc-code .cs { color: #75715e } /* Comment.Special */\n.pdoc-code .gd { color: #f92672 } /* Generic.Deleted */\n.pdoc-code .ge { color: #f8f8f2; font-style: italic } /* Generic.Emph */\n.pdoc-code .gr { color: #f8f8f2 } /* Generic.Error */\n.pdoc-code .gh { color: #f8f8f2 } /* Generic.Heading */\n.pdoc-code .gi { color: #a6e22e } /* Generic.Inserted */\n.pdoc-code .go { color: #66d9ef } /* Generic.Output */\n.pdoc-code .gp { color: #f92672; font-weight: bold } /* Generic.Prompt */\n.pdoc-code .gs { color: #f8f8f2; font-weight: bold } /* Generic.Strong */\n.pdoc-code .gu { color: #75715e } /* Generic.Subheading */\n.pdoc-code .gt { color: #f8f8f2 } /* Generic.Traceback */\n.pdoc-code .kc { color: #66d9ef } /* Keyword.Constant */\n.pdoc-code .kd { color: #66d9ef } /* Keyword.Declaration */\n.pdoc-code .kn { color: #f92672 } /* Keyword.Namespace */\n.pdoc-code .kp { color: #66d9ef } /* Keyword.Pseudo */\n.pdoc-code .kr { color: #66d9ef } /* Keyword.Reserved */\n.pdoc-code .kt { color: #66d9ef } /* Keyword.Type */\n.pdoc-code .ld { color: #e6db74 } /* Literal.Date */\n.pdoc-code .m { color: #ae81ff } /* Literal.Number */\n.pdoc-code .s { color: #e6db74 } /* Literal.String */\n.pdoc-code .na { color: #a6e22e } /* Name.Attribute */\n.pdoc-code .nb { color: #f8f8f2 } /* Name.Builtin */\n.pdoc-code .nc { color: #a6e22e } /* Name.Class */\n.pdoc-code .no { color: #66d9ef } /* Name.Constant */\n.pdoc-code .nd { color: #a6e22e } /* Name.Decorator */\n.pdoc-code .ni { color: #f8f8f2 } /* Name.Entity */\n.pdoc-code .ne { color: #a6e22e } /* Name.Exception */\n.pdoc-code .nf { color: #a6e22e } /* Name.Function */\n.pdoc-code .nl { color: #f8f8f2 } /* Name.Label */\n.pdoc-code .nn { color: #f8f8f2 } /* Name.Namespace */\n.pdoc-code .nx { color: #a6e22e } /* Name.Other */\n.pdoc-code .py { color: #f8f8f2 } /* Name.Property */\n.pdoc-code .nt { color: #f92672 } /* Name.Tag */\n.pdoc-code .nv { color: #f8f8f2 } /* Name.Variable */\n.pdoc-code .ow { color: #f92672 } /* Operator.Word */\n.pdoc-code .w { color: #f8f8f2 } /* Text.Whitespace */\n.pdoc-code .mb { color: #ae81ff } /* Literal.Number.Bin */\n.pdoc-code .mf { color: #ae81ff } /* Literal.Number.Float */\n.pdoc-code .mh { color: #ae81ff } /* Literal.Number.Hex */\n.pdoc-code .mi { color: #ae81ff } /* Literal.Number.Integer */\n.pdoc-code .mo { color: #ae81ff } /* Literal.Number.Oct */\n.pdoc-code .sa { color: #e6db74 } /* Literal.String.Affix */\n.pdoc-code .sb { color: #e6db74 } /* Literal.String.Backtick */\n.pdoc-code .sc { color: #e6db74 } /* Literal.String.Char */\n.pdoc-code .dl { color: #e6db74 } /* Literal.String.Delimiter */\n.pdoc-code .sd { color: #e6db74 } /* Literal.String.Doc */\n.pdoc-code .s2 { color: #e6db74 } /* Literal.String.Double */\n.pdoc-code .se { color: #ae81ff } /* Literal.String.Escape */\n.pdoc-code .sh { color: #e6db74 } /* Literal.String.Heredoc */\n.pdoc-code .si { color: #e6db74 } /* Literal.String.Interpol */\n.pdoc-code .sx { color: #e6db74 } /* Literal.String.Other */\n.pdoc-code .sr { color: #e6db74 } /* Literal.String.Regex */\n.pdoc-code .s1 { color: #e6db74 } /* Literal.String.Single */\n.pdoc-code .ss { color: #e6db74 } /* Literal.String.Symbol */\n.pdoc-code .bp { color: #f8f8f2 } /* Name.Builtin.Pseudo */\n.pdoc-code .fm { color: #a6e22e } /* Name.Function.Magic */\n.pdoc-code .vc { color: #f8f8f2 } /* Name.Variable.Class */\n.pdoc-code .vg { color: #f8f8f2 } /* Name.Variable.Global */\n.pdoc-code .vi { color: #f8f8f2 } /* Name.Variable.Instance */\n.pdoc-code .vm { color: #f8f8f2 } /* Name.Variable.Magic */\n","path":null,"size_bytes":4565,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/price/__init__.py":{"content":"\"\"\"\n# Retrieving price information\n\nMain functions:\n\n- `tessa.price.price.price_history`: Retrieve the full history of an asset as a\n  dataframe.\n- `tessa.price.price.price_point_strict`: Get an asset's price at a certain point in\n  time. Fail if no price found.\n- `tessa.price.price.price_point`: Same, but find the nearest price if the given point\n  in time has no price.\n- `tessa.price.price.price_latest`: Get an asset's latest price.\n\n\nExample use:\n\n```python\n>>> from tessa import price_history, price_point, price_point_strict, price_latest\n\n>>> df, currency = price_history(\"AAPL\")\n\n>>> price_point(\"AAPL\", \"2015-01-01\")           # will return price at 2014-12-31\n\n>>> price_point_strict(\"AAPL\", \"2015-01-01\")    # will raise a KeyError\n\n>>> price_latest(\"ethereum\", source=\"coingecko\", currency_preference=\"CHF\")\n\n>>> price_latest(\"ETH-EUR\", source=\"yahoo\")\n\n>>> price_latest(\"ethereum\", source=\"yahoo\")    # error b/c symbol not found on yahoo\n\n>>> price_latest(\"ETH-EUR\", source=\"coingecko\") # error b/c symbol not found on coingecko\n\n```\n\n\"\"\"\n\nfrom .types import PriceHistory, PricePoint\nfrom .price import (\n    price_history,\n    price_point,\n    price_point_strict,\n    price_latest,\n)\n","path":null,"size_bytes":1202,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tests/price/test_coingecko.py":{"content":"\"\"\"Test the Coingecko API.\"\"\"\n\n# pylint: disable=missing-docstring\n\nimport pytest\nfrom tessa.price import coingecko\nfrom tessa.price.types import SymbolNotFoundError, CurrencyPreferenceNotFoundError\n\n\n@pytest.mark.net\ndef test_api_returns_reasonable_data():\n    df, crncy = coingecko.get_price_history(\"bitcoin\", \"CHF\")\n    assert df.shape[0] > 0\n    assert crncy == \"CHF\"\n\n\n@pytest.mark.net\ndef test_error_non_existent_currency_preference():\n    with pytest.raises(CurrencyPreferenceNotFoundError) as excinfo:\n        coingecko.get_price_history(\"ethereum\", currency_preference=\"non-existent\")\n    assert \"No currency preference found\" in str(excinfo.value)\n\n\n@pytest.mark.net\ndef test_error_non_existent_name():\n    with pytest.raises(SymbolNotFoundError) as excinfo:\n        coingecko.get_price_history(\"non-existent\")\n    assert \"No symbol found\" in str(excinfo.value)\n","path":null,"size_bytes":873,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/README.md":{"content":"\n# tessa  simple, hassle-free access to price information of financial assets\n\ntessa is a Python library to help you **easily retrieve price information** for assets\nfrom different sources such as Yahoo or Coingecko. It takes care of the different APIs,\ncaching, rate limiting, and other hassles.\n\ntessa provides a **Symbol class that encapsulates the methods relevant for a symbol**.\ntessa also provides functionality to **manage collections of symbols**, store and load\nthem, and extend their functionality.\n\nFinally, tessa makes sure to be nice to the sites being accessed and tries to **prevent\nusers from being blocked by 429 rate limiting errors** by 1) caching results upon\nretrieval and 2) keeping track of request timestamps and waiting appropriate amounts of\ntime if necessary. tessa also automatically waits and retries requests that fail with a\n5xx error.\n\n[ Check out the full documentation. ](https://ymyke.github.io/tessa/tessa.html)\n\n\n## How to use\n\nHere's a longer example that shows all aspects of the library. Refer to\nsubmodules [symbol](tessa/symbol.html), [search](tessa/search.html), and\n[price](tessa/price.html) for more information.\n\n###### Imports:\n\n```python\nfrom tessa import Symbol, SymbolCollection, search\nimport pendulum\n```\n\n###### Create a symbol for MSFT and access some functions:\n\n```python\ns1 = Symbol(\"MSFT\")             # will use \"yahoo\" as the default source\ns1.price_latest()               # get latest price\n```\n\n###### Create another symbol from a bloomberg ticker as it is used by Yahoo Finance:\n\n```python\ns2 = Symbol(\"SREN.SW\")\ns2.price_point(\"2022-06-30\")    # get price at specific point in time\n```\n\n###### Create a symbol from the coingecko source with an id as it is used by coingecko:\n\n```python\ns3 = Symbol(\"bitcoin\", source=\"coingecko\")\ns3.price_graph()                # show price graph\n```\n\n###### Search for a crypto ticker on coingecko:\n\n```python\nres = search(\"name\")  # search and print search result summary\nfiltered = res.filter(source=\"coingecko\")  # filter results\nfiltered.p()  # print summary of filtered results\nfiltered.buckets[1].symbols  # review the 2nd bucket in the filtered results\ns4 = filtered.buckets[1].symbols[4]  # our symbol is the 5th in that list\ns4.price_history()  # get entire history\ns4.price_graph()  # visualize the price history\n```\n\n###### Build a collection of several symbols and use the collection to retrieve symbols:\n\n```python\nsc = SymbolCollection([s1, s2, s3, s4])   # create a collection w/ symbols from above\nsc.add(Symbol(\"AAPL\"))                    # add another one\nsc.find_one(\"SREN\").price_graph()\n```\n\n###### Store and load a symbol collection:\n\n```python\nsc.save_yaml(\"my_symbols.yaml\")\nsc_new = SymbolCollection()\nsc_new.load_yaml(\"my_symbols.yaml\")\n```\n\n###### Use a different currency preference:\n\n```python\nsc.find_one(\"ens\").price_latest()   # will return price in USD\nSymbol.currency_preference = \"CHF\"\nsc.find_one(\"ens\").price_latest()   # will return price in CHF\n```\n\nNote that `currency_preference` will only have an effect with sources that support it.\nIt is supported for Coingecko but not for Yahoo. So you should always verify the\neffective currency you receive in the result.\n\nOn Yahoo, some tickers are listed in several currency-specific variants that you can\ntry:\n\n```python\nSymbol(\"ETH-USD\").price_latest()  # will return the price in USD\nSymbol(\"ETH-EUR\").price_latest()  # will return the price in EUR\n```\n\n###### Accessing older crypto price information:\n\nCoingecko only provides a limited amount of historical data:\n\n```python\nfrom_date = (pendulum.now() - pendulum.duration(months=6)).to_date_string()\nSymbol(\"bitcoin\", source=\"coingecko\").price_point(from_date)\n# Will work because coingecko has data for the last year\nSymbol(\"bitcoin\", source=\"coingecko\").price_point(\"2020-08-01\")\n# Will result in a value error as the data is not available\n```\n\nYahoo also lists a number of crypto assets with longer history, so you can try that\nsource as well:\n\n```python\nSymbol(\"BTC-USD\").price_point(from_date)  # Should work, \"yahoo\" is the default source\n```\n\n###### `price_point` tries to be lenient and you can adjust the leniency:\n\nBy default, `price_point` will try to find the closest price to the requested date as\nlong as it's not more than `max_date_deviation_days` days away (default: 10 days).\n\n```python\nea = Symbol(\"EA\")\nea.price_point(\"2022-01-01\")  # Will return the price for 2021-12-31\nSymbol.max_date_deviation_days = 0\nea.price_point(\"2022-01-01\")  # Will raise a ValueError\n```\n\n\n## Data sources\n\ntessa builds on [yfinance](https://pypi.org/project/yfinance/) and\n[pycoingecko](https://github.com/man-c/pycoingecko) and offers **a simplified and\nunified interface**. \n\nWhy these two sources? Yahoo Finance (via yfinance) is fast and offers an extensive\ndatabase that also contains many non-US markets and many crypto tokens. Coingecko (via\npycoingecko) offers great access to crypto prices, but is limited to 1 year of\nhistorical data. \n\nMore sources can be added in the future. Let me know in the\n[issues](https://github.com/ymyke/tessa/issues) of you have a particular request.\n\n\n## Main submodules\n\n- [symbol](tessa/symbol.html): working with symbols and symbol collections.\n- [search](tessa/search.html): searching the different sources.\n- [price](tessa/price.html): accessing price functions directly instead of via the\n  `Symbol` class.\n- [sources](tessa/sources.html): if you'd like to add additional sources to the library.\n\n\n## How to install\n\n`pip install tessa`\n\n\n## Prerequisites\n\nSee `pyproject.toml`. Major prerequisites are the `yfinance` and `pycoingecko` packages\nto access finance information.\n\n\n## Repository\n\nhttps://github.com/ymyke/tessa\n\n\n## On terminology\n\nI'm using symbol instead of ticker because a ticker is mainly used for stock on stock\nmarkets, whereas tessa is inteded to be used for any kind of financial assets, e.g. also\ncrypto.\n\n\n## Other noteworthy libraries\n\n- [strela](https://github.com/ymyke/strela): A python package for financial alerts.\n- [pypme](https://github.com/ymyke/pypme): A Python package for PME (Public Market\n  Equivalent) calculation.\n\n\n## On investpy as a data source\n\nTessa used to use the [investpy package](https://github.com/alvarobartt/investpy) as the\nmain source of information until mid 2022 until investing.com introduced Cloudflare,\nwhich broke access by investpy.  It is currently unclear if investpy will be available\nagain in the future. [You can follow the developments in issue\n600.](https://github.com/alvarobartt/investpy/issues/600) The old tessa/investpy code is\nstill available in the [add-symbols-based-on-investpy\nbranch](https://github.com/ymyke/tessa/tree/add-symbols-based-on-investpy).\n","path":null,"size_bytes":6729,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/price/yahoo.py":{"content":"\"\"\"Everything Yahoo-Finance-related (other than search).\"\"\"\n\nimport pandas as pd\nimport yfinance as yf\nfrom .types import PriceHistory\n\nSTART_FROM = \"2000-01-01\"\n\"\"\"Adjust this date if you need to get historical data further in the past. Note that\nextending this date will lead to increased load on the Yahoo Finance servers.\n\"\"\"\n\n\ndef get_price_history(\n    query: str, currency_preference: str = \"USD\"  # pylint: disable=unused-argument\n) -> PriceHistory:\n    \"\"\"Get price history for a given query. Note that `currency_preference` will be\n    ignored since Yahoo Finance returns each ticker in the one currency that is set for\n    that ticker.\n    \"\"\"\n    ticker = yf.Ticker(query)\n    df = ticker.history(start=START_FROM, raise_errors=True)\n\n    # Simplify dataframe:\n    df = df.copy()\n    df = df[[\"Close\"]]\n    df.index = pd.to_datetime(df.index, utc=True)\n    df.index.name = \"date\"\n    df.rename(columns={\"Close\": \"close\"}, inplace=True)\n\n    return PriceHistory(df, ticker.get_history_metadata()[\"currency\"])\n","path":null,"size_bytes":1020,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tests/__init__.py":{"content":"","path":null,"size_bytes":0,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tests/search/test_search_result.py":{"content":"\"\"\"Test the SearchResult class.\"\"\"\n\n# pylint: disable=missing-function-docstring\n\nfrom tessa.search.search_result import (\n    SearchResult,\n    matches_entire_name_or_alias,\n    matches_word_boundary,\n    matches_inanyway,\n)\nfrom tessa import Symbol\n\n\ndef test_matches_predicates():\n    assert matches_entire_name_or_alias(\"eth\", Symbol(\"ETH\")) > 0\n    assert matches_word_boundary(\"eth\", Symbol(\"ETHW\", aliases=[\"PoW ETH\"])) > 0\n    assert matches_inanyway(\"eth\", Symbol(\"TOGETHER\")) > 0\n    assert matches_inanyway(\"et h\", Symbol(\"TOGETHER\")) == 0\n\n\ndef test_init_with_empty_list():\n    res = SearchResult(\"q\", [])\n    assert res.query == \"q\"\n    assert res.symbols == []\n    assert all(b.symbols == [] for b in res.buckets)\n\n\ndef test_add_symbols():\n    res = SearchResult(\"q\", [Symbol(\"A\")])\n    res.add_symbols([Symbol(\"B\")])\n    assert len(res.symbols) == 2\n\n\ndef test_remove_duplicates():\n    symbols = [Symbol(x) for x in \"ABBBCBB\"]\n    res = SearchResult(\"q\", symbols)\n    assert [s.name for s in res.symbols] == [\"A\", \"B\", \"C\"]\n    symbols[-1].source = \"zzz\"  # type: ignore\n    res = SearchResult(\"q\", symbols)\n    assert [s.name for s in res.symbols] == [\"A\", \"B\", \"C\", \"B\"]\n\n\ndef test_sort_and_bucketize():\n    symbol_ranking_specs = [\n        # name, query, source, aliases, expected_bucket_lengths\n        (\"AAA\", \"\", \"\", [], [1, 0, 0, 0]),  # perfect match on name\n        (\"x1\", \"\", \"\", [\"aaa\"], [2, 0, 0, 0]),  # perfect match on alias\n        (\"x2\", \"...aaa...\", \"\", [], [2, 1, 0, 0]),  # word bounadary match\n        (\"xxaaaxxx\", \"\", \"\", [], [2, 1, 1, 0]),  # anywhere match\n        (\"x\", \"\", \"\", [], [2, 1, 1, 1]),  # no match\n    ]\n    res = SearchResult(\"aaa\", [])\n    for spec in symbol_ranking_specs:\n        symbol_spec = spec[:-1]\n        expected_bucket_lengths = spec[-1]\n        res.add_symbols([Symbol(*symbol_spec)])\n        assert [len(b.symbols) for b in res.buckets] == expected_bucket_lengths\n\n\ndef test_filtering():\n    def names_as_set(sr: SearchResult) -> set:  # pylint: disable=invalid-name\n        return set(s.name for s in sr.symbols)\n\n    symbol_specs = [\n        # name, query, source, aliases\n        (\"A\", \"\", \"yahoo\", []),\n        (\"B\", \"\", \"coingecko\", []),\n        (\"C\", \"\", \"yahoo\", []),\n        (\"D\", \"\", \"coingecko\", []),\n    ]\n    res = SearchResult(\"q\", [Symbol(*spec) for spec in symbol_specs])\n    assert names_as_set(res) == set(\"ABCD\")\n    assert names_as_set(res.filter(source=\"yahoo\")) == set(\"AC\")\n    assert names_as_set(res.filter(source=\"nosource\")) == set()  # type: ignore\n\n\ndef test_filter_history_gets_updated():\n    res = SearchResult(\"q\", [])\n    assert res.filter_history == []\n    assert res.filter(source=\"coingecko\").filter_history == [\"source=coingecko\"]\n","path":null,"size_bytes":2733,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tests/price/test_yahoo_api.py":{"content":"\"\"\"Test the Yahoo API.\"\"\"\n\n# pylint: disable=missing-docstring\n\nimport pytest\nfrom tessa.price import yahoo\n\n\n@pytest.mark.parametrize(\n    \"query, expected_currency\",\n    [\n        (\"TSLA\", \"USD\"),\n        (\"SPICHA.SW\", \"CHF\"),\n        (\"ZAL.DE\", \"EUR\"),\n    ],\n)\n@pytest.mark.net\ndef test_api_returns_reasonable_data(query: str, expected_currency: str):\n    # FIXME Why does this test take so long?\n    old_start_from = yahoo.START_FROM\n    yahoo.START_FROM = \"2022-01-01\"\n    df, crncy = yahoo.get_price_history(query)\n    assert df.shape[0] > 0\n    assert crncy == expected_currency\n    yahoo.START_FROM = old_start_from\n\n\n@pytest.mark.net\ndef test_non_existing_query_raises():\n    with pytest.raises(Exception):\n        yahoo.get_price_history(\"thisshouldntexistreally\")\n","path":null,"size_bytes":776,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/symbol/extended_symbol.py":{"content":"\"\"\"An example of how to extend the Symbol class with more information and functionality.\n\"\"\"\n\nfrom typing import Optional, List, Union\nfrom dataclasses import dataclass, field\nfrom . import Symbol\nfrom .geo import CountryName, j2r\n\n\n# Customizations to jurisdiction2region (remove or adapt according to your needs):\nj2r.jurisdiction2region.update(\n    {\n        \"CH\": \"CH\",\n        \"CN\": \"CN\",\n        \"EU\": \"EU\",\n        \"irrelevant\": \"OT\",\n        \"several\": \"OT\",\n        \"unknown\": \"OT\",\n    }\n)\nj2r.region2name.update(\n    {\n        \"CH\": \"Switzerland\",\n        \"CN\": \"China\",\n        \"AS\": \"Asia sans China\",\n    }\n)\n\n\n@dataclass\nclass ExtendedSymbol(Symbol):\n    \"\"\"ExtendedSymbol class. Adds more information and functionality to the Symbol\n    class.\n    \"\"\"\n\n    description: Optional[str] = None\n    \"\"\"Informational only.\"\"\"\n    # FIXME A design alternative could be to move the `description` attribute to\n    # `Symbol` itself, rename it to `info` so it can be used for arbitrary additional\n    # informaton around a symbol such as a description or similar.\n\n    country: Optional[CountryName] = \"united states\"\n    \"\"\"Country of HQ / listing.\"\"\"\n\n    watch: bool = False\n    \"\"\"Whether the ticker can produce alerts.\"\"\"\n\n    delisted: bool = False\n    \"\"\"Used to filter certain symbols from analysis.\"\"\"\n\n    jurisdiction: str = \"US\"\n    \"\"\"main jurisdiction of the underlying asset(s) (not of the title representing the\n    asset); default US, other examples: CN, EU, several, irrelevant, unknown\n    \"\"\"\n\n    isin: Optional[str] = None\n    \"\"\"Informational only.\"\"\"\n\n    strategy: Union[str, List[str]] = field(default_factory=list)\n    \"\"\"One strategy or a list of several strategies. Some strategies I use:\n      - F&F: Fire & Forget (implies HoldForGrowth)\n      - HoldForGrowth\n      - HoldForStability: low growth expected, but also low risk\n      - HoldForDiversification: titles I find important for diversification\n      - EnterIf: consider starting a position if prices for this title fall\n      - SellIf: consider selling if prices high and/or liquidity needed\n      - Sold: earlier holding that was sold at some point\n      - Quarterly: quarterly invest\n    \"\"\"\n\n    strategy_comments: Optional[str] = None\n    \"\"\"Additional comments re strategy.\"\"\"\n\n    region: str = field(init=False)\n    \"\"\"Will be set automatically.\"\"\"\n\n    def __post_init__(self) -> None:\n        super().__post_init__()\n        self.region = j2r.map_jurisdiction_to_region(self.jurisdiction)\n\n    def get_strategy_string(self) -> str:\n        \"\"\"Return a nice string with the strategy including comments.\"\"\"\n        if isinstance(self.strategy, list):\n            res = \", \".join(self.strategy)\n        else:\n            res = self.strategy\n        if getattr(self, \"strategy_comments\", False):\n            res += f\"  {self.strategy_comments}\"\n        return res\n\n    def price_graph(self, monthsback: int = 6) -> tuple:\n        \"\"\"Add some extra information to the price graph.\"\"\"\n        (from_date, fig, ax) = super().price_graph(monthsback)\n        print(f\"{self.name}\")\n        latestprice = self.price_latest().price\n        print(f\"Latest price: {latestprice:.2f}\")\n        hist = self.price_history()[0]\n        maxprice = hist[hist.index > from_date].max().close\n        print(f\"Drop since max: {(latestprice - maxprice) / maxprice:2.0%}\")\n        return from_date, fig, ax\n","path":null,"size_bytes":3386,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/price/coingecko.py":{"content":"\"\"\"Everything coingecko-related (other than search).\"\"\"\n\nimport pandas as pd\nfrom pycoingecko import CoinGeckoAPI\nfrom .types import (\n    PriceHistory,\n    SymbolNotFoundError,\n    CurrencyPreferenceNotFoundError,\n    RateLimitHitError,\n)\n\n\ndef dataframify_price_list(prices: list) -> pd.DataFrame:\n    \"\"\"Turn price list returned by Coingecko API into a pricing dataframe in the form\n    that we use.\n    \"\"\"\n    df = pd.DataFrame(prices)\n    df.columns = [\"date\", \"close\"]\n    df[\"date\"] = pd.to_datetime(df[\"date\"] / 1000, unit=\"s\", utc=True)\n    df = df.set_index(\"date\")\n    return df\n\n\ndef get_price_history(query: str, currency_preference: str = \"USD\") -> PriceHistory:\n    \"\"\"Get price history for a given cryptocurrency.\"\"\"\n    try:\n        res = CoinGeckoAPI().get_coin_market_chart_by_id(\n            id=query,\n            vs_currency=currency_preference,\n            days=\"365\",  # Public API is limited to 365 days back\n            interval=\"daily\",\n        )[\"prices\"]\n    except ValueError as exc:\n        if \"invalid vs_currency\" in str(exc):\n            raise CurrencyPreferenceNotFoundError(\n                source=\"coingecko\", cur_pref=currency_preference\n            ) from exc\n        if \"429\" in str(exc):\n            # (pycoingecko masks the underlying HTTPError.)\n            raise RateLimitHitError(source=\"coingecko\") from exc\n        if \"exceeds the allowed time range\" in str(exc):\n            raise ValueError(\n                \"Coingecko's public API is limited to historical data 365 days back.\"\n            ) from exc\n        raise SymbolNotFoundError(source=\"coingecko\", query=query) from exc\n\n    return PriceHistory(dataframify_price_list(res), currency_preference)\n","path":null,"size_bytes":1701,"size_tokens":null},"server/strategies/smc/zoneRefinement.ts":{"content":"import {\n  Candle,\n  SupplyDemandZone,\n  Timeframe,\n} from '../core/types';\nimport {\n  detectSupplyDemandZones,\n  getUnmitigatedZones,\n  getZonesByType,\n} from '../shared/zoneDetection';\nimport { SMC_ZONE_CONFIG } from './config';\n\nexport interface RefinementResult {\n  originalZone: SupplyDemandZone;\n  refinedZone: SupplyDemandZone | null;\n  refinementLevel: '15M' | '5M' | '1M';\n  isClean: boolean;\n  reasoning: string[];\n}\n\nconst PIP_THRESHOLDS = {\n  '15M': { maxPips: 30, targetPips: 15 },\n  '5M': { maxPips: 13, targetPips: 8 },\n  '1M': { maxPips: 6, targetPips: 3 },\n};\n\nexport function refineZoneToLowerTimeframe(\n  parentZone: SupplyDemandZone,\n  m5Candles: Candle[],\n  m1Candles: Candle[]\n): RefinementResult {\n  const reasoning: string[] = [];\n\n  reasoning.push(`Attempting to refine ${parentZone.type} zone from ${parentZone.timeframe}`);\n  reasoning.push(`Original zone: ${parentZone.topPrice.toFixed(5)} - ${parentZone.bottomPrice.toFixed(5)} (${parentZone.pipSize.toFixed(4)} pips)`);\n\n  const m5Result = attemptRefinement(parentZone, m5Candles, '5M');\n\n  if (!m5Result.success || !m5Result.refinedZone) {\n    reasoning.push('M5 refinement failed: ' + m5Result.reason);\n    return {\n      originalZone: parentZone,\n      refinedZone: null,\n      refinementLevel: '15M',\n      isClean: false,\n      reasoning,\n    };\n  }\n\n  reasoning.push(`M5 refinement: ${m5Result.refinedZone.topPrice.toFixed(5)} - ${m5Result.refinedZone.bottomPrice.toFixed(5)} (${m5Result.refinedZone.pipSize.toFixed(4)} pips)`);\n\n  const m1Result = attemptRefinement(m5Result.refinedZone, m1Candles, '1M');\n\n  if (m1Result.success && m1Result.refinedZone && m1Result.isClean) {\n    reasoning.push(`M1 refinement: ${m1Result.refinedZone.topPrice.toFixed(5)} - ${m1Result.refinedZone.bottomPrice.toFixed(5)} (${m1Result.refinedZone.pipSize.toFixed(4)} pips)`);\n    reasoning.push('Using M1 refined zone (clean single zone)');\n\n    return {\n      originalZone: parentZone,\n      refinedZone: {\n        ...m1Result.refinedZone,\n        refinedFrom: parentZone.id,\n      },\n      refinementLevel: '1M',\n      isClean: true,\n      reasoning,\n    };\n  }\n\n  if (!m1Result.isClean) {\n    reasoning.push('M1 refinement resulted in multiple zones, staying with M5');\n  } else {\n    reasoning.push('M1 refinement failed: ' + m1Result.reason);\n  }\n\n  return {\n    originalZone: parentZone,\n    refinedZone: {\n      ...m5Result.refinedZone,\n      refinedFrom: parentZone.id,\n    },\n    refinementLevel: '5M',\n    isClean: m5Result.isClean,\n    reasoning,\n  };\n}\n\ninterface AttemptResult {\n  success: boolean;\n  refinedZone: SupplyDemandZone | null;\n  isClean: boolean;\n  reason: string;\n}\n\nfunction attemptRefinement(\n  parentZone: SupplyDemandZone,\n  lowerTfCandles: Candle[],\n  targetTimeframe: Timeframe\n): AttemptResult {\n  const candlesInRange = lowerTfCandles.filter(\n    c => c.high >= parentZone.bottomPrice && c.low <= parentZone.topPrice\n  );\n\n  if (candlesInRange.length < 3) {\n    return {\n      success: false,\n      refinedZone: null,\n      isClean: false,\n      reason: 'Not enough candles in zone range',\n    };\n  }\n\n  const zonesFound = detectSupplyDemandZones(candlesInRange, targetTimeframe, {\n    lookback: candlesInRange.length,\n  });\n\n  const matchingZones = zonesFound.filter(z => z.type === parentZone.type);\n\n  if (matchingZones.length === 0) {\n    return {\n      success: false,\n      refinedZone: null,\n      isClean: false,\n      reason: 'No matching zones found in lower timeframe',\n    };\n  }\n\n  const pipThreshold = PIP_THRESHOLDS[targetTimeframe as keyof typeof PIP_THRESHOLDS] || { maxPips: 30, targetPips: 15 };\n  const pipValue = parentZone.pipSize > 0 ? parentZone.pipSize / 10 : 0.0001;\n\n  if (matchingZones.length === 1) {\n    const refined = matchingZones[0];\n    const zonePips = (refined.topPrice - refined.bottomPrice) / pipValue;\n\n    if (isZoneWithinBounds(refined, parentZone) && zonePips <= pipThreshold.maxPips) {\n      return {\n        success: true,\n        refinedZone: refined,\n        isClean: zonePips <= pipThreshold.targetPips,\n        reason: `Single zone found (${zonePips.toFixed(1)} pips)`,\n      };\n    }\n  }\n\n  if (matchingZones.length > 1) {\n    const unmitigated = getUnmitigatedZones(matchingZones);\n\n    if (unmitigated.length === 1) {\n      const refined = unmitigated[0];\n      const zonePips = (refined.topPrice - refined.bottomPrice) / pipValue;\n      \n      if (isZoneWithinBounds(refined, parentZone) && zonePips <= pipThreshold.maxPips) {\n        return {\n          success: true,\n          refinedZone: refined,\n          isClean: zonePips <= pipThreshold.targetPips,\n          reason: `One unmitigated zone (${zonePips.toFixed(1)} pips)`,\n        };\n      }\n    }\n\n    if (matchingZones.length >= 2) {\n      return {\n        success: false,\n        refinedZone: null,\n        isClean: false,\n        reason: `${matchingZones.length} zones - too messy, stay with parent`,\n      };\n    }\n\n    const bestZone = selectBestZone(matchingZones);\n    if (bestZone && isZoneWithinBounds(bestZone, parentZone)) {\n      const zonePips = (bestZone.topPrice - bestZone.bottomPrice) / pipValue;\n      return {\n        success: true,\n        refinedZone: bestZone,\n        isClean: false,\n        reason: `Selected strongest zone (${zonePips.toFixed(1)} pips)`,\n      };\n    }\n\n    return {\n      success: false,\n      refinedZone: null,\n      isClean: false,\n      reason: 'Multiple zones - too messy for refinement',\n    };\n  }\n\n  return {\n    success: false,\n    refinedZone: null,\n    isClean: false,\n    reason: 'Refinement criteria not met',\n  };\n}\n\nfunction isZoneWithinBounds(zone: SupplyDemandZone, parentZone: SupplyDemandZone): boolean {\n  return zone.topPrice <= parentZone.topPrice && zone.bottomPrice >= parentZone.bottomPrice;\n}\n\nfunction selectBestZone(zones: SupplyDemandZone[]): SupplyDemandZone | null {\n  if (zones.length === 0) return null;\n\n  const strengthOrder = { strong: 3, moderate: 2, weak: 1 };\n\n  return zones.reduce((best, zone) => {\n    if (strengthOrder[zone.strength] > strengthOrder[best.strength]) {\n      return zone;\n    }\n    if (zone.status === 'unmitigated' && best.status === 'mitigated') {\n      return zone;\n    }\n    return best;\n  });\n}\n\nexport function calculateOptimalEntry(\n  zone: SupplyDemandZone,\n  direction: 'buy' | 'sell'\n): number {\n  if (direction === 'buy') {\n    return zone.bottomPrice + (zone.topPrice - zone.bottomPrice) * 0.7;\n  } else {\n    return zone.topPrice - (zone.topPrice - zone.bottomPrice) * 0.7;\n  }\n}\n\nexport function calculateStopLoss(\n  zone: SupplyDemandZone,\n  direction: 'buy' | 'sell',\n  bufferPips: number = 5\n): number {\n  const pipValue = zone.pipSize > 0 ? zone.pipSize / 10 : 0.0001;\n  const buffer = bufferPips * pipValue;\n\n  if (direction === 'buy') {\n    return zone.bottomPrice - buffer;\n  } else {\n    return zone.topPrice + buffer;\n  }\n}\n","path":null,"size_bytes":6861,"size_tokens":null},"server/lib/priceService.ts":{"content":"import { spawn } from 'child_process';\nimport path from 'path';\n\ninterface PriceRequest {\n  action: 'get_price' | 'get_multiple_prices' | 'ping';\n  symbol?: string;\n  assetClass?: 'stock' | 'forex' | 'commodity' | 'crypto';\n  symbols?: Array<{ symbol: string; assetClass: string }>;\n}\n\ninterface PriceResult {\n  symbol: string;\n  assetClass?: string;\n  price?: number;\n  change?: number;\n  changePercent?: number;\n  high?: number;\n  low?: number;\n  open?: number;\n  previousClose?: number;\n  volume?: number;\n  marketCap?: number;\n  timestamp?: string;\n  source?: string;\n  error?: string;\n}\n\nconst PYTHON_SCRIPT_PATH = path.join(process.cwd(), 'server', 'python', 'price_service.py');\n\nasync function callPythonService(request: PriceRequest): Promise<any> {\n  return new Promise((resolve, reject) => {\n    const pythonProcess = spawn('python3', [PYTHON_SCRIPT_PATH], {\n      stdio: ['pipe', 'pipe', 'pipe']\n    });\n    \n    let stdout = '';\n    let stderr = '';\n    \n    pythonProcess.stdout.on('data', (data) => {\n      stdout += data.toString();\n    });\n    \n    pythonProcess.stderr.on('data', (data) => {\n      stderr += data.toString();\n    });\n    \n    pythonProcess.on('close', (code) => {\n      if (code !== 0) {\n        console.error('Python price service error:', stderr);\n        reject(new Error(`Python process exited with code ${code}: ${stderr}`));\n        return;\n      }\n      \n      try {\n        const result = JSON.parse(stdout);\n        resolve(result);\n      } catch (e) {\n        reject(new Error(`Failed to parse Python output: ${stdout}`));\n      }\n    });\n    \n    pythonProcess.on('error', (err) => {\n      reject(new Error(`Failed to start Python process: ${err.message}`));\n    });\n    \n    // Send request to Python process\n    pythonProcess.stdin.write(JSON.stringify(request));\n    pythonProcess.stdin.end();\n  });\n}\n\nexport async function getPrice(symbol: string, assetClass: 'stock' | 'forex' | 'commodity' | 'crypto' = 'stock'): Promise<PriceResult> {\n  try {\n    const result = await callPythonService({\n      action: 'get_price',\n      symbol,\n      assetClass\n    });\n    return result;\n  } catch (error) {\n    console.error(`Error fetching price for ${symbol}:`, error);\n    return {\n      symbol,\n      assetClass,\n      error: error instanceof Error ? error.message : 'Unknown error'\n    };\n  }\n}\n\nexport async function getMultiplePrices(symbols: Array<{ symbol: string; assetClass: string }>): Promise<PriceResult[]> {\n  try {\n    const result = await callPythonService({\n      action: 'get_multiple_prices',\n      symbols\n    });\n    return result;\n  } catch (error) {\n    console.error('Error fetching multiple prices:', error);\n    return symbols.map(s => ({\n      symbol: s.symbol,\n      assetClass: s.assetClass,\n      error: error instanceof Error ? error.message : 'Unknown error'\n    }));\n  }\n}\n\nexport async function pingPriceService(): Promise<boolean> {\n  try {\n    const result = await callPythonService({ action: 'ping' });\n    return result.status === 'ok';\n  } catch (error) {\n    console.error('Price service ping failed:', error);\n    return false;\n  }\n}\n\n// Cache for price data to reduce API calls\nconst priceCache = new Map<string, { data: PriceResult; timestamp: number }>();\nconst CACHE_TTL = 30000; // 30 seconds\n\nexport async function getCachedPrice(symbol: string, assetClass: 'stock' | 'forex' | 'commodity' | 'crypto' = 'stock'): Promise<PriceResult> {\n  const cacheKey = `${symbol}-${assetClass}`;\n  const cached = priceCache.get(cacheKey);\n  \n  if (cached && Date.now() - cached.timestamp < CACHE_TTL) {\n    return cached.data;\n  }\n  \n  const result = await getPrice(symbol, assetClass);\n  \n  if (!result.error) {\n    priceCache.set(cacheKey, {\n      data: result,\n      timestamp: Date.now()\n    });\n  }\n  \n  return result;\n}\n\nexport async function getCachedMultiplePrices(symbols: Array<{ symbol: string; assetClass: string }>): Promise<PriceResult[]> {\n  const now = Date.now();\n  const results: PriceResult[] = [];\n  const symbolsToFetch: Array<{ symbol: string; assetClass: string; index: number }> = [];\n  \n  // Check cache for each symbol\n  symbols.forEach((s, index) => {\n    const cacheKey = `${s.symbol}-${s.assetClass}`;\n    const cached = priceCache.get(cacheKey);\n    \n    if (cached && now - cached.timestamp < CACHE_TTL) {\n      results[index] = cached.data;\n    } else {\n      symbolsToFetch.push({ ...s, index });\n    }\n  });\n  \n  // Fetch uncached symbols\n  if (symbolsToFetch.length > 0) {\n    const fetchedResults = await getMultiplePrices(\n      symbolsToFetch.map(s => ({ symbol: s.symbol, assetClass: s.assetClass }))\n    );\n    \n    fetchedResults.forEach((result, i) => {\n      const originalIndex = symbolsToFetch[i].index;\n      results[originalIndex] = result;\n      \n      if (!result.error) {\n        const cacheKey = `${result.symbol}-${symbolsToFetch[i].assetClass}`;\n        priceCache.set(cacheKey, {\n          data: result,\n          timestamp: now\n        });\n      }\n    });\n  }\n  \n  return results;\n}\n","path":null,"size_bytes":5011,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tests/price/test_price_history.py":{"content":"\"\"\"Test `price_history` function.\n\nNote that tests will hit the network and therefore will take a while to run.\n\"\"\"\n\n# pylint: disable=missing-docstring\n\nimport pandas as pd\nimport pendulum\nimport pytest\nfrom pandas.core.dtypes.dtypes import DatetimeTZDtype\nfrom tessa import price_history\nfrom tessa.price import PriceHistory\nfrom tessa import sources\n\n\n@pytest.mark.net\ndef test_price_history_on_yahoo_including_caching_and_ratelimiting():\n    # Make sure rate limiter and cache are in a pristine setup:\n    sources.reset_rate_limiters()\n    rate_limiter = sources.get_source(\"yahoo\").rate_limiter\n    assert rate_limiter.last_call == pendulum.parse(\"1900\")\n    price_history.cache_clear()\n\n    # Retrieve asset and make sure the result is correct:\n    res = price_history(\"AAPL\", \"yahoo\")\n    assert isinstance(res, PriceHistory)\n    df, crncy = res\n    assert crncy == \"USD\"\n    assert df.index[0] == pd.Timestamp(\"2000-01-03 05:00:00+0000\", tz=\"UTC\")\n    assert df.shape[0] > 5000\n    assert df.shape[1] == 1\n    assert isinstance(df.index.dtype, DatetimeTZDtype)\n    assert df.dtypes.to_string() == \"close    float64\"\n    # pylint: disable=no-value-for-parameter\n    assert price_history.cache_info().misses == 1\n    assert price_history.cache_info().hits == 0\n\n    # Make sure the rate limiter was updated:\n    assert (pendulum.now() - rate_limiter.last_call).total_seconds() < 30\n    assert rate_limiter.count_all_calls == 1\n    assert rate_limiter.count_limited_calls == 0\n\n    # Retrieve again and check that the cache is used:\n    df2, crncy2 = price_history(\"AAPL\", \"yahoo\")\n    assert crncy2 == crncy\n    assert df2.equals(df)\n    assert price_history.cache_info().misses == 1\n    assert price_history.cache_info().hits == 1\n    assert rate_limiter.count_all_calls == 1\n    assert rate_limiter.count_limited_calls == 0\n\n\n@pytest.mark.net\ndef test_price_history_coingecko():\n    df, crncy = price_history(\"ethereum\", \"coingecko\", currency_preference=\"CHF\")\n    assert crncy == \"CHF\"\n    assert df.shape[0] == 366\n    assert df.shape[1] == 1\n    assert isinstance(df.index.dtype, DatetimeTZDtype)\n    assert df.dtypes.to_string() == \"close    float64\"\n\n\ndef test_error_unsupported_asset_source():\n    with pytest.raises(ValueError) as excinfo:\n        price_history(query=\"AAPL\", source=\"xxx\")\n    assert \"Unknown source\" in str(excinfo.value)\n","path":null,"size_bytes":2355,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/search/yahoo.py":{"content":"\"\"\"Yahoo Finance search\"\"\"\n\nimport warnings\nfrom ..search import SearchResult\n\n\ndef yahoo_search(query: str) -> SearchResult:\n    warnings.warn(\n        \"Yahoo Finance search is not implemented due to their search result page changing to being JavaScript-based. Returning empty search result for Yahoo Finance.\",\n        UserWarning,\n    )\n    return SearchResult(query, [])\n","path":null,"size_bytes":375,"size_tokens":null},"server/strategies/core/baseStrategy.ts":{"content":"import {\n  StrategyConfig,\n  StrategyResult,\n  StrategySignal,\n  InstrumentData,\n  EntrySetup,\n  MultiTimeframeData,\n} from './types';\n\nexport abstract class BaseStrategy {\n  protected config: StrategyConfig;\n  protected lastScanTime: number = 0;\n\n  constructor(config: StrategyConfig) {\n    this.config = config;\n  }\n\n  get id(): string {\n    return this.config.id;\n  }\n\n  get name(): string {\n    return this.config.name;\n  }\n\n  get isEnabled(): boolean {\n    return this.config.enabled;\n  }\n\n  get minConfidence(): number {\n    return this.config.minConfidence;\n  }\n\n  abstract analyze(instrument: InstrumentData): Promise<StrategyResult>;\n\n  abstract validateSetup(setup: EntrySetup, data: MultiTimeframeData): boolean;\n\n  enable(): void {\n    this.config.enabled = true;\n  }\n\n  disable(): void {\n    this.config.enabled = false;\n  }\n\n  updateConfig(updates: Partial<StrategyConfig>): void {\n    this.config = { ...this.config, ...updates };\n  }\n\n  shouldScan(): boolean {\n    const now = Date.now();\n    if (now - this.lastScanTime >= this.config.scanIntervalMs) {\n      this.lastScanTime = now;\n      return true;\n    }\n    return false;\n  }\n\n  protected createSignalId(): string {\n    return `${this.config.id}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  protected calculateExpiryTime(): number {\n    return Date.now() + this.config.expiryMinutes * 60 * 1000;\n  }\n\n  protected logAnalysis(message: string): void {\n    console.log(`[${this.config.name}] ${message}`);\n  }\n\n  protected logError(message: string, error?: Error): void {\n    console.error(`[${this.config.name}] ERROR: ${message}`, error?.message || '');\n  }\n}\n","path":null,"size_bytes":1652,"size_tokens":null},"server/strategies/smc/clarityAnalysis.ts":{"content":"import {\n  Candle,\n  SupplyDemandZone,\n  SwingPoint,\n  Timeframe,\n  TrendDirection,\n  MarketControl,\n} from '../core/types';\nimport { detectSwingPoints, detectTrendFromSwings } from '../shared/swingPoints';\nimport { detectSupplyDemandZones, getUnmitigatedZones } from '../shared/zoneDetection';\nimport { SMC_CLARITY_CONFIG, CONTEXT_TIMEFRAME, MAJOR_ZONE_TIMEFRAMES, ZONE_IDENTIFICATION_TIMEFRAMES, ENTRY_REFINEMENT_TIMEFRAMES } from './config';\n\nexport interface ClarityResult {\n  score: number;\n  isClear: boolean;\n  trendConsistency: number;\n  zoneClarity: number;\n  structureClarity: number;\n  reasons: string[];\n}\n\nexport interface TimeframeSelection {\n  dailyContextTf: Timeframe;\n  majorZoneTf: Timeframe;\n  zoneIdentificationTf: Timeframe;\n  entryRefinementTf: Timeframe;\n  usedAlternative: boolean;\n  dailyContextClarity: ClarityResult;\n  majorZoneClarity: ClarityResult;\n  zoneIdentificationClarity: ClarityResult;\n  entryRefinementClarity: ClarityResult;\n  reasoning: string[];\n}\n\nexport function analyzeClarity(\n  candles: Candle[],\n  timeframe: Timeframe\n): ClarityResult {\n  const reasons: string[] = [];\n\n  if (!candles || candles.length < 20) {\n    return {\n      score: 0,\n      isClear: false,\n      trendConsistency: 0,\n      zoneClarity: 0,\n      structureClarity: 0,\n      reasons: ['Insufficient candle data'],\n    };\n  }\n\n  const swingPoints = detectSwingPoints(candles, { lookback: 3 });\n  const trend = detectTrendFromSwings(swingPoints);\n\n  const trendConsistency = calculateTrendConsistency(swingPoints, trend);\n  reasons.push(`Trend consistency: ${(trendConsistency * 100).toFixed(0)}%`);\n\n  const zones = detectSupplyDemandZones(candles, timeframe, { lookback: candles.length });\n  const unmitigatedZones = getUnmitigatedZones(zones);\n\n  const zoneClarity = calculateZoneClarity(unmitigatedZones);\n  reasons.push(`Zone clarity: ${(zoneClarity * 100).toFixed(0)}% (${unmitigatedZones.length} unmitigated zones)`);\n\n  const structureClarity = calculateStructureClarity(swingPoints);\n  reasons.push(`Structure clarity: ${(structureClarity * 100).toFixed(0)}%`);\n\n  const score = Math.round(\n    (trendConsistency * 35) + \n    (zoneClarity * 35) + \n    (structureClarity * 30)\n  );\n\n  const isClear = score >= SMC_CLARITY_CONFIG.minClarityScore &&\n                  swingPoints.length >= SMC_CLARITY_CONFIG.minSwingPointsRequired &&\n                  unmitigatedZones.length >= SMC_CLARITY_CONFIG.minZonesRequired;\n\n  return {\n    score,\n    isClear,\n    trendConsistency,\n    zoneClarity,\n    structureClarity,\n    reasons,\n  };\n}\n\nfunction calculateTrendConsistency(swingPoints: SwingPoint[], trend: TrendDirection): number {\n  if (swingPoints.length < 4) return 0;\n\n  const recentSwings = swingPoints.slice(-8);\n\n  if (trend === 'bullish') {\n    const bullishSwings = recentSwings.filter(s => s.type === 'HH' || s.type === 'HL').length;\n    return bullishSwings / recentSwings.length;\n  }\n\n  if (trend === 'bearish') {\n    const bearishSwings = recentSwings.filter(s => s.type === 'LL' || s.type === 'LH').length;\n    return bearishSwings / recentSwings.length;\n  }\n\n  const hhhl = recentSwings.filter(s => s.type === 'HH' || s.type === 'HL').length;\n  const lllh = recentSwings.filter(s => s.type === 'LL' || s.type === 'LH').length;\n  const balance = Math.abs(hhhl - lllh) / recentSwings.length;\n\n  return 1 - balance;\n}\n\nfunction calculateZoneClarity(zones: SupplyDemandZone[]): number {\n  if (zones.length === 0) return 0;\n\n  if (zones.length > SMC_CLARITY_CONFIG.maxZonesForClarity) {\n    return 0.3;\n  }\n\n  const strongZones = zones.filter(z => z.strength === 'strong').length;\n  const moderateZones = zones.filter(z => z.strength === 'moderate').length;\n\n  const qualityScore = (strongZones * 1.0 + moderateZones * 0.6) / zones.length;\n\n  const supplyZones = zones.filter(z => z.type === 'supply').length;\n  const demandZones = zones.filter(z => z.type === 'demand').length;\n  const balanceScore = supplyZones > 0 && demandZones > 0 ? 1 : 0.5;\n\n  return Math.min(1, (qualityScore * 0.7 + balanceScore * 0.3));\n}\n\nfunction calculateStructureClarity(swingPoints: SwingPoint[]): number {\n  if (swingPoints.length < SMC_CLARITY_CONFIG.minSwingPointsRequired) {\n    return 0;\n  }\n\n  const recentSwings = swingPoints.slice(-10);\n\n  let alternatingCount = 0;\n  for (let i = 1; i < recentSwings.length; i++) {\n    const prev = recentSwings[i - 1];\n    const curr = recentSwings[i];\n\n    const prevIsHigh = prev.type === 'HH' || prev.type === 'LH';\n    const currIsHigh = curr.type === 'HH' || curr.type === 'LH';\n\n    if (prevIsHigh !== currIsHigh) {\n      alternatingCount++;\n    }\n  }\n\n  return alternatingCount / (recentSwings.length - 1);\n}\n\nexport function selectBestTimeframes(\n  h4Candles: Candle[],\n  h2Candles: Candle[],\n  m30Candles: Candle[],\n  m15Candles: Candle[],\n  m5Candles: Candle[],\n  m3Candles: Candle[],\n  m1Candles: Candle[],\n  d1Candles?: Candle[],\n  h1Candles?: Candle[]\n): TimeframeSelection {\n  const reasoning: string[] = [];\n  \n  const d1Clarity = d1Candles && d1Candles.length >= 20 \n    ? analyzeClarity(d1Candles, '1D')\n    : { score: 0, isClear: false, trendConsistency: 0, zoneClarity: 0, structureClarity: 0, reasons: ['No 1D data'] };\n  \n  const h4Clarity = analyzeClarity(h4Candles, '4H');\n  const h2Clarity = analyzeClarity(h2Candles, '2H');\n  const h1Clarity = h1Candles && h1Candles.length >= 20\n    ? analyzeClarity(h1Candles, '1H')\n    : { score: 0, isClear: false, trendConsistency: 0, zoneClarity: 0, structureClarity: 0, reasons: ['No 1H data'] };\n  \n  const m30Clarity = analyzeClarity(m30Candles, '30M');\n  const m15Clarity = analyzeClarity(m15Candles, '15M');\n  \n  const m5Clarity = analyzeClarity(m5Candles, '5M');\n  const m3Clarity = analyzeClarity(m3Candles, '3M');\n  const m1Clarity = analyzeClarity(m1Candles, '1M');\n\n  const dailyContextTf: Timeframe = '1D';\n  const dailyContextClarity = d1Clarity;\n  \n  if (d1Clarity.isClear) {\n    reasoning.push(`1D Context: trend confirmed (clarity: ${d1Clarity.score}%)`);\n  } else {\n    reasoning.push(`1D Context: limited clarity (${d1Clarity.score}%), proceeding with caution`);\n  }\n\n  const majorZoneOptions: { tf: Timeframe; clarity: ClarityResult }[] = [\n    { tf: '4H' as Timeframe, clarity: h4Clarity },\n    { tf: '2H' as Timeframe, clarity: h2Clarity },\n    { tf: '1H' as Timeframe, clarity: h1Clarity },\n  ].filter(o => o.clarity.score > 0);\n  \n  majorZoneOptions.sort((a, b) => b.clarity.score - a.clarity.score);\n  \n  let majorZoneTf: Timeframe = '4H';\n  let majorZoneClarity = h4Clarity;\n  let usedAlternative = false;\n\n  if (majorZoneOptions.length > 0) {\n    const bestMajorZone = majorZoneOptions[0];\n    if (bestMajorZone.clarity.isClear && bestMajorZone.clarity.score >= 60) {\n      majorZoneTf = bestMajorZone.tf;\n      majorZoneClarity = bestMajorZone.clarity;\n      if (bestMajorZone.tf !== '4H') usedAlternative = true;\n      reasoning.push(`Major Zones: ${bestMajorZone.tf} (best clarity: ${bestMajorZone.clarity.score}%)`);\n    } else if (h4Clarity.score >= 50) {\n      reasoning.push(`Major Zones: 4H (clarity: ${h4Clarity.score}%)`);\n    } else {\n      const fallback = majorZoneOptions.find(o => o.clarity.score >= 50) || majorZoneOptions[0];\n      majorZoneTf = fallback.tf;\n      majorZoneClarity = fallback.clarity;\n      if (fallback.tf !== '4H') usedAlternative = true;\n      reasoning.push(`Major Zones: ${fallback.tf} (best available: ${fallback.clarity.score}%)`);\n    }\n  }\n\n  const zoneIdOptions: { tf: Timeframe; clarity: ClarityResult }[] = [\n    { tf: '30M' as Timeframe, clarity: m30Clarity },\n    { tf: '15M' as Timeframe, clarity: m15Clarity },\n  ];\n  zoneIdOptions.sort((a, b) => b.clarity.score - a.clarity.score);\n\n  let zoneIdentificationTf: Timeframe = '15M';\n  let zoneIdentificationClarity = m15Clarity;\n\n  const bestZoneId = zoneIdOptions[0];\n  if (bestZoneId.clarity.isClear && bestZoneId.clarity.score >= 60) {\n    zoneIdentificationTf = bestZoneId.tf;\n    zoneIdentificationClarity = bestZoneId.clarity;\n    if (bestZoneId.tf !== '15M') usedAlternative = true;\n    reasoning.push(`Zone ID: ${bestZoneId.tf} (best clarity: ${bestZoneId.clarity.score}%)`);\n  } else if (m15Clarity.score >= 50) {\n    reasoning.push(`Zone ID: 15M (clarity: ${m15Clarity.score}%)`);\n  } else {\n    const fallback = zoneIdOptions.find(o => o.clarity.score >= 50) || zoneIdOptions[0];\n    zoneIdentificationTf = fallback.tf;\n    zoneIdentificationClarity = fallback.clarity;\n    if (fallback.tf !== '15M') usedAlternative = true;\n    reasoning.push(`Zone ID: ${fallback.tf} (best available: ${fallback.clarity.score}%)`);\n  }\n\n  const entryOptions: { tf: Timeframe; clarity: ClarityResult }[] = [\n    { tf: '5M' as Timeframe, clarity: m5Clarity },\n    { tf: '3M' as Timeframe, clarity: m3Clarity },\n    { tf: '1M' as Timeframe, clarity: m1Clarity },\n  ];\n  entryOptions.sort((a, b) => b.clarity.score - a.clarity.score);\n\n  let entryRefinementTf: Timeframe = '5M';\n  let entryRefinementClarity = m5Clarity;\n\n  const bestEntry = entryOptions[0];\n  if (bestEntry.clarity.isClear && bestEntry.clarity.score >= 60) {\n    entryRefinementTf = bestEntry.tf;\n    entryRefinementClarity = bestEntry.clarity;\n    reasoning.push(`Entry/Refinement: ${bestEntry.tf} (best clarity: ${bestEntry.clarity.score}%)`);\n  } else if (m5Clarity.score >= 50) {\n    reasoning.push(`Entry/Refinement: 5M (clarity: ${m5Clarity.score}%)`);\n  } else {\n    const fallback = entryOptions.find(o => o.clarity.score >= 40) || entryOptions[0];\n    entryRefinementTf = fallback.tf;\n    entryRefinementClarity = fallback.clarity;\n    reasoning.push(`Entry/Refinement: ${fallback.tf} (best available: ${fallback.clarity.score}%)`);\n  }\n\n  return {\n    dailyContextTf,\n    majorZoneTf,\n    zoneIdentificationTf,\n    entryRefinementTf,\n    usedAlternative,\n    dailyContextClarity,\n    majorZoneClarity,\n    zoneIdentificationClarity,\n    entryRefinementClarity,\n    reasoning,\n  };\n}\n\nexport function isMarketClear(selection: TimeframeSelection): boolean {\n  const minContextClarity = 40;\n  const minMajorZoneClarity = 50;\n  const minZoneIdClarity = 50;\n  const minEntryClarity = 40;\n\n  const contextOk = selection.dailyContextClarity.score >= minContextClarity;\n  const majorZoneOk = selection.majorZoneClarity.score >= minMajorZoneClarity;\n  const zoneIdOk = selection.zoneIdentificationClarity.score >= minZoneIdClarity;\n  const entryOk = selection.entryRefinementClarity.score >= minEntryClarity;\n\n  return contextOk && majorZoneOk && zoneIdOk && entryOk;\n}\n\nexport function getMarketClarityStatus(selection: TimeframeSelection): string {\n  if (!isMarketClear(selection)) {\n    const issues: string[] = [];\n    if (selection.dailyContextClarity.score < 40) issues.push('unclear 1D context');\n    if (selection.majorZoneClarity.score < 50) issues.push('unclear major zones');\n    if (selection.zoneIdentificationClarity.score < 50) issues.push('unclear zone ID');\n    if (selection.entryRefinementClarity.score < 40) issues.push('unclear entry TF');\n    return `Market unclear: ${issues.join(', ')}`;\n  }\n\n  return `Market clear: 1D/${selection.majorZoneTf}/${selection.zoneIdentificationTf}/${selection.entryRefinementTf}`;\n}\n\nexport function isWatchlistCandidate(selection: TimeframeSelection): boolean {\n  return selection.dailyContextClarity.score >= 40 && \n         selection.majorZoneClarity.score >= 50 && \n         selection.zoneIdentificationClarity.score >= 50;\n}\n\nexport function isEntryConfirmed(selection: TimeframeSelection): boolean {\n  return isWatchlistCandidate(selection) && selection.entryRefinementClarity.score >= 50;\n}\n","path":null,"size_bytes":11556,"size_tokens":null},"server/strategies/smc/m15Zones.ts":{"content":"import {\n  Candle,\n  SupplyDemandZone,\n  MarketControl,\n} from '../core/types';\nimport {\n  detectSupplyDemandZones,\n  getUnmitigatedZones,\n  getZonesByType,\n  updateZoneMitigation,\n} from '../shared/zoneDetection';\nimport { SMC_ZONE_CONFIG } from './config';\n\nexport interface M15ZoneResult {\n  allZones: SupplyDemandZone[];\n  unmitigatedSupply: SupplyDemandZone[];\n  unmitigatedDemand: SupplyDemandZone[];\n  tradableZones: SupplyDemandZone[];\n  reasoning: string[];\n}\n\nexport function analyzeM15Zones(\n  m15Candles: Candle[],\n  h4Control: MarketControl,\n  currentPrice: number\n): M15ZoneResult {\n  const reasoning: string[] = [];\n\n  let allZones = detectSupplyDemandZones(\n    m15Candles,\n    '15M',\n    { lookback: SMC_ZONE_CONFIG.m15LookbackCandles }\n  );\n\n  if (m15Candles.length > 0) {\n    const latestCandle = m15Candles[m15Candles.length - 1];\n    allZones = updateZoneMitigation(allZones, latestCandle);\n  }\n\n  const supplyZones = getZonesByType(allZones, 'supply');\n  const demandZones = getZonesByType(allZones, 'demand');\n  const unmitigatedSupply = getUnmitigatedZones(supplyZones);\n  const unmitigatedDemand = getUnmitigatedZones(demandZones);\n\n  reasoning.push(`M15: Found ${supplyZones.length} supply zones (${unmitigatedSupply.length} unmitigated)`);\n  reasoning.push(`M15: Found ${demandZones.length} demand zones (${unmitigatedDemand.length} unmitigated)`);\n\n  const tradableZones = getTradableZones(\n    unmitigatedSupply,\n    unmitigatedDemand,\n    h4Control,\n    currentPrice\n  );\n\n  reasoning.push(`M15: ${tradableZones.length} tradable zones based on H4 ${h4Control} control`);\n\n  return {\n    allZones,\n    unmitigatedSupply,\n    unmitigatedDemand,\n    tradableZones,\n    reasoning,\n  };\n}\n\nfunction getTradableZones(\n  unmitigatedSupply: SupplyDemandZone[],\n  unmitigatedDemand: SupplyDemandZone[],\n  h4Control: MarketControl,\n  currentPrice: number\n): SupplyDemandZone[] {\n  const tradable: SupplyDemandZone[] = [];\n\n  if (h4Control === 'demand') {\n    for (const zone of unmitigatedDemand) {\n      if (currentPrice > zone.topPrice && zone.status === 'unmitigated') {\n        tradable.push(zone);\n      }\n    }\n  } else if (h4Control === 'supply') {\n    for (const zone of unmitigatedSupply) {\n      if (currentPrice < zone.bottomPrice && zone.status === 'unmitigated') {\n        tradable.push(zone);\n      }\n    }\n  } else {\n    for (const zone of unmitigatedDemand) {\n      if (currentPrice > zone.topPrice && zone.status === 'unmitigated') {\n        tradable.push(zone);\n      }\n    }\n    for (const zone of unmitigatedSupply) {\n      if (currentPrice < zone.bottomPrice && zone.status === 'unmitigated') {\n        tradable.push(zone);\n      }\n    }\n  }\n\n  return tradable.sort((a, b) => {\n    const aDist = Math.abs(((a.topPrice + a.bottomPrice) / 2) - currentPrice);\n    const bDist = Math.abs(((b.topPrice + b.bottomPrice) / 2) - currentPrice);\n    return aDist - bDist;\n  });\n}\n\nexport function isPriceApproachingZone(\n  currentPrice: number,\n  zone: SupplyDemandZone,\n  proximityPips: number = 10\n): boolean {\n  const pipValue = zone.pipSize > 0 ? zone.pipSize : 0.0001;\n  const proximityRange = proximityPips * pipValue;\n\n  if (zone.type === 'demand') {\n    return currentPrice <= zone.topPrice + proximityRange && currentPrice >= zone.bottomPrice;\n  } else {\n    return currentPrice >= zone.bottomPrice - proximityRange && currentPrice <= zone.topPrice;\n  }\n}\n\nexport function findNearestUnmitigatedZone(\n  zones: SupplyDemandZone[],\n  currentPrice: number,\n  direction: 'above' | 'below'\n): SupplyDemandZone | null {\n  const unmitigated = zones.filter(z => z.status === 'unmitigated');\n\n  const filtered = unmitigated.filter(z => {\n    const zoneCenter = (z.topPrice + z.bottomPrice) / 2;\n    return direction === 'above' ? zoneCenter > currentPrice : zoneCenter < currentPrice;\n  });\n\n  if (filtered.length === 0) return null;\n\n  return filtered.reduce((nearest, zone) => {\n    const zoneCenter = (zone.topPrice + zone.bottomPrice) / 2;\n    const nearestCenter = (nearest.topPrice + nearest.bottomPrice) / 2;\n    const zoneDist = Math.abs(zoneCenter - currentPrice);\n    const nearestDist = Math.abs(nearestCenter - currentPrice);\n    return zoneDist < nearestDist ? zone : nearest;\n  });\n}\n","path":null,"size_bytes":4229,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tests/symbols/test_extended_symbol.py":{"content":"\"\"\"ExtendedSymbol-related tests.\"\"\"\n\nfrom tessa.symbol import ExtendedSymbol\n\n# pylint: disable=missing-function-docstring\n\n\ndef test_initializer():\n    s = ExtendedSymbol(\"MSFT\", delisted=True)\n    assert s.name == \"MSFT\"\n    assert not s.watch\n    assert s.delisted\n    assert s.jurisdiction == \"US\"\n    assert s.isin is None\n    assert s.strategy == []\n\n\ndef test_standard_jurisdictions():\n    assert ExtendedSymbol(\"X\", jurisdiction=\"US\").region == \"North America\"\n    assert ExtendedSymbol(\"X\", jurisdiction=\"DE\").region == \"Europe\"\n\n\ndef test_jurisdiction_updates():\n    assert ExtendedSymbol(\"X\", jurisdiction=\"CH\").region == \"Switzerland\"\n    assert ExtendedSymbol(\"X\", jurisdiction=\"CN\").region == \"China\"\n    assert ExtendedSymbol(\"X\", jurisdiction=\"several\").region == \"Other\"\n","path":null,"size_bytes":788,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/docs/search.js":{"content":"window.pdocSearch = (function(){\n/** elasticlunr - http://weixsong.github.io * Copyright (C) 2017 Oliver Nightingale * Copyright (C) 2017 Wei Song * MIT Licensed */!function(){function e(e){if(null===e||\"object\"!=typeof e)return e;var t=e.constructor();for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var t=function(e){var n=new t.Index;return n.pipeline.add(t.trimmer,t.stopWordFilter,t.stemmer),e&&e.call(n,n),n};t.version=\"0.9.5\",lunr=t,t.utils={},t.utils.warn=function(e){return function(t){e.console&&console.warn&&console.warn(t)}}(this),t.utils.toString=function(e){return void 0===e||null===e?\"\":e.toString()},t.EventEmitter=function(){this.events={}},t.EventEmitter.prototype.addListener=function(){var e=Array.prototype.slice.call(arguments),t=e.pop(),n=e;if(\"function\"!=typeof t)throw new TypeError(\"last argument must be a function\");n.forEach(function(e){this.hasHandler(e)||(this.events[e]=[]),this.events[e].push(t)},this)},t.EventEmitter.prototype.removeListener=function(e,t){if(this.hasHandler(e)){var n=this.events[e].indexOf(t);-1!==n&&(this.events[e].splice(n,1),0==this.events[e].length&&delete this.events[e])}},t.EventEmitter.prototype.emit=function(e){if(this.hasHandler(e)){var t=Array.prototype.slice.call(arguments,1);this.events[e].forEach(function(e){e.apply(void 0,t)},this)}},t.EventEmitter.prototype.hasHandler=function(e){return e in this.events},t.tokenizer=function(e){if(!arguments.length||null===e||void 0===e)return[];if(Array.isArray(e)){var n=e.filter(function(e){return null===e||void 0===e?!1:!0});n=n.map(function(e){return t.utils.toString(e).toLowerCase()});var i=[];return n.forEach(function(e){var n=e.split(t.tokenizer.seperator);i=i.concat(n)},this),i}return e.toString().trim().toLowerCase().split(t.tokenizer.seperator)},t.tokenizer.defaultSeperator=/[\\s\\-]+/,t.tokenizer.seperator=t.tokenizer.defaultSeperator,t.tokenizer.setSeperator=function(e){null!==e&&void 0!==e&&\"object\"==typeof e&&(t.tokenizer.seperator=e)},t.tokenizer.resetSeperator=function(){t.tokenizer.seperator=t.tokenizer.defaultSeperator},t.tokenizer.getSeperator=function(){return t.tokenizer.seperator},t.Pipeline=function(){this._queue=[]},t.Pipeline.registeredFunctions={},t.Pipeline.registerFunction=function(e,n){n in t.Pipeline.registeredFunctions&&t.utils.warn(\"Overwriting existing registered function: \"+n),e.label=n,t.Pipeline.registeredFunctions[n]=e},t.Pipeline.getRegisteredFunction=function(e){return e in t.Pipeline.registeredFunctions!=!0?null:t.Pipeline.registeredFunctions[e]},t.Pipeline.warnIfFunctionNotRegistered=function(e){var n=e.label&&e.label in this.registeredFunctions;n||t.utils.warn(\"Function is not registered with pipeline. This may cause problems when serialising the index.\\n\",e)},t.Pipeline.load=function(e){var n=new t.Pipeline;return e.forEach(function(e){var i=t.Pipeline.getRegisteredFunction(e);if(!i)throw new Error(\"Cannot load un-registered function: \"+e);n.add(i)}),n},t.Pipeline.prototype.add=function(){var e=Array.prototype.slice.call(arguments);e.forEach(function(e){t.Pipeline.warnIfFunctionNotRegistered(e),this._queue.push(e)},this)},t.Pipeline.prototype.after=function(e,n){t.Pipeline.warnIfFunctionNotRegistered(n);var i=this._queue.indexOf(e);if(-1===i)throw new Error(\"Cannot find existingFn\");this._queue.splice(i+1,0,n)},t.Pipeline.prototype.before=function(e,n){t.Pipeline.warnIfFunctionNotRegistered(n);var i=this._queue.indexOf(e);if(-1===i)throw new Error(\"Cannot find existingFn\");this._queue.splice(i,0,n)},t.Pipeline.prototype.remove=function(e){var t=this._queue.indexOf(e);-1!==t&&this._queue.splice(t,1)},t.Pipeline.prototype.run=function(e){for(var t=[],n=e.length,i=this._queue.length,o=0;n>o;o++){for(var r=e[o],s=0;i>s&&(r=this._queue[s](r,o,e),void 0!==r&&null!==r);s++);void 0!==r&&null!==r&&t.push(r)}return t},t.Pipeline.prototype.reset=function(){this._queue=[]},t.Pipeline.prototype.get=function(){return this._queue},t.Pipeline.prototype.toJSON=function(){return this._queue.map(function(e){return t.Pipeline.warnIfFunctionNotRegistered(e),e.label})},t.Index=function(){this._fields=[],this._ref=\"id\",this.pipeline=new t.Pipeline,this.documentStore=new t.DocumentStore,this.index={},this.eventEmitter=new t.EventEmitter,this._idfCache={},this.on(\"add\",\"remove\",\"update\",function(){this._idfCache={}}.bind(this))},t.Index.prototype.on=function(){var e=Array.prototype.slice.call(arguments);return this.eventEmitter.addListener.apply(this.eventEmitter,e)},t.Index.prototype.off=function(e,t){return this.eventEmitter.removeListener(e,t)},t.Index.load=function(e){e.version!==t.version&&t.utils.warn(\"version mismatch: current \"+t.version+\" importing \"+e.version);var n=new this;n._fields=e.fields,n._ref=e.ref,n.documentStore=t.DocumentStore.load(e.documentStore),n.pipeline=t.Pipeline.load(e.pipeline),n.index={};for(var i in e.index)n.index[i]=t.InvertedIndex.load(e.index[i]);return n},t.Index.prototype.addField=function(e){return this._fields.push(e),this.index[e]=new t.InvertedIndex,this},t.Index.prototype.setRef=function(e){return this._ref=e,this},t.Index.prototype.saveDocument=function(e){return this.documentStore=new t.DocumentStore(e),this},t.Index.prototype.addDoc=function(e,n){if(e){var n=void 0===n?!0:n,i=e[this._ref];this.documentStore.addDoc(i,e),this._fields.forEach(function(n){var o=this.pipeline.run(t.tokenizer(e[n]));this.documentStore.addFieldLength(i,n,o.length);var r={};o.forEach(function(e){e in r?r[e]+=1:r[e]=1},this);for(var s in r){var u=r[s];u=Math.sqrt(u),this.index[n].addToken(s,{ref:i,tf:u})}},this),n&&this.eventEmitter.emit(\"add\",e,this)}},t.Index.prototype.removeDocByRef=function(e){if(e&&this.documentStore.isDocStored()!==!1&&this.documentStore.hasDoc(e)){var t=this.documentStore.getDoc(e);this.removeDoc(t,!1)}},t.Index.prototype.removeDoc=function(e,n){if(e){var n=void 0===n?!0:n,i=e[this._ref];this.documentStore.hasDoc(i)&&(this.documentStore.removeDoc(i),this._fields.forEach(function(n){var o=this.pipeline.run(t.tokenizer(e[n]));o.forEach(function(e){this.index[n].removeToken(e,i)},this)},this),n&&this.eventEmitter.emit(\"remove\",e,this))}},t.Index.prototype.updateDoc=function(e,t){var t=void 0===t?!0:t;this.removeDocByRef(e[this._ref],!1),this.addDoc(e,!1),t&&this.eventEmitter.emit(\"update\",e,this)},t.Index.prototype.idf=function(e,t){var n=\"@\"+t+\"/\"+e;if(Object.prototype.hasOwnProperty.call(this._idfCache,n))return this._idfCache[n];var i=this.index[t].getDocFreq(e),o=1+Math.log(this.documentStore.length/(i+1));return this._idfCache[n]=o,o},t.Index.prototype.getFields=function(){return this._fields.slice()},t.Index.prototype.search=function(e,n){if(!e)return[];e=\"string\"==typeof e?{any:e}:JSON.parse(JSON.stringify(e));var i=null;null!=n&&(i=JSON.stringify(n));for(var o=new t.Configuration(i,this.getFields()).get(),r={},s=Object.keys(e),u=0;u<s.length;u++){var a=s[u];r[a]=this.pipeline.run(t.tokenizer(e[a]))}var l={};for(var c in o){var d=r[c]||r.any;if(d){var f=this.fieldSearch(d,c,o),h=o[c].boost;for(var p in f)f[p]=f[p]*h;for(var p in f)p in l?l[p]+=f[p]:l[p]=f[p]}}var v,g=[];for(var p in l)v={ref:p,score:l[p]},this.documentStore.hasDoc(p)&&(v.doc=this.documentStore.getDoc(p)),g.push(v);return g.sort(function(e,t){return t.score-e.score}),g},t.Index.prototype.fieldSearch=function(e,t,n){var i=n[t].bool,o=n[t].expand,r=n[t].boost,s=null,u={};return 0!==r?(e.forEach(function(e){var n=[e];1==o&&(n=this.index[t].expandToken(e));var r={};n.forEach(function(n){var o=this.index[t].getDocs(n),a=this.idf(n,t);if(s&&\"AND\"==i){var l={};for(var c in s)c in o&&(l[c]=o[c]);o=l}n==e&&this.fieldSearchStats(u,n,o);for(var c in o){var d=this.index[t].getTermFrequency(n,c),f=this.documentStore.getFieldLength(c,t),h=1;0!=f&&(h=1/Math.sqrt(f));var p=1;n!=e&&(p=.15*(1-(n.length-e.length)/n.length));var v=d*a*h*p;c in r?r[c]+=v:r[c]=v}},this),s=this.mergeScores(s,r,i)},this),s=this.coordNorm(s,u,e.length)):void 0},t.Index.prototype.mergeScores=function(e,t,n){if(!e)return t;if(\"AND\"==n){var i={};for(var o in t)o in e&&(i[o]=e[o]+t[o]);return i}for(var o in t)o in e?e[o]+=t[o]:e[o]=t[o];return e},t.Index.prototype.fieldSearchStats=function(e,t,n){for(var i in n)i in e?e[i].push(t):e[i]=[t]},t.Index.prototype.coordNorm=function(e,t,n){for(var i in e)if(i in t){var o=t[i].length;e[i]=e[i]*o/n}return e},t.Index.prototype.toJSON=function(){var e={};return this._fields.forEach(function(t){e[t]=this.index[t].toJSON()},this),{version:t.version,fields:this._fields,ref:this._ref,documentStore:this.documentStore.toJSON(),index:e,pipeline:this.pipeline.toJSON()}},t.Index.prototype.use=function(e){var t=Array.prototype.slice.call(arguments,1);t.unshift(this),e.apply(this,t)},t.DocumentStore=function(e){this._save=null===e||void 0===e?!0:e,this.docs={},this.docInfo={},this.length=0},t.DocumentStore.load=function(e){var t=new this;return t.length=e.length,t.docs=e.docs,t.docInfo=e.docInfo,t._save=e.save,t},t.DocumentStore.prototype.isDocStored=function(){return this._save},t.DocumentStore.prototype.addDoc=function(t,n){this.hasDoc(t)||this.length++,this.docs[t]=this._save===!0?e(n):null},t.DocumentStore.prototype.getDoc=function(e){return this.hasDoc(e)===!1?null:this.docs[e]},t.DocumentStore.prototype.hasDoc=function(e){return e in this.docs},t.DocumentStore.prototype.removeDoc=function(e){this.hasDoc(e)&&(delete this.docs[e],delete this.docInfo[e],this.length--)},t.DocumentStore.prototype.addFieldLength=function(e,t,n){null!==e&&void 0!==e&&0!=this.hasDoc(e)&&(this.docInfo[e]||(this.docInfo[e]={}),this.docInfo[e][t]=n)},t.DocumentStore.prototype.updateFieldLength=function(e,t,n){null!==e&&void 0!==e&&0!=this.hasDoc(e)&&this.addFieldLength(e,t,n)},t.DocumentStore.prototype.getFieldLength=function(e,t){return null===e||void 0===e?0:e in this.docs&&t in this.docInfo[e]?this.docInfo[e][t]:0},t.DocumentStore.prototype.toJSON=function(){return{docs:this.docs,docInfo:this.docInfo,length:this.length,save:this._save}},t.stemmer=function(){var e={ational:\"ate\",tional:\"tion\",enci:\"ence\",anci:\"ance\",izer:\"ize\",bli:\"ble\",alli:\"al\",entli:\"ent\",eli:\"e\",ousli:\"ous\",ization:\"ize\",ation:\"ate\",ator:\"ate\",alism:\"al\",iveness:\"ive\",fulness:\"ful\",ousness:\"ous\",aliti:\"al\",iviti:\"ive\",biliti:\"ble\",logi:\"log\"},t={icate:\"ic\",ative:\"\",alize:\"al\",iciti:\"ic\",ical:\"ic\",ful:\"\",ness:\"\"},n=\"[^aeiou]\",i=\"[aeiouy]\",o=n+\"[^aeiouy]*\",r=i+\"[aeiou]*\",s=\"^(\"+o+\")?\"+r+o,u=\"^(\"+o+\")?\"+r+o+\"(\"+r+\")?$\",a=\"^(\"+o+\")?\"+r+o+r+o,l=\"^(\"+o+\")?\"+i,c=new RegExp(s),d=new RegExp(a),f=new RegExp(u),h=new RegExp(l),p=/^(.+?)(ss|i)es$/,v=/^(.+?)([^s])s$/,g=/^(.+?)eed$/,m=/^(.+?)(ed|ing)$/,y=/.$/,S=/(at|bl|iz)$/,x=new RegExp(\"([^aeiouylsz])\\\\1$\"),w=new RegExp(\"^\"+o+i+\"[^aeiouwxy]$\"),I=/^(.+?[^aeiou])y$/,b=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,E=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,D=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,F=/^(.+?)(s|t)(ion)$/,_=/^(.+?)e$/,P=/ll$/,k=new RegExp(\"^\"+o+i+\"[^aeiouwxy]$\"),z=function(n){var i,o,r,s,u,a,l;if(n.length<3)return n;if(r=n.substr(0,1),\"y\"==r&&(n=r.toUpperCase()+n.substr(1)),s=p,u=v,s.test(n)?n=n.replace(s,\"$1$2\"):u.test(n)&&(n=n.replace(u,\"$1$2\")),s=g,u=m,s.test(n)){var z=s.exec(n);s=c,s.test(z[1])&&(s=y,n=n.replace(s,\"\"))}else if(u.test(n)){var z=u.exec(n);i=z[1],u=h,u.test(i)&&(n=i,u=S,a=x,l=w,u.test(n)?n+=\"e\":a.test(n)?(s=y,n=n.replace(s,\"\")):l.test(n)&&(n+=\"e\"))}if(s=I,s.test(n)){var z=s.exec(n);i=z[1],n=i+\"i\"}if(s=b,s.test(n)){var z=s.exec(n);i=z[1],o=z[2],s=c,s.test(i)&&(n=i+e[o])}if(s=E,s.test(n)){var z=s.exec(n);i=z[1],o=z[2],s=c,s.test(i)&&(n=i+t[o])}if(s=D,u=F,s.test(n)){var z=s.exec(n);i=z[1],s=d,s.test(i)&&(n=i)}else if(u.test(n)){var z=u.exec(n);i=z[1]+z[2],u=d,u.test(i)&&(n=i)}if(s=_,s.test(n)){var z=s.exec(n);i=z[1],s=d,u=f,a=k,(s.test(i)||u.test(i)&&!a.test(i))&&(n=i)}return s=P,u=d,s.test(n)&&u.test(n)&&(s=y,n=n.replace(s,\"\")),\"y\"==r&&(n=r.toLowerCase()+n.substr(1)),n};return z}(),t.Pipeline.registerFunction(t.stemmer,\"stemmer\"),t.stopWordFilter=function(e){return e&&t.stopWordFilter.stopWords[e]!==!0?e:void 0},t.clearStopWords=function(){t.stopWordFilter.stopWords={}},t.addStopWords=function(e){null!=e&&Array.isArray(e)!==!1&&e.forEach(function(e){t.stopWordFilter.stopWords[e]=!0},this)},t.resetStopWords=function(){t.stopWordFilter.stopWords=t.defaultStopWords},t.defaultStopWords={\"\":!0,a:!0,able:!0,about:!0,across:!0,after:!0,all:!0,almost:!0,also:!0,am:!0,among:!0,an:!0,and:!0,any:!0,are:!0,as:!0,at:!0,be:!0,because:!0,been:!0,but:!0,by:!0,can:!0,cannot:!0,could:!0,dear:!0,did:!0,\"do\":!0,does:!0,either:!0,\"else\":!0,ever:!0,every:!0,\"for\":!0,from:!0,get:!0,got:!0,had:!0,has:!0,have:!0,he:!0,her:!0,hers:!0,him:!0,his:!0,how:!0,however:!0,i:!0,\"if\":!0,\"in\":!0,into:!0,is:!0,it:!0,its:!0,just:!0,least:!0,let:!0,like:!0,likely:!0,may:!0,me:!0,might:!0,most:!0,must:!0,my:!0,neither:!0,no:!0,nor:!0,not:!0,of:!0,off:!0,often:!0,on:!0,only:!0,or:!0,other:!0,our:!0,own:!0,rather:!0,said:!0,say:!0,says:!0,she:!0,should:!0,since:!0,so:!0,some:!0,than:!0,that:!0,the:!0,their:!0,them:!0,then:!0,there:!0,these:!0,they:!0,\"this\":!0,tis:!0,to:!0,too:!0,twas:!0,us:!0,wants:!0,was:!0,we:!0,were:!0,what:!0,when:!0,where:!0,which:!0,\"while\":!0,who:!0,whom:!0,why:!0,will:!0,\"with\":!0,would:!0,yet:!0,you:!0,your:!0},t.stopWordFilter.stopWords=t.defaultStopWords,t.Pipeline.registerFunction(t.stopWordFilter,\"stopWordFilter\"),t.trimmer=function(e){if(null===e||void 0===e)throw new Error(\"token should not be undefined\");return e.replace(/^\\W+/,\"\").replace(/\\W+$/,\"\")},t.Pipeline.registerFunction(t.trimmer,\"trimmer\"),t.InvertedIndex=function(){this.root={docs:{},df:0}},t.InvertedIndex.load=function(e){var t=new this;return t.root=e.root,t},t.InvertedIndex.prototype.addToken=function(e,t,n){for(var n=n||this.root,i=0;i<=e.length-1;){var o=e[i];o in n||(n[o]={docs:{},df:0}),i+=1,n=n[o]}var r=t.ref;n.docs[r]?n.docs[r]={tf:t.tf}:(n.docs[r]={tf:t.tf},n.df+=1)},t.InvertedIndex.prototype.hasToken=function(e){if(!e)return!1;for(var t=this.root,n=0;n<e.length;n++){if(!t[e[n]])return!1;t=t[e[n]]}return!0},t.InvertedIndex.prototype.getNode=function(e){if(!e)return null;for(var t=this.root,n=0;n<e.length;n++){if(!t[e[n]])return null;t=t[e[n]]}return t},t.InvertedIndex.prototype.getDocs=function(e){var t=this.getNode(e);return null==t?{}:t.docs},t.InvertedIndex.prototype.getTermFrequency=function(e,t){var n=this.getNode(e);return null==n?0:t in n.docs?n.docs[t].tf:0},t.InvertedIndex.prototype.getDocFreq=function(e){var t=this.getNode(e);return null==t?0:t.df},t.InvertedIndex.prototype.removeToken=function(e,t){if(e){var n=this.getNode(e);null!=n&&t in n.docs&&(delete n.docs[t],n.df-=1)}},t.InvertedIndex.prototype.expandToken=function(e,t,n){if(null==e||\"\"==e)return[];var t=t||[];if(void 0==n&&(n=this.getNode(e),null==n))return t;n.df>0&&t.push(e);for(var i in n)\"docs\"!==i&&\"df\"!==i&&this.expandToken(e+i,t,n[i]);return t},t.InvertedIndex.prototype.toJSON=function(){return{root:this.root}},t.Configuration=function(e,n){var e=e||\"\";if(void 0==n||null==n)throw new Error(\"fields should not be null\");this.config={};var i;try{i=JSON.parse(e),this.buildUserConfig(i,n)}catch(o){t.utils.warn(\"user configuration parse failed, will use default configuration\"),this.buildDefaultConfig(n)}},t.Configuration.prototype.buildDefaultConfig=function(e){this.reset(),e.forEach(function(e){this.config[e]={boost:1,bool:\"OR\",expand:!1}},this)},t.Configuration.prototype.buildUserConfig=function(e,n){var i=\"OR\",o=!1;if(this.reset(),\"bool\"in e&&(i=e.bool||i),\"expand\"in e&&(o=e.expand||o),\"fields\"in e)for(var r in e.fields)if(n.indexOf(r)>-1){var s=e.fields[r],u=o;void 0!=s.expand&&(u=s.expand),this.config[r]={boost:s.boost||0===s.boost?s.boost:1,bool:s.bool||i,expand:u}}else t.utils.warn(\"field name in user configuration not found in index instance fields\");else this.addAllFields2UserConfig(i,o,n)},t.Configuration.prototype.addAllFields2UserConfig=function(e,t,n){n.forEach(function(n){this.config[n]={boost:1,bool:e,expand:t}},this)},t.Configuration.prototype.get=function(){return this.config},t.Configuration.prototype.reset=function(){this.config={}},lunr.SortedSet=function(){this.length=0,this.elements=[]},lunr.SortedSet.load=function(e){var t=new this;return t.elements=e,t.length=e.length,t},lunr.SortedSet.prototype.add=function(){var e,t;for(e=0;e<arguments.length;e++)t=arguments[e],~this.indexOf(t)||this.elements.splice(this.locationFor(t),0,t);this.length=this.elements.length},lunr.SortedSet.prototype.toArray=function(){return this.elements.slice()},lunr.SortedSet.prototype.map=function(e,t){return this.elements.map(e,t)},lunr.SortedSet.prototype.forEach=function(e,t){return this.elements.forEach(e,t)},lunr.SortedSet.prototype.indexOf=function(e){for(var t=0,n=this.elements.length,i=n-t,o=t+Math.floor(i/2),r=this.elements[o];i>1;){if(r===e)return o;e>r&&(t=o),r>e&&(n=o),i=n-t,o=t+Math.floor(i/2),r=this.elements[o]}return r===e?o:-1},lunr.SortedSet.prototype.locationFor=function(e){for(var t=0,n=this.elements.length,i=n-t,o=t+Math.floor(i/2),r=this.elements[o];i>1;)e>r&&(t=o),r>e&&(n=o),i=n-t,o=t+Math.floor(i/2),r=this.elements[o];return r>e?o:e>r?o+1:void 0},lunr.SortedSet.prototype.intersect=function(e){for(var t=new lunr.SortedSet,n=0,i=0,o=this.length,r=e.length,s=this.elements,u=e.elements;;){if(n>o-1||i>r-1)break;s[n]!==u[i]?s[n]<u[i]?n++:s[n]>u[i]&&i++:(t.add(s[n]),n++,i++)}return t},lunr.SortedSet.prototype.clone=function(){var e=new lunr.SortedSet;return e.elements=this.toArray(),e.length=e.elements.length,e},lunr.SortedSet.prototype.union=function(e){var t,n,i;this.length>=e.length?(t=this,n=e):(t=e,n=this),i=t.clone();for(var o=0,r=n.toArray();o<r.length;o++)i.add(r[o]);return i},lunr.SortedSet.prototype.toJSON=function(){return this.toArray()},function(e,t){\"function\"==typeof define&&define.amd?define(t):\"object\"==typeof exports?module.exports=t():e.elasticlunr=t()}(this,function(){return t})}();\n    /** pdoc search index */const docs = [{\"fullname\": \"tessa\", \"modulename\": \"tessa\", \"kind\": \"module\", \"doc\": \"<h1 id=\\\"tessa-simple-hassle-free-access-to-price-information-of-financial-assets\\\">tessa \\u2013 simple, hassle-free access to price information of financial assets</h1>\\n\\n<p>tessa is a Python library to help you <strong>easily retrieve price information</strong> for assets\\nfrom different sources such as Yahoo or Coingecko. It takes care of the different APIs,\\ncaching, rate limiting, and other hassles.</p>\\n\\n<p>tessa provides a <strong>Symbol class that encapsulates the methods relevant for a symbol</strong>.\\ntessa also provides functionality to <strong>manage collections of symbols</strong>, store and load\\nthem, and extend their functionality.</p>\\n\\n<p>Finally, tessa makes sure to be nice to the sites being accessed and tries to <strong>prevent\\nusers from being blocked by 429 rate limiting errors</strong> by 1) caching results upon\\nretrieval and 2) keeping track of request timestamps and waiting appropriate amounts of\\ntime if necessary. tessa also automatically waits and retries requests that fail with a\\n5xx error.</p>\\n\\n<p><a href=\\\"https://ymyke.github.io/tessa/tessa.html\\\">\\u2192 Check out the full documentation. \\ud83d\\udcd6</a></p>\\n\\n<h2 id=\\\"how-to-use\\\">How to use</h2>\\n\\n<p>Here's a longer example that shows all aspects of the library. Refer to\\nsubmodules <a href=\\\"tessa/symbol.html\\\">symbol</a>, <a href=\\\"tessa/search.html\\\">search</a>, and\\n<a href=\\\"tessa/price.html\\\">price</a> for more information.</p>\\n\\n<h6 id=\\\"imports\\\">Imports:</h6>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"kn\\\">from</span><span class=\\\"w\\\"> </span><span class=\\\"nn\\\">tessa</span><span class=\\\"w\\\"> </span><span class=\\\"kn\\\">import</span> <span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">SymbolCollection</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">search</span>\\n<span class=\\\"kn\\\">import</span><span class=\\\"w\\\"> </span><span class=\\\"nn\\\">pendulum</span>\\n</code></pre>\\n</div>\\n\\n<h6 id=\\\"create-a-symbol-for-msft-and-access-some-functions\\\">Create a symbol for MSFT and access some functions:</h6>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"n\\\">s1</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;MSFT&quot;</span><span class=\\\"p\\\">)</span>             <span class=\\\"c1\\\"># will use &quot;yahoo&quot; as the default source</span>\\n<span class=\\\"n\\\">s1</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_latest</span><span class=\\\"p\\\">()</span>               <span class=\\\"c1\\\"># get latest price</span>\\n</code></pre>\\n</div>\\n\\n<h6 id=\\\"create-another-symbol-from-a-bloomberg-ticker-as-it-is-used-by-yahoo-finance\\\">Create another symbol from a bloomberg ticker as it is used by Yahoo Finance:</h6>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"n\\\">s2</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;SREN.SW&quot;</span><span class=\\\"p\\\">)</span>\\n<span class=\\\"n\\\">s2</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_point</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;2022-06-30&quot;</span><span class=\\\"p\\\">)</span>    <span class=\\\"c1\\\"># get price at specific point in time</span>\\n</code></pre>\\n</div>\\n\\n<h6 id=\\\"create-a-symbol-from-the-coingecko-source-with-an-id-as-it-is-used-by-coingecko\\\">Create a symbol from the coingecko source with an id as it is used by coingecko:</h6>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"n\\\">s3</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;bitcoin&quot;</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">source</span><span class=\\\"o\\\">=</span><span class=\\\"s2\\\">&quot;coingecko&quot;</span><span class=\\\"p\\\">)</span>\\n<span class=\\\"n\\\">s3</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_graph</span><span class=\\\"p\\\">()</span>                <span class=\\\"c1\\\"># show price graph</span>\\n</code></pre>\\n</div>\\n\\n<h6 id=\\\"search-for-a-crypto-ticker-on-coingecko\\\">Search for a crypto ticker on coingecko:</h6>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"n\\\">res</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">search</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;name&quot;</span><span class=\\\"p\\\">)</span>  <span class=\\\"c1\\\"># search and print search result summary</span>\\n<span class=\\\"n\\\">filtered</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">res</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">filter</span><span class=\\\"p\\\">(</span><span class=\\\"n\\\">source</span><span class=\\\"o\\\">=</span><span class=\\\"s2\\\">&quot;coingecko&quot;</span><span class=\\\"p\\\">)</span>  <span class=\\\"c1\\\"># filter results</span>\\n<span class=\\\"n\\\">filtered</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">p</span><span class=\\\"p\\\">()</span>  <span class=\\\"c1\\\"># print summary of filtered results</span>\\n<span class=\\\"n\\\">filtered</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">buckets</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">1</span><span class=\\\"p\\\">]</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbols</span>  <span class=\\\"c1\\\"># review the 2nd bucket in the filtered results</span>\\n<span class=\\\"n\\\">s4</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">filtered</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">buckets</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">1</span><span class=\\\"p\\\">]</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbols</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">4</span><span class=\\\"p\\\">]</span>  <span class=\\\"c1\\\"># our symbol is the 5th in that list</span>\\n<span class=\\\"n\\\">s4</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_history</span><span class=\\\"p\\\">()</span>  <span class=\\\"c1\\\"># get entire history</span>\\n<span class=\\\"n\\\">s4</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_graph</span><span class=\\\"p\\\">()</span>  <span class=\\\"c1\\\"># visualize the price history</span>\\n</code></pre>\\n</div>\\n\\n<h6 id=\\\"build-a-collection-of-several-symbols-and-use-the-collection-to-retrieve-symbols\\\">Build a collection of several symbols and use the collection to retrieve symbols:</h6>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"n\\\">sc</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">SymbolCollection</span><span class=\\\"p\\\">([</span><span class=\\\"n\\\">s1</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">s2</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">s3</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">s4</span><span class=\\\"p\\\">])</span>   <span class=\\\"c1\\\"># create a collection w/ symbols from above</span>\\n<span class=\\\"n\\\">sc</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">add</span><span class=\\\"p\\\">(</span><span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;AAPL&quot;</span><span class=\\\"p\\\">))</span>                    <span class=\\\"c1\\\"># add another one</span>\\n<span class=\\\"n\\\">sc</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">find_one</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;SREN&quot;</span><span class=\\\"p\\\">)</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_graph</span><span class=\\\"p\\\">()</span>\\n</code></pre>\\n</div>\\n\\n<h6 id=\\\"store-and-load-a-symbol-collection\\\">Store and load a symbol collection:</h6>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"n\\\">sc</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">save_yaml</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;my_symbols.yaml&quot;</span><span class=\\\"p\\\">)</span>\\n<span class=\\\"n\\\">sc_new</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">SymbolCollection</span><span class=\\\"p\\\">()</span>\\n<span class=\\\"n\\\">sc_new</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">load_yaml</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;my_symbols.yaml&quot;</span><span class=\\\"p\\\">)</span>\\n</code></pre>\\n</div>\\n\\n<h6 id=\\\"use-a-different-currency-preference\\\">Use a different currency preference:</h6>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"n\\\">sc</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">find_one</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;ens&quot;</span><span class=\\\"p\\\">)</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_latest</span><span class=\\\"p\\\">()</span>   <span class=\\\"c1\\\"># will return price in USD</span>\\n<span class=\\\"n\\\">Symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">currency_preference</span> <span class=\\\"o\\\">=</span> <span class=\\\"s2\\\">&quot;CHF&quot;</span>\\n<span class=\\\"n\\\">sc</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">find_one</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;ens&quot;</span><span class=\\\"p\\\">)</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_latest</span><span class=\\\"p\\\">()</span>   <span class=\\\"c1\\\"># will return price in CHF</span>\\n</code></pre>\\n</div>\\n\\n<p>Note that <code>currency_preference</code> will only have an effect with sources that support it.\\nIt is supported for Coingecko but not for Yahoo. So you should always verify the\\neffective currency you receive in the result.</p>\\n\\n<p>On Yahoo, some tickers are listed in several currency-specific variants that you can\\ntry:</p>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;ETH-USD&quot;</span><span class=\\\"p\\\">)</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_latest</span><span class=\\\"p\\\">()</span>  <span class=\\\"c1\\\"># will return the price in USD</span>\\n<span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;ETH-EUR&quot;</span><span class=\\\"p\\\">)</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_latest</span><span class=\\\"p\\\">()</span>  <span class=\\\"c1\\\"># will return the price in EUR</span>\\n</code></pre>\\n</div>\\n\\n<h6 id=\\\"accessing-older-crypto-price-information\\\">Accessing older crypto price information:</h6>\\n\\n<p>Coingecko only provides a limited amount of historical data:</p>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"n\\\">from_date</span> <span class=\\\"o\\\">=</span> <span class=\\\"p\\\">(</span><span class=\\\"n\\\">pendulum</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">now</span><span class=\\\"p\\\">()</span> <span class=\\\"o\\\">-</span> <span class=\\\"n\\\">pendulum</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">duration</span><span class=\\\"p\\\">(</span><span class=\\\"n\\\">months</span><span class=\\\"o\\\">=</span><span class=\\\"mi\\\">6</span><span class=\\\"p\\\">))</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">to_date_string</span><span class=\\\"p\\\">()</span>\\n<span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;bitcoin&quot;</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">source</span><span class=\\\"o\\\">=</span><span class=\\\"s2\\\">&quot;coingecko&quot;</span><span class=\\\"p\\\">)</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_point</span><span class=\\\"p\\\">(</span><span class=\\\"n\\\">from_date</span><span class=\\\"p\\\">)</span>\\n<span class=\\\"c1\\\"># Will work because coingecko has data for the last year</span>\\n<span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;bitcoin&quot;</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">source</span><span class=\\\"o\\\">=</span><span class=\\\"s2\\\">&quot;coingecko&quot;</span><span class=\\\"p\\\">)</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_point</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;2020-08-01&quot;</span><span class=\\\"p\\\">)</span>\\n<span class=\\\"c1\\\"># Will result in a value error as the data is not available</span>\\n</code></pre>\\n</div>\\n\\n<p>Yahoo also lists a number of crypto assets with longer history, so you can try that\\nsource as well:</p>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;BTC-USD&quot;</span><span class=\\\"p\\\">)</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_point</span><span class=\\\"p\\\">(</span><span class=\\\"n\\\">from_date</span><span class=\\\"p\\\">)</span>  <span class=\\\"c1\\\"># Should work, &quot;yahoo&quot; is the default source</span>\\n</code></pre>\\n</div>\\n\\n<h6 id=\\\"price_point-tries-to-be-lenient-and-you-can-adjust-the-leniency\\\"><code>price_point</code> tries to be lenient and you can adjust the leniency:</h6>\\n\\n<p>By default, <code>price_point</code> will try to find the closest price to the requested date as\\nlong as it's not more than <code>max_date_deviation_days</code> days away (default: 10 days).</p>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"n\\\">ea</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;EA&quot;</span><span class=\\\"p\\\">)</span>\\n<span class=\\\"n\\\">ea</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_point</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;2022-01-01&quot;</span><span class=\\\"p\\\">)</span>  <span class=\\\"c1\\\"># Will return the price for 2021-12-31</span>\\n<span class=\\\"n\\\">Symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">max_date_deviation_days</span> <span class=\\\"o\\\">=</span> <span class=\\\"mi\\\">0</span>\\n<span class=\\\"n\\\">ea</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_point</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;2022-01-01&quot;</span><span class=\\\"p\\\">)</span>  <span class=\\\"c1\\\"># Will raise a ValueError</span>\\n</code></pre>\\n</div>\\n\\n<h2 id=\\\"data-sources\\\">Data sources</h2>\\n\\n<p>tessa builds on <a href=\\\"https://pypi.org/project/yfinance/\\\">yfinance</a> and\\n<a href=\\\"https://github.com/man-c/pycoingecko\\\">pycoingecko</a> and offers <strong>a simplified and\\nunified interface</strong>. </p>\\n\\n<p>Why these two sources? Yahoo Finance (via yfinance) is fast and offers an extensive\\ndatabase that also contains many non-US markets and many crypto tokens. Coingecko (via\\npycoingecko) offers great access to crypto prices, but is limited to 1 year of\\nhistorical data. </p>\\n\\n<p>More sources can be added in the future. Let me know in the\\n<a href=\\\"https://github.com/ymyke/tessa/issues\\\">issues</a> of you have a particular request.</p>\\n\\n<h2 id=\\\"main-submodules\\\">Main submodules</h2>\\n\\n<ul>\\n<li><a href=\\\"tessa/symbol.html\\\">symbol</a>: working with symbols and symbol collections.</li>\\n<li><a href=\\\"tessa/search.html\\\">search</a>: searching the different sources.</li>\\n<li><a href=\\\"tessa/price.html\\\">price</a>: accessing price functions directly instead of via the\\n<code>Symbol</code> class.</li>\\n<li><a href=\\\"tessa/sources.html\\\">sources</a>: if you'd like to add additional sources to the library.</li>\\n</ul>\\n\\n<h2 id=\\\"how-to-install\\\">How to install</h2>\\n\\n<p><code>pip install tessa</code></p>\\n\\n<h2 id=\\\"prerequisites\\\">Prerequisites</h2>\\n\\n<p>See <code>pyproject.toml</code>. Major prerequisites are the <code>yfinance</code> and <code>pycoingecko</code> packages\\nto access finance information.</p>\\n\\n<h2 id=\\\"repository\\\">Repository</h2>\\n\\n<p><a href=\\\"https://github.com/ymyke/tessa\\\">https://github.com/ymyke/tessa</a></p>\\n\\n<h2 id=\\\"on-terminology\\\">On terminology</h2>\\n\\n<p>I'm using symbol instead of ticker because a ticker is mainly used for stock on stock\\nmarkets, whereas tessa is inteded to be used for any kind of financial assets, e.g. also\\ncrypto.</p>\\n\\n<h2 id=\\\"other-noteworthy-libraries\\\">Other noteworthy libraries</h2>\\n\\n<ul>\\n<li><a href=\\\"https://github.com/ymyke/strela\\\">strela</a>: A python package for financial alerts.</li>\\n<li><a href=\\\"https://github.com/ymyke/pypme\\\">pypme</a>: A Python package for PME (Public Market\\nEquivalent) calculation.</li>\\n</ul>\\n\\n<h2 id=\\\"on-investpy-as-a-data-source\\\">On investpy as a data source</h2>\\n\\n<p>Tessa used to use the <a href=\\\"https://github.com/alvarobartt/investpy\\\">investpy package</a> as the\\nmain source of information until mid 2022 until investing.com introduced Cloudflare,\\nwhich broke access by investpy. \\ud83d\\ude16 It is currently unclear if investpy will be available\\nagain in the future. <a href=\\\"https://github.com/alvarobartt/investpy/issues/600\\\">You can follow the developments in issue\\n600.</a> The old tessa/investpy code is\\nstill available in the <a href=\\\"https://github.com/ymyke/tessa/tree/add-symbols-based-on-investpy\\\">add-symbols-based-on-investpy\\nbranch</a>.</p>\\n\"}, {\"fullname\": \"tessa.price\", \"modulename\": \"tessa.price\", \"kind\": \"module\", \"doc\": \"<h1 id=\\\"retrieving-price-information\\\">Retrieving price information</h1>\\n\\n<p>Main functions:</p>\\n\\n<ul>\\n<li><code>tessa.price.price.price_history</code>: Retrieve the full history of an asset as a\\ndataframe.</li>\\n<li><code>tessa.price.price.price_point_strict</code>: Get an asset's price at a certain point in\\ntime. Fail if no price found.</li>\\n<li><code>tessa.price.price.price_point</code>: Same, but find the nearest price if the given point\\nin time has no price.</li>\\n<li><code>tessa.price.price.price_latest</code>: Get an asset's latest price.</li>\\n</ul>\\n\\n<p>Example use:</p>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"o\\\">&gt;&gt;&gt;</span> <span class=\\\"kn\\\">from</span><span class=\\\"w\\\"> </span><span class=\\\"nn\\\">tessa</span><span class=\\\"w\\\"> </span><span class=\\\"kn\\\">import</span> <span class=\\\"n\\\">price_history</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">price_point</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">price_point_strict</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">price_latest</span>\\n\\n<span class=\\\"o\\\">&gt;&gt;&gt;</span> <span class=\\\"n\\\">df</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">currency</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">price_history</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;AAPL&quot;</span><span class=\\\"p\\\">)</span>\\n\\n<span class=\\\"o\\\">&gt;&gt;&gt;</span> <span class=\\\"n\\\">price_point</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;AAPL&quot;</span><span class=\\\"p\\\">,</span> <span class=\\\"s2\\\">&quot;2015-01-01&quot;</span><span class=\\\"p\\\">)</span>           <span class=\\\"c1\\\"># will return price at 2014-12-31</span>\\n\\n<span class=\\\"o\\\">&gt;&gt;&gt;</span> <span class=\\\"n\\\">price_point_strict</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;AAPL&quot;</span><span class=\\\"p\\\">,</span> <span class=\\\"s2\\\">&quot;2015-01-01&quot;</span><span class=\\\"p\\\">)</span>    <span class=\\\"c1\\\"># will raise a KeyError</span>\\n\\n<span class=\\\"o\\\">&gt;&gt;&gt;</span> <span class=\\\"n\\\">price_latest</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;ethereum&quot;</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">source</span><span class=\\\"o\\\">=</span><span class=\\\"s2\\\">&quot;coingecko&quot;</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">currency_preference</span><span class=\\\"o\\\">=</span><span class=\\\"s2\\\">&quot;CHF&quot;</span><span class=\\\"p\\\">)</span>\\n\\n<span class=\\\"o\\\">&gt;&gt;&gt;</span> <span class=\\\"n\\\">price_latest</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;ETH-EUR&quot;</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">source</span><span class=\\\"o\\\">=</span><span class=\\\"s2\\\">&quot;yahoo&quot;</span><span class=\\\"p\\\">)</span>\\n\\n<span class=\\\"o\\\">&gt;&gt;&gt;</span> <span class=\\\"n\\\">price_latest</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;ethereum&quot;</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">source</span><span class=\\\"o\\\">=</span><span class=\\\"s2\\\">&quot;yahoo&quot;</span><span class=\\\"p\\\">)</span>    <span class=\\\"c1\\\"># error b/c symbol not found on yahoo</span>\\n\\n<span class=\\\"o\\\">&gt;&gt;&gt;</span> <span class=\\\"n\\\">price_latest</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;ETH-EUR&quot;</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">source</span><span class=\\\"o\\\">=</span><span class=\\\"s2\\\">&quot;coingecko&quot;</span><span class=\\\"p\\\">)</span> <span class=\\\"c1\\\"># error b/c symbol not found on coingecko</span>\\n</code></pre>\\n</div>\\n\"}, {\"fullname\": \"tessa.price.coingecko\", \"modulename\": \"tessa.price.coingecko\", \"kind\": \"module\", \"doc\": \"<p>Everything coingecko-related (other than search).</p>\\n\"}, {\"fullname\": \"tessa.price.coingecko.dataframify_price_list\", \"modulename\": \"tessa.price.coingecko\", \"qualname\": \"dataframify_price_list\", \"kind\": \"function\", \"doc\": \"<p>Turn price list returned by Coingecko API into a pricing dataframe in the form\\nthat we use.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">prices</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">list</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">pandas</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">core</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">frame</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">DataFrame</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.price.coingecko.get_price_history\", \"modulename\": \"tessa.price.coingecko\", \"qualname\": \"get_price_history\", \"kind\": \"function\", \"doc\": \"<p>Get price history for a given cryptocurrency.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">currency_preference</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span> <span class=\\\"o\\\">=</span> <span class=\\\"s1\\\">&#39;USD&#39;</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">types</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">PriceHistory</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.price.price\", \"modulename\": \"tessa.price.price\", \"kind\": \"module\", \"doc\": \"<p>Retrieve price information.</p>\\n\"}, {\"fullname\": \"tessa.price.price.custom_cache_wrapper\", \"modulename\": \"tessa.price.price\", \"qualname\": \"custom_cache_wrapper\", \"kind\": \"function\", \"doc\": \"<p>To preserve the function's signature _and_ give access to <code>cache_clear</code> etc.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">func</span></span><span class=\\\"return-annotation\\\">):</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.price.price.price_history\", \"modulename\": \"tessa.price.price\", \"qualname\": \"price_history\", \"kind\": \"function\", \"doc\": \"<p>Get price history and return <code>PriceHistory</code>, i.e., a tuple of a dataframe with\\nthe price history and the effective currency. Note that the effective currency\\nreturned might differ from the currency_preference.</p>\\n\\n<ul>\\n<li><code>query</code>: A query string that makes sense in combination with the source. E.g.,\\n\\\"BTC-USD\\\" for \\\"yahoo\\\" or \\\"bitcoin\\\" for \\\"coingecko\\\".</li>\\n<li><code>source</code>: The source to query. Defaults to \\\"yahoo\\\".</li>\\n<li><code>currency_preference</code>: The currency the prices should be returned in; defaults\\nto \\\"USD\\\". The effective currency might differ and will be returned in the second\\nreturn value.</li>\\n</ul>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">source</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Literal</span><span class=\\\"p\\\">[</span><span class=\\\"s1\\\">&#39;yahoo&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;coingecko&#39;</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">=</span> <span class=\\\"s1\\\">&#39;yahoo&#39;</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">currency_preference</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span> <span class=\\\"o\\\">=</span> <span class=\\\"s1\\\">&#39;USD&#39;</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">types</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">PriceHistory</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.price.price.price_point\", \"modulename\": \"tessa.price.price\", \"qualname\": \"price_point\", \"kind\": \"function\", \"doc\": \"<p>Return the price at a given point in time given by <code>when</code>. Look for the closest\\npoint in time if the exact point in time is not found. Returns a <code>PricePoint</code>, i.e.,\\na tuple of the price, the effective timestamp of the price, and the currency.</p>\\n\\n<p>Raises a <code>ValueError</code> if the found date is more than <code>max_date_deviation_days</code> from\\n<code>when</code>. Use <code>None</code> to disable this check.</p>\\n\\n<p>Arguments other than <code>when</code> are the same as with <code>price_history</code>.</p>\\n\\n<p>Example call:</p>\\n\\n<pre><code>price_point(\\\"AAPL\\\", \\\"2020-01-01\\\")\\n</code></pre>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">when</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Union</span><span class=\\\"p\\\">[</span><span class=\\\"nb\\\">str</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">pandas</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">_libs</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">tslibs</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">timestamps</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Timestamp</span><span class=\\\"p\\\">]</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">source</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Literal</span><span class=\\\"p\\\">[</span><span class=\\\"s1\\\">&#39;yahoo&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;coingecko&#39;</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">=</span> <span class=\\\"s1\\\">&#39;yahoo&#39;</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">currency_preference</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span> <span class=\\\"o\\\">=</span> <span class=\\\"s1\\\">&#39;USD&#39;</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">max_date_deviation_days</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Optional</span><span class=\\\"p\\\">[</span><span class=\\\"nb\\\">int</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">=</span> <span class=\\\"mi\\\">10</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">types</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">PricePoint</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.price.price.price_point_strict\", \"modulename\": \"tessa.price.price\", \"qualname\": \"price_point_strict\", \"kind\": \"function\", \"doc\": \"<p>Same as <code>price_point</code> but will raise a <code>KeyError</code> if no price is found. This\\nfunction is offered for backwards compatibility and is largely obsolete with the\\nintroduction of <code>max_date_deviation_days</code> in <code>price_point</code>.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">when</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">source</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Literal</span><span class=\\\"p\\\">[</span><span class=\\\"s1\\\">&#39;yahoo&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;coingecko&#39;</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">=</span> <span class=\\\"s1\\\">&#39;yahoo&#39;</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">currency_preference</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span> <span class=\\\"o\\\">=</span> <span class=\\\"s1\\\">&#39;USD&#39;</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">types</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">PricePoint</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.price.price.price_latest\", \"modulename\": \"tessa.price.price\", \"qualname\": \"price_latest\", \"kind\": \"function\", \"doc\": \"<p>Same as <code>price_point</code> but will return the latest price.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">source</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Literal</span><span class=\\\"p\\\">[</span><span class=\\\"s1\\\">&#39;yahoo&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;coingecko&#39;</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">=</span> <span class=\\\"s1\\\">&#39;yahoo&#39;</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">currency_preference</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span> <span class=\\\"o\\\">=</span> <span class=\\\"s1\\\">&#39;USD&#39;</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">types</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">PricePoint</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.price.types\", \"modulename\": \"tessa.price.types\", \"kind\": \"module\", \"doc\": \"<p>Price-related types.</p>\\n\"}, {\"fullname\": \"tessa.price.types.PriceHistory\", \"modulename\": \"tessa.price.types\", \"qualname\": \"PriceHistory\", \"kind\": \"class\", \"doc\": \"<p>PriceHistory(df, currency)</p>\\n\", \"bases\": \"builtins.tuple\"}, {\"fullname\": \"tessa.price.types.PriceHistory.__init__\", \"modulename\": \"tessa.price.types\", \"qualname\": \"PriceHistory.__init__\", \"kind\": \"function\", \"doc\": \"<p>Create new instance of PriceHistory(df, currency)</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">df</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">pandas</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">core</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">frame</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">DataFrame</span>, </span><span class=\\\"param\\\"><span class=\\\"n\\\">currency</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span></span>)</span>\"}, {\"fullname\": \"tessa.price.types.PriceHistory.df\", \"modulename\": \"tessa.price.types\", \"qualname\": \"PriceHistory.df\", \"kind\": \"variable\", \"doc\": \"<p>Alias for field number 0</p>\\n\", \"annotation\": \": pandas.core.frame.DataFrame\"}, {\"fullname\": \"tessa.price.types.PriceHistory.currency\", \"modulename\": \"tessa.price.types\", \"qualname\": \"PriceHistory.currency\", \"kind\": \"variable\", \"doc\": \"<p>Alias for field number 1</p>\\n\", \"annotation\": \": str\"}, {\"fullname\": \"tessa.price.types.PricePoint\", \"modulename\": \"tessa.price.types\", \"qualname\": \"PricePoint\", \"kind\": \"class\", \"doc\": \"<p>PricePoint(when, price, currency)</p>\\n\", \"bases\": \"builtins.tuple\"}, {\"fullname\": \"tessa.price.types.PricePoint.__init__\", \"modulename\": \"tessa.price.types\", \"qualname\": \"PricePoint.__init__\", \"kind\": \"function\", \"doc\": \"<p>Create new instance of PricePoint(when, price, currency)</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">when</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">pandas</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">_libs</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">tslibs</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">timestamps</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Timestamp</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">price</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">float</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">currency</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span></span>)</span>\"}, {\"fullname\": \"tessa.price.types.PricePoint.when\", \"modulename\": \"tessa.price.types\", \"qualname\": \"PricePoint.when\", \"kind\": \"variable\", \"doc\": \"<p>Alias for field number 0</p>\\n\", \"annotation\": \": pandas._libs.tslibs.timestamps.Timestamp\"}, {\"fullname\": \"tessa.price.types.PricePoint.price\", \"modulename\": \"tessa.price.types\", \"qualname\": \"PricePoint.price\", \"kind\": \"variable\", \"doc\": \"<p>Alias for field number 1</p>\\n\", \"annotation\": \": float\"}, {\"fullname\": \"tessa.price.types.PricePoint.currency\", \"modulename\": \"tessa.price.types\", \"qualname\": \"PricePoint.currency\", \"kind\": \"variable\", \"doc\": \"<p>Alias for field number 2</p>\\n\", \"annotation\": \": str\"}, {\"fullname\": \"tessa.price.types.SymbolNotFoundError\", \"modulename\": \"tessa.price.types\", \"qualname\": \"SymbolNotFoundError\", \"kind\": \"class\", \"doc\": \"<p>Common base class for all non-exit exceptions.</p>\\n\", \"bases\": \"builtins.Exception\"}, {\"fullname\": \"tessa.price.types.SymbolNotFoundError.__init__\", \"modulename\": \"tessa.price.types\", \"qualname\": \"SymbolNotFoundError.__init__\", \"kind\": \"function\", \"doc\": \"<p></p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">source</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Literal</span><span class=\\\"p\\\">[</span><span class=\\\"s1\\\">&#39;yahoo&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;coingecko&#39;</span><span class=\\\"p\\\">]</span>, </span><span class=\\\"param\\\"><span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>, </span><span class=\\\"param\\\"><span class=\\\"o\\\">*</span><span class=\\\"n\\\">args</span>, </span><span class=\\\"param\\\"><span class=\\\"o\\\">**</span><span class=\\\"n\\\">kwargs</span></span>)</span>\"}, {\"fullname\": \"tessa.price.types.CurrencyPreferenceNotFoundError\", \"modulename\": \"tessa.price.types\", \"qualname\": \"CurrencyPreferenceNotFoundError\", \"kind\": \"class\", \"doc\": \"<p>Common base class for all non-exit exceptions.</p>\\n\", \"bases\": \"builtins.Exception\"}, {\"fullname\": \"tessa.price.types.CurrencyPreferenceNotFoundError.__init__\", \"modulename\": \"tessa.price.types\", \"qualname\": \"CurrencyPreferenceNotFoundError.__init__\", \"kind\": \"function\", \"doc\": \"<p></p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">source</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Literal</span><span class=\\\"p\\\">[</span><span class=\\\"s1\\\">&#39;yahoo&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;coingecko&#39;</span><span class=\\\"p\\\">]</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">cur_pref</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"o\\\">*</span><span class=\\\"n\\\">args</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"o\\\">**</span><span class=\\\"n\\\">kwargs</span></span>)</span>\"}, {\"fullname\": \"tessa.price.types.RateLimitHitError\", \"modulename\": \"tessa.price.types\", \"qualname\": \"RateLimitHitError\", \"kind\": \"class\", \"doc\": \"<p>Common base class for all non-exit exceptions.</p>\\n\", \"bases\": \"builtins.Exception\"}, {\"fullname\": \"tessa.price.types.RateLimitHitError.__init__\", \"modulename\": \"tessa.price.types\", \"qualname\": \"RateLimitHitError.__init__\", \"kind\": \"function\", \"doc\": \"<p></p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">source</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Literal</span><span class=\\\"p\\\">[</span><span class=\\\"s1\\\">&#39;yahoo&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;coingecko&#39;</span><span class=\\\"p\\\">]</span>, </span><span class=\\\"param\\\"><span class=\\\"o\\\">*</span><span class=\\\"n\\\">args</span>, </span><span class=\\\"param\\\"><span class=\\\"o\\\">**</span><span class=\\\"n\\\">kwargs</span></span>)</span>\"}, {\"fullname\": \"tessa.price.yahoo\", \"modulename\": \"tessa.price.yahoo\", \"kind\": \"module\", \"doc\": \"<p>Everything Yahoo-Finance-related (other than search).</p>\\n\"}, {\"fullname\": \"tessa.price.yahoo.START_FROM\", \"modulename\": \"tessa.price.yahoo\", \"qualname\": \"START_FROM\", \"kind\": \"variable\", \"doc\": \"<p>Adjust this date if you need to get historical data further in the past. Note that\\nextending this date will lead to increased load on the Yahoo Finance servers.</p>\\n\", \"default_value\": \"&#x27;2000-01-01&#x27;\"}, {\"fullname\": \"tessa.price.yahoo.get_price_history\", \"modulename\": \"tessa.price.yahoo\", \"qualname\": \"get_price_history\", \"kind\": \"function\", \"doc\": \"<p>Get price history for a given query. Note that <code>currency_preference</code> will be\\nignored since Yahoo Finance returns each ticker in the one currency that is set for\\nthat ticker.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">currency_preference</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span> <span class=\\\"o\\\">=</span> <span class=\\\"s1\\\">&#39;USD&#39;</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">types</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">PriceHistory</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.search\", \"modulename\": \"tessa.search\", \"kind\": \"module\", \"doc\": \"<h1 id=\\\"searching-symbols\\\">Searching symbols</h1>\\n\\n<p>Main function is <code>tessa.search.search.search</code>, which will return a\\n<code>tessa.search.search_result.SearchResult</code>, offering all kinds of useful functionality.</p>\\n\\n<p>Example use:</p>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"kn\\\">from</span><span class=\\\"w\\\"> </span><span class=\\\"nn\\\">tessa</span><span class=\\\"w\\\"> </span><span class=\\\"kn\\\">import</span> <span class=\\\"n\\\">search</span>\\n\\n<span class=\\\"o\\\">&gt;&gt;&gt;</span> <span class=\\\"n\\\">r</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">search</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;botto&quot;</span><span class=\\\"p\\\">)</span>\\n<span class=\\\"o\\\">&gt;&gt;&gt;</span> <span class=\\\"n\\\">r</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">filter</span><span class=\\\"p\\\">(</span><span class=\\\"n\\\">source</span><span class=\\\"o\\\">=</span><span class=\\\"s2\\\">&quot;coingecko&quot;</span><span class=\\\"p\\\">)</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbols</span>\\n</code></pre>\\n</div>\\n\\n<p>(Note that the filter currently doesn't make much sense because coingecko is the only\\nsearch source currently with Yahoo Finance disabled.)</p>\\n\"}, {\"fullname\": \"tessa.search.coingecko\", \"modulename\": \"tessa.search.coingecko\", \"kind\": \"module\", \"doc\": \"<p>Everything related to searching via coingecko.</p>\\n\"}, {\"fullname\": \"tessa.search.coingecko.get_symbol_map\", \"modulename\": \"tessa.search.coingecko\", \"qualname\": \"get_symbol_map\", \"kind\": \"function\", \"doc\": \"<p>Get the symbol map. Separate function to use caching, so the API doesn't get\\nhit too often.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"return-annotation\\\">) -> <span class=\\\"nb\\\">list</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.search.coingecko.coingecko_search\", \"modulename\": \"tessa.search.coingecko\", \"qualname\": \"coingecko_search\", \"kind\": \"function\", \"doc\": \"<p>Find coingecko ids that match <code>query</code> somehow. Returns <code>SearchResult</code>.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">search</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">search_result</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">SearchResult</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.search.search\", \"modulename\": \"tessa.search.search\", \"kind\": \"module\", \"doc\": \"<p>Unified search.</p>\\n\"}, {\"fullname\": \"tessa.search.search.search\", \"modulename\": \"tessa.search.search\", \"qualname\": \"search\", \"kind\": \"function\", \"doc\": \"<p>Unified search function. Returns a <code>tessa.search.SearchResult</code>.</p>\\n\\n<ul>\\n<li><code>query</code>: The string to search for. (Note that this query attribute has a different\\nsemantics to the query attribute in the <code>Symbol</code> class.)</li>\\n<li><code>silent</code>: No print output if True.</li>\\n</ul>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">silent</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">bool</span> <span class=\\\"o\\\">=</span> <span class=\\\"kc\\\">False</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">search</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">search_result</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">SearchResult</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.search.search_result\", \"modulename\": \"tessa.search.search_result\", \"kind\": \"module\", \"doc\": \"<p>Everything related to search results, especially the <code>SearchResult</code> class.</p>\\n\"}, {\"fullname\": \"tessa.search.search_result.matches_entire_name_or_alias\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"matches_entire_name_or_alias\", \"kind\": \"function\", \"doc\": \"<p>Try to match the complete name or one of the aliases completely. E.g.:\\n<code>matches_entire_name_or_alias(\\\"eth\\\", Symbol(\\\"ETH\\\")) &gt; 0</code>.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>, </span><span class=\\\"param\\\"><span class=\\\"n\\\">symbol</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Symbol</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"nb\\\">int</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.search.search_result.matches_word_boundary\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"matches_word_boundary\", \"kind\": \"function\", \"doc\": \"<p>Try to match a complete word in name, aliases, or query. E.g.:\\n<code>matches_word_boundary(\\\"eth\\\", Symbol(\\\"ETHW\\\", aliases=[\\\"PoW ETH\\\"])) &gt; 0</code>.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>, </span><span class=\\\"param\\\"><span class=\\\"n\\\">symbol</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Symbol</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"nb\\\">int</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.search.search_result.matches_inanyway\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"matches_inanyway\", \"kind\": \"function\", \"doc\": \"<p>Try to match anywhere in name, aliases, or query. E.g.:\\n<code>matches_inanyway(\\\"eth\\\", Symbol(\\\"TOGETHER\\\")) &gt; 0</code>.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>, </span><span class=\\\"param\\\"><span class=\\\"n\\\">symbol</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Symbol</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"nb\\\">int</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.search.search_result.Bucket\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"Bucket\", \"kind\": \"class\", \"doc\": \"<p>A bucket is a set of results of a certain quality level in a larger search result. A\\nbucket has a name and a list of symbols that belong into that bucket.</p>\\n\", \"bases\": \"builtins.tuple\"}, {\"fullname\": \"tessa.search.search_result.Bucket.__init__\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"Bucket.__init__\", \"kind\": \"function\", \"doc\": \"<p>Create new instance of Bucket(name, symbols)</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">name</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>, </span><span class=\\\"param\\\"><span class=\\\"n\\\">symbols</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">List</span><span class=\\\"p\\\">[</span><span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">]</span></span>)</span>\"}, {\"fullname\": \"tessa.search.search_result.Bucket.name\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"Bucket.name\", \"kind\": \"variable\", \"doc\": \"<p>Alias for field number 0</p>\\n\", \"annotation\": \": str\"}, {\"fullname\": \"tessa.search.search_result.Bucket.symbols\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"Bucket.symbols\", \"kind\": \"variable\", \"doc\": \"<p>Alias for field number 1</p>\\n\", \"annotation\": \": List[tessa.symbol.symbol.Symbol]\"}, {\"fullname\": \"tessa.search.search_result.BUCKET_SPEC\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"BUCKET_SPEC\", \"kind\": \"variable\", \"doc\": \"<p></p>\\n\", \"default_value\": \"[(&#x27;Matches entire name or alias \\u2b50&#x27;, &lt;function matches_entire_name_or_alias&gt;), (&#x27;Matches word boundary&#x27;, &lt;function matches_word_boundary&gt;), (&#x27;Matches in any way&#x27;, &lt;function matches_inanyway&gt;)]\"}, {\"fullname\": \"tessa.search.search_result.bucketize\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"bucketize\", \"kind\": \"function\", \"doc\": \"<p>Split a list of <code>Symbol</code>s into buckets based on how well a symbol matches the\\n<code>query</code>.</p>\\n\\n<p>(We're not using <code>itertools.groupby</code> here bc we need empty lists for empty buckets,\\nwhich <code>groupby</code> doesn't provide.)</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">symbols</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">List</span><span class=\\\"p\\\">[</span><span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">]</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">List</span><span class=\\\"p\\\">[</span><span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">search</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">search_result</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Bucket</span><span class=\\\"p\\\">]</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.search.search_result.create_sort_key_for_query\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"create_sort_key_for_query\", \"kind\": \"function\", \"doc\": \"<p>Create a sort key function that classifies a <code>Symbol</code> based on <code>query</code>.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">Callable</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.search.search_result.remove_duplicates\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"remove_duplicates\", \"kind\": \"function\", \"doc\": \"<p>Return a list in which every symbol is unique. Two symbols are considered\\nequivalent if they match in <code>query</code> and <code>source</code>. Regardless of whether their names\\nare the same or different.</p>\\n\\n<p>Note further that several symbols can have the same name but still be considered\\ndifferent if they differ in any of <code>query</code> or <code>source</code>.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">symbols</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">List</span><span class=\\\"p\\\">[</span><span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">]</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">List</span><span class=\\\"p\\\">[</span><span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">]</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.search.search_result.SearchResult\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"SearchResult\", \"kind\": \"class\", \"doc\": \"<p>Manages a search result consisting of a list of <code>Symbol</code>s. Removes duplicates,\\nbucketizes, sorts and offers methods to filter and print statistics.</p>\\n\\n<p>(Design note 1: <code>SearchResult</code> has no relationship with <code>SymbolCollection</code> because\\nthe purposes of the two classes are very different and because they have different\\nequality definitions for symbols.</p>\\n\\n<p>Design note 2: <code>SearchResult</code> and <code>SymbolCollection</code> have different definitions of\\nequality between symbols: <code>SearchResult</code> considers 2 symbols to be equal if they are\\nequal in <code>query</code> and <code>source</code>, regardless of whether they have the same name or not.\\nA <code>SymbolCollection</code> does not have a definition of equality, but it does enforce\\nthat names are unique.)</p>\\n\\n<p>Example use:</p>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"kn\\\">from</span><span class=\\\"w\\\"> </span><span class=\\\"nn\\\">tessa</span><span class=\\\"w\\\"> </span><span class=\\\"kn\\\">import</span> <span class=\\\"n\\\">search</span>\\n<span class=\\\"n\\\">r</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">search</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;harmony&quot;</span><span class=\\\"p\\\">)</span>\\n\\n<span class=\\\"c1\\\"># Review results:</span>\\n<span class=\\\"n\\\">r</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">p</span><span class=\\\"p\\\">()</span>\\n\\n<span class=\\\"c1\\\"># Get the 1 symbol from source &quot;coingecko&quot; in the best bucket (i.e., bucket 0):</span>\\n<span class=\\\"n\\\">s</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">r</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">filter</span><span class=\\\"p\\\">(</span><span class=\\\"n\\\">source</span><span class=\\\"o\\\">=</span><span class=\\\"s2\\\">&quot;coingecko&quot;</span><span class=\\\"p\\\">)</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">buckets</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">]</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbols</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">]</span>\\n<span class=\\\"n\\\">s</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_latest</span><span class=\\\"p\\\">()</span>\\n</code></pre>\\n</div>\\n\"}, {\"fullname\": \"tessa.search.search_result.SearchResult.__init__\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"SearchResult.__init__\", \"kind\": \"function\", \"doc\": \"<p></p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>, </span><span class=\\\"param\\\"><span class=\\\"n\\\">symbols</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">List</span><span class=\\\"p\\\">[</span><span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">]</span></span>)</span>\"}, {\"fullname\": \"tessa.search.search_result.SearchResult.query\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"SearchResult.query\", \"kind\": \"variable\", \"doc\": \"<p>The query that produced the results here.</p>\\n\", \"annotation\": \": str\"}, {\"fullname\": \"tessa.search.search_result.SearchResult.symbols\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"SearchResult.symbols\", \"kind\": \"variable\", \"doc\": \"<p>List of symbols in this result. Always deduplicated and sorted.</p>\\n\", \"annotation\": \": List[tessa.symbol.symbol.Symbol]\"}, {\"fullname\": \"tessa.search.search_result.SearchResult.buckets\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"SearchResult.buckets\", \"kind\": \"variable\", \"doc\": \"<p>List of buckets after bucketizing the symbols.</p>\\n\", \"annotation\": \": List[tessa.search.search_result.Bucket]\"}, {\"fullname\": \"tessa.search.search_result.SearchResult.filter_history\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"SearchResult.filter_history\", \"kind\": \"variable\", \"doc\": \"<p>The filters that have been applied to get to this result.</p>\\n\", \"annotation\": \": List[str]\"}, {\"fullname\": \"tessa.search.search_result.SearchResult.add_symbols\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"SearchResult.add_symbols\", \"kind\": \"function\", \"doc\": \"<p>Add symbols. Removes duplicates, sorts, and bucketizes after adding.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"bp\\\">self</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">symbols</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">List</span><span class=\\\"p\\\">[</span><span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">]</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">search</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">search_result</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">SearchResult</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.search.search_result.SearchResult.filter\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"SearchResult.filter\", \"kind\": \"function\", \"doc\": \"<p>Filter for arbitrary attribute-value-pairs (e.g., <code>source=\\\"coingecko\\\"</code> or\\n<code>exchange=\\\"ebs\\\"</code>) and return a new <code>SearchResult</code> with the results after the\\nfiltering. Also updates the filter history.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span>, </span><span class=\\\"param\\\"><span class=\\\"o\\\">**</span><span class=\\\"n\\\">kwargs</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">search</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">search_result</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">SearchResult</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.search.search_result.SearchResult.p\", \"modulename\": \"tessa.search.search_result\", \"qualname\": \"SearchResult.p\", \"kind\": \"function\", \"doc\": \"<p>Convenience method to print str rep.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"kc\\\">None</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.search.yahoo\", \"modulename\": \"tessa.search.yahoo\", \"kind\": \"module\", \"doc\": \"<p>Yahoo Finance search</p>\\n\"}, {\"fullname\": \"tessa.search.yahoo.yahoo_search\", \"modulename\": \"tessa.search.yahoo\", \"qualname\": \"yahoo_search\", \"kind\": \"function\", \"doc\": \"<p></p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">search</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">search_result</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">SearchResult</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.sources\", \"modulename\": \"tessa.sources\", \"kind\": \"module\", \"doc\": \"<h1 id=\\\"managing-different-data-sources\\\">Managing different data sources</h1>\\n\\n<p>A <code>tessa.sources.sources.Source</code> ties together all the functionality and state related\\nto a source such as Yahoo or Coingecko.</p>\\n\\n<p><code>tessa.sources.rate_limiter.RateLimiter</code> takes care of rate limiting for a source.</p>\\n\\n<p>All known sources are specified in <code>tessa.sources.sources_directory</code>.</p>\\n\"}, {\"fullname\": \"tessa.sources.low_level_rate_limiter\", \"modulename\": \"tessa.sources.low_level_rate_limiter\", \"kind\": \"module\", \"doc\": \"<p>Rate Limiter -- makes sure we don't hit the APIs too often by waiting by default and\\nwaiting exponentially if a 429 error is encountered.</p>\\n\\n<p>The goal is to never run into errors in the first place, because some sites like\\ncoingecko.com take substantial time until they allow-list a blocked IP address again.\\nThat is also why we can't use a library such das Tenacity here.</p>\\n\\n<p>Note that this module is no longer used by the package. But I left it in here anyway,\\nbecause it might come in handy for people who use the pycoingecko or some other library\\nin other ways than through this package.</p>\\n\\n<p>Usage: Import the module and call <code>setup_guards()</code>.</p>\\n\"}, {\"fullname\": \"tessa.sources.low_level_rate_limiter.guards\", \"modulename\": \"tessa.sources.low_level_rate_limiter\", \"qualname\": \"guards\", \"kind\": \"variable\", \"doc\": \"<p></p>\\n\", \"default_value\": \"{&#x27;yahoo&#x27;: {&#x27;func_name&#x27;: &#x27;requests.post&#x27;, &#x27;initial_wait_seconds&#x27;: 0.2, &#x27;pattern&#x27;: &#x27;yahoo.com&#x27;}, &#x27;coingecko&#x27;: {&#x27;func_name&#x27;: &#x27;requests.Session.get&#x27;, &#x27;initial_wait_seconds&#x27;: 2.5, &#x27;pattern&#x27;: &#x27;coingecko.com&#x27;}}\"}, {\"fullname\": \"tessa.sources.low_level_rate_limiter.create_guard\", \"modulename\": \"tessa.sources.low_level_rate_limiter\", \"qualname\": \"create_guard\", \"kind\": \"function\", \"doc\": \"<p>Create a guard.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">func</span><span class=\\\"p\\\">:</span> <span class=\\\"o\\\">&lt;</span><span class=\\\"n\\\">built</span><span class=\\\"o\\\">-</span><span class=\\\"ow\\\">in</span> <span class=\\\"n\\\">function</span> <span class=\\\"nb\\\">callable</span><span class=\\\"o\\\">&gt;</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">guard</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">dict</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"o\\\">&lt;</span><span class=\\\"n\\\">built</span><span class=\\\"o\\\">-</span><span class=\\\"ow\\\">in</span> <span class=\\\"n\\\">function</span> <span class=\\\"nb\\\">callable</span><span class=\\\"o\\\">&gt;</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.sources.low_level_rate_limiter.setup_guards\", \"modulename\": \"tessa.sources.low_level_rate_limiter\", \"qualname\": \"setup_guards\", \"kind\": \"function\", \"doc\": \"<p>Set up guards.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"return-annotation\\\">) -> <span class=\\\"kc\\\">None</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.sources.rate_limiter\", \"modulename\": \"tessa.sources.rate_limiter\", \"kind\": \"module\", \"doc\": \"<p>Rate Limiter -- makes sure we don't hit the APIs too often by making sure a minimum\\namount of time has elapsed between calls to an API.</p>\\n\\n<p>The goal is to never run into errors in the first place, b/c some sites take substantial\\ntime until it allow-lists a blocked IP address again. That is also why we can't use a\\nlibrary such das Tenacity here.</p>\\n\"}, {\"fullname\": \"tessa.sources.rate_limiter.VERY_LONG_AGO\", \"modulename\": \"tessa.sources.rate_limiter\", \"qualname\": \"VERY_LONG_AGO\", \"kind\": \"variable\", \"doc\": \"<p></p>\\n\", \"default_value\": \"DateTime(1900, 1, 1, 0, 0, 0, tzinfo=Timezone(&#x27;UTC&#x27;))\"}, {\"fullname\": \"tessa.sources.rate_limiter.INITIAL_BACK_OFF_TIME\", \"modulename\": \"tessa.sources.rate_limiter\", \"qualname\": \"INITIAL_BACK_OFF_TIME\", \"kind\": \"variable\", \"doc\": \"<p></p>\\n\", \"default_value\": \"10\"}, {\"fullname\": \"tessa.sources.rate_limiter.RateLimiter\", \"modulename\": \"tessa.sources.rate_limiter\", \"qualname\": \"RateLimiter\", \"kind\": \"class\", \"doc\": \"<p>Encapsulates state and stats of a rate limiter object.</p>\\n\"}, {\"fullname\": \"tessa.sources.rate_limiter.RateLimiter.__init__\", \"modulename\": \"tessa.sources.rate_limiter\", \"qualname\": \"RateLimiter.__init__\", \"kind\": \"function\", \"doc\": \"<p></p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">wait_seconds</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">float</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">last_call</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">datetime</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">datetime</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">DateTime</span><span class=\\\"p\\\">(</span><span class=\\\"mi\\\">1900</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">1</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">1</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">tzinfo</span><span class=\\\"o\\\">=</span><span class=\\\"n\\\">Timezone</span><span class=\\\"p\\\">(</span><span class=\\\"s1\\\">&#39;UTC&#39;</span><span class=\\\"p\\\">))</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">count_all_calls</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">int</span> <span class=\\\"o\\\">=</span> <span class=\\\"mi\\\">0</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">count_limited_calls</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">int</span> <span class=\\\"o\\\">=</span> <span class=\\\"mi\\\">0</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">back_off_time</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">int</span> <span class=\\\"o\\\">=</span> <span class=\\\"mi\\\">10</span></span>)</span>\"}, {\"fullname\": \"tessa.sources.rate_limiter.RateLimiter.wait_seconds\", \"modulename\": \"tessa.sources.rate_limiter\", \"qualname\": \"RateLimiter.wait_seconds\", \"kind\": \"variable\", \"doc\": \"<p>Enforce this amount of seconds between subsequent calls.</p>\\n\", \"annotation\": \": float\"}, {\"fullname\": \"tessa.sources.rate_limiter.RateLimiter.last_call\", \"modulename\": \"tessa.sources.rate_limiter\", \"qualname\": \"RateLimiter.last_call\", \"kind\": \"variable\", \"doc\": \"<p>Keeps track of last call's timestamp.</p>\\n\", \"annotation\": \": datetime.datetime\", \"default_value\": \"DateTime(1900, 1, 1, 0, 0, 0, tzinfo=Timezone(&#x27;UTC&#x27;))\"}, {\"fullname\": \"tessa.sources.rate_limiter.RateLimiter.count_all_calls\", \"modulename\": \"tessa.sources.rate_limiter\", \"qualname\": \"RateLimiter.count_all_calls\", \"kind\": \"variable\", \"doc\": \"<p>Number of total calls.</p>\\n\", \"annotation\": \": int\", \"default_value\": \"0\"}, {\"fullname\": \"tessa.sources.rate_limiter.RateLimiter.count_limited_calls\", \"modulename\": \"tessa.sources.rate_limiter\", \"qualname\": \"RateLimiter.count_limited_calls\", \"kind\": \"variable\", \"doc\": \"<p>Number of calls that triggered some waiting.</p>\\n\", \"annotation\": \": int\", \"default_value\": \"0\"}, {\"fullname\": \"tessa.sources.rate_limiter.RateLimiter.back_off_time\", \"modulename\": \"tessa.sources.rate_limiter\", \"qualname\": \"RateLimiter.back_off_time\", \"kind\": \"variable\", \"doc\": \"<p>Number of seconds to wait after a rate limit hit.</p>\\n\", \"annotation\": \": int\", \"default_value\": \"10\"}, {\"fullname\": \"tessa.sources.rate_limiter.RateLimiter.reset_back_off\", \"modulename\": \"tessa.sources.rate_limiter\", \"qualname\": \"RateLimiter.reset_back_off\", \"kind\": \"function\", \"doc\": \"<p>Reset back-off time to initial value.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span></span><span class=\\\"return-annotation\\\">):</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.sources.rate_limiter.RateLimiter.reset\", \"modulename\": \"tessa.sources.rate_limiter\", \"qualname\": \"RateLimiter.reset\", \"kind\": \"function\", \"doc\": \"<p>Reset state and stats.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span></span><span class=\\\"return-annotation\\\">):</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.sources.rate_limiter.RateLimiter.rate_limit\", \"modulename\": \"tessa.sources.rate_limiter\", \"qualname\": \"RateLimiter.rate_limit\", \"kind\": \"function\", \"doc\": \"<p>Enforce the minimum wait time as specified in <code>wait_seconds</code>.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span></span><span class=\\\"return-annotation\\\">):</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.sources.rate_limiter.RateLimiter.back_off\", \"modulename\": \"tessa.sources.rate_limiter\", \"qualname\": \"RateLimiter.back_off\", \"kind\": \"function\", \"doc\": \"<p>Back off exponentially.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span></span><span class=\\\"return-annotation\\\">):</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.sources.sources\", \"modulename\": \"tessa.sources.sources\", \"kind\": \"module\", \"doc\": \"<p>Source class and related functions.</p>\\n\"}, {\"fullname\": \"tessa.sources.sources.Source\", \"modulename\": \"tessa.sources.sources\", \"qualname\": \"Source\", \"kind\": \"class\", \"doc\": \"<p>A <code>Source</code> encapsulates everything related to a source such as Yahoo or\\nCoingecko.</p>\\n\"}, {\"fullname\": \"tessa.sources.sources.Source.__init__\", \"modulename\": \"tessa.sources.sources\", \"qualname\": \"Source.__init__\", \"kind\": \"function\", \"doc\": \"<p></p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">get_price_history</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Callable</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">get_search_results</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Callable</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">rate_limiter</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">sources</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">rate_limiter</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">RateLimiter</span></span>)</span>\"}, {\"fullname\": \"tessa.sources.sources.Source.get_price_history\", \"modulename\": \"tessa.sources.sources\", \"qualname\": \"Source.get_price_history\", \"kind\": \"variable\", \"doc\": \"<p>Callback to retrieve price history.</p>\\n\", \"annotation\": \": Callable\"}, {\"fullname\": \"tessa.sources.sources.Source.get_search_results\", \"modulename\": \"tessa.sources.sources\", \"qualname\": \"Source.get_search_results\", \"kind\": \"variable\", \"doc\": \"<p>Callback to retrieve search results.</p>\\n\", \"annotation\": \": Callable\"}, {\"fullname\": \"tessa.sources.sources.Source.rate_limiter\", \"modulename\": \"tessa.sources.sources\", \"qualname\": \"Source.rate_limiter\", \"kind\": \"variable\", \"doc\": \"<p>Rate limiter object.</p>\\n\", \"annotation\": \": tessa.sources.rate_limiter.RateLimiter\"}, {\"fullname\": \"tessa.sources.sources.Source.get_price_history_bruteforcefully\", \"modulename\": \"tessa.sources.sources\", \"qualname\": \"Source.get_price_history_bruteforcefully\", \"kind\": \"function\", \"doc\": \"<p>Variant of <code>get_price_history</code> that will ignore some server-side errors\\n(which often seem to be intermittent, at least on Coingecko) and just\\nretries.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"bp\\\">self</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">currency_preference</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span> <span class=\\\"o\\\">=</span> <span class=\\\"s1\\\">&#39;USD&#39;</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">types</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">PriceHistory</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.sources.sources.get_source\", \"modulename\": \"tessa.sources.sources\", \"qualname\": \"get_source\", \"kind\": \"function\", \"doc\": \"<p>Get a specific source.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">name</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Literal</span><span class=\\\"p\\\">[</span><span class=\\\"s1\\\">&#39;yahoo&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;coingecko&#39;</span><span class=\\\"p\\\">]</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">sources</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">sources</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Source</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.sources.sources.get_all_sources\", \"modulename\": \"tessa.sources.sources\", \"qualname\": \"get_all_sources\", \"kind\": \"function\", \"doc\": \"<p>Get all the known sources.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">Generator</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.sources.sources.reset_rate_limiters\", \"modulename\": \"tessa.sources.sources\", \"qualname\": \"reset_rate_limiters\", \"kind\": \"function\", \"doc\": \"<p>Reset the rate limiters of all sources.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"return-annotation\\\">) -> <span class=\\\"kc\\\">None</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.sources.sources_directory\", \"modulename\": \"tessa.sources.sources_directory\", \"kind\": \"module\", \"doc\": \"<p>The directory (i.e., dictionary) of all know sources. To be accessed via the\\nfunctions in <code>tessa.sources.sources</code>. This module is factored out so the directory can\\nbe imported late within functions in order to prevent circular dependencies.</p>\\n\"}, {\"fullname\": \"tessa.sources.sources_directory.SOURCES_DIRECTORY\", \"modulename\": \"tessa.sources.sources_directory\", \"qualname\": \"SOURCES_DIRECTORY\", \"kind\": \"variable\", \"doc\": \"<p></p>\\n\", \"annotation\": \": Final[Dict[Literal[&#x27;yahoo&#x27;, &#x27;coingecko&#x27;], tessa.sources.sources.Source]]\", \"default_value\": \"{&#x27;yahoo&#x27;: Source(get_price_history=&lt;function get_price_history&gt;, get_search_results=&lt;function yahoo_search&gt;, rate_limiter=RateLimiter(wait_seconds=0.5, last_call=DateTime(1900, 1, 1, 0, 0, 0, tzinfo=Timezone(&#x27;UTC&#x27;)), count_all_calls=0, count_limited_calls=0, back_off_time=10)), &#x27;coingecko&#x27;: Source(get_price_history=&lt;function get_price_history&gt;, get_search_results=&lt;function coingecko_search&gt;, rate_limiter=RateLimiter(wait_seconds=2.5, last_call=DateTime(1900, 1, 1, 0, 0, 0, tzinfo=Timezone(&#x27;UTC&#x27;)), count_all_calls=0, count_limited_calls=0, back_off_time=10))}\"}, {\"fullname\": \"tessa.sources.sourcetype\", \"modulename\": \"tessa.sources.sourcetype\", \"kind\": \"module\", \"doc\": \"<p><code>SourceType</code> is a literal type with all known sources; used for type hinting and to\\nsupport autocomplete suggestions.</p>\\n\"}, {\"fullname\": \"tessa.sources.sourcetype.SourceType\", \"modulename\": \"tessa.sources.sourcetype\", \"qualname\": \"SourceType\", \"kind\": \"variable\", \"doc\": \"<p></p>\\n\", \"default_value\": \"typing.Literal[&#x27;yahoo&#x27;, &#x27;coingecko&#x27;]\"}, {\"fullname\": \"tessa.symbol\", \"modulename\": \"tessa.symbol\", \"kind\": \"module\", \"doc\": \"<h1 id=\\\"working-with-symbols\\\">Working with Symbols</h1>\\n\\n<p>The main class is <code>tessa.symbol.symbol.Symbol</code>, which encapsulates all the information\\nand functionality around symbols. A <code>tessa.symbol.symbolcollection.SymbolCollection</code>\\nmanages a collection of symbols including save and load functionality.</p>\\n\\n<p>Example use:</p>\\n\\n<div class=\\\"pdoc-code codehilite\\\">\\n<pre><span></span><code><span class=\\\"kn\\\">from</span><span class=\\\"w\\\"> </span><span class=\\\"nn\\\">tessa</span><span class=\\\"w\\\"> </span><span class=\\\"kn\\\">import</span> <span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">SymbolCollection</span>\\n<span class=\\\"n\\\">s1</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;MSFT&quot;</span><span class=\\\"p\\\">)</span>                 <span class=\\\"c1\\\"># will use &quot;yahoo&quot; as the default source</span>\\n<span class=\\\"n\\\">s1</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_latest</span><span class=\\\"p\\\">()</span>                   <span class=\\\"c1\\\"># get latest price</span>\\n<span class=\\\"n\\\">sc</span> <span class=\\\"o\\\">=</span> <span class=\\\"n\\\">SymbolCollection</span><span class=\\\"p\\\">([</span><span class=\\\"n\\\">s1</span><span class=\\\"p\\\">])</span>         <span class=\\\"c1\\\"># create collection</span>\\n<span class=\\\"n\\\">sc</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">add</span><span class=\\\"p\\\">(</span><span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;ethereum&quot;</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">source</span><span class=\\\"o\\\">=</span><span class=\\\"s2\\\">&quot;coingecko&quot;</span><span class=\\\"p\\\">))</span>       <span class=\\\"c1\\\"># add another symbol</span>\\n<span class=\\\"n\\\">sc</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">find_one</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;ethereum&quot;</span><span class=\\\"p\\\">)</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price_graph</span><span class=\\\"p\\\">(</span><span class=\\\"n\\\">monthsback</span><span class=\\\"o\\\">=</span><span class=\\\"mi\\\">6</span><span class=\\\"p\\\">)</span>    <span class=\\\"c1\\\"># graph of 6 past months</span>\\n<span class=\\\"n\\\">sc</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">save_yaml</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">&quot;my_symbols.yaml&quot;</span><span class=\\\"p\\\">)</span>     <span class=\\\"c1\\\"># save</span>\\n</code></pre>\\n</div>\\n\\n<p><code>tessa.symbol.extended_symbol.ExtendedSymbol</code> shows how the <code>Symbol</code> class can be\\nextended.</p>\\n\"}, {\"fullname\": \"tessa.symbol.extended_symbol\", \"modulename\": \"tessa.symbol.extended_symbol\", \"kind\": \"module\", \"doc\": \"<p>An example of how to extend the Symbol class with more information and functionality.</p>\\n\"}, {\"fullname\": \"tessa.symbol.extended_symbol.ExtendedSymbol\", \"modulename\": \"tessa.symbol.extended_symbol\", \"qualname\": \"ExtendedSymbol\", \"kind\": \"class\", \"doc\": \"<p>ExtendedSymbol class. Adds more information and functionality to the Symbol\\nclass.</p>\\n\", \"bases\": \"tessa.symbol.symbol.Symbol\"}, {\"fullname\": \"tessa.symbol.extended_symbol.ExtendedSymbol.__init__\", \"modulename\": \"tessa.symbol.extended_symbol\", \"qualname\": \"ExtendedSymbol.__init__\", \"kind\": \"function\", \"doc\": \"<p></p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">name</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Optional</span><span class=\\\"p\\\">[</span><span class=\\\"nb\\\">str</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">=</span> <span class=\\\"kc\\\">None</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">source</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Literal</span><span class=\\\"p\\\">[</span><span class=\\\"s1\\\">&#39;yahoo&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;coingecko&#39;</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">=</span> <span class=\\\"s1\\\">&#39;yahoo&#39;</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">aliases</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">list</span><span class=\\\"p\\\">[</span><span class=\\\"nb\\\">str</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">=</span> <span class=\\\"o\\\">&lt;</span><span class=\\\"n\\\">factory</span><span class=\\\"o\\\">&gt;</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">description</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Optional</span><span class=\\\"p\\\">[</span><span class=\\\"nb\\\">str</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">=</span> <span class=\\\"kc\\\">None</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">country</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Optional</span><span class=\\\"p\\\">[</span><span class=\\\"n\\\">Literal</span><span class=\\\"p\\\">[</span><span class=\\\"s1\\\">&#39;andorra&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;united arab emirates&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;afghanistan&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;antigua and barbuda&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;anguilla&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;albania&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;armenia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;angola&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;antarctica&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;argentina&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;american samoa&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;austria&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;australia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;aruba&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;\\u00e5land&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;azerbaijan&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;bosnia and herzegovina&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;barbados&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;bangladesh&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;belgium&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;burkina faso&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;bulgaria&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;bahrain&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;burundi&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;benin&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;saint barth\\u00e9lemy&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;bermuda&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;brunei&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;bolivia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;bonaire&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;brazil&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;bahamas&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;bhutan&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;bouvet island&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;botswana&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;belarus&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;belize&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;canada&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;cocos [keeling] islands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;democratic republic of the congo&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;central african republic&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;republic of the congo&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;switzerland&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;ivory coast&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;cook islands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;chile&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;cameroon&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;china&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;colombia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;costa rica&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;cuba&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;cape verde&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;curacao&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;christmas island&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;cyprus&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;czech republic&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;germany&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;djibouti&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;denmark&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;dominica&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;dominican republic&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;algeria&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;ecuador&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;estonia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;egypt&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;western sahara&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;eritrea&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;spain&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;ethiopia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;finland&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;fiji&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;falkland islands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;micronesia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;faroe islands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;france&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;gabon&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;united kingdom&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;grenada&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;georgia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;french guiana&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;guernsey&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;ghana&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;gibraltar&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;greenland&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;gambia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;guinea&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;guadeloupe&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;equatorial guinea&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;greece&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;south georgia and the south sandwich islands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;guatemala&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;guam&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;guinea-bissau&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;guyana&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;hong kong&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;heard island and mcdonald islands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;honduras&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;croatia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;haiti&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;hungary&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;indonesia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;ireland&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;israel&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;isle of man&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;india&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;british indian ocean territory&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;iraq&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;iran&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;iceland&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;italy&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;jersey&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;jamaica&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;jordan&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;japan&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;kenya&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;kyrgyzstan&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;cambodia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;kiribati&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;comoros&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;saint kitts and nevis&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;north korea&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;south korea&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;kuwait&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;cayman islands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;kazakhstan&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;laos&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;lebanon&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;saint lucia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;liechtenstein&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;sri lanka&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;liberia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;lesotho&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;lithuania&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;luxembourg&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;latvia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;libya&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;morocco&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;monaco&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;moldova&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;montenegro&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;saint martin&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;madagascar&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;marshall islands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;north macedonia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;mali&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;myanmar [burma]&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;mongolia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;macao&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;northern mariana islands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;martinique&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;mauritania&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;montserrat&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;malta&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;mauritius&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;maldives&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;malawi&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;mexico&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;malaysia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;mozambique&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;namibia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;new caledonia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;niger&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;norfolk island&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;nigeria&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;nicaragua&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;netherlands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;norway&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;nepal&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;nauru&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;niue&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;new zealand&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;oman&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;panama&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;peru&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;french polynesia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;papua new guinea&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;philippines&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;pakistan&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;poland&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;saint pierre and miquelon&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;pitcairn islands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;puerto rico&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;palestine&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;portugal&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;palau&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;paraguay&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;qatar&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;r\\u00e9union&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;romania&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;serbia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;russia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;rwanda&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;saudi arabia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;solomon islands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;seychelles&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;sudan&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;sweden&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;singapore&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;saint helena&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;slovenia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;svalbard and jan mayen&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;slovakia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;sierra leone&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;san marino&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;senegal&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;somalia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;suriname&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;south sudan&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;s\\u00e3o tom\\u00e9 and pr\\u00edncipe&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;el salvador&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;sint maarten&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;syria&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;swaziland&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;turks and caicos islands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;chad&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;french southern territories&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;togo&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;thailand&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;tajikistan&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;tokelau&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;east timor&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;turkmenistan&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;tunisia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;tonga&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;turkey&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;trinidad and tobago&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;tuvalu&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;taiwan&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;tanzania&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;ukraine&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;uganda&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;u.s. minor outlying islands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;united states&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;uruguay&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;uzbekistan&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;vatican city&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;saint vincent and the grenadines&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;venezuela&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;british virgin islands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;u.s. virgin islands&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;vietnam&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;vanuatu&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;wallis and futuna&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;samoa&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;kosovo&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;yemen&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;mayotte&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;south africa&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;zambia&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;zimbabwe&#39;</span><span class=\\\"p\\\">]]</span> <span class=\\\"o\\\">=</span> <span class=\\\"s1\\\">&#39;united states&#39;</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">watch</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">bool</span> <span class=\\\"o\\\">=</span> <span class=\\\"kc\\\">False</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">delisted</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">bool</span> <span class=\\\"o\\\">=</span> <span class=\\\"kc\\\">False</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">jurisdiction</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span> <span class=\\\"o\\\">=</span> <span class=\\\"s1\\\">&#39;US&#39;</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">isin</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Optional</span><span class=\\\"p\\\">[</span><span class=\\\"nb\\\">str</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">=</span> <span class=\\\"kc\\\">None</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">strategy</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Union</span><span class=\\\"p\\\">[</span><span class=\\\"nb\\\">str</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">List</span><span class=\\\"p\\\">[</span><span class=\\\"nb\\\">str</span><span class=\\\"p\\\">]]</span> <span class=\\\"o\\\">=</span> <span class=\\\"o\\\">&lt;</span><span class=\\\"n\\\">factory</span><span class=\\\"o\\\">&gt;</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">strategy_comments</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Optional</span><span class=\\\"p\\\">[</span><span class=\\\"nb\\\">str</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">=</span> <span class=\\\"kc\\\">None</span></span>)</span>\"}, {\"fullname\": \"tessa.symbol.extended_symbol.ExtendedSymbol.description\", \"modulename\": \"tessa.symbol.extended_symbol\", \"qualname\": \"ExtendedSymbol.description\", \"kind\": \"variable\", \"doc\": \"<p>Informational only.</p>\\n\", \"annotation\": \": Optional[str]\", \"default_value\": \"None\"}, {\"fullname\": \"tessa.symbol.extended_symbol.ExtendedSymbol.country\", \"modulename\": \"tessa.symbol.extended_symbol\", \"qualname\": \"ExtendedSymbol.country\", \"kind\": \"variable\", \"doc\": \"<p>Country of HQ / listing.</p>\\n\", \"annotation\": \": Optional[Literal[&#x27;andorra&#x27;, &#x27;united arab emirates&#x27;, &#x27;afghanistan&#x27;, &#x27;antigua and barbuda&#x27;, &#x27;anguilla&#x27;, &#x27;albania&#x27;, &#x27;armenia&#x27;, &#x27;angola&#x27;, &#x27;antarctica&#x27;, &#x27;argentina&#x27;, &#x27;american samoa&#x27;, &#x27;austria&#x27;, &#x27;australia&#x27;, &#x27;aruba&#x27;, &#x27;\\u00e5land&#x27;, &#x27;azerbaijan&#x27;, &#x27;bosnia and herzegovina&#x27;, &#x27;barbados&#x27;, &#x27;bangladesh&#x27;, &#x27;belgium&#x27;, &#x27;burkina faso&#x27;, &#x27;bulgaria&#x27;, &#x27;bahrain&#x27;, &#x27;burundi&#x27;, &#x27;benin&#x27;, &#x27;saint barth\\u00e9lemy&#x27;, &#x27;bermuda&#x27;, &#x27;brunei&#x27;, &#x27;bolivia&#x27;, &#x27;bonaire&#x27;, &#x27;brazil&#x27;, &#x27;bahamas&#x27;, &#x27;bhutan&#x27;, &#x27;bouvet island&#x27;, &#x27;botswana&#x27;, &#x27;belarus&#x27;, &#x27;belize&#x27;, &#x27;canada&#x27;, &#x27;cocos [keeling] islands&#x27;, &#x27;democratic republic of the congo&#x27;, &#x27;central african republic&#x27;, &#x27;republic of the congo&#x27;, &#x27;switzerland&#x27;, &#x27;ivory coast&#x27;, &#x27;cook islands&#x27;, &#x27;chile&#x27;, &#x27;cameroon&#x27;, &#x27;china&#x27;, &#x27;colombia&#x27;, &#x27;costa rica&#x27;, &#x27;cuba&#x27;, &#x27;cape verde&#x27;, &#x27;curacao&#x27;, &#x27;christmas island&#x27;, &#x27;cyprus&#x27;, &#x27;czech republic&#x27;, &#x27;germany&#x27;, &#x27;djibouti&#x27;, &#x27;denmark&#x27;, &#x27;dominica&#x27;, &#x27;dominican republic&#x27;, &#x27;algeria&#x27;, &#x27;ecuador&#x27;, &#x27;estonia&#x27;, &#x27;egypt&#x27;, &#x27;western sahara&#x27;, &#x27;eritrea&#x27;, &#x27;spain&#x27;, &#x27;ethiopia&#x27;, &#x27;finland&#x27;, &#x27;fiji&#x27;, &#x27;falkland islands&#x27;, &#x27;micronesia&#x27;, &#x27;faroe islands&#x27;, &#x27;france&#x27;, &#x27;gabon&#x27;, &#x27;united kingdom&#x27;, &#x27;grenada&#x27;, &#x27;georgia&#x27;, &#x27;french guiana&#x27;, &#x27;guernsey&#x27;, &#x27;ghana&#x27;, &#x27;gibraltar&#x27;, &#x27;greenland&#x27;, &#x27;gambia&#x27;, &#x27;guinea&#x27;, &#x27;guadeloupe&#x27;, &#x27;equatorial guinea&#x27;, &#x27;greece&#x27;, &#x27;south georgia and the south sandwich islands&#x27;, &#x27;guatemala&#x27;, &#x27;guam&#x27;, &#x27;guinea-bissau&#x27;, &#x27;guyana&#x27;, &#x27;hong kong&#x27;, &#x27;heard island and mcdonald islands&#x27;, &#x27;honduras&#x27;, &#x27;croatia&#x27;, &#x27;haiti&#x27;, &#x27;hungary&#x27;, &#x27;indonesia&#x27;, &#x27;ireland&#x27;, &#x27;israel&#x27;, &#x27;isle of man&#x27;, &#x27;india&#x27;, &#x27;british indian ocean territory&#x27;, &#x27;iraq&#x27;, &#x27;iran&#x27;, &#x27;iceland&#x27;, &#x27;italy&#x27;, &#x27;jersey&#x27;, &#x27;jamaica&#x27;, &#x27;jordan&#x27;, &#x27;japan&#x27;, &#x27;kenya&#x27;, &#x27;kyrgyzstan&#x27;, &#x27;cambodia&#x27;, &#x27;kiribati&#x27;, &#x27;comoros&#x27;, &#x27;saint kitts and nevis&#x27;, &#x27;north korea&#x27;, &#x27;south korea&#x27;, &#x27;kuwait&#x27;, &#x27;cayman islands&#x27;, &#x27;kazakhstan&#x27;, &#x27;laos&#x27;, &#x27;lebanon&#x27;, &#x27;saint lucia&#x27;, &#x27;liechtenstein&#x27;, &#x27;sri lanka&#x27;, &#x27;liberia&#x27;, &#x27;lesotho&#x27;, &#x27;lithuania&#x27;, &#x27;luxembourg&#x27;, &#x27;latvia&#x27;, &#x27;libya&#x27;, &#x27;morocco&#x27;, &#x27;monaco&#x27;, &#x27;moldova&#x27;, &#x27;montenegro&#x27;, &#x27;saint martin&#x27;, &#x27;madagascar&#x27;, &#x27;marshall islands&#x27;, &#x27;north macedonia&#x27;, &#x27;mali&#x27;, &#x27;myanmar [burma]&#x27;, &#x27;mongolia&#x27;, &#x27;macao&#x27;, &#x27;northern mariana islands&#x27;, &#x27;martinique&#x27;, &#x27;mauritania&#x27;, &#x27;montserrat&#x27;, &#x27;malta&#x27;, &#x27;mauritius&#x27;, &#x27;maldives&#x27;, &#x27;malawi&#x27;, &#x27;mexico&#x27;, &#x27;malaysia&#x27;, &#x27;mozambique&#x27;, &#x27;namibia&#x27;, &#x27;new caledonia&#x27;, &#x27;niger&#x27;, &#x27;norfolk island&#x27;, &#x27;nigeria&#x27;, &#x27;nicaragua&#x27;, &#x27;netherlands&#x27;, &#x27;norway&#x27;, &#x27;nepal&#x27;, &#x27;nauru&#x27;, &#x27;niue&#x27;, &#x27;new zealand&#x27;, &#x27;oman&#x27;, &#x27;panama&#x27;, &#x27;peru&#x27;, &#x27;french polynesia&#x27;, &#x27;papua new guinea&#x27;, &#x27;philippines&#x27;, &#x27;pakistan&#x27;, &#x27;poland&#x27;, &#x27;saint pierre and miquelon&#x27;, &#x27;pitcairn islands&#x27;, &#x27;puerto rico&#x27;, &#x27;palestine&#x27;, &#x27;portugal&#x27;, &#x27;palau&#x27;, &#x27;paraguay&#x27;, &#x27;qatar&#x27;, &#x27;r\\u00e9union&#x27;, &#x27;romania&#x27;, &#x27;serbia&#x27;, &#x27;russia&#x27;, &#x27;rwanda&#x27;, &#x27;saudi arabia&#x27;, &#x27;solomon islands&#x27;, &#x27;seychelles&#x27;, &#x27;sudan&#x27;, &#x27;sweden&#x27;, &#x27;singapore&#x27;, &#x27;saint helena&#x27;, &#x27;slovenia&#x27;, &#x27;svalbard and jan mayen&#x27;, &#x27;slovakia&#x27;, &#x27;sierra leone&#x27;, &#x27;san marino&#x27;, &#x27;senegal&#x27;, &#x27;somalia&#x27;, &#x27;suriname&#x27;, &#x27;south sudan&#x27;, &#x27;s\\u00e3o tom\\u00e9 and pr\\u00edncipe&#x27;, &#x27;el salvador&#x27;, &#x27;sint maarten&#x27;, &#x27;syria&#x27;, &#x27;swaziland&#x27;, &#x27;turks and caicos islands&#x27;, &#x27;chad&#x27;, &#x27;french southern territories&#x27;, &#x27;togo&#x27;, &#x27;thailand&#x27;, &#x27;tajikistan&#x27;, &#x27;tokelau&#x27;, &#x27;east timor&#x27;, &#x27;turkmenistan&#x27;, &#x27;tunisia&#x27;, &#x27;tonga&#x27;, &#x27;turkey&#x27;, &#x27;trinidad and tobago&#x27;, &#x27;tuvalu&#x27;, &#x27;taiwan&#x27;, &#x27;tanzania&#x27;, &#x27;ukraine&#x27;, &#x27;uganda&#x27;, &#x27;u.s. minor outlying islands&#x27;, &#x27;united states&#x27;, &#x27;uruguay&#x27;, &#x27;uzbekistan&#x27;, &#x27;vatican city&#x27;, &#x27;saint vincent and the grenadines&#x27;, &#x27;venezuela&#x27;, &#x27;british virgin islands&#x27;, &#x27;u.s. virgin islands&#x27;, &#x27;vietnam&#x27;, &#x27;vanuatu&#x27;, &#x27;wallis and futuna&#x27;, &#x27;samoa&#x27;, &#x27;kosovo&#x27;, &#x27;yemen&#x27;, &#x27;mayotte&#x27;, &#x27;south africa&#x27;, &#x27;zambia&#x27;, &#x27;zimbabwe&#x27;]]\", \"default_value\": \"&#x27;united states&#x27;\"}, {\"fullname\": \"tessa.symbol.extended_symbol.ExtendedSymbol.watch\", \"modulename\": \"tessa.symbol.extended_symbol\", \"qualname\": \"ExtendedSymbol.watch\", \"kind\": \"variable\", \"doc\": \"<p>Whether the ticker can produce alerts.</p>\\n\", \"annotation\": \": bool\", \"default_value\": \"False\"}, {\"fullname\": \"tessa.symbol.extended_symbol.ExtendedSymbol.delisted\", \"modulename\": \"tessa.symbol.extended_symbol\", \"qualname\": \"ExtendedSymbol.delisted\", \"kind\": \"variable\", \"doc\": \"<p>Used to filter certain symbols from analysis.</p>\\n\", \"annotation\": \": bool\", \"default_value\": \"False\"}, {\"fullname\": \"tessa.symbol.extended_symbol.ExtendedSymbol.jurisdiction\", \"modulename\": \"tessa.symbol.extended_symbol\", \"qualname\": \"ExtendedSymbol.jurisdiction\", \"kind\": \"variable\", \"doc\": \"<p>main jurisdiction of the underlying asset(s) (not of the title representing the\\nasset); default US, other examples: CN, EU, several, irrelevant, unknown</p>\\n\", \"annotation\": \": str\", \"default_value\": \"&#x27;US&#x27;\"}, {\"fullname\": \"tessa.symbol.extended_symbol.ExtendedSymbol.isin\", \"modulename\": \"tessa.symbol.extended_symbol\", \"qualname\": \"ExtendedSymbol.isin\", \"kind\": \"variable\", \"doc\": \"<p>Informational only.</p>\\n\", \"annotation\": \": Optional[str]\", \"default_value\": \"None\"}, {\"fullname\": \"tessa.symbol.extended_symbol.ExtendedSymbol.strategy\", \"modulename\": \"tessa.symbol.extended_symbol\", \"qualname\": \"ExtendedSymbol.strategy\", \"kind\": \"variable\", \"doc\": \"<p>One strategy or a list of several strategies. Some strategies I use:</p>\\n\\n<ul>\\n<li>F&amp;F: Fire &amp; Forget (implies HoldForGrowth)</li>\\n<li>HoldForGrowth</li>\\n<li>HoldForStability: low growth expected, but also low risk</li>\\n<li>HoldForDiversification: titles I find important for diversification</li>\\n<li>EnterIf: consider starting a position if prices for this title fall</li>\\n<li>SellIf: consider selling if prices high and/or liquidity needed</li>\\n<li>Sold: earlier holding that was sold at some point</li>\\n<li>Quarterly: quarterly invest</li>\\n</ul>\\n\", \"annotation\": \": Union[str, List[str]]\"}, {\"fullname\": \"tessa.symbol.extended_symbol.ExtendedSymbol.strategy_comments\", \"modulename\": \"tessa.symbol.extended_symbol\", \"qualname\": \"ExtendedSymbol.strategy_comments\", \"kind\": \"variable\", \"doc\": \"<p>Additional comments re strategy.</p>\\n\", \"annotation\": \": Optional[str]\", \"default_value\": \"None\"}, {\"fullname\": \"tessa.symbol.extended_symbol.ExtendedSymbol.region\", \"modulename\": \"tessa.symbol.extended_symbol\", \"qualname\": \"ExtendedSymbol.region\", \"kind\": \"variable\", \"doc\": \"<p>Will be set automatically.</p>\\n\", \"annotation\": \": str\"}, {\"fullname\": \"tessa.symbol.extended_symbol.ExtendedSymbol.get_strategy_string\", \"modulename\": \"tessa.symbol.extended_symbol\", \"qualname\": \"ExtendedSymbol.get_strategy_string\", \"kind\": \"function\", \"doc\": \"<p>Return a nice string with the strategy including comments.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"nb\\\">str</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.extended_symbol.ExtendedSymbol.price_graph\", \"modulename\": \"tessa.symbol.extended_symbol\", \"qualname\": \"ExtendedSymbol.price_graph\", \"kind\": \"function\", \"doc\": \"<p>Add some extra information to the price graph.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span>, </span><span class=\\\"param\\\"><span class=\\\"n\\\">monthsback</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">int</span> <span class=\\\"o\\\">=</span> <span class=\\\"mi\\\">6</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"nb\\\">tuple</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.geo\", \"modulename\": \"tessa.symbol.geo\", \"kind\": \"module\", \"doc\": \"<p>Geography helpers for <code>ExtendedSymbol</code>.</p>\\n\"}, {\"fullname\": \"tessa.symbol.geo.countrynames\", \"modulename\": \"tessa.symbol.geo.countrynames\", \"kind\": \"module\", \"doc\": \"<p><code>CountryName</code> type.</p>\\n\"}, {\"fullname\": \"tessa.symbol.geo.countrynames.CountryName\", \"modulename\": \"tessa.symbol.geo.countrynames\", \"qualname\": \"CountryName\", \"kind\": \"variable\", \"doc\": \"<p></p>\\n\", \"default_value\": \"typing.Literal[&#x27;andorra&#x27;, &#x27;united arab emirates&#x27;, &#x27;afghanistan&#x27;, &#x27;antigua and barbuda&#x27;, &#x27;anguilla&#x27;, &#x27;albania&#x27;, &#x27;armenia&#x27;, &#x27;angola&#x27;, &#x27;antarctica&#x27;, &#x27;argentina&#x27;, &#x27;american samoa&#x27;, &#x27;austria&#x27;, &#x27;australia&#x27;, &#x27;aruba&#x27;, &#x27;\\u00e5land&#x27;, &#x27;azerbaijan&#x27;, &#x27;bosnia and herzegovina&#x27;, &#x27;barbados&#x27;, &#x27;bangladesh&#x27;, &#x27;belgium&#x27;, &#x27;burkina faso&#x27;, &#x27;bulgaria&#x27;, &#x27;bahrain&#x27;, &#x27;burundi&#x27;, &#x27;benin&#x27;, &#x27;saint barth\\u00e9lemy&#x27;, &#x27;bermuda&#x27;, &#x27;brunei&#x27;, &#x27;bolivia&#x27;, &#x27;bonaire&#x27;, &#x27;brazil&#x27;, &#x27;bahamas&#x27;, &#x27;bhutan&#x27;, &#x27;bouvet island&#x27;, &#x27;botswana&#x27;, &#x27;belarus&#x27;, &#x27;belize&#x27;, &#x27;canada&#x27;, &#x27;cocos [keeling] islands&#x27;, &#x27;democratic republic of the congo&#x27;, &#x27;central african republic&#x27;, &#x27;republic of the congo&#x27;, &#x27;switzerland&#x27;, &#x27;ivory coast&#x27;, &#x27;cook islands&#x27;, &#x27;chile&#x27;, &#x27;cameroon&#x27;, &#x27;china&#x27;, &#x27;colombia&#x27;, &#x27;costa rica&#x27;, &#x27;cuba&#x27;, &#x27;cape verde&#x27;, &#x27;curacao&#x27;, &#x27;christmas island&#x27;, &#x27;cyprus&#x27;, &#x27;czech republic&#x27;, &#x27;germany&#x27;, &#x27;djibouti&#x27;, &#x27;denmark&#x27;, &#x27;dominica&#x27;, &#x27;dominican republic&#x27;, &#x27;algeria&#x27;, &#x27;ecuador&#x27;, &#x27;estonia&#x27;, &#x27;egypt&#x27;, &#x27;western sahara&#x27;, &#x27;eritrea&#x27;, &#x27;spain&#x27;, &#x27;ethiopia&#x27;, &#x27;finland&#x27;, &#x27;fiji&#x27;, &#x27;falkland islands&#x27;, &#x27;micronesia&#x27;, &#x27;faroe islands&#x27;, &#x27;france&#x27;, &#x27;gabon&#x27;, &#x27;united kingdom&#x27;, &#x27;grenada&#x27;, &#x27;georgia&#x27;, &#x27;french guiana&#x27;, &#x27;guernsey&#x27;, &#x27;ghana&#x27;, &#x27;gibraltar&#x27;, &#x27;greenland&#x27;, &#x27;gambia&#x27;, &#x27;guinea&#x27;, &#x27;guadeloupe&#x27;, &#x27;equatorial guinea&#x27;, &#x27;greece&#x27;, &#x27;south georgia and the south sandwich islands&#x27;, &#x27;guatemala&#x27;, &#x27;guam&#x27;, &#x27;guinea-bissau&#x27;, &#x27;guyana&#x27;, &#x27;hong kong&#x27;, &#x27;heard island and mcdonald islands&#x27;, &#x27;honduras&#x27;, &#x27;croatia&#x27;, &#x27;haiti&#x27;, &#x27;hungary&#x27;, &#x27;indonesia&#x27;, &#x27;ireland&#x27;, &#x27;israel&#x27;, &#x27;isle of man&#x27;, &#x27;india&#x27;, &#x27;british indian ocean territory&#x27;, &#x27;iraq&#x27;, &#x27;iran&#x27;, &#x27;iceland&#x27;, &#x27;italy&#x27;, &#x27;jersey&#x27;, &#x27;jamaica&#x27;, &#x27;jordan&#x27;, &#x27;japan&#x27;, &#x27;kenya&#x27;, &#x27;kyrgyzstan&#x27;, &#x27;cambodia&#x27;, &#x27;kiribati&#x27;, &#x27;comoros&#x27;, &#x27;saint kitts and nevis&#x27;, &#x27;north korea&#x27;, &#x27;south korea&#x27;, &#x27;kuwait&#x27;, &#x27;cayman islands&#x27;, &#x27;kazakhstan&#x27;, &#x27;laos&#x27;, &#x27;lebanon&#x27;, &#x27;saint lucia&#x27;, &#x27;liechtenstein&#x27;, &#x27;sri lanka&#x27;, &#x27;liberia&#x27;, &#x27;lesotho&#x27;, &#x27;lithuania&#x27;, &#x27;luxembourg&#x27;, &#x27;latvia&#x27;, &#x27;libya&#x27;, &#x27;morocco&#x27;, &#x27;monaco&#x27;, &#x27;moldova&#x27;, &#x27;montenegro&#x27;, &#x27;saint martin&#x27;, &#x27;madagascar&#x27;, &#x27;marshall islands&#x27;, &#x27;north macedonia&#x27;, &#x27;mali&#x27;, &#x27;myanmar [burma]&#x27;, &#x27;mongolia&#x27;, &#x27;macao&#x27;, &#x27;northern mariana islands&#x27;, &#x27;martinique&#x27;, &#x27;mauritania&#x27;, &#x27;montserrat&#x27;, &#x27;malta&#x27;, &#x27;mauritius&#x27;, &#x27;maldives&#x27;, &#x27;malawi&#x27;, &#x27;mexico&#x27;, &#x27;malaysia&#x27;, &#x27;mozambique&#x27;, &#x27;namibia&#x27;, &#x27;new caledonia&#x27;, &#x27;niger&#x27;, &#x27;norfolk island&#x27;, &#x27;nigeria&#x27;, &#x27;nicaragua&#x27;, &#x27;netherlands&#x27;, &#x27;norway&#x27;, &#x27;nepal&#x27;, &#x27;nauru&#x27;, &#x27;niue&#x27;, &#x27;new zealand&#x27;, &#x27;oman&#x27;, &#x27;panama&#x27;, &#x27;peru&#x27;, &#x27;french polynesia&#x27;, &#x27;papua new guinea&#x27;, &#x27;philippines&#x27;, &#x27;pakistan&#x27;, &#x27;poland&#x27;, &#x27;saint pierre and miquelon&#x27;, &#x27;pitcairn islands&#x27;, &#x27;puerto rico&#x27;, &#x27;palestine&#x27;, &#x27;portugal&#x27;, &#x27;palau&#x27;, &#x27;paraguay&#x27;, &#x27;qatar&#x27;, &#x27;r\\u00e9union&#x27;, &#x27;romania&#x27;, &#x27;serbia&#x27;, &#x27;russia&#x27;, &#x27;rwanda&#x27;, &#x27;saudi arabia&#x27;, &#x27;solomon islands&#x27;, &#x27;seychelles&#x27;, &#x27;sudan&#x27;, &#x27;sweden&#x27;, &#x27;singapore&#x27;, &#x27;saint helena&#x27;, &#x27;slovenia&#x27;, &#x27;svalbard and jan mayen&#x27;, &#x27;slovakia&#x27;, &#x27;sierra leone&#x27;, &#x27;san marino&#x27;, &#x27;senegal&#x27;, &#x27;somalia&#x27;, &#x27;suriname&#x27;, &#x27;south sudan&#x27;, &#x27;s\\u00e3o tom\\u00e9 and pr\\u00edncipe&#x27;, &#x27;el salvador&#x27;, &#x27;sint maarten&#x27;, &#x27;syria&#x27;, &#x27;swaziland&#x27;, &#x27;turks and caicos islands&#x27;, &#x27;chad&#x27;, &#x27;french southern territories&#x27;, &#x27;togo&#x27;, &#x27;thailand&#x27;, &#x27;tajikistan&#x27;, &#x27;tokelau&#x27;, &#x27;east timor&#x27;, &#x27;turkmenistan&#x27;, &#x27;tunisia&#x27;, &#x27;tonga&#x27;, &#x27;turkey&#x27;, &#x27;trinidad and tobago&#x27;, &#x27;tuvalu&#x27;, &#x27;taiwan&#x27;, &#x27;tanzania&#x27;, &#x27;ukraine&#x27;, &#x27;uganda&#x27;, &#x27;u.s. minor outlying islands&#x27;, &#x27;united states&#x27;, &#x27;uruguay&#x27;, &#x27;uzbekistan&#x27;, &#x27;vatican city&#x27;, &#x27;saint vincent and the grenadines&#x27;, &#x27;venezuela&#x27;, &#x27;british virgin islands&#x27;, &#x27;u.s. virgin islands&#x27;, &#x27;vietnam&#x27;, &#x27;vanuatu&#x27;, &#x27;wallis and futuna&#x27;, &#x27;samoa&#x27;, &#x27;kosovo&#x27;, &#x27;yemen&#x27;, &#x27;mayotte&#x27;, &#x27;south africa&#x27;, &#x27;zambia&#x27;, &#x27;zimbabwe&#x27;]\"}, {\"fullname\": \"tessa.symbol.geo.jurisdiction2region\", \"modulename\": \"tessa.symbol.geo.jurisdiction2region\", \"kind\": \"module\", \"doc\": \"<p>Jurisdiction to region mapping.</p>\\n\"}, {\"fullname\": \"tessa.symbol.geo.jurisdiction2region.region2name\", \"modulename\": \"tessa.symbol.geo.jurisdiction2region\", \"qualname\": \"region2name\", \"kind\": \"variable\", \"doc\": \"<p></p>\\n\", \"default_value\": \"{&#x27;AF&#x27;: &#x27;Africa&#x27;, &#x27;AS&#x27;: &#x27;Asia sans China&#x27;, &#x27;EU&#x27;: &#x27;Europe&#x27;, &#x27;NA&#x27;: &#x27;North America&#x27;, &#x27;SA&#x27;: &#x27;South America&#x27;, &#x27;OC&#x27;: &#x27;Oceania&#x27;, &#x27;AN&#x27;: &#x27;Antarctica&#x27;, &#x27;OT&#x27;: &#x27;Other&#x27;, &#x27;CH&#x27;: &#x27;Switzerland&#x27;, &#x27;CN&#x27;: &#x27;China&#x27;}\"}, {\"fullname\": \"tessa.symbol.geo.jurisdiction2region.jurisdiction2region\", \"modulename\": \"tessa.symbol.geo.jurisdiction2region\", \"qualname\": \"jurisdiction2region\", \"kind\": \"variable\", \"doc\": \"<p></p>\\n\", \"default_value\": \"{&#x27;AD&#x27;: &#x27;EU&#x27;, &#x27;AE&#x27;: &#x27;AS&#x27;, &#x27;AF&#x27;: &#x27;AS&#x27;, &#x27;AG&#x27;: &#x27;NA&#x27;, &#x27;AI&#x27;: &#x27;NA&#x27;, &#x27;AL&#x27;: &#x27;EU&#x27;, &#x27;AM&#x27;: &#x27;AS&#x27;, &#x27;AO&#x27;: &#x27;AF&#x27;, &#x27;AQ&#x27;: &#x27;AN&#x27;, &#x27;AR&#x27;: &#x27;SA&#x27;, &#x27;AS&#x27;: &#x27;OC&#x27;, &#x27;AT&#x27;: &#x27;EU&#x27;, &#x27;AU&#x27;: &#x27;OC&#x27;, &#x27;AW&#x27;: &#x27;NA&#x27;, &#x27;AX&#x27;: &#x27;EU&#x27;, &#x27;AZ&#x27;: &#x27;AS&#x27;, &#x27;BA&#x27;: &#x27;EU&#x27;, &#x27;BB&#x27;: &#x27;NA&#x27;, &#x27;BD&#x27;: &#x27;AS&#x27;, &#x27;BE&#x27;: &#x27;EU&#x27;, &#x27;BF&#x27;: &#x27;AF&#x27;, &#x27;BG&#x27;: &#x27;EU&#x27;, &#x27;BH&#x27;: &#x27;AS&#x27;, &#x27;BI&#x27;: &#x27;AF&#x27;, &#x27;BJ&#x27;: &#x27;AF&#x27;, &#x27;BL&#x27;: &#x27;NA&#x27;, &#x27;BM&#x27;: &#x27;NA&#x27;, &#x27;BN&#x27;: &#x27;AS&#x27;, &#x27;BO&#x27;: &#x27;SA&#x27;, &#x27;BQ&#x27;: &#x27;NA&#x27;, &#x27;BR&#x27;: &#x27;SA&#x27;, &#x27;BS&#x27;: &#x27;NA&#x27;, &#x27;BT&#x27;: &#x27;AS&#x27;, &#x27;BV&#x27;: &#x27;AN&#x27;, &#x27;BW&#x27;: &#x27;AF&#x27;, &#x27;BY&#x27;: &#x27;EU&#x27;, &#x27;BZ&#x27;: &#x27;NA&#x27;, &#x27;CA&#x27;: &#x27;NA&#x27;, &#x27;CC&#x27;: &#x27;AS&#x27;, &#x27;CD&#x27;: &#x27;AF&#x27;, &#x27;CF&#x27;: &#x27;AF&#x27;, &#x27;CG&#x27;: &#x27;AF&#x27;, &#x27;CH&#x27;: &#x27;CH&#x27;, &#x27;CI&#x27;: &#x27;AF&#x27;, &#x27;CK&#x27;: &#x27;OC&#x27;, &#x27;CL&#x27;: &#x27;SA&#x27;, &#x27;CM&#x27;: &#x27;AF&#x27;, &#x27;CN&#x27;: &#x27;CN&#x27;, &#x27;CO&#x27;: &#x27;SA&#x27;, &#x27;CR&#x27;: &#x27;NA&#x27;, &#x27;CU&#x27;: &#x27;NA&#x27;, &#x27;CV&#x27;: &#x27;AF&#x27;, &#x27;CW&#x27;: &#x27;NA&#x27;, &#x27;CX&#x27;: &#x27;AS&#x27;, &#x27;CY&#x27;: &#x27;EU&#x27;, &#x27;CZ&#x27;: &#x27;EU&#x27;, &#x27;DE&#x27;: &#x27;EU&#x27;, &#x27;DJ&#x27;: &#x27;AF&#x27;, &#x27;DK&#x27;: &#x27;EU&#x27;, &#x27;DM&#x27;: &#x27;NA&#x27;, &#x27;DO&#x27;: &#x27;NA&#x27;, &#x27;DZ&#x27;: &#x27;AF&#x27;, &#x27;EC&#x27;: &#x27;SA&#x27;, &#x27;EE&#x27;: &#x27;EU&#x27;, &#x27;EG&#x27;: &#x27;AF&#x27;, &#x27;EH&#x27;: &#x27;AF&#x27;, &#x27;ER&#x27;: &#x27;AF&#x27;, &#x27;ES&#x27;: &#x27;EU&#x27;, &#x27;ET&#x27;: &#x27;AF&#x27;, &#x27;FI&#x27;: &#x27;EU&#x27;, &#x27;FJ&#x27;: &#x27;OC&#x27;, &#x27;FK&#x27;: &#x27;SA&#x27;, &#x27;FM&#x27;: &#x27;OC&#x27;, &#x27;FO&#x27;: &#x27;EU&#x27;, &#x27;FR&#x27;: &#x27;EU&#x27;, &#x27;GA&#x27;: &#x27;AF&#x27;, &#x27;GB&#x27;: &#x27;EU&#x27;, &#x27;GD&#x27;: &#x27;NA&#x27;, &#x27;GE&#x27;: &#x27;AS&#x27;, &#x27;GF&#x27;: &#x27;SA&#x27;, &#x27;GG&#x27;: &#x27;EU&#x27;, &#x27;GH&#x27;: &#x27;AF&#x27;, &#x27;GI&#x27;: &#x27;EU&#x27;, &#x27;GL&#x27;: &#x27;NA&#x27;, &#x27;GM&#x27;: &#x27;AF&#x27;, &#x27;GN&#x27;: &#x27;AF&#x27;, &#x27;GP&#x27;: &#x27;NA&#x27;, &#x27;GQ&#x27;: &#x27;AF&#x27;, &#x27;GR&#x27;: &#x27;EU&#x27;, &#x27;GS&#x27;: &#x27;AN&#x27;, &#x27;GT&#x27;: &#x27;NA&#x27;, &#x27;GU&#x27;: &#x27;OC&#x27;, &#x27;GW&#x27;: &#x27;AF&#x27;, &#x27;GY&#x27;: &#x27;SA&#x27;, &#x27;HK&#x27;: &#x27;AS&#x27;, &#x27;HM&#x27;: &#x27;AN&#x27;, &#x27;HN&#x27;: &#x27;NA&#x27;, &#x27;HR&#x27;: &#x27;EU&#x27;, &#x27;HT&#x27;: &#x27;NA&#x27;, &#x27;HU&#x27;: &#x27;EU&#x27;, &#x27;ID&#x27;: &#x27;AS&#x27;, &#x27;IE&#x27;: &#x27;EU&#x27;, &#x27;IL&#x27;: &#x27;AS&#x27;, &#x27;IM&#x27;: &#x27;EU&#x27;, &#x27;IN&#x27;: &#x27;AS&#x27;, &#x27;IO&#x27;: &#x27;AS&#x27;, &#x27;IQ&#x27;: &#x27;AS&#x27;, &#x27;IR&#x27;: &#x27;AS&#x27;, &#x27;IS&#x27;: &#x27;EU&#x27;, &#x27;IT&#x27;: &#x27;EU&#x27;, &#x27;JE&#x27;: &#x27;EU&#x27;, &#x27;JM&#x27;: &#x27;NA&#x27;, &#x27;JO&#x27;: &#x27;AS&#x27;, &#x27;JP&#x27;: &#x27;AS&#x27;, &#x27;KE&#x27;: &#x27;AF&#x27;, &#x27;KG&#x27;: &#x27;AS&#x27;, &#x27;KH&#x27;: &#x27;AS&#x27;, &#x27;KI&#x27;: &#x27;OC&#x27;, &#x27;KM&#x27;: &#x27;AF&#x27;, &#x27;KN&#x27;: &#x27;NA&#x27;, &#x27;KP&#x27;: &#x27;AS&#x27;, &#x27;KR&#x27;: &#x27;AS&#x27;, &#x27;KW&#x27;: &#x27;AS&#x27;, &#x27;KY&#x27;: &#x27;NA&#x27;, &#x27;KZ&#x27;: &#x27;AS&#x27;, &#x27;LA&#x27;: &#x27;AS&#x27;, &#x27;LB&#x27;: &#x27;AS&#x27;, &#x27;LC&#x27;: &#x27;NA&#x27;, &#x27;LI&#x27;: &#x27;EU&#x27;, &#x27;LK&#x27;: &#x27;AS&#x27;, &#x27;LR&#x27;: &#x27;AF&#x27;, &#x27;LS&#x27;: &#x27;AF&#x27;, &#x27;LT&#x27;: &#x27;EU&#x27;, &#x27;LU&#x27;: &#x27;EU&#x27;, &#x27;LV&#x27;: &#x27;EU&#x27;, &#x27;LY&#x27;: &#x27;AF&#x27;, &#x27;MA&#x27;: &#x27;AF&#x27;, &#x27;MC&#x27;: &#x27;EU&#x27;, &#x27;MD&#x27;: &#x27;EU&#x27;, &#x27;ME&#x27;: &#x27;EU&#x27;, &#x27;MF&#x27;: &#x27;NA&#x27;, &#x27;MG&#x27;: &#x27;AF&#x27;, &#x27;MH&#x27;: &#x27;OC&#x27;, &#x27;MK&#x27;: &#x27;EU&#x27;, &#x27;ML&#x27;: &#x27;AF&#x27;, &#x27;MM&#x27;: &#x27;AS&#x27;, &#x27;MN&#x27;: &#x27;AS&#x27;, &#x27;MO&#x27;: &#x27;AS&#x27;, &#x27;MP&#x27;: &#x27;OC&#x27;, &#x27;MQ&#x27;: &#x27;NA&#x27;, &#x27;MR&#x27;: &#x27;AF&#x27;, &#x27;MS&#x27;: &#x27;NA&#x27;, &#x27;MT&#x27;: &#x27;EU&#x27;, &#x27;MU&#x27;: &#x27;AF&#x27;, &#x27;MV&#x27;: &#x27;AS&#x27;, &#x27;MW&#x27;: &#x27;AF&#x27;, &#x27;MX&#x27;: &#x27;NA&#x27;, &#x27;MY&#x27;: &#x27;AS&#x27;, &#x27;MZ&#x27;: &#x27;AF&#x27;, &#x27;NA&#x27;: &#x27;AF&#x27;, &#x27;NC&#x27;: &#x27;OC&#x27;, &#x27;NE&#x27;: &#x27;AF&#x27;, &#x27;NF&#x27;: &#x27;OC&#x27;, &#x27;NG&#x27;: &#x27;AF&#x27;, &#x27;NI&#x27;: &#x27;NA&#x27;, &#x27;NL&#x27;: &#x27;EU&#x27;, &#x27;NO&#x27;: &#x27;EU&#x27;, &#x27;NP&#x27;: &#x27;AS&#x27;, &#x27;NR&#x27;: &#x27;OC&#x27;, &#x27;NU&#x27;: &#x27;OC&#x27;, &#x27;NZ&#x27;: &#x27;OC&#x27;, &#x27;OM&#x27;: &#x27;AS&#x27;, &#x27;PA&#x27;: &#x27;NA&#x27;, &#x27;PE&#x27;: &#x27;SA&#x27;, &#x27;PF&#x27;: &#x27;OC&#x27;, &#x27;PG&#x27;: &#x27;OC&#x27;, &#x27;PH&#x27;: &#x27;AS&#x27;, &#x27;PK&#x27;: &#x27;AS&#x27;, &#x27;PL&#x27;: &#x27;EU&#x27;, &#x27;PM&#x27;: &#x27;NA&#x27;, &#x27;PN&#x27;: &#x27;OC&#x27;, &#x27;PR&#x27;: &#x27;NA&#x27;, &#x27;PS&#x27;: &#x27;AS&#x27;, &#x27;PT&#x27;: &#x27;EU&#x27;, &#x27;PW&#x27;: &#x27;OC&#x27;, &#x27;PY&#x27;: &#x27;SA&#x27;, &#x27;QA&#x27;: &#x27;AS&#x27;, &#x27;RE&#x27;: &#x27;AF&#x27;, &#x27;RO&#x27;: &#x27;EU&#x27;, &#x27;RS&#x27;: &#x27;EU&#x27;, &#x27;RU&#x27;: &#x27;EU&#x27;, &#x27;RW&#x27;: &#x27;AF&#x27;, &#x27;SA&#x27;: &#x27;AS&#x27;, &#x27;SB&#x27;: &#x27;OC&#x27;, &#x27;SC&#x27;: &#x27;AF&#x27;, &#x27;SD&#x27;: &#x27;AF&#x27;, &#x27;SE&#x27;: &#x27;EU&#x27;, &#x27;SG&#x27;: &#x27;AS&#x27;, &#x27;SH&#x27;: &#x27;AF&#x27;, &#x27;SI&#x27;: &#x27;EU&#x27;, &#x27;SJ&#x27;: &#x27;EU&#x27;, &#x27;SK&#x27;: &#x27;EU&#x27;, &#x27;SL&#x27;: &#x27;AF&#x27;, &#x27;SM&#x27;: &#x27;EU&#x27;, &#x27;SN&#x27;: &#x27;AF&#x27;, &#x27;SO&#x27;: &#x27;AF&#x27;, &#x27;SR&#x27;: &#x27;SA&#x27;, &#x27;SS&#x27;: &#x27;AF&#x27;, &#x27;ST&#x27;: &#x27;AF&#x27;, &#x27;SV&#x27;: &#x27;NA&#x27;, &#x27;SX&#x27;: &#x27;NA&#x27;, &#x27;SY&#x27;: &#x27;AS&#x27;, &#x27;SZ&#x27;: &#x27;AF&#x27;, &#x27;TC&#x27;: &#x27;NA&#x27;, &#x27;TD&#x27;: &#x27;AF&#x27;, &#x27;TF&#x27;: &#x27;AN&#x27;, &#x27;TG&#x27;: &#x27;AF&#x27;, &#x27;TH&#x27;: &#x27;AS&#x27;, &#x27;TJ&#x27;: &#x27;AS&#x27;, &#x27;TK&#x27;: &#x27;OC&#x27;, &#x27;TL&#x27;: &#x27;OC&#x27;, &#x27;TM&#x27;: &#x27;AS&#x27;, &#x27;TN&#x27;: &#x27;AF&#x27;, &#x27;TO&#x27;: &#x27;OC&#x27;, &#x27;TR&#x27;: &#x27;AS&#x27;, &#x27;TT&#x27;: &#x27;NA&#x27;, &#x27;TV&#x27;: &#x27;OC&#x27;, &#x27;TW&#x27;: &#x27;AS&#x27;, &#x27;TZ&#x27;: &#x27;AF&#x27;, &#x27;UA&#x27;: &#x27;EU&#x27;, &#x27;UG&#x27;: &#x27;AF&#x27;, &#x27;UM&#x27;: &#x27;OC&#x27;, &#x27;US&#x27;: &#x27;NA&#x27;, &#x27;UY&#x27;: &#x27;SA&#x27;, &#x27;UZ&#x27;: &#x27;AS&#x27;, &#x27;VA&#x27;: &#x27;EU&#x27;, &#x27;VC&#x27;: &#x27;NA&#x27;, &#x27;VE&#x27;: &#x27;SA&#x27;, &#x27;VG&#x27;: &#x27;NA&#x27;, &#x27;VI&#x27;: &#x27;NA&#x27;, &#x27;VN&#x27;: &#x27;AS&#x27;, &#x27;VU&#x27;: &#x27;OC&#x27;, &#x27;WF&#x27;: &#x27;OC&#x27;, &#x27;WS&#x27;: &#x27;OC&#x27;, &#x27;XK&#x27;: &#x27;EU&#x27;, &#x27;YE&#x27;: &#x27;AS&#x27;, &#x27;YT&#x27;: &#x27;AF&#x27;, &#x27;ZA&#x27;: &#x27;AF&#x27;, &#x27;ZM&#x27;: &#x27;AF&#x27;, &#x27;ZW&#x27;: &#x27;AF&#x27;, &#x27;EU&#x27;: &#x27;EU&#x27;, &#x27;irrelevant&#x27;: &#x27;OT&#x27;, &#x27;several&#x27;: &#x27;OT&#x27;, &#x27;unknown&#x27;: &#x27;OT&#x27;}\"}, {\"fullname\": \"tessa.symbol.geo.jurisdiction2region.map_jurisdiction_to_region\", \"modulename\": \"tessa.symbol.geo.jurisdiction2region\", \"qualname\": \"map_jurisdiction_to_region\", \"kind\": \"function\", \"doc\": \"<p>Map jurisdiction to region.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">jur</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"nb\\\">str</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.symbol\", \"modulename\": \"tessa.symbol.symbol\", \"kind\": \"module\", \"doc\": \"<p>Symbol class.</p>\\n\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol\", \"kind\": \"class\", \"doc\": \"<p>Symbol class. Encapsulates all the relevant information around a financial symbol\\nand some functionality to get price information, display graphs, etc.</p>\\n\\n<p>Notes:</p>\\n\\n<ul>\\n<li>Price-related functions rely on caching happening on lower levels to be efficient;\\nthis is fulfilled thanks to the way tessa's caching works.</li>\\n<li>The initializers don't hit the network -- it will only be hit when accessing the\\nprice methods or related methods such as <code>currency</code>.</li>\\n</ul>\\n\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol.__init__\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol.__init__\", \"kind\": \"function\", \"doc\": \"<p></p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"n\\\">name</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">query</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Optional</span><span class=\\\"p\\\">[</span><span class=\\\"nb\\\">str</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">=</span> <span class=\\\"kc\\\">None</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">source</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Literal</span><span class=\\\"p\\\">[</span><span class=\\\"s1\\\">&#39;yahoo&#39;</span><span class=\\\"p\\\">,</span> <span class=\\\"s1\\\">&#39;coingecko&#39;</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">=</span> <span class=\\\"s1\\\">&#39;yahoo&#39;</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">aliases</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">list</span><span class=\\\"p\\\">[</span><span class=\\\"nb\\\">str</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">=</span> <span class=\\\"o\\\">&lt;</span><span class=\\\"n\\\">factory</span><span class=\\\"o\\\">&gt;</span></span>)</span>\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol.name\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol.name\", \"kind\": \"variable\", \"doc\": \"<p>Symbol's name and default query.</p>\\n\", \"annotation\": \": str\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol.query\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol.query\", \"kind\": \"variable\", \"doc\": \"<p>Use this to use a query that is different than the name. <code>name</code> will be used as\\nthe <code>query</code> if it is <code>None</code>.</p>\\n\", \"annotation\": \": Optional[str]\", \"default_value\": \"None\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol.source\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol.source\", \"kind\": \"variable\", \"doc\": \"<p>The source to query for this symbol. Defaults to \\\"yahoo\\\".</p>\\n\", \"annotation\": \": Literal[&#x27;yahoo&#x27;, &#x27;coingecko&#x27;]\", \"default_value\": \"&#x27;yahoo&#x27;\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol.aliases\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol.aliases\", \"kind\": \"variable\", \"doc\": \"<p>Optional other names this symbol should be found under. (Will not be used as\\nadditional queries but \\\"internally\\\" in the <code>matches</code> method.)</p>\\n\", \"annotation\": \": list[str]\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol.currency_preference\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol.currency_preference\", \"kind\": \"variable\", \"doc\": \"<p>Use this to set the preferred currency to get price information in.</p>\\n\\n<p>This is no guarantee and you should always double-check the currency that gets\\nreturned by any of the <code>price_*</code> methods in actuality. This is also the reason why\\nthis feature is slightly hidden behind an underscore.</p>\\n\\n<p>Since this is a class variable, you can set your preference once for all objects.</p>\\n\", \"annotation\": \": ClassVar[str]\", \"default_value\": \"&#x27;USD&#x27;\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol.max_date_deviation_days\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol.max_date_deviation_days\", \"kind\": \"variable\", \"doc\": \"<p>The maximum number of days a date can deviate from the requested date in the\\n<code>price_point</code> method. Use <code>None</code> to disable this check.</p>\\n\\n<p>Since this is a class variable, you can set your preference once for all objects.</p>\\n\", \"annotation\": \": ClassVar[int]\", \"default_value\": \"10\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol.p\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol.p\", \"kind\": \"function\", \"doc\": \"<p>Convenience method to print the symbol.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"kc\\\">None</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol.to_yaml\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol.to_yaml\", \"kind\": \"function\", \"doc\": \"<p>Return a YAML representation of this symbol.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"nb\\\">str</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol.currency\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol.currency\", \"kind\": \"function\", \"doc\": \"<p>Return currency for this symbol.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"nb\\\">str</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol.price_latest\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol.price_latest\", \"kind\": \"function\", \"doc\": \"<p>Return the latest close price.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">types</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">PricePoint</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol.price_history\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol.price_history\", \"kind\": \"function\", \"doc\": \"<p>Return a tuple of the full price history.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">types</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">PriceHistory</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol.price_point\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol.price_point\", \"kind\": \"function\", \"doc\": \"<p>Look up price at given date <code>when</code>. Look for the closest point in time if the\\nexact point in time is not found.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"bp\\\">self</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">when</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Union</span><span class=\\\"p\\\">[</span><span class=\\\"nb\\\">str</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">pandas</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">_libs</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">tslibs</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">timestamps</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Timestamp</span><span class=\\\"p\\\">]</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">price</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">types</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">PricePoint</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol.price_graph\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol.price_graph\", \"kind\": \"function\", \"doc\": \"<p>Display this symbol's price graph over the last monthsback months.</p>\\n\\n<p>Returns from_date, fig, and ax in order for subclass functions to add to the\\ninformation and even the graph displayed here.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span>, </span><span class=\\\"param\\\"><span class=\\\"n\\\">monthsback</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">int</span> <span class=\\\"o\\\">=</span> <span class=\\\"mi\\\">6</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"nb\\\">tuple</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.symbol.Symbol.matches\", \"modulename\": \"tessa.symbol.symbol\", \"qualname\": \"Symbol.matches\", \"kind\": \"function\", \"doc\": \"<p>Check if <code>what</code> matches this symbol's name or aliases. Also tries to match\\nthings like SPICHA if SPICHA.SW is in the aliases. Ignores case.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span>, </span><span class=\\\"param\\\"><span class=\\\"n\\\">what</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"nb\\\">bool</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.symbolcollection\", \"modulename\": \"tessa.symbol.symbolcollection\", \"kind\": \"module\", \"doc\": \"<p>SymbolCollection class.</p>\\n\"}, {\"fullname\": \"tessa.symbol.symbolcollection.SymbolCollection\", \"modulename\": \"tessa.symbol.symbolcollection\", \"qualname\": \"SymbolCollection\", \"kind\": \"class\", \"doc\": \"<p>A collection of <code>Symbol</code>s. A <code>Symbol</code>'s name is treated as a key in a collection\\nand this class enforces as much in the <code>add</code> method.</p>\\n\"}, {\"fullname\": \"tessa.symbol.symbolcollection.SymbolCollection.__init__\", \"modulename\": \"tessa.symbol.symbolcollection\", \"qualname\": \"SymbolCollection.__init__\", \"kind\": \"function\", \"doc\": \"<p>Initializer. Use <code>symbols</code> to add symbols immediately and/or use <code>add</code> method\\nlater.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"n\\\">symbols</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Optional</span><span class=\\\"p\\\">[</span><span class=\\\"n\\\">List</span><span class=\\\"p\\\">[</span><span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">]]</span> <span class=\\\"o\\\">=</span> <span class=\\\"kc\\\">None</span></span>)</span>\"}, {\"fullname\": \"tessa.symbol.symbolcollection.SymbolCollection.symbols\", \"modulename\": \"tessa.symbol.symbolcollection\", \"qualname\": \"SymbolCollection.symbols\", \"kind\": \"variable\", \"doc\": \"<p>The <code>Symbol</code>s in the collection.</p>\\n\", \"annotation\": \": List[tessa.symbol.symbol.Symbol]\"}, {\"fullname\": \"tessa.symbol.symbolcollection.SymbolCollection.add\", \"modulename\": \"tessa.symbol.symbolcollection\", \"qualname\": \"SymbolCollection.add\", \"kind\": \"function\", \"doc\": \"<p>Add symbols to the collection. Ensure names are unique.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"bp\\\">self</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">symbols</span><span class=\\\"p\\\">:</span> <span class=\\\"n\\\">Union</span><span class=\\\"p\\\">[</span><span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">,</span> <span class=\\\"n\\\">List</span><span class=\\\"p\\\">[</span><span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">]]</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbolcollection</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">SymbolCollection</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.symbolcollection.SymbolCollection.find_one\", \"modulename\": \"tessa.symbol.symbolcollection\", \"qualname\": \"SymbolCollection.find_one\", \"kind\": \"function\", \"doc\": \"<p>Find exactly one <code>Symbol</code> that matches the query. Raises <code>ValueError</code> if\\nthere's more than 1 match. Returns <code>None</code> if there's no match.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span>, </span><span class=\\\"param\\\"><span class=\\\"n\\\">what</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">Optional</span><span class=\\\"p\\\">[</span><span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">]</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.symbolcollection.SymbolCollection.find\", \"modulename\": \"tessa.symbol.symbolcollection\", \"qualname\": \"SymbolCollection.find\", \"kind\": \"function\", \"doc\": \"<p>Find all <code>Symbol</code>s that match the query.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span>, </span><span class=\\\"param\\\"><span class=\\\"n\\\">what</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"n\\\">List</span><span class=\\\"p\\\">[</span><span class=\\\"n\\\">tessa</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">symbol</span><span class=\\\"o\\\">.</span><span class=\\\"n\\\">Symbol</span><span class=\\\"p\\\">]</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.symbolcollection.SymbolCollection.load_yaml\", \"modulename\": \"tessa.symbol.symbolcollection\", \"qualname\": \"SymbolCollection.load_yaml\", \"kind\": \"function\", \"doc\": \"<p>Load symbols from a YAML file.</p>\\n\\n<ul>\\n<li><code>yaml_file</code>: Name/path of file to load.</li>\\n<li><code>which_class</code>: The class to be instantiated, can be used to instatiate\\nsubclasses of <code>Symbol</code>.</li>\\n</ul>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code multiline\\\">(<span class=\\\"param\\\">\\t<span class=\\\"bp\\\">self</span>,</span><span class=\\\"param\\\">\\t<span class=\\\"n\\\">yaml_file</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span>,</span><span class=\\\"param\\\">\\twhich_class: Type[tessa.symbol.symbol.Symbol] = &lt;class &#x27;tessa.symbol.symbol.Symbol&#x27;&gt;</span><span class=\\\"return-annotation\\\">) -> <span class=\\\"kc\\\">None</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.symbolcollection.SymbolCollection.to_yaml\", \"modulename\": \"tessa.symbol.symbolcollection\", \"qualname\": \"SymbolCollection.to_yaml\", \"kind\": \"function\", \"doc\": \"<p>Return a YAML representation of all symbols.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"nb\\\">str</span>:</span></span>\", \"funcdef\": \"def\"}, {\"fullname\": \"tessa.symbol.symbolcollection.SymbolCollection.save_yaml\", \"modulename\": \"tessa.symbol.symbolcollection\", \"qualname\": \"SymbolCollection.save_yaml\", \"kind\": \"function\", \"doc\": \"<p>Save symbols to a YAML file.</p>\\n\", \"signature\": \"<span class=\\\"signature pdoc-code condensed\\\">(<span class=\\\"param\\\"><span class=\\\"bp\\\">self</span>, </span><span class=\\\"param\\\"><span class=\\\"n\\\">yaml_file</span><span class=\\\"p\\\">:</span> <span class=\\\"nb\\\">str</span></span><span class=\\\"return-annotation\\\">) -> <span class=\\\"kc\\\">None</span>:</span></span>\", \"funcdef\": \"def\"}];\n\n    // mirrored in build-search-index.js (part 1)\n    // Also split on html tags. this is a cheap heuristic, but good enough.\n    elasticlunr.tokenizer.setSeperator(/[\\s\\-.;&_'\"=,()]+|<[^>]*>/);\n\n    let searchIndex;\n    if (docs._isPrebuiltIndex) {\n        console.info(\"using precompiled search index\");\n        searchIndex = elasticlunr.Index.load(docs);\n    } else {\n        console.time(\"building search index\");\n        // mirrored in build-search-index.js (part 2)\n        searchIndex = elasticlunr(function () {\n            this.pipeline.remove(elasticlunr.stemmer);\n            this.pipeline.remove(elasticlunr.stopWordFilter);\n            this.addField(\"qualname\");\n            this.addField(\"fullname\");\n            this.addField(\"annotation\");\n            this.addField(\"default_value\");\n            this.addField(\"signature\");\n            this.addField(\"bases\");\n            this.addField(\"doc\");\n            this.setRef(\"fullname\");\n        });\n        for (let doc of docs) {\n            searchIndex.addDoc(doc);\n        }\n        console.timeEnd(\"building search index\");\n    }\n\n    return (term) => searchIndex.search(term, {\n        fields: {\n            qualname: {boost: 4},\n            fullname: {boost: 2},\n            annotation: {boost: 2},\n            default_value: {boost: 2},\n            signature: {boost: 2},\n            bases: {boost: 2},\n            doc: {boost: 1},\n        },\n        expand: true\n    });\n})();","path":null,"size_bytes":159785,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tests/sources/test_sources.py":{"content":"\"\"\"Sources-related tests.\"\"\"\n\n# pylint: disable=missing-docstring\n\nimport time\nimport warnings\nimport pytest\nimport requests\nfrom tessa.price.types import RateLimitHitError\nfrom tessa.sources import rate_limiter, Source, sources\nfrom tessa.price import PriceHistory\n\n\ndef test_get_source():\n    src = sources.get_source(\"yahoo\")\n    assert isinstance(src, sources.Source)\n    assert callable(src.get_price_history)\n    assert callable(src.get_search_results)\n    assert isinstance(src.rate_limiter, rate_limiter.RateLimiter)\n\n\ndef test_get_unknown_source():\n    with pytest.raises(ValueError):\n        sources.get_source(\"unknown_source\")  # type: ignore\n\n\ndef test_get_all_sources():\n    assert all(isinstance(s, sources.Source) for s in sources.get_all_sources())\n\n\ndef test_resetting_rate_limiters():\n    sources.get_source(\"yahoo\").rate_limiter.count_limited_calls = 7\n    assert sources.get_source(\"yahoo\").rate_limiter.count_limited_calls == 7\n    sources.reset_rate_limiters()\n    assert sources.get_source(\"yahoo\").rate_limiter.count_limited_calls == 0\n\n\n# ----- get_price_history_bruteforcefully tests -----\n\n\ndef test_get_price_history_bruteforcefully_success(mocker):\n    def mock_get_price_history_success(*_, **__) -> PriceHistory:\n        return PriceHistory(df=None, currency=None)\n\n    mocker.patch(\"warnings.warn\")\n    source = Source(\n        get_price_history=mock_get_price_history_success,\n        get_search_results=None,\n        rate_limiter=rate_limiter.RateLimiter(wait_seconds=1),\n    )\n    source.get_price_history_bruteforcefully(\"BTC\")\n    warnings.warn.assert_not_called()\n\n\ndef test_get_price_history_bruteforcefully_exceeds_max_tries(mocker):\n    def mock_get_price_history_retryable_error(*_, **__) -> PriceHistory:\n        response = requests.Response()\n        response.status_code = 504\n        raise requests.HTTPError(response=response)\n\n    mocker.patch(\"warnings.warn\")\n    source = Source(\n        get_price_history=mock_get_price_history_retryable_error,\n        get_search_results=None,\n        rate_limiter=None,\n    )\n    with pytest.raises(\n        ConnectionError, match=\"Cannot access source, even after 100 tries\"\n    ):\n        source.get_price_history_bruteforcefully(\"BTC\")\n    assert warnings.warn.call_count == 100\n\n\ndef test_get_price_history_bruteforcefully_non_retriable_error(mocker):\n    def mock_get_price_history_non_retriable_error(*_, **__) -> PriceHistory:\n        response = requests.Response()\n        response.status_code = 400\n        raise requests.HTTPError(response=response)\n\n    mocker.patch(\"warnings.warn\")\n    source = Source(\n        get_price_history=mock_get_price_history_non_retriable_error,\n        get_search_results=None,\n        rate_limiter=None,\n    )\n    with pytest.raises(requests.HTTPError) as exc_info:\n        source.get_price_history_bruteforcefully(\"BTC\")\n    assert exc_info.value.response.status_code == 400\n    warnings.warn.assert_not_called()\n\n\ndef test_get_price_history_bruteforcefully_rate_limit_hit(mocker):\n    def mock_get_price_history_rate_limit_hit(*_, **__) -> PriceHistory:\n        nonlocal is_first_call\n        if is_first_call:\n            is_first_call = False\n            raise RateLimitHitError(source=\"coingecko\")\n        return PriceHistory(df=None, currency=None)\n\n    mocker.patch(\"warnings.warn\")\n    mocker.patch(\"time.sleep\")\n    is_first_call = True\n    source = Source(\n        get_price_history=mock_get_price_history_rate_limit_hit,\n        get_search_results=None,\n        rate_limiter=rate_limiter.RateLimiter(wait_seconds=1),\n    )\n    source.get_price_history_bruteforcefully(\"BTC\")\n    # back_off_time gets reset after the successful second request:\n    assert source.rate_limiter.back_off_time == 10\n    assert time.sleep.call_count == 1\n    warnings.warn.assert_called_once_with(\n        \"Rate limit hit (429). Backing off 10 seconds.\"\n    )\n","path":null,"size_bytes":3877,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/symbol/geo/jurisdiction2region.py":{"content":"\"\"\"Jurisdiction to region mapping.\"\"\"\n\n\nregion2name = {}\njurisdiction2region = {}\n\n\ndef map_jurisdiction_to_region(jur: str) -> str:\n    \"\"\"Map jurisdiction to region.\"\"\"\n    return region2name[jurisdiction2region[jur]]\n\n\n# ----- the mappings -----\n\nregion2name = {\n    \"AF\": \"Africa\",\n    \"AS\": \"Asia\",\n    \"EU\": \"Europe\",\n    \"NA\": \"North America\",\n    \"SA\": \"South America\",\n    \"OC\": \"Oceania\",\n    \"AN\": \"Antarctica\",\n    \"OT\": \"Other\",\n}\n\n# Data source for this: https://github.com/annexare/Countries\njurisdiction2region = {\n    \"AD\": \"EU\",\n    \"AE\": \"AS\",\n    \"AF\": \"AS\",\n    \"AG\": \"NA\",\n    \"AI\": \"NA\",\n    \"AL\": \"EU\",\n    \"AM\": \"AS\",\n    \"AO\": \"AF\",\n    \"AQ\": \"AN\",\n    \"AR\": \"SA\",\n    \"AS\": \"OC\",\n    \"AT\": \"EU\",\n    \"AU\": \"OC\",\n    \"AW\": \"NA\",\n    \"AX\": \"EU\",\n    \"AZ\": \"AS\",\n    \"BA\": \"EU\",\n    \"BB\": \"NA\",\n    \"BD\": \"AS\",\n    \"BE\": \"EU\",\n    \"BF\": \"AF\",\n    \"BG\": \"EU\",\n    \"BH\": \"AS\",\n    \"BI\": \"AF\",\n    \"BJ\": \"AF\",\n    \"BL\": \"NA\",\n    \"BM\": \"NA\",\n    \"BN\": \"AS\",\n    \"BO\": \"SA\",\n    \"BQ\": \"NA\",\n    \"BR\": \"SA\",\n    \"BS\": \"NA\",\n    \"BT\": \"AS\",\n    \"BV\": \"AN\",\n    \"BW\": \"AF\",\n    \"BY\": \"EU\",\n    \"BZ\": \"NA\",\n    \"CA\": \"NA\",\n    \"CC\": \"AS\",\n    \"CD\": \"AF\",\n    \"CF\": \"AF\",\n    \"CG\": \"AF\",\n    \"CH\": \"EU\",\n    \"CI\": \"AF\",\n    \"CK\": \"OC\",\n    \"CL\": \"SA\",\n    \"CM\": \"AF\",\n    \"CN\": \"AS\",\n    \"CO\": \"SA\",\n    \"CR\": \"NA\",\n    \"CU\": \"NA\",\n    \"CV\": \"AF\",\n    \"CW\": \"NA\",\n    \"CX\": \"AS\",\n    \"CY\": \"EU\",\n    \"CZ\": \"EU\",\n    \"DE\": \"EU\",\n    \"DJ\": \"AF\",\n    \"DK\": \"EU\",\n    \"DM\": \"NA\",\n    \"DO\": \"NA\",\n    \"DZ\": \"AF\",\n    \"EC\": \"SA\",\n    \"EE\": \"EU\",\n    \"EG\": \"AF\",\n    \"EH\": \"AF\",\n    \"ER\": \"AF\",\n    \"ES\": \"EU\",\n    \"ET\": \"AF\",\n    \"FI\": \"EU\",\n    \"FJ\": \"OC\",\n    \"FK\": \"SA\",\n    \"FM\": \"OC\",\n    \"FO\": \"EU\",\n    \"FR\": \"EU\",\n    \"GA\": \"AF\",\n    \"GB\": \"EU\",\n    \"GD\": \"NA\",\n    \"GE\": \"AS\",\n    \"GF\": \"SA\",\n    \"GG\": \"EU\",\n    \"GH\": \"AF\",\n    \"GI\": \"EU\",\n    \"GL\": \"NA\",\n    \"GM\": \"AF\",\n    \"GN\": \"AF\",\n    \"GP\": \"NA\",\n    \"GQ\": \"AF\",\n    \"GR\": \"EU\",\n    \"GS\": \"AN\",\n    \"GT\": \"NA\",\n    \"GU\": \"OC\",\n    \"GW\": \"AF\",\n    \"GY\": \"SA\",\n    \"HK\": \"AS\",\n    \"HM\": \"AN\",\n    \"HN\": \"NA\",\n    \"HR\": \"EU\",\n    \"HT\": \"NA\",\n    \"HU\": \"EU\",\n    \"ID\": \"AS\",\n    \"IE\": \"EU\",\n    \"IL\": \"AS\",\n    \"IM\": \"EU\",\n    \"IN\": \"AS\",\n    \"IO\": \"AS\",\n    \"IQ\": \"AS\",\n    \"IR\": \"AS\",\n    \"IS\": \"EU\",\n    \"IT\": \"EU\",\n    \"JE\": \"EU\",\n    \"JM\": \"NA\",\n    \"JO\": \"AS\",\n    \"JP\": \"AS\",\n    \"KE\": \"AF\",\n    \"KG\": \"AS\",\n    \"KH\": \"AS\",\n    \"KI\": \"OC\",\n    \"KM\": \"AF\",\n    \"KN\": \"NA\",\n    \"KP\": \"AS\",\n    \"KR\": \"AS\",\n    \"KW\": \"AS\",\n    \"KY\": \"NA\",\n    \"KZ\": \"AS\",\n    \"LA\": \"AS\",\n    \"LB\": \"AS\",\n    \"LC\": \"NA\",\n    \"LI\": \"EU\",\n    \"LK\": \"AS\",\n    \"LR\": \"AF\",\n    \"LS\": \"AF\",\n    \"LT\": \"EU\",\n    \"LU\": \"EU\",\n    \"LV\": \"EU\",\n    \"LY\": \"AF\",\n    \"MA\": \"AF\",\n    \"MC\": \"EU\",\n    \"MD\": \"EU\",\n    \"ME\": \"EU\",\n    \"MF\": \"NA\",\n    \"MG\": \"AF\",\n    \"MH\": \"OC\",\n    \"MK\": \"EU\",\n    \"ML\": \"AF\",\n    \"MM\": \"AS\",\n    \"MN\": \"AS\",\n    \"MO\": \"AS\",\n    \"MP\": \"OC\",\n    \"MQ\": \"NA\",\n    \"MR\": \"AF\",\n    \"MS\": \"NA\",\n    \"MT\": \"EU\",\n    \"MU\": \"AF\",\n    \"MV\": \"AS\",\n    \"MW\": \"AF\",\n    \"MX\": \"NA\",\n    \"MY\": \"AS\",\n    \"MZ\": \"AF\",\n    \"NA\": \"AF\",\n    \"NC\": \"OC\",\n    \"NE\": \"AF\",\n    \"NF\": \"OC\",\n    \"NG\": \"AF\",\n    \"NI\": \"NA\",\n    \"NL\": \"EU\",\n    \"NO\": \"EU\",\n    \"NP\": \"AS\",\n    \"NR\": \"OC\",\n    \"NU\": \"OC\",\n    \"NZ\": \"OC\",\n    \"OM\": \"AS\",\n    \"PA\": \"NA\",\n    \"PE\": \"SA\",\n    \"PF\": \"OC\",\n    \"PG\": \"OC\",\n    \"PH\": \"AS\",\n    \"PK\": \"AS\",\n    \"PL\": \"EU\",\n    \"PM\": \"NA\",\n    \"PN\": \"OC\",\n    \"PR\": \"NA\",\n    \"PS\": \"AS\",\n    \"PT\": \"EU\",\n    \"PW\": \"OC\",\n    \"PY\": \"SA\",\n    \"QA\": \"AS\",\n    \"RE\": \"AF\",\n    \"RO\": \"EU\",\n    \"RS\": \"EU\",\n    \"RU\": \"EU\",\n    \"RW\": \"AF\",\n    \"SA\": \"AS\",\n    \"SB\": \"OC\",\n    \"SC\": \"AF\",\n    \"SD\": \"AF\",\n    \"SE\": \"EU\",\n    \"SG\": \"AS\",\n    \"SH\": \"AF\",\n    \"SI\": \"EU\",\n    \"SJ\": \"EU\",\n    \"SK\": \"EU\",\n    \"SL\": \"AF\",\n    \"SM\": \"EU\",\n    \"SN\": \"AF\",\n    \"SO\": \"AF\",\n    \"SR\": \"SA\",\n    \"SS\": \"AF\",\n    \"ST\": \"AF\",\n    \"SV\": \"NA\",\n    \"SX\": \"NA\",\n    \"SY\": \"AS\",\n    \"SZ\": \"AF\",\n    \"TC\": \"NA\",\n    \"TD\": \"AF\",\n    \"TF\": \"AN\",\n    \"TG\": \"AF\",\n    \"TH\": \"AS\",\n    \"TJ\": \"AS\",\n    \"TK\": \"OC\",\n    \"TL\": \"OC\",\n    \"TM\": \"AS\",\n    \"TN\": \"AF\",\n    \"TO\": \"OC\",\n    \"TR\": \"AS\",\n    \"TT\": \"NA\",\n    \"TV\": \"OC\",\n    \"TW\": \"AS\",\n    \"TZ\": \"AF\",\n    \"UA\": \"EU\",\n    \"UG\": \"AF\",\n    \"UM\": \"OC\",\n    \"US\": \"NA\",\n    \"UY\": \"SA\",\n    \"UZ\": \"AS\",\n    \"VA\": \"EU\",\n    \"VC\": \"NA\",\n    \"VE\": \"SA\",\n    \"VG\": \"NA\",\n    \"VI\": \"NA\",\n    \"VN\": \"AS\",\n    \"VU\": \"OC\",\n    \"WF\": \"OC\",\n    \"WS\": \"OC\",\n    \"XK\": \"EU\",\n    \"YE\": \"AS\",\n    \"YT\": \"AF\",\n    \"ZA\": \"AF\",\n    \"ZM\": \"AF\",\n    \"ZW\": \"AF\",\n}\n","path":null,"size_bytes":4533,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/price/price.py":{"content":"\"\"\"Retrieve price information.\"\"\"\n\nfrom __future__ import annotations\nfrom functools import lru_cache, wraps\nfrom typing import Union, TYPE_CHECKING\nimport pandas as pd\nfrom . import PriceHistory, PricePoint\nfrom .. import sources\n\nif TYPE_CHECKING:\n    from .. import SourceType\n\n\ndef custom_cache_wrapper(func):\n    \"\"\"To preserve the function's signature _and_ give access to `cache_clear` etc.\"\"\"\n    cached_func = lru_cache(maxsize=None)(func)\n    wrapped_func = wraps(func)(cached_func)\n    return wrapped_func\n\n\n@custom_cache_wrapper\ndef price_history(\n    query: str,\n    source: SourceType = \"yahoo\",\n    currency_preference: str = \"USD\",\n) -> PriceHistory:\n    \"\"\"Get price history and return `PriceHistory`, i.e., a tuple of a dataframe with\n    the price history and the effective currency. Note that the effective currency\n    returned might differ from the currency_preference.\n\n    - `query`: A query string that makes sense in combination with the source. E.g.,\n      \"BTC-USD\" for \"yahoo\" or \"bitcoin\" for \"coingecko\".\n    - `source`: The source to query. Defaults to \"yahoo\".\n    - `currency_preference`: The currency the prices should be returned in; defaults\n      to \"USD\". The effective currency might differ and will be returned in the second\n      return value.\n    \"\"\"\n    src = sources.get_source(source)\n    src.rate_limiter.rate_limit()\n    df, effective_currency = src.get_price_history_bruteforcefully(\n        query, currency_preference\n    )\n    return PriceHistory(df.copy(), effective_currency.upper())\n    # (Returning a copy of the dataframe so the cached original is preserved even if it\n    # gets modified by the caller.)\n\n\ndef price_point(\n    query: str,\n    when: Union[str, pd.Timestamp],\n    source: SourceType = \"yahoo\",\n    currency_preference: str = \"USD\",\n    max_date_deviation_days: Union[int, None] = 10,\n) -> PricePoint:\n    \"\"\"Return the price at a given point in time given by `when`. Look for the closest\n    point in time if the exact point in time is not found. Returns a `PricePoint`, i.e.,\n    a tuple of the price, the effective timestamp of the price, and the currency.\n\n    Raises a `ValueError` if the found date is more than `max_date_deviation_days` from\n    `when`. Use `None` to disable this check.\n\n    Arguments other than `when` are the same as with `price_history`.\n\n    Example call:\n    ```\n    price_point(\"AAPL\", \"2020-01-01\")\n    ```\n    \"\"\"\n    df, currency = price_history(query, source, currency_preference)\n\n    when = pd.Timestamp(when)\n    if df.index.tz is not None:  # Ensure when matches the timezone of df.index\n        when = when.tz_localize(\"UTC\") if when.tz is None else when.tz_convert(\"UTC\")\n\n    nearest_index = df.index.get_indexer([when], method=\"nearest\")[0]\n    found_date = df.index[nearest_index]\n\n    if (\n        max_date_deviation_days is not None\n        and abs((found_date - when).days) > max_date_deviation_days\n    ):\n        raise ValueError(\n            f\"Found date {found_date} is more than {max_date_deviation_days} days away \"\n            f\"from requested date {when}\"\n        )\n\n    price = df.iloc[nearest_index]\n    return PricePoint(when=found_date, price=float(price.iloc[0]), currency=currency)\n\n\ndef price_point_strict(\n    query: str,\n    when: str,\n    source: SourceType = \"yahoo\",\n    currency_preference: str = \"USD\",\n) -> PricePoint:\n    \"\"\"Same as `price_point` but will raise a `KeyError` if no price is found. This\n    function is offered for backwards compatibility and is largely obsolete with the\n    introduction of `max_date_deviation_days` in `price_point`.\n    \"\"\"\n    try:\n        return price_point(\n            query, when, source, currency_preference, max_date_deviation_days=0\n        )\n    except ValueError as e:\n        raise KeyError(f\"No price found for {query} at {when}\") from e\n\n\ndef price_latest(\n    query: str,\n    source: SourceType = \"yahoo\",\n    currency_preference: str = \"USD\",\n) -> PricePoint:\n    \"\"\"Same as `price_point` but will return the latest price.\"\"\"\n    df, currency = price_history(query, source, currency_preference)\n    return PricePoint(\n        when=df.iloc[-1].name, price=float(df.iloc[-1][\"close\"]), currency=currency\n    )\n","path":null,"size_bytes":4200,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tests/price/test_price_points.py":{"content":"\"\"\"All tests related to `price_point_*` and `price_latest`.\"\"\"\n\nimport pytest\nimport pandas as pd\nfrom tessa import price_point, price_point_strict, price_latest\nfrom tessa.price import PriceHistory, PricePoint\n\n\n# pylint: disable=unused-argument,missing-function-docstring,redefined-outer-name\n\n# ----- Tests that don't hit the net -----\n\n\n@pytest.fixture()\ndef mock_price_history(mocker):\n    df_as_json = {\n        \"date\": [\n            pd.Timestamp(\"2017-01-11\", tz=\"utc\"),\n            pd.Timestamp(\"2018-01-11\", tz=\"utc\"),\n            pd.Timestamp(\"2018-01-12\", tz=\"utc\"),\n        ],\n        \"close\": [1.0, 2.0, 3.0],\n    }\n    mocker.patch(\n        \"tessa.price.price.price_history\",\n        return_value=PriceHistory(pd.DataFrame(df_as_json).set_index(\"date\"), \"USD\"),\n    )\n\n\ndef test_price_point_strict(mock_price_history):\n    assert price_point_strict(\"xx\", \"2018-01-11\").price == 2.0\n\n\ndef test_price_point_strict_with_non_existent_timestamp_fails(mock_price_history):\n    with pytest.raises(KeyError):\n        price_point_strict(\"xx\", \"2018-01-13\")\n\n\ndef test_price_point_with_non_existent_timestamp_finds_nearest(mock_price_history):\n    assert price_point(\"xx\", \"2018-01-13\") == PricePoint(\n        when=pd.Timestamp(\"2018-01-12\", tz=\"utc\"), price=3.0, currency=\"USD\"\n    )\n\n\ndef test_price_point_works_correctly_with_max_date_deviation_days(mock_price_history):\n    assert price_point(\"xx\", \"2018-01-13\", max_date_deviation_days=1) == PricePoint(\n        when=pd.Timestamp(\"2018-01-12\", tz=\"utc\"), price=3.0, currency=\"USD\"\n    )\n    with pytest.raises(ValueError):\n        price_point(\"xx\", \"2018-01-13\", max_date_deviation_days=0)\n        price_point(\"xx\", \"2022-01-01\", max_date_deviation_days=10)\n\n    assert price_point(\"xx\", \"2022-01-01\", max_date_deviation_days=None) == PricePoint(\n        when=pd.Timestamp(\"2018-01-12\", tz=\"utc\"), price=3.0, currency=\"USD\"\n    )\n\n\ndef test_price_latest(mock_price_history):\n    assert price_latest(\"xx\") == PricePoint(\n        when=pd.Timestamp(\"2018-01-12\", tz=\"utc\"), price=3.0, currency=\"USD\"\n    )\n\n\ndef test_verify_pricepoint_types_are_used(mock_price_history):\n    assert isinstance(price_point(\"xx\", \"2018-01-11\"), PricePoint)\n    assert isinstance(price_point_strict(\"xx\", \"2018-01-11\"), PricePoint)\n    assert isinstance(price_latest(\"xx\"), PricePoint)\n\n\n# ----- Tests that do hit the net -----\n\n\n@pytest.mark.net\ndef test_concrete_yahoo_price_point():\n    res = price_point(\"AAPL\", \"2018-01-11\", \"yahoo\")\n    assert isinstance(res, PricePoint)\n    assert res.when == pd.Timestamp(\"2018-01-11 05:00:00+0000\", tz=\"UTC\")\n    assert round(res.price) == 41\n    assert res.currency == \"USD\"\n\n\n@pytest.mark.net\ndef test_concrete_coingecko_price_point():\n    \"\"\"Since coingecko only reports prices for 1 year and in order to make this test\n    robust, we use price_latest below and do some basic checks.\n    \"\"\"\n    res = price_latest(\"bitcoin\", \"coingecko\")\n    assert isinstance(res, PricePoint)\n    assert pd.Timestamp.now(\"utc\") - res.when < pd.Timedelta(\"7 days\")\n    assert res.price > 0\n    assert res.currency == \"USD\"\n","path":null,"size_bytes":3089,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/sources/sourcetype.py":{"content":"\"\"\"`SourceType` is a literal type with all known sources; used for type hinting and to\nsupport autocomplete suggestions.\n\"\"\"\n\nfrom typing import Literal\n\nSourceType = Literal[\n    \"yahoo\",\n    \"coingecko\",\n]\n","path":null,"size_bytes":208,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/__init__.py":{"content":"\"\"\"\n.. include:: ../README.md\n\"\"\"\n\nfrom .sources import SourceType\nfrom .price import (\n    price_history,\n    price_point,\n    price_point_strict,\n    price_latest,\n)\nfrom .search import search\nfrom .symbol import Symbol, ExtendedSymbol, SymbolCollection\n","path":null,"size_bytes":256,"size_tokens":null},"server/strategies/smc/h4Context.ts":{"content":"import {\n  Candle,\n  MarketContext,\n  MarketControl,\n  TrendDirection,\n  SupplyDemandZone,\n  SwingPoint,\n} from '../core/types';\nimport { detectSupplyDemandZones, getUnmitigatedZones, getNearestZone, getZonesByType } from '../shared/zoneDetection';\nimport { detectSwingPoints, detectTrendFromSwings } from '../shared/swingPoints';\nimport { SMC_ZONE_CONFIG } from './config';\n\nexport interface H4AnalysisResult {\n  control: MarketControl;\n  trend: TrendDirection;\n  supplyZones: SupplyDemandZone[];\n  demandZones: SupplyDemandZone[];\n  unmitigatedSupply: SupplyDemandZone[];\n  unmitigatedDemand: SupplyDemandZone[];\n  nearestSupplyTarget: SupplyDemandZone | null;\n  nearestDemandTarget: SupplyDemandZone | null;\n  swingPoints: SwingPoint[];\n  reasoning: string[];\n}\n\nexport function analyzeH4Context(\n  h4Candles: Candle[],\n  currentPrice: number\n): H4AnalysisResult {\n  const reasoning: string[] = [];\n\n  const allZones = detectSupplyDemandZones(\n    h4Candles,\n    '4H',\n    { lookback: SMC_ZONE_CONFIG.h4LookbackCandles }\n  );\n\n  const supplyZones = getZonesByType(allZones, 'supply');\n  const demandZones = getZonesByType(allZones, 'demand');\n\n  const unmitigatedSupply = getUnmitigatedZones(supplyZones);\n  const unmitigatedDemand = getUnmitigatedZones(demandZones);\n\n  reasoning.push(`H4: Found ${supplyZones.length} supply zones (${unmitigatedSupply.length} unmitigated)`);\n  reasoning.push(`H4: Found ${demandZones.length} demand zones (${unmitigatedDemand.length} unmitigated)`);\n\n  const swingPoints = detectSwingPoints(h4Candles, { lookback: 5 });\n  const trend = detectTrendFromSwings(swingPoints);\n\n  reasoning.push(`H4 Trend: ${trend} (based on ${swingPoints.length} swing points)`);\n\n  const control = determineMarketControl(\n    h4Candles,\n    unmitigatedSupply,\n    unmitigatedDemand,\n    swingPoints,\n    currentPrice\n  );\n\n  reasoning.push(`H4 Control: ${control}`);\n\n  const nearestSupplyTarget = getNearestZone(unmitigatedSupply, currentPrice, 'above');\n  const nearestDemandTarget = getNearestZone(unmitigatedDemand, currentPrice, 'below');\n\n  if (nearestSupplyTarget) {\n    reasoning.push(`Nearest H4 supply target: ${nearestSupplyTarget.topPrice.toFixed(5)} - ${nearestSupplyTarget.bottomPrice.toFixed(5)}`);\n  }\n  if (nearestDemandTarget) {\n    reasoning.push(`Nearest H4 demand target: ${nearestDemandTarget.topPrice.toFixed(5)} - ${nearestDemandTarget.bottomPrice.toFixed(5)}`);\n  }\n\n  return {\n    control,\n    trend,\n    supplyZones,\n    demandZones,\n    unmitigatedSupply,\n    unmitigatedDemand,\n    nearestSupplyTarget,\n    nearestDemandTarget,\n    swingPoints,\n    reasoning,\n  };\n}\n\nfunction determineMarketControl(\n  candles: Candle[],\n  unmitigatedSupply: SupplyDemandZone[],\n  unmitigatedDemand: SupplyDemandZone[],\n  swingPoints: SwingPoint[],\n  currentPrice: number\n): MarketControl {\n  if (candles.length < 10) return 'neutral';\n\n  const recentSwings = swingPoints.slice(-6);\n  const hhCount = recentSwings.filter(s => s.type === 'HH').length;\n  const hlCount = recentSwings.filter(s => s.type === 'HL').length;\n  const lhCount = recentSwings.filter(s => s.type === 'LH').length;\n  const llCount = recentSwings.filter(s => s.type === 'LL').length;\n\n  const bullishScore = hhCount * 2 + hlCount;\n  const bearishScore = llCount * 2 + lhCount;\n\n  let brokenSupply = false;\n  let brokenDemand = false;\n\n  for (const zone of unmitigatedSupply) {\n    if (currentPrice > zone.topPrice) {\n      brokenSupply = true;\n      break;\n    }\n  }\n\n  for (const zone of unmitigatedDemand) {\n    if (currentPrice < zone.bottomPrice) {\n      brokenDemand = true;\n      break;\n    }\n  }\n\n  if (brokenSupply && !brokenDemand) {\n    return 'demand';\n  }\n  if (brokenDemand && !brokenSupply) {\n    return 'supply';\n  }\n\n  if (bullishScore > bearishScore + 2) {\n    return 'demand';\n  }\n  if (bearishScore > bullishScore + 2) {\n    return 'supply';\n  }\n\n  return 'neutral';\n}\n\nexport function isNearH4Zone(\n  currentPrice: number,\n  h4Zones: SupplyDemandZone[],\n  proximityPercent: number = 0.5\n): { near: boolean; zone: SupplyDemandZone | null; type: 'supply' | 'demand' | null } {\n  for (const zone of h4Zones) {\n    const zoneSize = zone.topPrice - zone.bottomPrice;\n    const proximityRange = zoneSize * (1 + proximityPercent);\n\n    const isNearSupply = \n      zone.type === 'supply' && \n      currentPrice >= zone.bottomPrice - proximityRange && \n      currentPrice <= zone.topPrice + proximityRange;\n\n    const isNearDemand = \n      zone.type === 'demand' && \n      currentPrice >= zone.bottomPrice - proximityRange && \n      currentPrice <= zone.topPrice + proximityRange;\n\n    if (isNearSupply || isNearDemand) {\n      return {\n        near: true,\n        zone,\n        type: zone.type,\n      };\n    }\n  }\n\n  return { near: false, zone: null, type: null };\n}\n\nexport function buildMarketContext(\n  h4Result: H4AnalysisResult,\n  swingPoints: SwingPoint[]\n): MarketContext {\n  return {\n    h4Control: h4Result.control,\n    h4TrendDirection: h4Result.trend,\n    h4SupplyZones: h4Result.unmitigatedSupply,\n    h4DemandZones: h4Result.unmitigatedDemand,\n    nearestH4Target: h4Result.control === 'demand' \n      ? h4Result.nearestSupplyTarget \n      : h4Result.nearestDemandTarget,\n    swingPoints,\n  };\n}\n","path":null,"size_bytes":5223,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/docs/pdoc-dark-mode/theme.css":{"content":":root {\n    --pdoc-background: #212529;\n}\n\n.pdoc {\n    --text: #f7f7f7;\n    --muted: #9d9d9d;\n    --link: #58a6ff;\n    --link-hover: #3989ff;\n    --code: #333;\n    --active: #555;\n\n    --accent: #343434;\n    --accent2: #555;\n\n    --nav-hover: rgba(0, 0, 0, 0.1);\n    --name: #77C1FF;\n    --def: #0cdd0c;\n    --annotation: #00c037;\n}\n","path":null,"size_bytes":333,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/symbol/symbolcollection.py":{"content":"\"\"\"SymbolCollection class.\"\"\"\n\nfrom __future__ import annotations\nfrom typing import Optional, Type, Union, List\nimport collections\nimport yaml\nfrom . import Symbol\n\n\nclass SymbolCollection:\n    \"\"\"A collection of `Symbol`s. A `Symbol`'s name is treated as a key in a collection\n    and this class enforces as much in the `add` method.\n    \"\"\"\n\n    symbols: List[Symbol]\n    \"\"\"The `Symbol`s in the collection.\"\"\"\n\n    def __init__(self, symbols: Optional[List[Symbol]] = None) -> None:\n        \"\"\"Initializer. Use `symbols` to add symbols immediately and/or use `add` method\n        later.\n        \"\"\"\n        self.symbols = []\n        if symbols is not None:\n            self.add(symbols)\n\n    def __iter__(self) -> object:\n        \"\"\"Make class iterable directly.\"\"\"\n        return self.symbols.__iter__()\n\n    def __repr__(self) -> str:\n        return f\"{self.__class__.__name__} with {len(self.symbols)} symbols\"\n\n    def add(self, symbols: Union[Symbol, List[Symbol]]) -> SymbolCollection:\n        \"\"\"Add symbols to the collection. Ensure names are unique.\"\"\"\n        if not isinstance(symbols, list):\n            symbols = [symbols]\n        if not all(isinstance(x, Symbol) for x in symbols):\n            raise ValueError(\"Please only add Symbol types to a SymbolCollection.\")\n        all_names = [s.name for s in self.symbols + symbols]\n        duplicates = [k for k, v in collections.Counter(all_names).items() if v > 1]\n        if duplicates:\n            raise ValueError(\n                f\"Duplicate names ({', '.join(duplicates)}). \"\n                \"Please make sure each name is only used once.\"\n            )\n        self.symbols.extend(symbols)\n        return self\n\n    def find_one(self, what: str) -> Optional[Symbol]:\n        \"\"\"Find exactly one `Symbol` that matches the query. Raises `ValueError` if\n        there's more than 1 match. Returns `None` if there's no match.\n        \"\"\"\n        matches = self.find(what)\n        if len(matches) > 1:\n            raise ValueError(f\"Found several matching symbols for '{what}'\")\n        return matches[0] if matches else None\n\n    def find(self, what: str) -> List[Symbol]:\n        \"\"\"Find all `Symbol`s that match the query.\"\"\"\n        return [s for s in self.symbols if s.matches(what)]\n\n    def load_yaml(self, yaml_file: str, which_class: Type[Symbol] = Symbol) -> None:\n        \"\"\"Load symbols from a YAML file.\n\n        - `yaml_file`: Name/path of file to load.\n        - `which_class`: The class to be instantiated, can be used to instatiate\n          subclasses of `Symbol`.\n        \"\"\"\n        with open(yaml_file, \"r\", encoding=\"utf-8\") as stream:\n            ymldict = yaml.safe_load(stream)\n        new_symbols = [which_class(k, **(v or {})) for k, v in ymldict.items()]\n        self.add(new_symbols)\n\n    def to_yaml(self) -> str:\n        \"\"\"Return a YAML representation of all symbols.\"\"\"\n        return \"\".join([s.to_yaml() for s in self.symbols])\n\n    def save_yaml(self, yaml_file: str) -> None:\n        \"\"\"Save symbols to a YAML file.\"\"\"\n        with open(yaml_file, \"w\", encoding=\"utf-8\") as stream:\n            stream.write(self.to_yaml())\n","path":null,"size_bytes":3125,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tests/price/__init__.py":{"content":"","path":null,"size_bytes":0,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/symbol/geo/__init__.py":{"content":"\"\"\"Geography helpers for `ExtendedSymbol`.\"\"\"\n\nfrom .countrynames import CountryName\nfrom . import jurisdiction2region as j2r\n","path":null,"size_bytes":126,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/DEVNOTES.md":{"content":"\n\nThese are internal notes that won't make much sense to anybody other than me...\n-- ymyke\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# How to build pdoc documentation:\n\n`pdoc -o docs -t docs/pdoc-dark-mode tessa`\n\n- Maybe try the pdoc workflow Github action to automate this. Would require\n  requirements.txt in the folder, which can be generated via `poetry export -f\n  requirements.txt --output requirements.txt`\n\nTo simply run the doc locally, use this:\n\n`pdoc -t docs/pdoc-dark-mode tessa`\n\n\n## MetricHistory\n\n- What about MetricHistory? -- I guess this is part of alerts? Or should this be another\n  separate package? If so, why? -- Or should the whole thing be a library and alerts,\n  ticker, metric history etc. be packages within it? -- Would MetricHistory be a\n  glorified / persistent cache for tessa?\n\n# Low prio stuff\n\n- Do we have a timezone issue? Do the different APIs return datetimes in different\n  timezones and should the standardized?\n\n\n","path":null,"size_bytes":929,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/sources/low_level_rate_limiter.py":{"content":"\"\"\"Rate Limiter -- makes sure we don't hit the APIs too often by waiting by default and\nwaiting exponentially if a 429 error is encountered.\n\nThe goal is to never run into errors in the first place, because some sites like\ncoingecko.com take substantial time until they allow-list a blocked IP address again.\nThat is also why we can't use a library such das Tenacity here.\n\nNote that this module is no longer used by the package. But I left it in here anyway,\nbecause it might come in handy for people who use the pycoingecko or some other library\nin other ways than through this package.\n\nUsage: Import the module and call `setup_guards()`.\n\"\"\"\n\n# pylint: disable=eval-used,exec-used,unused-import\n\nimport time\nimport requests\nimport pendulum\n\nguards = {\n    # Additional attributes that will be added dynamically are: last_call, wait_seconds\n    \"yahoo\": {\n        \"func_name\": \"requests.post\",\n        \"initial_wait_seconds\": 0.2,\n        \"pattern\": \"yahoo.com\",\n    },\n    \"coingecko\": {\n        \"func_name\": \"requests.Session.get\",\n        \"initial_wait_seconds\": 2.5,\n        \"pattern\": \"coingecko.com\",\n    },\n}\n\n\ndef create_guard(func: callable, guard: dict) -> callable:\n    \"\"\"Create a guard.\"\"\"\n\n    def guarded_func(*args, **kwargs):\n\n        # If the call is for the url pattern, check if the last call was long enough in\n        # the past and wait, if not:\n        if any(\n            guard[\"pattern\"] in x\n            for x in args + tuple(kwargs.values())\n            if isinstance(x, str)\n        ):\n            diff = (pendulum.now() - guard[\"last_call\"]).total_seconds()\n            if diff < guard[\"wait_seconds\"]:\n                time.sleep(guard[\"wait_seconds\"] - diff)\n            guard[\"last_call\"] = pendulum.now()\n\n        # Call the original function and return, increase wait_seconds exponentially if\n        # a 429 error is encountered:\n        try:\n            res = func(*args, **kwargs)\n        except (requests.HTTPError, ConnectionError) as exc:\n            if \"429\" in exc:\n                guard[\"wait_seconds\"] *= 2\n            raise exc\n\n        guard[\"wait_seconds\"] = guard[\"initial_wait_seconds\"]  # Reset if no error\n        return res\n\n    return guarded_func\n\n\ndef setup_guards() -> None:\n    \"\"\"Set up guards.\"\"\"\n    for guard in guards.values():\n        guard[\"last_call\"] = pendulum.parse(\"1900\")\n        guard[\"wait_seconds\"] = guard[\"initial_wait_seconds\"]\n        guard[\"func_orig\"] = eval(guard[\"func_name\"])\n        exec(f\"{guard['func_name']} = create_guard({guard['func_name']}, guard)\")\n\n\n# def reset_guards() -> None:\n#     \"\"\"Reset to the originals.\"\"\"\n#     for guard in guards.values():\n#         exec(f\"{guard['func_name']} = {guard['func_orig']}\")\n#         # Note that his doesn't work bc `func_orig` gets interpolated to a string\n#         # representation, which in turn leads to a syntax error.\n","path":null,"size_bytes":2861,"size_tokens":null},"attached_assets/tessa-data/tessa-data-master/tessa/sources/sources_directory.py":{"content":"\"\"\"The directory (i.e., dictionary) of all know sources. To be accessed via the\nfunctions in `tessa.sources.sources`. This module is factored out so the directory can\nbe imported late within functions in order to prevent circular dependencies.\n\"\"\"\n\nfrom typing import Dict, Final\nfrom .sources import Source\nfrom .sourcetype import SourceType\nfrom .rate_limiter import RateLimiter\nfrom ..price import yahoo as yahooprice, coingecko as coingeckoprice\nfrom ..search import yahoo as yahoosearch, coingecko as coingeckosearch\n\nSOURCES_DIRECTORY: Final[Dict[SourceType, Source]] = {\n    \"yahoo\": Source(\n        get_price_history=yahooprice.get_price_history,\n        get_search_results=yahoosearch.yahoo_search,\n        rate_limiter=RateLimiter(0.5),\n    ),\n    \"coingecko\": Source(\n        get_price_history=coingeckoprice.get_price_history,\n        get_search_results=coingeckosearch.coingecko_search,\n        rate_limiter=RateLimiter(2.5),\n    ),\n}\n","path":null,"size_bytes":948,"size_tokens":null},"client/src/pages/Join.tsx":{"content":"import { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Check, Zap, Shield, BarChart3, Bell } from 'lucide-react';\n\nexport default function Join() {\n  const features = [\n    { icon: Zap, text: 'Real-time trading signals across Forex, Stocks, Crypto & Commodities' },\n    { icon: BarChart3, text: 'Smart Money Concepts analysis with institutional methodology' },\n    { icon: Bell, text: 'Telegram notifications for new signals and economic events' },\n    { icon: Shield, text: 'Multi-timeframe confirmation for higher accuracy' },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-[#f7f7f7] dark:bg-background text-gray-800 dark:text-foreground p-4 md:p-8\">\n      <div className=\"max-w-4xl mx-auto\">\n        <div className=\"text-center mb-12\">\n          <h1 className=\"text-4xl font-extrabold tracking-tight mb-4\">\n            Join <span className=\"text-bull-green\">Find</span>Buy<span className=\"text-bear-red\">Sell</span>Zones\n          </h1>\n          <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto\">\n            Get access to professional-grade trading signals powered by Smart Money Concepts\n          </p>\n        </div>\n\n        <div className=\"grid md:grid-cols-2 gap-6 mb-12\">\n          <Card className=\"border-2 border-border\">\n            <CardHeader>\n              <CardTitle className=\"text-2xl\">Free Plan</CardTitle>\n              <CardDescription>Get started with basic signals</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-4xl font-extrabold mb-6\">$0<span className=\"text-lg font-normal text-muted-foreground\">/month</span></div>\n              <ul className=\"space-y-3 mb-6\">\n                <li className=\"flex items-center gap-2\">\n                  <Check className=\"w-5 h-5 text-bull-green\" />\n                  <span>5 signals per day</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <Check className=\"w-5 h-5 text-bull-green\" />\n                  <span>Major forex pairs</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <Check className=\"w-5 h-5 text-bull-green\" />\n                  <span>Economic calendar</span>\n                </li>\n              </ul>\n              <Button className=\"w-full\" variant=\"outline\" data-testid=\"button-free-signup\">\n                Get Started Free\n              </Button>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-2 border-primary relative overflow-visible\">\n            <div className=\"absolute -top-3 left-1/2 -translate-x-1/2 px-4 py-1 bg-primary text-primary-foreground text-sm font-bold rounded-full\">\n              POPULAR\n            </div>\n            <CardHeader>\n              <CardTitle className=\"text-2xl\">Pro Plan</CardTitle>\n              <CardDescription>Full access to all features</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-4xl font-extrabold mb-6\">$29<span className=\"text-lg font-normal text-muted-foreground\">/month</span></div>\n              <ul className=\"space-y-3 mb-6\">\n                <li className=\"flex items-center gap-2\">\n                  <Check className=\"w-5 h-5 text-bull-green\" />\n                  <span>Unlimited signals</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <Check className=\"w-5 h-5 text-bull-green\" />\n                  <span>All asset classes</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <Check className=\"w-5 h-5 text-bull-green\" />\n                  <span>Telegram notifications</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <Check className=\"w-5 h-5 text-bull-green\" />\n                  <span>Priority support</span>\n                </li>\n              </ul>\n              <Button className=\"w-full\" data-testid=\"button-pro-signup\">\n                Start Pro Trial\n              </Button>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"bg-white dark:bg-background border-2 border-border rounded-lg p-8\">\n          <h2 className=\"text-2xl font-bold mb-6 text-center\">Why Choose Us?</h2>\n          <div className=\"grid md:grid-cols-2 gap-6\">\n            {features.map((feature, index) => (\n              <div key={index} className=\"flex items-start gap-4\">\n                <div className=\"p-2 bg-primary/10 rounded-lg\">\n                  <feature.icon className=\"w-6 h-6 text-primary\" />\n                </div>\n                <p className=\"text-muted-foreground\">{feature.text}</p>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":4890,"size_tokens":null},"attached_assets/news-keeper-extracted/news-keeper-main/README.md":{"content":"# News Keeper\n\nNews Keeper is an Economic Calendar News discord bot\n\nInorder to get news simply type \"news\"\n\n![News Keeper](./img/newskeeper.png)\n\n## Permissions Needed\n\n- Send Messages in Threads\n- Send Messages\n- Mention Everyone\n- Read Messages/View Channels\n- Read Messae History\n\n## Invite Me\n\nUse this link to invite the bot to your channel:\n\n<https://discord.com/api/oauth2/authorize?client_id=1196091282792136794&permissions=274878106624&scope=bot>\n\n## Usage\n\nType 'news'\n\n## Development\n\n**1. Clone Me**\n\n```sh\ngit clone https://github.com/takumade/economic_calendar_bot\n```\n\n**2. Create a virtual environment**\n\n```sh\nvirtualenv venv\n```\n\n**3. Activate it**\n\n```sh\nsource venv/bin/activate\n```\n\n**4. Install dependencies**\n\n```sh\npip install -r requirements.txt\n```\n\nInside the .env file add your DISCORD TOKEN\n\n**5. Run it**\n\n```sh\npython main.py\n```\n\n\n\n## CONTRIBUTIONS\n\n### Code\n\n1. Fork the repo\n2. Create a branch\n3. Add your miserable contribution(s)\n   \n   ![Mike Tyson Lauhing](https://usagif.com/wp-content/uploads/laughing-42.gif)\n\n4. Create a pull request stating what changes you added etc\n5. Then I merge your changes\n\n### Suggestions\n\n1. DM me on twitter [takucoder](https://twitter.com/takucoder)\n2. OR raise an Issue\n\n#### No unclear or useless contributions please\n\n## Special Thanks\n\n- [Federico Azzurro](https://github.com/federicoazzu)\n- [Takunda Madechangu](https://github.com/takumade)\n","path":null,"size_bytes":1418,"size_tokens":null},"attached_assets/news-keeper-extracted/news-keeper-main/lib/emojis.py":{"content":"\n\ndef get_emoji(pair):\n    if pair == \"USD\":\n        return \"\"\n    elif pair == \"EUR\":\n        return \"\"\n    elif pair == \"GBP\":\n        return \"\"\n    elif pair == \"CAD\":\n        return \"\"\n    elif pair == \"CNY\":\n        return \"\"\n    elif pair == \"JPY\":\n        return \"\"\n    elif pair == \"CHF\":\n        return \"\"\n    elif pair == \"AUD\":\n        return \"\"\n    ","path":null,"size_bytes":425,"size_tokens":null},"attached_assets/news-keeper-extracted/news-keeper-main/keep_alive.py":{"content":"from flask import Flask\nfrom threading import Thread\n\napp = Flask('')\n\n@app.route('/')\ndef home():\n    return \"I'm alive\"\n\ndef run():\n  app.run(host='0.0.0.0',port=8080)\n\ndef keep_alive():  \n    t = Thread(target=run)\n    t.start()\n","path":null,"size_bytes":232,"size_tokens":null},"attached_assets/news-keeper-extracted/news-keeper-main/lib/storage.py":{"content":"import json \nimport os\nfrom datetime import datetime\n \njson_file_path = \"news_data_.json\"\ntotal_hours = 5\n\n\n\ndef store_data(data) -> bool:\n   \n    try:\n        # Writing the dictionary to a JSON file\n        with open(json_file_path, 'w') as json_file:\n            json.dump(data, json_file)\n            \n        return True\n    except Exception: \n        print(f\"Could't write to file: {json}\")\n        return False\n        \ndef get_data() -> dict:\n    \n    try:\n        # Reading data from the JSON file\n        with open(json_file_path, 'r') as json_file:\n            data = json.load(json_file)\n        return data\n    except FileNotFoundError:\n        print(f\"File '{json_file_path}' not found.\")\n        return None\n    except json.JSONDecodeError:\n        print(f\"Error decoding JSON in '{json_file_path}'.\")\n        return None\n        \ndef get_write_time() -> datetime:\n    \n    # Get the last modification time\n    modification_time = os.path.getmtime(json_file_path)\n\n    # Convert the modification time to a readable format\n    last_modified_date = datetime.fromtimestamp(modification_time)\n    \n    return last_modified_date\n\ndef time_difference() -> int:\n\n    last_modified_date = get_write_time()\n    current_date = datetime.today()\n    seconds_difference = (current_date - last_modified_date).total_seconds()\n    hours_difference = seconds_difference / 3600\n    \n    return hours_difference\n\ndef should_fetch_live_data() -> bool:\n    \n    if os.path.exists(json_file_path):\n        return time_difference() > total_hours\n    else:\n        return True","path":null,"size_bytes":1566,"size_tokens":null},"attached_assets/news-keeper-extracted/news-keeper-main/main.py":{"content":"from typing import Final\nimport os\nfrom dotenv import load_dotenv\nfrom discord import Intents, Client, Message\nfrom responses import get_response\n\nfrom keep_alive import keep_alive\n\n# STEP 0: LOAD OUR TOKEN FROM SOMEWHERE SAFE\nload_dotenv()\nTOKEN: Final[str] = os.getenv('DISCORD_TOKEN')\n\n# STEP 1: BOT SETUP\nintents: Intents = Intents.default()\nintents.message_content = True  # NOQA\nclient: Client = Client(intents=intents)\n\n\n# STEP 2: MESSAGE FUNCTIONALITY\nasync def send_message(message: Message, user_message: str) -> None:\n    if not user_message:\n        print('(Message was empty because intents were not enabled probably)')\n        return\n\n    if is_private := user_message[0] == '?':\n        user_message = user_message[1:]\n\n    try:\n        response: str = get_response(user_message)\n        await message.author.send(response) if is_private else await message.channel.send(response)\n    except Exception as e:\n        print(e)\n\n\n# STEP 3: HANDLING THE STARTUP FOR OUR BOT\n@client.event\nasync def on_ready() -> None:\n    print(f'{client.user} is now running!')\n\n\n# STEP 4: HANDLING INCOMING MESSAGES\n@client.event\nasync def on_message(message: Message) -> None:\n    if message.author == client.user:\n        return\n\n    username: str = str(message.author)\n    user_message: str = message.content\n    channel: str = str(message.channel)\n\n    print(f'[{channel}] {username}: \"{user_message}\"')\n    await send_message(message, user_message)\n\n\n# STEP 5: MAIN ENTRY POINT\ndef main() -> None:\n    keep_alive()\n    client.run(token=TOKEN)\n\n\nif __name__ == '__main__':\n    main()\n\n\n\n","path":null,"size_bytes":1586,"size_tokens":null},"attached_assets/news-keeper-extracted/news-keeper-main/lib/news.py":{"content":"from lib.emojis import get_emoji\nfrom lib.storage import should_fetch_live_data, store_data, get_data\nfrom lib.scrapper import scrape_news\nfrom lib.utils import formart_date\n\n\ndef order_news_by_day(raw_news):\n    ordered_news = {}\n    \n    for news in raw_news:\n        \n        if news['day'] not in ordered_news.keys():\n            ordered_news[news['day']] = []\n            \n        ordered_news[news['day']].append(news)\n    return ordered_news\n \ndef get_news_string(ordered_news, impact=['High']):\n    news_string = \"\"\n    \n    for day in ordered_news.keys():   \n        news_string += f\"\\n`{formart_date(day)}`\\n\"\n        \n        for news in ordered_news[day]: \n            if (news['impact'] in impact ):\n                cleaned_name = ' '.join(news['name'].splitlines())\n                news_string += f\"{get_emoji(news['pair'])}   {news['time']}   **{cleaned_name}**\\n\"\n                \n    return news_string\n    \ndef get_news() -> str:\n    if should_fetch_live_data():\n        print(\"[log] Fetching live data...\")\n        raw_news = scrape_news()\n        store_data(raw_news)\n    else: \n        print(\"[log] Using stored data...\")\n        raw_news = get_data()\n    \n    ordered_news = order_news_by_day(raw_news)\n    news_string = get_news_string(ordered_news)\n        \n    return news_string","path":null,"size_bytes":1304,"size_tokens":null},"attached_assets/news-keeper-extracted/news-keeper-main/responses.py":{"content":"from random import choice, randint\nfrom lib.news import get_news\n\ndef get_response(user_input: str) -> str:\n    lowered: str = user_input.lower()\n\n    if 'news' in lowered:\n        return get_news()","path":null,"size_bytes":198,"size_tokens":null},"attached_assets/news-keeper-extracted/news-keeper-main/lib/utils.py":{"content":"from datetime import datetime\n\ndef formart_date(day) -> str:\n    # day,time = date.split(\",\")\n    from datetime import datetime\n    \n    date_string = f\"{day} {datetime.now().year}\"\n\n\n    # Convert the original date string to a datetime object\n    date_object = datetime.strptime(date_string, \"%b %d %Y\")\n\n    # Format the datetime object to the desired output\n    return date_object.strftime(\"%a %b %d\")","path":null,"size_bytes":404,"size_tokens":null},"attached_assets/news-keeper-extracted/news-keeper-main/lib/scrapper.py":{"content":"import requests\nfrom bs4 import BeautifulSoup\n\ndef scrape_news() -> dict:\n    # Specify the URL you want to scrape\n    url = 'https://www.myfxbook.com/forex-economic-calendar'\n\n    # Make a GET request to the website\n    response = requests.get(url)\n\n    if response.status_code == 200:\n        # Parse the HTML content of the page\n        soup = BeautifulSoup(response.text, 'html.parser')\n        links = soup.find_all('tr', class_='economicCalendarRow')\n        \n        results = []\n        \n        # Print the extracted links\n        for link in links:\n            # if (link[\"data-ignore-row\"] == True)\n            cells = link.find_all('td', class_='calendarToggleCell')\n            \n            row = {}\n            \n            if len(cells) > 1:\n                row['date'] = cells[0].get_text().strip()\n                row['day'] = row['date'].split(\",\")[0].strip()\n                row['time'] = row['date'].split(\",\")[1].strip()\n                row['time_left'] = cells[1].get_text().strip()\n                row['flag'] = cells[2].get_text().strip()\n                row['pair'] = cells[3].get_text().strip()\n                row['name'] = cells[4].get_text().strip()\n                row['impact'] = cells[5].get_text().strip()\n                row['previous'] = cells[6].get_text().strip()\n                row['consensus'] = cells[7].get_text().strip()\n                row['actual'] = cells[8].get_text().strip()\n            results.append(row)    \n\n        return results\n    else:\n        print(f\"Failed to retrieve the page. Status code: {response.status_code}\")\n        ","path":null,"size_bytes":1585,"size_tokens":null}},"version":2}