{"file_contents":{"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":21846},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"replit.md":{"content":"# Overview\n\nThe Infod Trading Partner System is a professional financial analysis platform providing real-time market scanning, signal generation, trade history tracking, and analytics. It focuses on Smart Money Concepts (SMC), multi-timeframe analysis, and various trading strategies like scalping, day trading, swing trading, and Opening Range Breakout (ORB). The system features a Bloomberg Terminal-inspired interface, optimized for data-dense financial information and high-frequency decision-making.\n\n# User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n# System Architecture\n\n## Frontend\n- **Framework**: React 18 with TypeScript\n- **Build Tool**: Vite\n- **Routing**: Wouter\n- **State Management**: TanStack React Query\n- **UI Framework**: Radix UI with shadcn/ui\n- **Styling**: Tailwind CSS with custom financial trading tokens\n\n## Backend\n- **Runtime**: Node.js with Express.js\n- **Language**: TypeScript\n- **Session Management**: Connect-pg-simple for PostgreSQL-backed sessions\n- **Development**: Hot module replacement with Vite integration\n\n## Data Storage\n- **Primary Database**: PostgreSQL with Neon serverless hosting\n- **ORM**: Drizzle ORM\n- **Schema Validation**: Zod\n- **Trade History**: Stores comprehensive trade records (entry/exit, P&L, strategy, timeframe).\n- **Analytics Engine**: Real-time calculation of trading metrics (win rate, P&L, risk-reward).\n- **Economic Calendar**: Web scraping-based system from Investing.com with 15-minute caching and 7-day retention.\n\n## Economic Calendar Data Scraping\n- **Primary Source**: Investing.com\n- **Scraping Stack**: Cheerio (parsing), Axios (HTTP requests)\n- **Rate Limiting**: 3-second delays, rotating user agents\n- **Caching**: 15-minute cache, 7-day retention\n- **Scheduling**: Upcoming events (15 mins), full week (daily at 00:00 UTC), hourly cleanup.\n- **Data Standardization**: Normalizes event details (title, country, date/time, impact, forecast, actual, previous).\n- **API Endpoints**: `/api/calendar/today`, `/api/calendar/week`, `/api/economic-events`.\n\n## Design System\n- **Color Palette**: Dark-mode with financial trading colors (blue, green, red, amber).\n- **Typography**: Inter font for number readability.\n- **Components**: Card-based layout with 18rem sidebar navigation.\n- **Responsive Design**: Mobile-first with trading desk breakpoints.\n\n## Real-time Capabilities\n- **Market Data**: Live price feeds via Python/tessa integration (Yahoo Finance and CoinGecko).\n- **Session Monitoring**: Real-time tracking of major trading sessions (London, New York, Tokyo, Sydney).\n- **Signal Generation**: Live scanning and notification system for trading opportunities.\n\n## Python Price Service (tessa Integration)\n- **Location**: `server/python/price_service.py`\n- **Libraries**: tessa, yfinance, pycoingecko\n- **Data Sources**: \n  - Yahoo Finance for stocks, forex, commodities\n  - CoinGecko for cryptocurrency (with Yahoo fallback)\n- **Node.js Bridge**: `server/lib/priceService.ts` - spawns Python subprocess with JSON I/O\n- **Caching**: 30-second in-memory cache to reduce API calls\n- **API Endpoints**:\n  - `GET /api/prices/status` - Check if price service is online\n  - `GET /api/prices/:symbol?assetClass=stock|forex|commodity|crypto` - Single price\n  - `POST /api/prices/batch` - Batch price requests (max 50 symbols)\n- **Frontend Hook**: `client/src/hooks/usePrices.ts` - React Query integration with auto-refresh\n\n## Trading Analysis Framework\n- **Multi-timeframe Analysis**: 1D, 4H, 30M, 15M for analysis; 1M for entries.\n- **Technical Indicators**: Non-lagging volume, momentum, and trend indicators.\n- **Pattern Recognition**: Institutional candles, Fair Value Gaps (FVG), order blocks, liquidity sweeps.\n- **Risk Management**: Integrated stop-loss/take-profit with risk-reward ratios.\n- **Economic Calendar**: Tracks high/medium impact events with pre-release expectations and post-release analysis.\n\n## In-App Notification System\n- **Storage**: PostgreSQL table with read/unread status.\n- **Types**: Trading sessions (5 min before London/NY open), economic events (30 min advance for all impacts), trading signals.\n- **Real-time**: Unread count refreshes every 30 seconds.\n- **API Endpoints**: CRUD for notifications, mark as read, delete, signal creation.\n- **UI**: Popover in header with bell icon, badge, and management controls.\n\n## Telegram Notification System\n- **Integration**: node-telegram-bot-api for critical alerts.\n- **Commands**: `/start`, `/stop`, `/resume`, `/status`.\n- **Types**: Trading sessions (5 min before London/NY open), high/medium impact economic events (30 min advance).\n- **Scheduling**: Checks every 5 minutes.\n- **Frontend**: Telegram setup dropdown in header.\n\n## Supply/Demand Zone Detection\n- **Methodology**: Full range of base candle before institutional impulse.\n- **Differentiation**: Impulse direction determines zone type (bearish = supply, bullish = demand).\n- **Tracking**: Differentiates fresh vs. mitigated zones.\n- **Strength**: Calculated based on impulse magnitude and price reaction.\n\n## Liquidity Sweep Detection\n- **Pool Identification**: Detects Equal Highs/Lows, Swing Highs/Lows, Session Highs/Lows, Daily/Weekly/Monthly Highs/Lows.\n- **Sweep Detection**: Identifies price sweeping above/below liquidity pools.\n- **Mitigation**: Requires price to mitigate supply/demand zones after a sweep with structural confirmation.\n- **Entry Validation**: Close within zone AND next-candle reaction.\n- **Scoring**: +15 for sweep, +35+ for confirmed zone mitigation.\n- **Strategy Assignment**: \"liquidity_sweep_mitigation\" when criteria met.\n- **Reasoning**: Provides descriptive details of swept pools.\n\n## CHoCH (Change of Character) Detection\n- **Pattern Definition**: Identifies trend reversals through structural changes (HH/HL to LH/LL or vice versa).\n- **Swing Point Analysis**: Identifies HH, HL, LH, LL.\n- **Trend Change**: Bullish CHoCH (downtrend to HH), Bearish CHoCH (uptrend to LL).\n- **Entry Validation**: Confirmed CHoCH, targets unmitigated S/D zone, breaks 2+ S/D levels without mitigation, entry invalid if from unmitigated zone, rapid price push away from zone.\n- **Scoring**: +40 for valid CHoCH, +10 for 3+ levels broken, +10 for strong zone targeting.\n- **Priority**: Highest priority (CHoCH > liquidity sweep > traditional).\n- **Risk-Reward**: 1:3 R:R.\n\n## Modular Strategy Engine Architecture\n- **Location**: `server/strategies/`\n- **Core Components**:\n  - `core/strategyRegistry.ts` - Central registry for all trading strategies\n  - `core/baseStrategy.ts` - Abstract base class for all strategies\n  - `core/types.ts` - Shared TypeScript types for strategies\n- **Shared Utilities**: `server/strategies/shared/`\n  - `zoneDetection.ts` - Supply/demand zone detection and tracking\n  - `swingPoints.ts` - Swing point detection (HH, HL, LH, LL) and broken structure\n  - `candlePatterns.ts` - Institutional candles, engulfing, pin bars, rejection candles\n  - `multiTimeframe.ts` - Multi-timeframe data fetching and candle generation\n- **Design Principles**:\n  - Strategies are independent and isolated - one failure doesn't affect others\n  - Shared utilities layer for common trading analysis functions\n  - Strategy registry enables easy enable/disable and stats tracking\n  - Each strategy implements `analyze()` method with standardized output\n\n## SMC Strategy #1 (Smart Money Concepts)\n- **Location**: `server/strategies/smc/`\n- **Files**: config.ts, clarityAnalysis.ts, h4Context.ts, m15Zones.ts, zoneRefinement.ts, entryDetection.ts, index.ts\n- **Adaptive Timeframe Selection**:\n  - **Primary Timeframes**: 4H (context) + 15M (zones) - used when clarity is good\n  - **Alternative Timeframes**: 2H (context) + 30M (zones) - used when primary lacks clarity\n  - **Entry Timeframes**: 5M, 3M, or 1M - whichever has best clarity\n  - **Clarity Scoring**: Trend consistency (35%) + Zone clarity (35%) + Structure clarity (30%)\n  - **Minimum Clarity**: 60% required to proceed, otherwise market is skipped\n- **5-Step Analysis Process**:\n  1. **Clarity Analysis**: Evaluates all timeframes, selects best context/zone/entry TFs\n  2. **Context Analysis (4H/2H)**: Determines market control (supply/demand/neutral) and trend direction\n  3. **Zone Detection (15M/30M)**: Identifies unmitigated supply/demand zones, filters tradable zones\n  4. **Zone Refinement**: 15M→5M→1M (or 30M→3M→1M based on zone TF), stays higher if lower is messy\n  5. **Entry Detection + LTF Confirmation**: CHoCH, D/S-S/D flips, continuation - requires LTF candle confirmation\n- **Quality Focus**: Skips unclear markets entirely - setups must be clearly identified\n- **Entry Types**: CHoCH (40 base confidence), D/S-S/D Flip (35), Continuation (30)\n- **Confirmations**: Zone reaction (+15-20), reaction candle (+10), rejection candle (+10), strong zone (+10)\n- **LTF Confirmation**: Buy requires bullish close + higher low or price break; Sell requires bearish close + lower high or price break\n- **Targets**: Nearest unmitigated zone → H4 supply/demand → default 3:1 R:R\n\n## Google Gemini AI Integration\n- **Location**: `server/services/geminiAnalysis.ts`\n- **Model**: gemini-2.5-flash\n- **API Key**: `GOOGLE_API_KEY` (stored as secret)\n- **Role**: Gemini acts as an ASSISTANT to our refined SMC strategy (NOT a replacement)\n- **Functions**:\n  - **Signal Validation**: Reviews signals from our SMC strategy and provides second opinion\n  - **Confidence Adjustment**: Suggests confidence changes (-20 to +20) based on additional context\n  - **Risk Assessment**: Identifies concerns or additional confirmations needed\n  - **Quick Market Scan**: Pre-screens instruments to identify potential setups\n- **Critical Validation Rules**:\n  - **No Counter-Trend Trading**: Do NOT trade against the trend unless CHoCH is confirmed\n  - **Avoid Unclear Markets**: Skip signals when market structure is choppy, ranging, or messy\n  - **Trend Alignment**: BUY signals only in bullish trend, SELL signals only in bearish trend\n  - **CHoCH Exception**: Counter-trend signals ONLY valid with confirmed Change of Character\n- **Output Format**: Structured validation result with recommendation (proceed/caution/skip)\n- **Fallback Rule**: ONLY use strategy signal as-is when Gemini API is unavailable (marked `isFallback: true`)\n- **API Endpoints**:\n  - `GET /api/gemini/status` - Check Gemini connection status\n  - `POST /api/gemini/validate` - Validate a signal from our SMC strategy\n  - `POST /api/gemini/scan` - Quick market scan for pre-screening\n\n## PNG Chart Generation (for Telegram)\n- **Location**: `server/python/chart_generator.py` + `server/services/chartGenerator.ts`\n- **Libraries**: mplfinance, matplotlib\n- **Features**:\n  - Professional dark-themed trading charts\n  - Supply/Demand zones visualization\n  - Entry, Stop Loss, Take Profit markers\n  - Confidence percentage display\n- **API Endpoints**:\n  - `GET /api/charts/status` - Check if chart generator is available\n  - `POST /api/charts/generate` - Generate signal chart PNG\n  - `POST /api/charts/cleanup` - Clean up old chart files\n- **Output**: PNG images saved to `/tmp/charts/` for Telegram delivery\n\n## Real-Time Signal Generation\n- **Scanning Frequency**: Every 1 minute for 62 instruments (28 forex, 20 US stocks, 4 commodities, 4 crypto).\n- **Strategy Engine**: Modular architecture runs all enabled strategies per instrument\n- **Adaptive Multi-Timeframe Analysis**:\n  - Primary: 4H (context) → 15M (zones) → 5M/1M (entry)\n  - Alternative: 2H (context) → 30M (zones) → 3M/1M (entry)\n  - Selection based on clarity scoring per timeframe\n- **Pending Setups System**: Multi-stage validation (Forming <75% confidence, Monitoring, Ready >=70% confidence).\n- **Signal Thresholds**: Immediate (>=75%), Pending (50-74%), Ready (>=70%).\n- **Signal Lifecycle**: Active (4-hour expiry window) → Expired → Auto-archived to trade history.\n- **Expiry Tracking**: Live countdown timer displays time remaining until signal expires.\n- **Auto-Archival**: Expired signals automatically moved to trade history with duration and outcome tracking.\n- **Cleanup Scheduling**: Every 2 hours, expired signals are archived and removed from active list.\n\n# External Dependencies\n\n## UI and Component Libraries\n- **@radix-ui/**: Accessible UI primitives.\n- **class-variance-authority**: Type-safe variant API for styling.\n- **cmdk**: Command palette.\n- **embla-carousel-react**: Touch-friendly carousels.\n\n## Database and Data Management\n- **@neondatabase/serverless**: Serverless PostgreSQL.\n- **drizzle-orm**: Type-safe ORM for PostgreSQL.\n- **drizzle-zod**: Schema validation.\n- **connect-pg-simple**: PostgreSQL session store.\n\n## Development and Build Tools\n- **@tanstack/react-query**: Data fetching and caching.\n- **@hookform/resolvers**: Form validation with Zod.\n- **date-fns**: Date manipulation.\n- **wouter**: Minimalist React routing.\n- **@replit/vite-plugin-**: Replit-specific tooling.\n\n## Web Scraping and Data Collection\n- **cheerio**: HTML parsing.\n- **axios**: HTTP client.\n- **node-cron**: Task scheduler.\n\n## Styling and Design\n- **tailwindcss**: Utility-first CSS framework.\n- **tailwind-merge**: Tailwind class merging.\n- **clsx**: Conditional className utility.\n- **lucide-react**: Icon library.\n\n## AI and Analysis\n- **@google/genai**: Google Gemini AI SDK for SMC and Wyckoff analysis.\n- **mplfinance**: Python library for generating trading charts (PNG signals).\n- **matplotlib**: Chart rendering backend.\n\n## External APIs\n- **Google Gemini API** (`GOOGLE_API_KEY`): AI-powered chart analysis using SMC and Wyckoff methods.\n- **Yahoo Finance** (yfinance): Free price data for stocks, forex, commodities.\n- **CoinGecko**: Free cryptocurrency price data.\n- **Telegram Bot API** (`TELEGRAM_BOT_TOKEN`): Signal notifications with PNG charts.\n- **Investing.com** (web scraping): Economic calendar data.","size_bytes":13821},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5741},"client/src/pages/Dashboard.tsx":{"content":"import { HeroSection } from '@/components/HeroSection';\nimport TradingSession from '@/components/TradingSession';\nimport { Search } from 'lucide-react';\nimport { useQuery } from '@tanstack/react-query';\nimport SignalCard from '@/components/SignalCard';\nimport StockSignalCard from '@/components/StockSignalCard';\nimport WatchlistCard from '@/components/WatchlistCard';\nimport SectionHeader from '@/components/SectionHeader';\nimport { Target, Activity, Eye } from 'lucide-react';\nimport type { TradingSignal, PendingSetup } from '@shared/schema';\n\nexport default function Dashboard() {\n  const { data: allSignals = [], isLoading: signalsLoading } = useQuery<TradingSignal[]>({\n    queryKey: ['/api/trading-signals'],\n    refetchInterval: 10000,\n  });\n\n  const { data: pendingSetups = [], isLoading: setupsLoading } = useQuery<PendingSetup[]>({\n    queryKey: ['/api/pending-setups'],\n    refetchInterval: 15000,\n  });\n\n  // Filter active signals (all timeframes confirmed) vs watchlist (HTF only)\n  const activeSignals = allSignals.filter(s => s.status === 'active');\n  const watchlistSignals = allSignals.filter(s => s.status === 'watchlist' || s.status === 'pending');\n  \n  // Split active signals by asset class\n  const activeCurrencySignals = activeSignals.filter(s => {\n    const assetClass = s.assetClass?.toLowerCase();\n    return assetClass === 'forex' || assetClass === 'crypto' || assetClass === 'commodity';\n  });\n  const activeStockSignals = activeSignals.filter(s => s.assetClass?.toLowerCase() === 'stock' || s.assetClass?.toLowerCase() === 'index');\n  \n  // Split watchlist signals by asset class\n  const watchlistCurrencySignals = watchlistSignals.filter(s => {\n    const assetClass = s.assetClass?.toLowerCase();\n    return assetClass === 'forex' || assetClass === 'crypto' || assetClass === 'commodity';\n  });\n  const watchlistStockSignals = watchlistSignals.filter(s => s.assetClass?.toLowerCase() === 'stock' || s.assetClass?.toLowerCase() === 'index');\n  \n  // Pending setups from scanner (not yet saved as signals)\n  const pendingWatchlistItems = pendingSetups.filter(s => s.readyForSignal !== true);\n\n  return (\n    <div>\n      {/* Hero Section */}\n      <HeroSection />\n\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6\">\n        {/* Search Bar */}\n        <div className=\"border border-blue-500/50 bg-card dark:bg-background rounded-xl shadow-md\">\n          <div className=\"relative flex items-center py-4 px-6\">\n            <Search className=\"h-6 w-6 text-muted-foreground mr-4\" />\n            <input\n              type=\"text\"\n              placeholder=\"Search markets, pairs, or signals...\"\n              className=\"flex-grow bg-transparent text-lg text-foreground placeholder-muted-foreground focus:outline-none\"\n              data-testid=\"input-search\"\n            />\n          </div>\n        </div>\n\n        {/* Trading Sessions */}\n        <TradingSession />\n\n        {/* Full-Width Sections - NO SIDEBARS */}\n        <div className=\"space-y-8\">\n          \n          {/* Section 1: Active Currency, Metals & Crypto Signals - ALL 4 TIERS CONFIRMED */}\n          <section className=\"bg-card border-t-2 border-bull-green\">\n            <SectionHeader \n              icon={Target} \n              title=\"Active Signals - Currency, Metals & Crypto\" \n              countLabel={`${activeCurrencySignals.length} Confirmed`}\n            />\n            <p className=\"px-6 py-1.5 text-[10px] text-muted-foreground/50 border-b border-border/30 italic\">\n              1D Context + Major Zone (4H/2H/1H) + Zone ID (30M/15M) + Entry Trigger (5M/3M/1M) all confirmed\n            </p>\n            <div className=\"flex flex-col\">\n              {signalsLoading ? (\n                <div className=\"p-8 text-center text-muted-foreground\">Loading signals...</div>\n              ) : activeCurrencySignals.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground/70 text-sm\">No confirmed signals - waiting for entry trigger on 5M/3M/1M</div>\n              ) : (\n                activeCurrencySignals.slice(0, 10).map(signal => (\n                  <SignalCard key={signal.id} signal={signal} />\n                ))\n              )}\n            </div>\n          </section>\n\n          {/* Section 2: Active Stock & Index Signals - ALL 4 TIERS CONFIRMED */}\n          <section className=\"bg-card border-t-2 border-bull-green\">\n            <SectionHeader \n              icon={Activity} \n              title=\"Active Signals - Stocks & Indices\" \n              countLabel={`${activeStockSignals.length} Confirmed`}\n            />\n            <p className=\"px-6 py-1.5 text-[10px] text-muted-foreground/50 border-b border-border/30 italic\">\n              1D Context + Major Zone (4H/2H/1H) + Zone ID (30M/15M) + Entry Trigger (5M/3M/1M) all confirmed\n            </p>\n            <div className=\"flex flex-col\">\n              {signalsLoading ? (\n                <div className=\"p-8 text-center text-muted-foreground\">Loading stock signals...</div>\n              ) : activeStockSignals.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground/70 text-sm\">No confirmed stock signals - waiting for entry trigger on 5M/3M/1M</div>\n              ) : (\n                activeStockSignals.slice(0, 10).map(signal => (\n                  <StockSignalCard key={signal.id} signal={signal} />\n                ))\n              )}\n            </div>\n          </section>\n\n          {/* Section 3: Watchlist - 3 TIERS CONFIRMED, AWAITING ENTRY TRIGGER */}\n          <section className=\"bg-card border-t-2 border-amber-500\">\n            <SectionHeader \n              icon={Eye} \n              title=\"Watchlist - Awaiting Entry Trigger\" \n              countLabel={`${watchlistCurrencySignals.length + watchlistStockSignals.length + pendingWatchlistItems.length} Pending`}\n            />\n            <p className=\"px-6 py-1.5 text-[10px] text-muted-foreground/50 border-b border-border/30 italic\">\n              1D Context + Major Zone (4H/2H/1H) + Zone ID (30M/15M) confirmed. Watching 5M/3M/1M for entry trigger.\n            </p>\n            <div className=\"flex flex-col\">\n              {signalsLoading ? (\n                <div className=\"p-8 text-center text-muted-foreground\">Loading watchlist...</div>\n              ) : (watchlistCurrencySignals.length + watchlistStockSignals.length + pendingWatchlistItems.length) === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground/70 text-sm\">No pending setups - scanning for major zones on 4H/2H/1H...</div>\n              ) : (\n                <>\n                  {watchlistCurrencySignals.slice(0, 5).map(signal => (\n                    <SignalCard key={signal.id} signal={signal} isWatchlist={true} />\n                  ))}\n                  {watchlistStockSignals.slice(0, 5).map(signal => (\n                    <StockSignalCard key={signal.id} signal={signal} isWatchlist={true} />\n                  ))}\n                  {pendingWatchlistItems.slice(0, 5).map(item => (\n                    <WatchlistCard key={`pending-${item.symbol}-${item.id}`} item={item} />\n                  ))}\n                </>\n              )}\n            </div>\n          </section>\n\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":7275},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ThemeToggle.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Moon, Sun } from 'lucide-react';\n\nexport default function ThemeToggle() {\n  const [theme, setTheme] = useState<'light' | 'dark'>('dark');\n\n  useEffect(() => {\n    const savedTheme = localStorage.getItem('theme') as 'light' | 'dark' | null;\n    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;\n    const initialTheme = savedTheme || (prefersDark ? 'dark' : 'light');\n    \n    setTheme(initialTheme);\n    document.documentElement.classList.toggle('dark', initialTheme === 'dark');\n  }, []);\n\n  const toggleTheme = () => {\n    const newTheme = theme === 'light' ? 'dark' : 'light';\n    setTheme(newTheme);\n    localStorage.setItem('theme', newTheme);\n    document.documentElement.classList.toggle('dark', newTheme === 'dark');\n    console.log(`Theme switched to ${newTheme}`);\n  };\n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"icon\"\n      onClick={toggleTheme}\n      className=\"w-9 h-9\"\n      data-testid=\"button-theme-toggle\"\n    >\n      {theme === 'light' ? (\n        <Moon className=\"w-4 h-4\" />\n      ) : (\n        <Sun className=\"w-4 h-4\" />\n      )}\n    </Button>\n  );\n}","size_bytes":1219},"design_guidelines.md":{"content":"# Infod Trading Partner System - Design Guidelines\n\n## Design Approach\n**Selected Approach**: Design System (Material Design) with Financial Trading Industry References\n**Justification**: This is a utility-focused, information-dense financial application requiring maximum efficiency and data clarity. Drawing inspiration from Bloomberg Terminal, TradingView, and MetaTrader interfaces.\n\n**Key Design Principles**:\n- Data-first hierarchy with clear visual separation\n- High contrast for critical trading information\n- Minimal cognitive load through consistent patterns\n- Professional, trustworthy aesthetic\n\n## Core Design Elements\n\n### A. Color Palette\n**Dark Mode Primary** (default):\n- Background: 210 15% 8%\n- Surface: 210 12% 12% \n- Primary: 210 100% 60% (trading blue)\n- Success: 120 60% 50% (profit green)\n- Danger: 0 75% 60% (loss red)\n- Warning: 45 90% 60% (alert amber)\n- Text Primary: 210 15% 95%\n- Text Secondary: 210 10% 70%\n\n**Light Mode**:\n- Background: 210 15% 98%\n- Surface: 210 10% 95%\n- Text Primary: 210 15% 15%\n\n### B. Typography\n**Font Stack**: Inter (Google Fonts) for optimal number readability\n- Headers: 600 weight, 24px-32px\n- Body: 400 weight, 14px-16px  \n- Data/Numbers: 500 weight, 14px (tabular numbers)\n- Labels: 500 weight, 12px uppercase\n\n### C. Layout System\n**Spacing Units**: Consistent use of 4, 8, 16, 24 units\n- Component padding: p-4, p-6\n- Section margins: m-8, m-12\n- Grid gaps: gap-4, gap-6\n\n### D. Component Library\n\n**Dashboard Layout**:\n- 12-column grid system with breakpoints\n- Sidebar navigation (240px fixed width)\n- Main content area with card-based modules\n- Status bar showing active session and connection\n\n**Data Display Components**:\n- Market overview cards with price, change, volume\n- Economic calendar table with impact indicators\n- Signal cards showing entry/exit levels and R:R ratios\n- Chart containers with technical indicator overlays\n\n**Navigation**:\n- Vertical sidebar with market categories\n- Horizontal tabs for timeframe switching\n- Breadcrumb navigation for deep analysis views\n\n**Interactive Elements**:\n- Real-time price tickers with color-coded changes\n- Expandable signal details with reasoning\n- Filterable watchlists and screeners\n\n### E. Specialized Financial UI Patterns\n\n**Price Display Standards**:\n- Green/red color coding for positive/negative changes\n- Consistent decimal precision per asset class\n- Percentage changes in parentheses\n- Volume with K/M/B abbreviations\n\n**Chart Integration**:\n- Dark theme candlestick charts\n- Support/resistance level overlays\n- Signal annotation markers\n- Multi-timeframe toggle buttons\n\n**Alert System**:\n- Toast notifications for new signals\n- Status indicators for market sessions\n- Connection status with WebSocket health\n- Priority-based notification styling\n\n**Data Tables**:\n- Sortable columns with directional indicators\n- Row highlighting for active positions\n- Expandable rows for additional details\n- Fixed headers for long datasets\n\n## Visual Hierarchy\n1. **Critical Trading Data**: Largest, highest contrast\n2. **Market Context**: Secondary prominence with clear grouping\n3. **Historical/Reference**: Subtle styling, easily scannable\n4. **System Status**: Minimal but always visible\n\nThis design system prioritizes speed of information processing and decision-making while maintaining the professional standards expected in financial trading applications.","size_bytes":3386},"client/src/components/EconomicCalendar.tsx":{"content":"import { useState } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Calendar, AlertTriangle, TrendingUp, TrendingDown, Minus } from 'lucide-react';\nimport { format } from 'date-fns';\nimport EventDetailsDialog from './EventDetailsDialog';\n\ninterface EconomicEvent {\n  id: string;\n  title: string;\n  currency: string;\n  countryCode?: string;\n  impactLevel: string;\n  eventTime: string;\n  expectedValue: string | null;\n  previousValue: string | null;\n  actualValue: string | null;\n  marketImpactAnalysis: string | null;\n  isReleased: boolean;\n  preReleaseSentiment?: string;\n  postReleaseSentiment?: string;\n  expertSentiment?: string;\n}\n\nexport default function EconomicCalendar() {\n  const [selectedEventId, setSelectedEventId] = useState<string | null>(null);\n  const [dialogOpen, setDialogOpen] = useState(false);\n\n  const { data: allEvents = [], isLoading } = useQuery<EconomicEvent[]>({\n    queryKey: ['/api/economic-events'],\n  });\n\n  const events = allEvents.slice(0, 20);\n\n  const handleEventClick = (eventId: string) => {\n    setSelectedEventId(eventId);\n    setDialogOpen(true);\n  };\n\n  const getImpactVariant = (impact: string): \"default\" | \"secondary\" | \"outline\" => {\n    const impactLower = impact?.toLowerCase() || '';\n    if (impactLower === 'high') return 'default';\n    if (impactLower === 'medium') return 'secondary';\n    return 'outline';\n  };\n\n  const groupEventsByDate = (events: EconomicEvent[]) => {\n    const grouped: { [key: string]: EconomicEvent[] } = {};\n    events.forEach(event => {\n      const dateKey = format(new Date(event.eventTime), 'yyyy-MM-dd');\n      if (!grouped[dateKey]) {\n        grouped[dateKey] = [];\n      }\n      grouped[dateKey].push(event);\n    });\n    return grouped;\n  };\n\n  const groupedEvents = groupEventsByDate(events);\n\n  const getMarketSentiment = (event: EconomicEvent) => {\n    let sentiment = 'neutral';\n    \n    if (event.isReleased && event.postReleaseSentiment) {\n      sentiment = event.postReleaseSentiment;\n    } else if (event.preReleaseSentiment) {\n      sentiment = event.preReleaseSentiment;\n    } else if (event.expertSentiment) {\n      sentiment = event.expertSentiment;\n    }\n    \n    if (sentiment === 'bullish') {\n      return { \n        sentiment: 'Bullish', \n        icon: <TrendingUp className=\"w-3 h-3 text-green-500\" />\n      };\n    } else if (sentiment === 'bearish') {\n      return { \n        sentiment: 'Bearish', \n        icon: <TrendingDown className=\"w-3 h-3 text-red-500\" />\n      };\n    }\n    return { \n      sentiment: 'Neutral', \n      icon: <Minus className=\"w-3 h-3 text-muted-foreground/50\" />\n    };\n  };\n\n  if (isLoading) {\n    return (\n      <Card data-testid=\"card-economic-calendar\">\n        <CardHeader className=\"pb-4\">\n          <CardTitle className=\"flex items-center gap-2 text-lg font-semibold\">\n            <Calendar className=\"w-5 h-5\" />\n            Economic Calendar\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <p className=\"text-sm text-muted-foreground text-center py-4\">Loading events...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card data-testid=\"card-economic-calendar\">\n      <CardHeader className=\"pb-4\">\n        <CardTitle className=\"flex items-center gap-2 text-lg font-semibold\">\n          <Calendar className=\"w-5 h-5\" />\n          Economic Calendar\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-4\">\n          {events.length === 0 ? (\n            <p className=\"text-sm text-muted-foreground text-center py-4\">No upcoming events</p>\n          ) : (\n            Object.entries(groupedEvents).map(([dateKey, dateEvents]) => {\n              const date = new Date(dateKey);\n              const isToday = format(new Date(), 'yyyy-MM-dd') === dateKey;\n              const isTomorrow = format(new Date(Date.now() + 86400000), 'yyyy-MM-dd') === dateKey;\n              \n              return (\n                <div key={dateKey} className=\"space-y-3\">\n                  <div className=\"sticky top-0 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 z-10 pb-2 pt-1\">\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"text-sm font-semibold\">\n                        {isToday ? 'Today' : isTomorrow ? 'Tomorrow' : format(date, 'EEE, MMM d')}\n                      </div>\n                      <div className=\"h-px flex-1 bg-border\"></div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    {dateEvents.map((event) => {\n                      const sentiment = getMarketSentiment(event);\n                      const eventTime = new Date(event.eventTime);\n                      \n                      return (\n                        <div\n                          key={event.id}\n                          onClick={() => handleEventClick(event.id)}\n                          className=\"group p-3 rounded-md border border-border hover-elevate active-elevate-2 transition-all cursor-pointer\"\n                          data-testid={`card-event-${event.id}`}\n                        >\n                          <div className=\"flex items-start justify-between mb-2\">\n                            <div className=\"flex items-center gap-2 flex-wrap\">\n                              <Badge \n                                variant=\"secondary\"\n                                className=\"text-xs font-medium shrink-0\"\n                              >\n                                {event.currency || event.countryCode}\n                              </Badge>\n                              <span className=\"text-xs font-mono text-muted-foreground shrink-0\" data-testid={`text-time-${event.id}`}>\n                                {format(eventTime, 'HH:mm')}\n                              </span>\n                              {event.impactLevel?.toLowerCase() === 'high' && (\n                                <AlertTriangle className=\"w-3 h-3 text-destructive shrink-0\" />\n                              )}\n                            </div>\n                            <div className=\"flex items-center gap-1.5 shrink-0\">\n                              {sentiment.icon}\n                              <Badge \n                                variant={getImpactVariant(event.impactLevel)}\n                                className=\"text-xs\"\n                              >\n                                {event.impactLevel?.toUpperCase() || 'MEDIUM'}\n                              </Badge>\n                            </div>\n                          </div>\n                          \n                          <div className=\"mb-2\">\n                            <h4 className=\"font-medium text-sm leading-snug group-hover:text-foreground transition-colors\" data-testid={`text-event-${event.id}`}>\n                              {event.title}\n                            </h4>\n                          </div>\n                          \n                          {(event.expectedValue || event.previousValue) && (\n                            <div className=\"flex items-center gap-3 text-xs mb-1.5\">\n                              {event.previousValue && (\n                                <div className=\"flex items-center gap-1\">\n                                  <span className=\"text-muted-foreground\">Prev:</span>\n                                  <span className=\"font-mono font-medium\" data-testid={`text-previous-${event.id}`}>\n                                    {event.previousValue}\n                                  </span>\n                                </div>\n                              )}\n                              {event.expectedValue && (\n                                <div className=\"flex items-center gap-1\">\n                                  <span className=\"text-muted-foreground\">Fcst:</span>\n                                  <span className=\"font-mono font-medium\" data-testid={`text-forecast-${event.id}`}>\n                                    {event.expectedValue}\n                                  </span>\n                                </div>\n                              )}\n                            </div>\n                          )}\n                          \n                          <div className=\"flex items-center justify-between text-xs\">\n                            <div className={`font-medium ${\n                              sentiment.sentiment === 'Bullish' ? 'text-green-500' : \n                              sentiment.sentiment === 'Bearish' ? 'text-red-500' : 'text-muted-foreground'\n                            }`}>\n                              {sentiment.sentiment}\n                            </div>\n                            {event.actualValue && (\n                              <Badge variant=\"outline\" className=\"text-xs bg-blue-500/10 text-blue-500 border-blue-500/20\">\n                                Released: {event.actualValue}\n                              </Badge>\n                            )}\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </div>\n              );\n            })\n          )}\n        </div>\n      </CardContent>\n      \n      <EventDetailsDialog \n        eventId={selectedEventId}\n        open={dialogOpen}\n        onOpenChange={setDialogOpen}\n      />\n    </Card>\n  );\n}","size_bytes":9572},"client/src/components/examples/EconomicCalendar.tsx":{"content":"import EconomicCalendar from '../EconomicCalendar';\n\nexport default function EconomicCalendarExample() {\n  return <EconomicCalendar />;\n}","size_bytes":137},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"server/scrapers/scheduler.ts":{"content":"import * as cron from 'node-cron';\nimport { economicCalendarScraper } from './economicCalendarScraper';\nimport { cacheService } from './cacheService';\nimport { scraperSettings } from './config';\nimport { telegramNotificationService } from '../services/telegramNotification';\nimport { signalScannerService } from '../services/signalScanner';\n\nexport class ScraperScheduler {\n  private upcomingEventsJob: ReturnType<typeof cron.schedule> | null = null;\n  private fullWeekJob: ReturnType<typeof cron.schedule> | null = null;\n  private cleanupJob: ReturnType<typeof cron.schedule> | null = null;\n  private notificationJob: ReturnType<typeof cron.schedule> | null = null;\n  private signalScanJob: ReturnType<typeof cron.schedule> | null = null;\n  private signalCleanupJob: ReturnType<typeof cron.schedule> | null = null;\n  private isRunning = false;\n\n  async runUpcomingEventsScrape(): Promise<void> {\n    if (this.isRunning) {\n      console.log('Scrape already in progress, skipping...');\n      return;\n    }\n\n    try {\n      this.isRunning = true;\n      console.log('Starting upcoming events scrape...');\n      \n      const events = await economicCalendarScraper.scrapeWithRetry();\n      if (events.length > 0) {\n        await cacheService.storeEvents(events);\n        console.log(`Successfully scraped and stored ${events.length} events`);\n      } else {\n        console.log('No events scraped');\n      }\n    } catch (error) {\n      console.error('Error during upcoming events scrape:', error);\n    } finally {\n      this.isRunning = false;\n    }\n  }\n\n  async runFullWeekScrape(): Promise<void> {\n    try {\n      console.log('Starting full week scrape...');\n      \n      const events = await economicCalendarScraper.scrapeWithRetry();\n      if (events.length > 0) {\n        await cacheService.storeEvents(events);\n        console.log(`Successfully scraped and stored ${events.length} events for the week`);\n      } else {\n        console.log('No events scraped for the week');\n      }\n    } catch (error) {\n      console.error('Error during full week scrape:', error);\n    }\n  }\n\n  async runCleanup(): Promise<void> {\n    try {\n      console.log('Running cleanup of old events...');\n      await cacheService.cleanupOldEvents();\n      console.log('Cleanup completed');\n    } catch (error) {\n      console.error('Error during cleanup:', error);\n    }\n  }\n\n  start(): void {\n    console.log('Starting economic calendar scraper scheduler...');\n\n    const upcomingIntervalMinutes = Math.floor(\n      scraperSettings.schedules.upcomingEventsInterval / (60 * 1000)\n    );\n    const upcomingCronPattern = `*/${upcomingIntervalMinutes} * * * *`;\n    \n    this.upcomingEventsJob = cron.schedule(upcomingCronPattern, async () => {\n      await this.runUpcomingEventsScrape();\n    });\n\n    this.fullWeekJob = cron.schedule(scraperSettings.schedules.fullWeekScrapeTime, async () => {\n      await this.runFullWeekScrape();\n    });\n\n    const cleanupIntervalHours = Math.floor(\n      scraperSettings.cacheSettings.cleanupInterval / (60 * 60 * 1000)\n    );\n    const cleanupCronPattern = `0 */${cleanupIntervalHours} * * *`;\n    \n    this.cleanupJob = cron.schedule(cleanupCronPattern, async () => {\n      await this.runCleanup();\n    });\n\n    this.notificationJob = cron.schedule('*/5 * * * *', async () => {\n      console.log('Checking for events and sessions to notify...');\n      await telegramNotificationService.checkAndNotifyUpcomingEvents();\n      await telegramNotificationService.checkAndNotifyTradingSessions();\n    });\n\n    this.signalScanJob = cron.schedule('*/1 * * * *', async () => {\n      console.log('Running automated signal market scan...');\n      await signalScannerService.scanMarkets();\n    });\n\n    this.signalCleanupJob = cron.schedule('0 */2 * * *', async () => {\n      console.log('Running signal cleanup...');\n      await signalScannerService.cleanupExpiredSignals();\n    });\n\n    console.log(`Scheduled upcoming events scrape: every ${upcomingIntervalMinutes} minutes`);\n    console.log(`Scheduled full week scrape: ${scraperSettings.schedules.fullWeekScrapeTime}`);\n    console.log(`Scheduled cleanup: every ${cleanupIntervalHours} hours`);\n    console.log(`Scheduled Telegram notifications (events, sessions, signals): every 5 minutes`);\n    console.log('Scheduled automated signal scanning: every 1 minute');\n    console.log('Scheduled signal cleanup: every 2 hours');\n\n    this.runUpcomingEventsScrape();\n    signalScannerService.scanMarkets();\n  }\n\n  stop(): void {\n    console.log('Stopping economic calendar scraper scheduler...');\n    \n    if (this.upcomingEventsJob) {\n      this.upcomingEventsJob.stop();\n      this.upcomingEventsJob = null;\n    }\n    \n    if (this.fullWeekJob) {\n      this.fullWeekJob.stop();\n      this.fullWeekJob = null;\n    }\n    \n    if (this.cleanupJob) {\n      this.cleanupJob.stop();\n      this.cleanupJob = null;\n    }\n\n    if (this.notificationJob) {\n      this.notificationJob.stop();\n      this.notificationJob = null;\n    }\n\n    if (this.signalScanJob) {\n      this.signalScanJob.stop();\n      this.signalScanJob = null;\n    }\n\n    if (this.signalCleanupJob) {\n      this.signalCleanupJob.stop();\n      this.signalCleanupJob = null;\n    }\n    \n    console.log('Scheduler stopped');\n  }\n}\n\nexport const scraperScheduler = new ScraperScheduler();\n","size_bytes":5297},"client/src/components/examples/ThemeToggle.tsx":{"content":"import ThemeToggle from '../ThemeToggle';\n\nexport default function ThemeToggleExample() {\n  return <ThemeToggle />;\n}","size_bytes":117},"client/src/components/examples/TradingSession.tsx":{"content":"import TradingSession from '../TradingSession';\n\nexport default function TradingSessionExample() {\n  return <TradingSession />;\n}","size_bytes":129},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":971},"server/storage.ts":{"content":"import { type User, type InsertUser, type Trade, type InsertTrade, type EconomicEvent, type InsertEconomicEvent, type TradingSignal, type InsertTradingSignal, type PendingSetup, type InsertPendingSetup } from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\n\nexport interface IStorage {\n  getUser(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n  \n  getTrades(userId?: string): Promise<Trade[]>;\n  getTradeById(id: string): Promise<Trade | undefined>;\n  createTrade(trade: InsertTrade): Promise<Trade>;\n  updateTrade(id: string, trade: Partial<InsertTrade>): Promise<Trade | undefined>;\n  deleteTrade(id: string): Promise<boolean>;\n  \n  getEconomicEvents(filters?: { region?: string; impactLevel?: string; currency?: string }): Promise<EconomicEvent[]>;\n  getEconomicEventById(id: string): Promise<EconomicEvent | undefined>;\n  createEconomicEvent(event: InsertEconomicEvent): Promise<EconomicEvent>;\n  updateEconomicEvent(id: string, event: Partial<InsertEconomicEvent>): Promise<EconomicEvent | undefined>;\n  deleteEconomicEvent(id: string): Promise<boolean>;\n  \n  getTradingSignals(filters?: { status?: string; assetClass?: string; symbol?: string }): Promise<TradingSignal[]>;\n  getTradingSignalById(id: string): Promise<TradingSignal | undefined>;\n  createTradingSignal(signal: InsertTradingSignal): Promise<TradingSignal>;\n  updateTradingSignal(id: string, signal: Partial<InsertTradingSignal>): Promise<TradingSignal | undefined>;\n  deleteTradingSignal(id: string): Promise<boolean>;\n  \n  getPendingSetups(filters?: { symbol?: string; readyForSignal?: boolean; invalidated?: boolean }): Promise<PendingSetup[]>;\n  getPendingSetupById(id: string): Promise<PendingSetup | undefined>;\n  createPendingSetup(setup: InsertPendingSetup): Promise<PendingSetup>;\n  updatePendingSetup(id: string, setup: Partial<InsertPendingSetup>): Promise<PendingSetup | undefined>;\n  deletePendingSetup(id: string): Promise<boolean>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User>;\n  private trades: Map<string, Trade>;\n  private economicEvents: Map<string, EconomicEvent>;\n  private tradingSignals: Map<string, TradingSignal>;\n  private pendingSetups: Map<string, PendingSetup>;\n\n  constructor() {\n    this.users = new Map();\n    this.trades = new Map();\n    this.economicEvents = new Map();\n    this.tradingSignals = new Map();\n    this.pendingSetups = new Map();\n  }\n\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    return Array.from(this.users.values()).find(\n      (user) => user.username === username,\n    );\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const id = randomUUID();\n    const user: User = { ...insertUser, id };\n    this.users.set(id, user);\n    return user;\n  }\n\n  async getTrades(userId?: string): Promise<Trade[]> {\n    const allTrades = Array.from(this.trades.values());\n    if (userId) {\n      return allTrades.filter(trade => trade.userId === userId);\n    }\n    return allTrades;\n  }\n\n  async getTradeById(id: string): Promise<Trade | undefined> {\n    return this.trades.get(id);\n  }\n\n  async createTrade(insertTrade: InsertTrade): Promise<Trade> {\n    const id = randomUUID();\n    const trade: Trade = {\n      ...insertTrade,\n      id,\n      userId: insertTrade.userId ?? null,\n      createdAt: new Date(),\n    };\n    this.trades.set(id, trade);\n    return trade;\n  }\n\n  async updateTrade(id: string, updateData: Partial<InsertTrade>): Promise<Trade | undefined> {\n    const trade = this.trades.get(id);\n    if (!trade) {\n      return undefined;\n    }\n    const updatedTrade = { ...trade, ...updateData };\n    this.trades.set(id, updatedTrade);\n    return updatedTrade;\n  }\n\n  async deleteTrade(id: string): Promise<boolean> {\n    return this.trades.delete(id);\n  }\n\n  async getEconomicEvents(filters?: { region?: string; impactLevel?: string; currency?: string }): Promise<EconomicEvent[]> {\n    let events = Array.from(this.economicEvents.values());\n    \n    if (filters) {\n      if (filters.region) {\n        events = events.filter(e => e.region === filters.region);\n      }\n      if (filters.impactLevel) {\n        events = events.filter(e => e.impactLevel === filters.impactLevel);\n      }\n      if (filters.currency) {\n        events = events.filter(e => e.currency === filters.currency);\n      }\n    }\n    \n    return events.sort((a, b) => \n      new Date(a.eventTime).getTime() - new Date(b.eventTime).getTime()\n    );\n  }\n\n  async getEconomicEventById(id: string): Promise<EconomicEvent | undefined> {\n    return this.economicEvents.get(id);\n  }\n\n  async createEconomicEvent(insertEvent: InsertEconomicEvent): Promise<EconomicEvent> {\n    const id = randomUUID();\n    const event: EconomicEvent = {\n      ...insertEvent,\n      id,\n      countryCode: insertEvent.countryCode ?? null,\n      affectedCurrencies: insertEvent.affectedCurrencies ?? [],\n      affectedStocks: insertEvent.affectedStocks ?? [],\n      description: insertEvent.description ?? null,\n      expectedValue: insertEvent.expectedValue ?? null,\n      previousValue: insertEvent.previousValue ?? null,\n      actualValue: insertEvent.actualValue ?? null,\n      unit: insertEvent.unit ?? null,\n      futuresImpliedExpectation: insertEvent.futuresImpliedExpectation ?? null,\n      surpriseFactor: insertEvent.surpriseFactor ?? null,\n      marketImpactAnalysis: insertEvent.marketImpactAnalysis ?? null,\n      expertSentiment: insertEvent.expertSentiment ?? null,\n      preReleaseSentiment: insertEvent.preReleaseSentiment ?? null,\n      postReleaseSentiment: insertEvent.postReleaseSentiment ?? null,\n      currencyPairImpacts: insertEvent.currencyPairImpacts ?? null,\n      stockImpacts: insertEvent.stockImpacts ?? null,\n      sourceSite: insertEvent.sourceSite ?? null,\n      sourceUrl: insertEvent.sourceUrl ?? null,\n      isReleased: insertEvent.isReleased ?? false,\n      telegramNotified: false,\n      lastScraped: new Date(),\n      createdAt: new Date(),\n    };\n    this.economicEvents.set(id, event);\n    return event;\n  }\n\n  async updateEconomicEvent(id: string, updateData: Partial<InsertEconomicEvent>): Promise<EconomicEvent | undefined> {\n    const event = this.economicEvents.get(id);\n    if (!event) {\n      return undefined;\n    }\n    const updatedEvent = { ...event, ...updateData };\n    this.economicEvents.set(id, updatedEvent);\n    return updatedEvent;\n  }\n\n  async deleteEconomicEvent(id: string): Promise<boolean> {\n    return this.economicEvents.delete(id);\n  }\n\n  async getTradingSignals(filters?: { status?: string; assetClass?: string; symbol?: string }): Promise<TradingSignal[]> {\n    let signals = Array.from(this.tradingSignals.values());\n    \n    if (filters) {\n      if (filters.status) {\n        signals = signals.filter(s => s.status === filters.status);\n      }\n      if (filters.assetClass) {\n        signals = signals.filter(s => s.assetClass === filters.assetClass);\n      }\n      if (filters.symbol) {\n        signals = signals.filter(s => s.symbol === filters.symbol);\n      }\n    }\n    \n    return signals.sort((a, b) => \n      new Date(b.createdAt!).getTime() - new Date(a.createdAt!).getTime()\n    );\n  }\n\n  async getTradingSignalById(id: string): Promise<TradingSignal | undefined> {\n    return this.tradingSignals.get(id);\n  }\n\n  async createTradingSignal(insertSignal: InsertTradingSignal): Promise<TradingSignal> {\n    const id = randomUUID();\n    const signal: TradingSignal = {\n      ...insertSignal,\n      id,\n      status: insertSignal.status ?? 'active',\n      confirmationTimeframe: insertSignal.confirmationTimeframe ?? null,\n      executionTimeframe: insertSignal.executionTimeframe ?? null,\n      interestRateDiffScore: insertSignal.interestRateDiffScore ?? null,\n      interestRateDiffValue: insertSignal.interestRateDiffValue ?? null,\n      interestRateNotes: insertSignal.interestRateNotes ?? null,\n      inflationImpactScore: insertSignal.inflationImpactScore ?? null,\n      inflationDifferential: insertSignal.inflationDifferential ?? null,\n      inflationNotes: insertSignal.inflationNotes ?? null,\n      trendScore: insertSignal.trendScore ?? null,\n      trendDirection: insertSignal.trendDirection ?? null,\n      trendStrength: insertSignal.trendStrength ?? null,\n      trendTimeframes: insertSignal.trendTimeframes ?? [],\n      smcScore: insertSignal.smcScore ?? null,\n      institutionalCandleDetected: insertSignal.institutionalCandleDetected ?? false,\n      institutionalCandleData: insertSignal.institutionalCandleData ?? null,\n      orderBlockType: insertSignal.orderBlockType ?? null,\n      orderBlockLevel: insertSignal.orderBlockLevel ?? null,\n      fvgDetected: insertSignal.fvgDetected ?? false,\n      fvgLevel: insertSignal.fvgLevel ?? null,\n      liquiditySweep: insertSignal.liquiditySweep ?? false,\n      liquiditySweepLevel: insertSignal.liquiditySweepLevel ?? null,\n      breakerBlockDetected: insertSignal.breakerBlockDetected ?? false,\n      bocChochDetected: insertSignal.bocChochDetected ?? null,\n      smcFactors: insertSignal.smcFactors ?? [],\n      technicalReasons: insertSignal.technicalReasons ?? [],\n      marketContext: insertSignal.marketContext ?? null,\n      strength: insertSignal.strength ?? null,\n      zonesTested: insertSignal.zonesTested ?? 0,\n      expiresAt: insertSignal.expiresAt ?? null,\n      executedAt: insertSignal.executedAt ?? null,\n      invalidatedAt: insertSignal.invalidatedAt ?? null,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n    this.tradingSignals.set(id, signal);\n    return signal;\n  }\n\n  async updateTradingSignal(id: string, updateData: Partial<InsertTradingSignal>): Promise<TradingSignal | undefined> {\n    const signal = this.tradingSignals.get(id);\n    if (!signal) {\n      return undefined;\n    }\n    const updatedSignal = { ...signal, ...updateData, updatedAt: new Date() };\n    this.tradingSignals.set(id, updatedSignal);\n    return updatedSignal;\n  }\n\n  async deleteTradingSignal(id: string): Promise<boolean> {\n    return this.tradingSignals.delete(id);\n  }\n\n  async getPendingSetups(filters?: { symbol?: string; readyForSignal?: boolean; invalidated?: boolean }): Promise<PendingSetup[]> {\n    let setups = Array.from(this.pendingSetups.values());\n    \n    if (filters) {\n      if (filters.symbol) {\n        setups = setups.filter(s => s.symbol === filters.symbol);\n      }\n      if (filters.readyForSignal !== undefined) {\n        setups = setups.filter(s => s.readyForSignal === filters.readyForSignal);\n      }\n      if (filters.invalidated !== undefined) {\n        setups = setups.filter(s => s.invalidated === filters.invalidated);\n      }\n    }\n    \n    return setups.sort((a, b) => \n      new Date(b.createdAt!).getTime() - new Date(a.createdAt!).getTime()\n    );\n  }\n\n  async getPendingSetupById(id: string): Promise<PendingSetup | undefined> {\n    return this.pendingSetups.get(id);\n  }\n\n  async createPendingSetup(insertSetup: InsertPendingSetup): Promise<PendingSetup> {\n    const id = randomUUID();\n    const setup: PendingSetup = {\n      ...insertSetup,\n      id,\n      potentialStrategy: insertSetup.potentialStrategy ?? null,\n      confirmationTimeframe: insertSetup.confirmationTimeframe ?? null,\n      interestRateBias: insertSetup.interestRateBias ?? null,\n      inflationBias: insertSetup.inflationBias ?? null,\n      trendBias: insertSetup.trendBias ?? null,\n      chochDetected: insertSetup.chochDetected ?? false,\n      chochDirection: insertSetup.chochDirection ?? null,\n      liquiditySweepDetected: insertSetup.liquiditySweepDetected ?? false,\n      supplyDemandZoneTargeted: insertSetup.supplyDemandZoneTargeted ?? false,\n      zoneLevel: insertSetup.zoneLevel ?? null,\n      zoneMitigated: insertSetup.zoneMitigated ?? false,\n      levelsBroken: insertSetup.levelsBroken ?? 0,\n      confirmationsPending: insertSetup.confirmationsPending ?? [],\n      setupNotes: insertSetup.setupNotes ?? [],\n      marketContext: insertSetup.marketContext ?? null,\n      lastCheckedPrice: insertSetup.lastCheckedPrice ?? null,\n      lastCheckedAt: new Date(),\n      readyForSignal: insertSetup.readyForSignal ?? false,\n      invalidated: insertSetup.invalidated ?? false,\n      invalidationReason: insertSetup.invalidationReason ?? null,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n    this.pendingSetups.set(id, setup);\n    return setup;\n  }\n\n  async updatePendingSetup(id: string, updateData: Partial<InsertPendingSetup>): Promise<PendingSetup | undefined> {\n    const setup = this.pendingSetups.get(id);\n    if (!setup) {\n      return undefined;\n    }\n    const updatedSetup = { ...setup, ...updateData, updatedAt: new Date(), lastCheckedAt: new Date() };\n    this.pendingSetups.set(id, updatedSetup);\n    return updatedSetup;\n  }\n\n  async deletePendingSetup(id: string): Promise<boolean> {\n    return this.pendingSetups.delete(id);\n  }\n}\n\nexport const storage = new MemStorage();\n","size_bytes":13050},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/examples/TradingSignals.tsx":{"content":"import TradingSignals from '../TradingSignals';\n\nexport default function TradingSignalsExample() {\n  return <TradingSignals />;\n}","size_bytes":129},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/pages/EconomicCalendar.tsx":{"content":"import { useState } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Calendar, TrendingUp, TrendingDown, Minus, Clock, AlertTriangle, DollarSign, BarChart3 } from 'lucide-react';\nimport { format } from 'date-fns';\nimport type { EconomicEvent } from '@shared/schema';\nimport EventDetailsDialog from '@/components/EventDetailsDialog';\n\nexport default function EconomicCalendar() {\n  const [regionFilter, setRegionFilter] = useState<string>('all');\n  const [impactFilter, setImpactFilter] = useState<string>('all');\n  const [currencyFilter, setCurrencyFilter] = useState<string>('all');\n  const [selectedEventId, setSelectedEventId] = useState<string | null>(null);\n  const [dialogOpen, setDialogOpen] = useState(false);\n\n  const { data: events = [], isLoading } = useQuery<EconomicEvent[]>({\n    queryKey: ['/api/economic-events', regionFilter, impactFilter, currencyFilter],\n    queryFn: async () => {\n      const params = new URLSearchParams();\n      if (regionFilter !== 'all') params.append('region', regionFilter);\n      if (impactFilter !== 'all') params.append('impactLevel', impactFilter);\n      if (currencyFilter !== 'all') params.append('currency', currencyFilter);\n      \n      const response = await fetch(`/api/economic-events?${params.toString()}`);\n      if (!response.ok) throw new Error('Failed to fetch events');\n      return response.json();\n    },\n  });\n\n  const upcomingEvents = events.filter(e => !e.isReleased && new Date(e.eventTime) > new Date());\n  const recentEvents = events.filter(e => e.isReleased);\n\n  const getImpactColor = (level: string) => {\n    return level === 'HIGH' ? 'hsl(0 84% 60%)' : 'hsl(38 92% 50%)';\n  };\n\n  const getImpactIcon = (level: string) => {\n    return level === 'HIGH' ? <AlertTriangle className=\"w-4 h-4\" /> : <TrendingUp className=\"w-4 h-4\" />;\n  };\n\n  const calculateSurprise = (expected: string | null, actual: string | null) => {\n    if (!expected || !actual) return null;\n    const exp = parseFloat(expected);\n    const act = parseFloat(actual);\n    if (isNaN(exp) || isNaN(act)) return null;\n    const diff = act - exp;\n    return diff > 0 ? `+${diff.toFixed(2)}` : diff.toFixed(2);\n  };\n\n  const getMarketSentiment = (event: EconomicEvent) => {\n    let sentiment = 'neutral';\n    \n    if (event.isReleased && event.postReleaseSentiment) {\n      sentiment = event.postReleaseSentiment;\n    } else if (event.preReleaseSentiment) {\n      sentiment = event.preReleaseSentiment;\n    } else if (event.expertSentiment) {\n      sentiment = event.expertSentiment;\n    }\n    \n    if (sentiment === 'bullish') {\n      return { \n        sentiment: 'Bullish', \n        icon: <TrendingUp className=\"w-3 h-3 text-green-500\" />\n      };\n    } else if (sentiment === 'bearish') {\n      return { \n        sentiment: 'Bearish', \n        icon: <TrendingDown className=\"w-3 h-3 text-red-500\" />\n      };\n    }\n    return { \n      sentiment: 'Neutral', \n      icon: <Minus className=\"w-3 h-3 text-muted-foreground/50\" />\n    };\n  };\n\n  const handleEventClick = (eventId: string) => {\n    setSelectedEventId(eventId);\n    setDialogOpen(true);\n  };\n\n  const handleDialogOpenChange = (open: boolean) => {\n    setDialogOpen(open);\n    if (!open) {\n      setSelectedEventId(null);\n    }\n  };\n\n  return (\n    <div className=\"h-full flex flex-col p-6 space-y-6 overflow-auto\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\" data-testid=\"text-page-title\">Economic Calendar</h1>\n          <p className=\"text-muted-foreground\">Track high-impact economic events and market-moving data releases</p>\n        </div>\n      </div>\n\n      <Card data-testid=\"card-filters\">\n        <CardHeader>\n          <CardTitle className=\"text-lg\">Filters</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium\">Region</label>\n              <Select value={regionFilter} onValueChange={setRegionFilter}>\n                <SelectTrigger data-testid=\"select-region\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Regions</SelectItem>\n                  <SelectItem value=\"NA\">North America</SelectItem>\n                  <SelectItem value=\"EU\">Europe</SelectItem>\n                  <SelectItem value=\"ASIA\">Asia</SelectItem>\n                  <SelectItem value=\"OCEANIA\">Oceania</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium\">Impact Level</label>\n              <Select value={impactFilter} onValueChange={setImpactFilter}>\n                <SelectTrigger data-testid=\"select-impact\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Levels</SelectItem>\n                  <SelectItem value=\"HIGH\">High Impact</SelectItem>\n                  <SelectItem value=\"MEDIUM\">Medium Impact</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium\">Currency</label>\n              <Select value={currencyFilter} onValueChange={setCurrencyFilter}>\n                <SelectTrigger data-testid=\"select-currency\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Currencies</SelectItem>\n                  <SelectItem value=\"USD\">USD</SelectItem>\n                  <SelectItem value=\"EUR\">EUR</SelectItem>\n                  <SelectItem value=\"GBP\">GBP</SelectItem>\n                  <SelectItem value=\"JPY\">JPY</SelectItem>\n                  <SelectItem value=\"AUD\">AUD</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {isLoading ? (\n        <Card>\n          <CardContent className=\"p-12 text-center\">\n            <p className=\"text-muted-foreground\">Loading events...</p>\n          </CardContent>\n        </Card>\n      ) : events.length === 0 ? (\n        <Card data-testid=\"card-empty\">\n          <CardContent className=\"p-12 text-center space-y-4\">\n            <Calendar className=\"w-12 h-12 mx-auto text-muted-foreground\" />\n            <div>\n              <h3 className=\"text-lg font-medium\">No Events Found</h3>\n              <p className=\"text-sm text-muted-foreground\">\n                No economic events match your current filters\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n      ) : (\n        <>\n          {upcomingEvents.length > 0 && (\n            <div className=\"space-y-4\">\n              <h2 className=\"text-xl font-semibold flex items-center gap-2\">\n                <Clock className=\"w-5 h-5\" />\n                Upcoming Events\n              </h2>\n              <div className=\"grid gap-4\">\n                {upcomingEvents.map((event) => {\n                  const sentiment = getMarketSentiment(event);\n                  return (\n                  <Card \n                    key={event.id} \n                    className=\"hover-elevate active-elevate-2 cursor-pointer\" \n                    onClick={() => handleEventClick(event.id)}\n                    data-testid={`card-event-${event.id}`}\n                  >\n                    <CardContent className=\"p-4\">\n                      <div className=\"flex items-start justify-between gap-4\">\n                        <div className=\"flex-1 space-y-2\">\n                          <div className=\"flex items-center gap-2 flex-wrap\">\n                            <Badge\n                              variant=\"default\"\n                              style={{ backgroundColor: getImpactColor(event.impactLevel) }}\n                              className=\"text-xs\"\n                              data-testid={`badge-impact-${event.id}`}\n                            >\n                              {getImpactIcon(event.impactLevel)}\n                              <span className=\"ml-1\">{event.impactLevel} IMPACT</span>\n                            </Badge>\n                            <Badge variant=\"secondary\" className=\"text-xs\" data-testid={`badge-currency-${event.id}`}>\n                              {event.currency}\n                            </Badge>\n                            <Badge variant=\"outline\" className=\"text-xs\">\n                              {event.country}\n                            </Badge>\n                            <div className=\"flex items-center gap-1\">\n                              {sentiment.icon}\n                              <span className={`text-xs font-medium ${\n                                sentiment.sentiment === 'Bullish' ? 'text-green-500' : \n                                sentiment.sentiment === 'Bearish' ? 'text-red-500' : 'text-muted-foreground'\n                              }`}>\n                                {sentiment.sentiment}\n                              </span>\n                            </div>\n                          </div>\n\n                          <div>\n                            <h3 className=\"font-semibold text-lg\" data-testid={`text-title-${event.id}`}>{event.title}</h3>\n                            {event.description && (\n                              <p className=\"text-sm text-muted-foreground\">{event.description}</p>\n                            )}\n                          </div>\n\n                          <div className=\"flex items-center gap-4 text-sm\">\n                            <div className=\"flex items-center gap-1 text-muted-foreground\">\n                              <Clock className=\"w-4 h-4\" />\n                              <span data-testid={`text-time-${event.id}`}>\n                                {format(new Date(event.eventTime), 'MMM dd, yyyy HH:mm')} UTC\n                              </span>\n                            </div>\n                            <div className=\"flex items-center gap-1 text-muted-foreground\">\n                              <BarChart3 className=\"w-4 h-4\" />\n                              <span>{event.eventType}</span>\n                            </div>\n                          </div>\n\n                          <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3 pt-2 border-t\">\n                            {event.previousValue && (\n                              <div className=\"space-y-1\">\n                                <p className=\"text-xs text-muted-foreground\">Previous</p>\n                                <p className=\"font-medium\" data-testid={`text-previous-${event.id}`}>\n                                  {event.previousValue} {event.unit}\n                                </p>\n                              </div>\n                            )}\n                            {event.expectedValue && (\n                              <div className=\"space-y-1\">\n                                <p className=\"text-xs text-muted-foreground\">Expected</p>\n                                <p className=\"font-medium\" data-testid={`text-expected-${event.id}`}>\n                                  {event.expectedValue} {event.unit}\n                                </p>\n                              </div>\n                            )}\n                            {event.futuresImpliedExpectation && (\n                              <div className=\"space-y-1\">\n                                <p className=\"text-xs text-muted-foreground\">Futures Implied</p>\n                                <p className=\"font-medium text-primary\">\n                                  {event.futuresImpliedExpectation} {event.unit}\n                                </p>\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                  )\n                })}\n              </div>\n            </div>\n          )}\n\n          {recentEvents.length > 0 && (\n            <div className=\"space-y-4\">\n              <h2 className=\"text-xl font-semibold flex items-center gap-2\">\n                <DollarSign className=\"w-5 h-5\" />\n                Released Events\n              </h2>\n              <div className=\"grid gap-4\">\n                {recentEvents.map((event) => {\n                  const surprise = calculateSurprise(event.expectedValue, event.actualValue);\n                  const sentiment = getMarketSentiment(event);\n                  return (\n                    <Card \n                      key={event.id} \n                      className=\"hover-elevate active-elevate-2 cursor-pointer\" \n                      onClick={() => handleEventClick(event.id)}\n                      data-testid={`card-released-${event.id}`}\n                    >\n                      <CardContent className=\"p-4\">\n                        <div className=\"flex items-start justify-between gap-4\">\n                          <div className=\"flex-1 space-y-2\">\n                            <div className=\"flex items-center gap-2 flex-wrap\">\n                              <Badge\n                                variant=\"default\"\n                                style={{ backgroundColor: getImpactColor(event.impactLevel) }}\n                                className=\"text-xs\"\n                              >\n                                {getImpactIcon(event.impactLevel)}\n                                <span className=\"ml-1\">{event.impactLevel} IMPACT</span>\n                              </Badge>\n                              <Badge variant=\"secondary\" className=\"text-xs\">\n                                {event.currency}\n                              </Badge>\n                              <Badge variant=\"outline\" className=\"text-xs\">\n                                {event.country}\n                              </Badge>\n                              <Badge variant=\"default\" className=\"text-xs bg-green-600\">\n                                RELEASED\n                              </Badge>\n                              <div className=\"flex items-center gap-1\">\n                                {sentiment.icon}\n                                <span className={`text-xs font-medium ${\n                                  sentiment.sentiment === 'Bullish' ? 'text-green-500' : \n                                  sentiment.sentiment === 'Bearish' ? 'text-red-500' : 'text-muted-foreground'\n                                }`}>\n                                  {sentiment.sentiment}\n                                </span>\n                              </div>\n                            </div>\n\n                            <div>\n                              <h3 className=\"font-semibold text-lg\">{event.title}</h3>\n                              {event.description && (\n                                <p className=\"text-sm text-muted-foreground\">{event.description}</p>\n                              )}\n                            </div>\n\n                            <div className=\"flex items-center gap-4 text-sm\">\n                              <div className=\"flex items-center gap-1 text-muted-foreground\">\n                                <Clock className=\"w-4 h-4\" />\n                                <span>\n                                  {format(new Date(event.eventTime), 'MMM dd, yyyy HH:mm')} UTC\n                                </span>\n                              </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 pt-2 border-t\">\n                              {event.previousValue && (\n                                <div className=\"space-y-1\">\n                                  <p className=\"text-xs text-muted-foreground\">Previous</p>\n                                  <p className=\"font-medium\">\n                                    {event.previousValue} {event.unit}\n                                  </p>\n                                </div>\n                              )}\n                              {event.expectedValue && (\n                                <div className=\"space-y-1\">\n                                  <p className=\"text-xs text-muted-foreground\">Expected</p>\n                                  <p className=\"font-medium\">\n                                    {event.expectedValue} {event.unit}\n                                  </p>\n                                </div>\n                              )}\n                              {event.actualValue && (\n                                <div className=\"space-y-1\">\n                                  <p className=\"text-xs text-muted-foreground\">Actual</p>\n                                  <p className=\"font-medium text-primary\" data-testid={`text-actual-${event.id}`}>\n                                    {event.actualValue} {event.unit}\n                                  </p>\n                                </div>\n                              )}\n                              {surprise && (\n                                <div className=\"space-y-1\">\n                                  <p className=\"text-xs text-muted-foreground\">Surprise</p>\n                                  <p className={`font-medium ${parseFloat(surprise) > 0 ? 'text-green-600' : 'text-red-600'}`}>\n                                    {surprise} {event.unit}\n                                  </p>\n                                </div>\n                              )}\n                            </div>\n\n                            {event.marketImpactAnalysis && (\n                              <div className=\"pt-2 border-t\">\n                                <p className=\"text-xs text-muted-foreground mb-1\">Market Impact Analysis</p>\n                                <p className=\"text-sm\">{event.marketImpactAnalysis}</p>\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  );\n                })}\n              </div>\n            </div>\n          )}\n        </>\n      )}\n      \n      <EventDetailsDialog \n        eventId={selectedEventId}\n        open={dialogOpen}\n        onOpenChange={handleDialogOpenChange}\n      />\n    </div>\n  );\n}\n","size_bytes":18790},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/AppSidebar.tsx":{"content":"import { Activity, BarChart3, Calendar, History, Home, Settings, Target, TrendingUp } from 'lucide-react';\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n} from '@/components/ui/sidebar';\n\nconst menuItems = [\n  {\n    title: 'Dashboard',\n    url: '/',\n    icon: Home,\n  },\n  {\n    title: 'Market Overview',\n    url: '/markets',\n    icon: Activity,\n  },\n  {\n    title: 'Trading Signals',\n    url: '/signals',\n    icon: Target,\n  },\n  {\n    title: 'Economic Calendar',\n    url: '/calendar',\n    icon: Calendar,\n  },\n  {\n    title: 'Trade History',\n    url: '/history',\n    icon: History,\n  },\n  {\n    title: 'Analytics',\n    url: '/analytics',\n    icon: BarChart3,\n  },\n];\n\nconst strategyItems = [\n  {\n    title: 'Scalping',\n    url: '/strategies/scalping',\n    icon: TrendingUp,\n  },\n  {\n    title: 'Day Trading',\n    url: '/strategies/day',\n    icon: TrendingUp,\n  },\n  {\n    title: 'Swing Trading',\n    url: '/strategies/swing',\n    icon: TrendingUp,\n  },\n  {\n    title: 'ORB Strategy',\n    url: '/strategies/orb',\n    icon: TrendingUp,\n  },\n];\n\nexport default function AppSidebar() {\n  return (\n    <Sidebar data-testid=\"sidebar-main\">\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel>Navigation</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {menuItems.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton asChild>\n                    <a href={item.url} data-testid={`link-${item.title.toLowerCase().replace(' ', '-')}`}>\n                      <item.icon />\n                      <span>{item.title}</span>\n                    </a>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n\n        <SidebarGroup>\n          <SidebarGroupLabel>Trading Strategies</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {strategyItems.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton asChild>\n                    <a href={item.url} data-testid={`link-strategy-${item.title.toLowerCase().replace(' ', '-')}`}>\n                      <item.icon />\n                      <span>{item.title}</span>\n                    </a>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n\n        <SidebarGroup>\n          <SidebarGroupLabel>Settings</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              <SidebarMenuItem>\n                <SidebarMenuButton asChild>\n                  <a href=\"/settings\" data-testid=\"link-settings\">\n                    <Settings />\n                    <span>Settings</span>\n                  </a>\n                </SidebarMenuButton>\n              </SidebarMenuItem>\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n    </Sidebar>\n  );\n}","size_bytes":3210},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":844},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/examples/MarketOverview.tsx":{"content":"import MarketOverview from '../MarketOverview';\n\nexport default function MarketOverviewExample() {\n  return <MarketOverview />;\n}","size_bytes":129},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1202},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/pages/TradeHistoryPage.tsx":{"content":"import TradeHistory from '@/components/TradeHistory';\n\nexport default function TradeHistoryPage() {\n  return (\n    <div className=\"container mx-auto p-6\">\n      <TradeHistory />\n    </div>\n  );\n}\n","size_bytes":196},"server/services/finnhub.ts":{"content":"interface FinnhubEconomicEvent {\n  country: string;\n  event: string;\n  impact: string;\n  actual: string | null;\n  estimate: string | null;\n  prev: string | null;\n  time: string;\n}\n\ninterface EconomicCalendarResponse {\n  economicCalendar: FinnhubEconomicEvent[];\n}\n\nconst COUNTRY_TO_REGION: Record<string, string> = {\n  'US': 'NA',\n  'CA': 'NA',\n  'MX': 'NA',\n  'GB': 'EU',\n  'DE': 'EU',\n  'FR': 'EU',\n  'IT': 'EU',\n  'ES': 'EU',\n  'EU': 'EU',\n  'JP': 'ASIA',\n  'CN': 'ASIA',\n  'IN': 'ASIA',\n  'AU': 'OCEANIA',\n  'NZ': 'OCEANIA',\n};\n\nconst COUNTRY_TO_CURRENCY: Record<string, string> = {\n  'US': 'USD',\n  'CA': 'CAD',\n  'MX': 'MXN',\n  'GB': 'GBP',\n  'DE': 'EUR',\n  'FR': 'EUR',\n  'IT': 'EUR',\n  'ES': 'EUR',\n  'EU': 'EUR',\n  'JP': 'JPY',\n  'CN': 'CNY',\n  'IN': 'INR',\n  'AU': 'AUD',\n  'NZ': 'NZD',\n};\n\nfunction generateEventId(event: FinnhubEconomicEvent): string {\n  const str = `${event.time}-${event.event}-${event.country}`;\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash;\n  }\n  return Math.abs(hash).toString(36);\n}\n\nexport async function fetchEconomicCalendar(fromDate?: string, toDate?: string) {\n  const apiKey = process.env.FINNHUB_API_KEY;\n  \n  if (!apiKey) {\n    throw new Error('FINNHUB_API_KEY environment variable is not set');\n  }\n\n  const today = new Date();\n  const from = fromDate || today.toISOString().split('T')[0];\n  const to = toDate || new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];\n\n  const url = `https://finnhub.io/api/v1/calendar/economic?from=${from}&to=${to}&token=${apiKey}`;\n\n  try {\n    const response = await fetch(url);\n    \n    if (!response.ok) {\n      if (response.status === 403) {\n        console.error('Finnhub API key does not have access to economic calendar endpoint. This feature requires a paid plan or different API key.');\n        return [];\n      }\n      throw new Error(`Finnhub API error: ${response.status} ${response.statusText}`);\n    }\n\n    const data: EconomicCalendarResponse = await response.json();\n    \n    const events = data.economicCalendar\n      .filter(event => {\n        const impact = event.impact?.toLowerCase() || '';\n        return impact === 'high' || impact === 'medium';\n      })\n      .map(event => {\n        const country = event.country || 'US';\n        const region = COUNTRY_TO_REGION[country] || 'NA';\n        const currency = COUNTRY_TO_CURRENCY[country] || 'USD';\n        \n        const eventDate = new Date(event.time);\n        const isReleased = event.actual !== null && event.actual !== '';\n        \n        let marketImpact = '';\n        if (isReleased && event.estimate && event.actual) {\n          const estimate = parseFloat(event.estimate);\n          const actual = parseFloat(event.actual);\n          if (!isNaN(estimate) && !isNaN(actual)) {\n            if (actual > estimate) {\n              marketImpact = 'Actual exceeded expectations, potentially bullish for ' + currency;\n            } else if (actual < estimate) {\n              marketImpact = 'Actual below expectations, potentially bearish for ' + currency;\n            } else {\n              marketImpact = 'In line with expectations, neutral impact';\n            }\n          }\n        }\n\n        const affectedCurrencies = [currency];\n        if (currency === 'USD') {\n          affectedCurrencies.push('EUR/USD', 'GBP/USD', 'USD/JPY');\n        } else if (currency === 'EUR') {\n          affectedCurrencies.push('EUR/USD', 'EUR/GBP');\n        } else if (currency === 'GBP') {\n          affectedCurrencies.push('GBP/USD', 'EUR/GBP');\n        }\n\n        return {\n          id: generateEventId(event),\n          title: event.event,\n          description: `${country} - ${event.event}`,\n          eventType: event.event.includes('GDP') ? 'GDP' : \n                     event.event.includes('CPI') ? 'Inflation' :\n                     event.event.includes('Employment') || event.event.includes('Payrolls') ? 'Employment' :\n                     event.event.includes('PMI') ? 'Manufacturing' :\n                     event.event.includes('Rate') ? 'Interest Rate' : 'Economic Indicator',\n          country: country,\n          region: region,\n          currency: currency,\n          impactLevel: event.impact?.toUpperCase() || 'MEDIUM',\n          eventTime: eventDate,\n          expectedValue: event.estimate || null,\n          previousValue: event.prev || null,\n          actualValue: event.actual || null,\n          unit: null,\n          futuresImpliedExpectation: null,\n          surpriseFactor: null,\n          marketImpactAnalysis: marketImpact || null,\n          affectedCurrencies: affectedCurrencies,\n          affectedStocks: [],\n          isReleased: isReleased,\n        };\n      });\n    \n    return events.sort((a, b) => \n      new Date(a.eventTime).getTime() - new Date(b.eventTime).getTime()\n    );\n  } catch (error) {\n    console.error('Error fetching Finnhub economic calendar:', error);\n    throw error;\n  }\n}\n","size_bytes":5008},"client/src/pages/Stocks.tsx":{"content":"import TradingSignals from '@/components/TradingSignals';\nimport InstrumentsToWatch from '@/components/InstrumentsToWatch';\nimport { TrendingUp } from 'lucide-react';\n\nexport default function Stocks() {\n  return (\n    <div className=\"p-6 space-y-6\">\n      {/* Header Section */}\n      <div>\n        <div className=\"flex items-center gap-3\">\n          <div className=\"p-2 bg-primary/10 rounded-lg\">\n            <TrendingUp className=\"w-6 h-6 text-primary\" />\n          </div>\n          <div>\n            <h1 className=\"text-2xl font-bold\">Stock Analysis</h1>\n            <p className=\"text-sm text-muted-foreground\">\n              Real-time analysis of 20 US equities with institutional trading methodology\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content Grid */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Active Stock Signals */}\n        <div>\n          <TradingSignals assetClassFilter=\"stock\" title=\"Stock Signals\" />\n        </div>\n        \n        {/* Stock Instruments to Watch */}\n        <div>\n          <InstrumentsToWatch assetClassFilter=\"stock\" />\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":1175},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/TradeHistory.tsx":{"content":"import { useState } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { History, TrendingUp, TrendingDown, Filter, Download } from 'lucide-react';\nimport type { Trade } from '@shared/schema';\n\nexport default function TradeHistory() {\n  const [filter, setFilter] = useState<'all' | 'wins' | 'losses'>('all');\n  \n  const { data: trades = [], isLoading } = useQuery<Trade[]>({\n    queryKey: ['/api/trades'],\n  });\n\n  if (isLoading) {\n    return (\n      <Card data-testid=\"card-trade-history\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <History className=\"w-5 h-5\" />\n            Trade History\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-center py-8 text-muted-foreground\">\n            Loading trades...\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const filteredTrades = trades.filter(trade => {\n    if (filter === 'wins') return trade.outcome === 'win';\n    if (filter === 'losses') return trade.outcome === 'loss';\n    return true;\n  });\n\n  const totalPnL = trades.reduce((sum, trade) => sum + parseFloat(trade.pnl), 0);\n  const winningTrades = trades.filter(t => t.outcome === 'win');\n  const losingTrades = trades.filter(t => t.outcome === 'loss');\n  const winRate = trades.length > 0 ? (winningTrades.length / trades.length) * 100 : 0;\n  const avgWin = winningTrades.length > 0 \n    ? winningTrades.reduce((sum, t) => sum + parseFloat(t.pnl), 0) / winningTrades.length \n    : 0;\n  const avgLoss = losingTrades.length > 0\n    ? Math.abs(losingTrades.reduce((sum, t) => sum + parseFloat(t.pnl), 0) / losingTrades.length)\n    : 0;\n\n  if (trades.length === 0) {\n    return (\n      <Card data-testid=\"card-trade-history\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <History className=\"w-5 h-5\" />\n            Trade History\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-center py-12\">\n            <History className=\"w-12 h-12 mx-auto mb-4 text-muted-foreground\" />\n            <h3 className=\"text-lg font-semibold mb-2\">No trades yet</h3>\n            <p className=\"text-muted-foreground\">\n              Your trade history will appear here once you start trading.\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card data-testid=\"card-trade-history\">\n      <CardHeader className=\"pb-4\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"flex items-center gap-2 text-lg font-semibold\">\n            <History className=\"w-5 h-5\" />\n            Trade History\n          </CardTitle>\n          <div className=\"flex items-center gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => console.log('Downloading trade history')}\n              data-testid=\"button-download-history\"\n            >\n              <Download className=\"w-4 h-4 mr-1\" />\n              Export\n            </Button>\n          </div>\n        </div>\n        \n        {/* Performance Summary */}\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4 p-4 bg-muted/30 rounded-md\">\n          <div className=\"text-center\">\n            <div className=\"text-xs text-muted-foreground\">Total P&L</div>\n            <div className={`font-mono font-semibold ${totalPnL >= 0 ? 'text-green-500' : 'text-red-500'}`}>\n              ${totalPnL >= 0 ? '+' : ''}{totalPnL.toFixed(0)}\n            </div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-xs text-muted-foreground\">Win Rate</div>\n            <div className=\"font-mono font-semibold\">\n              {winRate.toFixed(1)}%\n            </div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-xs text-muted-foreground\">Avg Win</div>\n            <div className=\"font-mono font-semibold text-green-500\">\n              ${avgWin.toFixed(0)}\n            </div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-xs text-muted-foreground\">Avg Loss</div>\n            <div className=\"font-mono font-semibold text-red-500\">\n              ${avgLoss.toFixed(0)}\n            </div>\n          </div>\n        </div>\n      </CardHeader>\n      \n      <CardContent>\n        {/* Filter Buttons */}\n        <div className=\"flex items-center gap-2 mb-4\">\n          <Filter className=\"w-4 h-4 text-muted-foreground\" />\n          <Button\n            variant={filter === 'all' ? 'default' : 'outline'}\n            size=\"sm\"\n            onClick={() => setFilter('all')}\n            data-testid=\"button-filter-all\"\n          >\n            All ({trades.length})\n          </Button>\n          <Button\n            variant={filter === 'wins' ? 'default' : 'outline'}\n            size=\"sm\"\n            onClick={() => setFilter('wins')}\n            data-testid=\"button-filter-wins\"\n          >\n            Wins ({trades.filter(t => t.outcome === 'win').length})\n          </Button>\n          <Button\n            variant={filter === 'losses' ? 'default' : 'outline'}\n            size=\"sm\"\n            onClick={() => setFilter('losses')}\n            data-testid=\"button-filter-losses\"\n          >\n            Losses ({trades.filter(t => t.outcome === 'loss').length})\n          </Button>\n        </div>\n\n        {/* Trade List */}\n        <div className=\"space-y-3\">\n          {filteredTrades.map((trade) => (\n            <div\n              key={trade.id}\n              className=\"p-3 rounded-md border border-border hover-elevate transition-colors\"\n              data-testid={`card-trade-${trade.id}`}\n            >\n              <div className=\"flex items-start justify-between mb-2\">\n                <div className=\"flex items-center gap-3\">\n                  <Badge \n                    variant=\"secondary\"\n                    className=\"text-xs font-medium\"\n                    style={{ \n                      backgroundColor: trade.type === 'buy' ? 'hsl(120 60% 50%)20' : 'hsl(0 75% 60%)20',\n                      color: trade.type === 'buy' ? 'hsl(120 60% 50%)' : 'hsl(0 75% 60%)'\n                    }}\n                  >\n                    {trade.type.toUpperCase()}\n                  </Badge>\n                  <div>\n                    <h4 className=\"font-semibold text-sm\" data-testid={`text-symbol-${trade.id}`}>\n                      {trade.symbol}\n                    </h4>\n                    <div className=\"text-xs text-muted-foreground\">\n                      {trade.strategy} • {trade.timeframe} • {trade.duration}\n                    </div>\n                  </div>\n                </div>\n                \n                <div className=\"text-right\">\n                  <div className={`font-mono font-semibold text-sm ${parseFloat(trade.pnl) >= 0 ? 'text-green-500' : 'text-red-500'}`}>\n                    {parseFloat(trade.pnl) >= 0 ? '+' : ''}${parseFloat(trade.pnl).toFixed(0)}\n                  </div>\n                  <div className={`text-xs ${parseFloat(trade.pnl) >= 0 ? 'text-green-500' : 'text-red-500'}`}>\n                    ({parseFloat(trade.pnl) >= 0 ? '+' : ''}{parseFloat(trade.pnlPercent).toFixed(2)}%)\n                  </div>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center justify-between text-xs\">\n                <div className=\"flex gap-4\">\n                  <div>\n                    <span className=\"text-muted-foreground\">Entry: </span>\n                    <span className=\"font-mono\">{parseFloat(trade.entryPrice).toFixed(4)}</span>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground\">Exit: </span>\n                    <span className=\"font-mono\">{parseFloat(trade.exitPrice).toFixed(4)}</span>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-1\">\n                  {trade.outcome === 'win' ? (\n                    <TrendingUp className=\"w-3 h-3 text-green-500\" />\n                  ) : (\n                    <TrendingDown className=\"w-3 h-3 text-red-500\" />\n                  )}\n                  <Badge \n                    variant={trade.outcome === 'win' ? 'default' : 'destructive'}\n                    className=\"text-xs\"\n                  >\n                    {trade.outcome}\n                  </Badge>\n                </div>\n              </div>\n              \n              <div className=\"mt-2 text-xs text-muted-foreground\">\n                <span className=\"font-medium\">Reason:</span> {trade.entryReason}\n              </div>\n              \n              <div className=\"mt-1 text-xs text-muted-foreground\">\n                Closed: {new Date(trade.exitDate).toLocaleDateString()} {new Date(trade.exitDate).toLocaleTimeString()}\n              </div>\n            </div>\n          ))}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":9148},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"server/services/sentimentAnalysis.ts":{"content":"import { EconomicEvent } from '@shared/schema';\n\nexport interface CurrencyPairImpact {\n  pair: string;\n  sentiment: 'bullish' | 'bearish' | 'neutral';\n  reasoning: string;\n}\n\nexport interface StockImpact {\n  sector: string;\n  sentiment: 'bullish' | 'bearish' | 'neutral';\n  reasoning: string;\n}\n\nexport interface SentimentAnalysis {\n  expertSentiment: 'bullish' | 'bearish' | 'neutral';\n  preReleaseSentiment: 'bullish' | 'bearish' | 'neutral';\n  postReleaseSentiment: 'bullish' | 'bearish' | 'neutral' | null;\n  currencyPairImpacts: CurrencyPairImpact[];\n  stockImpacts: StockImpact[];\n  marketImpactAnalysis: string;\n  surpriseFactor: string | null;\n}\n\nconst eventSentimentRules: Record<string, {\n  betterThanExpected: 'bullish' | 'bearish';\n  worseThanExpected: 'bullish' | 'bearish';\n  currencyEffect: 'positive' | 'negative';\n  stockEffect: 'positive' | 'negative';\n  description: string;\n}> = {\n  'GDP': {\n    betterThanExpected: 'bullish',\n    worseThanExpected: 'bearish',\n    currencyEffect: 'positive',\n    stockEffect: 'positive',\n    description: 'GDP growth indicates economic strength'\n  },\n  'CPI': {\n    betterThanExpected: 'bearish',\n    worseThanExpected: 'bullish',\n    currencyEffect: 'positive',\n    stockEffect: 'negative',\n    description: 'Higher inflation may lead to rate hikes'\n  },\n  'Inflation': {\n    betterThanExpected: 'bearish',\n    worseThanExpected: 'bullish',\n    currencyEffect: 'positive',\n    stockEffect: 'negative',\n    description: 'Higher inflation typically negative for stocks'\n  },\n  'NFP': {\n    betterThanExpected: 'bullish',\n    worseThanExpected: 'bearish',\n    currencyEffect: 'positive',\n    stockEffect: 'positive',\n    description: 'Strong employment supports economic growth'\n  },\n  'Employment': {\n    betterThanExpected: 'bullish',\n    worseThanExpected: 'bearish',\n    currencyEffect: 'positive',\n    stockEffect: 'positive',\n    description: 'Employment data reflects economic health'\n  },\n  'Unemployment': {\n    betterThanExpected: 'bearish',\n    worseThanExpected: 'bullish',\n    currencyEffect: 'negative',\n    stockEffect: 'negative',\n    description: 'Higher unemployment indicates economic weakness'\n  },\n  'Interest Rate': {\n    betterThanExpected: 'bearish',\n    worseThanExpected: 'bullish',\n    currencyEffect: 'positive',\n    stockEffect: 'negative',\n    description: 'Rate hikes strengthen currency but pressure stocks'\n  },\n  'Retail Sales': {\n    betterThanExpected: 'bullish',\n    worseThanExpected: 'bearish',\n    currencyEffect: 'positive',\n    stockEffect: 'positive',\n    description: 'Strong consumer spending drives growth'\n  },\n  'PMI': {\n    betterThanExpected: 'bullish',\n    worseThanExpected: 'bearish',\n    currencyEffect: 'positive',\n    stockEffect: 'positive',\n    description: 'Manufacturing activity indicates economic momentum'\n  },\n  'Trade Balance': {\n    betterThanExpected: 'bullish',\n    worseThanExpected: 'bearish',\n    currencyEffect: 'positive',\n    stockEffect: 'positive',\n    description: 'Trade surplus supports currency strength'\n  }\n};\n\nfunction getEventRule(title: string) {\n  for (const [key, rule] of Object.entries(eventSentimentRules)) {\n    if (title.toLowerCase().includes(key.toLowerCase())) {\n      return rule;\n    }\n  }\n  return eventSentimentRules['GDP'];\n}\n\nfunction parseNumericValue(value: string | null): number | null {\n  if (!value) return null;\n  const cleaned = value.replace(/[^\\d.-]/g, '');\n  const parsed = parseFloat(cleaned);\n  return isNaN(parsed) ? null : parsed;\n}\n\nfunction calculateSurpriseFactor(actual: number, expected: number): string {\n  const diff = actual - expected;\n  const percentDiff = ((diff / Math.abs(expected)) * 100);\n  \n  if (Math.abs(percentDiff) < 5) return 'In-line';\n  if (Math.abs(percentDiff) < 15) return percentDiff > 0 ? 'Mild Beat' : 'Mild Miss';\n  if (Math.abs(percentDiff) < 30) return percentDiff > 0 ? 'Strong Beat' : 'Strong Miss';\n  return percentDiff > 0 ? 'Major Beat' : 'Major Miss';\n}\n\nfunction getCurrencyPairs(currency: string): string[] {\n  const majorPairs: Record<string, string[]> = {\n    'USD': ['EUR/USD', 'USD/JPY', 'GBP/USD', 'USD/CHF', 'AUD/USD', 'USD/CAD'],\n    'EUR': ['EUR/USD', 'EUR/GBP', 'EUR/JPY', 'EUR/CHF'],\n    'GBP': ['GBP/USD', 'EUR/GBP', 'GBP/JPY'],\n    'JPY': ['USD/JPY', 'EUR/JPY', 'GBP/JPY'],\n    'AUD': ['AUD/USD', 'AUD/JPY'],\n    'CAD': ['USD/CAD', 'CAD/JPY'],\n    'CHF': ['USD/CHF', 'EUR/CHF'],\n    'NZD': ['NZD/USD', 'NZD/JPY']\n  };\n  \n  return majorPairs[currency] || [`${currency}/USD`];\n}\n\nfunction getAffectedStocks(currency: string, eventType: string): string[] {\n  const stocksByEvent: Record<string, string[]> = {\n    'Interest Rate': ['Banks', 'Financial Services', 'Real Estate'],\n    'CPI': ['Consumer Goods', 'Retail', 'Energy'],\n    'GDP': ['Broad Market', 'Industrials', 'Financials'],\n    'Employment': ['Consumer Discretionary', 'Services', 'Retail'],\n    'PMI': ['Manufacturing', 'Industrials', 'Materials'],\n    'Retail Sales': ['Retail', 'Consumer Discretionary', 'E-commerce']\n  };\n  \n  const stocksByCurrency: Record<string, string[]> = {\n    'USD': ['S&P 500', 'Dow Jones', 'NASDAQ'],\n    'EUR': ['DAX', 'CAC 40', 'Euro Stoxx 50'],\n    'GBP': ['FTSE 100', 'FTSE 250'],\n    'JPY': ['Nikkei 225', 'TOPIX'],\n    'AUD': ['ASX 200'],\n    'CAD': ['TSX Composite']\n  };\n  \n  for (const [key, stocks] of Object.entries(stocksByEvent)) {\n    if (eventType.includes(key)) {\n      return [...stocks, ...(stocksByCurrency[currency] || [])];\n    }\n  }\n  \n  return stocksByCurrency[currency] || ['Local Market Indices'];\n}\n\nexport function analyzeEventSentiment(event: Partial<EconomicEvent>): SentimentAnalysis {\n  const rule = getEventRule(event.title || '');\n  const currency = event.currency || event.countryCode || 'USD';\n  \n  let expertSentiment: 'bullish' | 'bearish' | 'neutral' = 'neutral';\n  let preReleaseSentiment: 'bullish' | 'bearish' | 'neutral' = 'neutral';\n  let postReleaseSentiment: 'bullish' | 'bearish' | 'neutral' | null = null;\n  let surpriseFactor: string | null = null;\n  \n  const expectedValue = parseNumericValue(event.expectedValue || null);\n  const previousValue = parseNumericValue(event.previousValue || null);\n  const actualValue = parseNumericValue(event.actualValue || null);\n  \n  if (expectedValue !== null && previousValue !== null) {\n    if (expectedValue > previousValue) {\n      preReleaseSentiment = rule.betterThanExpected;\n      expertSentiment = rule.betterThanExpected;\n    } else if (expectedValue < previousValue) {\n      preReleaseSentiment = rule.worseThanExpected;\n      expertSentiment = rule.worseThanExpected;\n    }\n  } else if (event.futuresImpliedExpectation) {\n    const futuresSentiment = event.futuresImpliedExpectation.toLowerCase();\n    if (futuresSentiment.includes('higher') || futuresSentiment.includes('increase')) {\n      preReleaseSentiment = rule.betterThanExpected;\n    } else if (futuresSentiment.includes('lower') || futuresSentiment.includes('decrease')) {\n      preReleaseSentiment = rule.worseThanExpected;\n    }\n  }\n  \n  if (actualValue !== null && expectedValue !== null) {\n    surpriseFactor = calculateSurpriseFactor(actualValue, expectedValue);\n    \n    if (actualValue > expectedValue) {\n      postReleaseSentiment = rule.betterThanExpected;\n    } else if (actualValue < expectedValue) {\n      postReleaseSentiment = rule.worseThanExpected;\n    } else {\n      postReleaseSentiment = 'neutral';\n    }\n  }\n  \n  const currencyPairs = getCurrencyPairs(currency);\n  const currencyPairImpacts: CurrencyPairImpact[] = currencyPairs.map(pair => {\n    const sentiment = event.isReleased && postReleaseSentiment \n      ? postReleaseSentiment \n      : preReleaseSentiment;\n    \n    const isBaseCurrency = pair.startsWith(currency);\n    const effectiveSentiment = rule.currencyEffect === 'positive' \n      ? sentiment \n      : (sentiment === 'bullish' ? 'bearish' : sentiment === 'bearish' ? 'bullish' : 'neutral');\n    \n    const finalSentiment = isBaseCurrency \n      ? effectiveSentiment \n      : (effectiveSentiment === 'bullish' ? 'bearish' : effectiveSentiment === 'bearish' ? 'bullish' : 'neutral');\n    \n    return {\n      pair,\n      sentiment: finalSentiment,\n      reasoning: event.isReleased \n        ? `Post-release: ${surpriseFactor} - ${rule.description}`\n        : `Pre-release: Market expects ${preReleaseSentiment} impact - ${rule.description}`\n    };\n  });\n  \n  const affectedStocks = getAffectedStocks(currency, event.title || '');\n  const stockImpacts: StockImpact[] = affectedStocks.slice(0, 3).map(sector => {\n    const sentiment = event.isReleased && postReleaseSentiment \n      ? postReleaseSentiment \n      : preReleaseSentiment;\n    \n    const effectiveSentiment = rule.stockEffect === 'positive' \n      ? sentiment \n      : (sentiment === 'bullish' ? 'bearish' : sentiment === 'bearish' ? 'bullish' : 'neutral');\n    \n    return {\n      sector,\n      sentiment: effectiveSentiment,\n      reasoning: event.isReleased\n        ? `${surpriseFactor} data ${effectiveSentiment === 'bullish' ? 'supports' : 'pressures'} ${sector}`\n        : `Expected data to ${effectiveSentiment === 'bullish' ? 'support' : 'pressure'} ${sector}`\n    };\n  });\n  \n  let marketImpactAnalysis = '';\n  if (event.isReleased && postReleaseSentiment) {\n    marketImpactAnalysis = `${surpriseFactor}: Actual ${actualValue} vs Expected ${expectedValue}. `;\n    marketImpactAnalysis += `${currency} likely to ${postReleaseSentiment === 'bullish' ? 'strengthen' : 'weaken'}. `;\n    marketImpactAnalysis += rule.description;\n  } else {\n    marketImpactAnalysis = `Market consensus expects ${expectedValue || 'no change'}. `;\n    marketImpactAnalysis += `Previous: ${previousValue}. `;\n    marketImpactAnalysis += `${preReleaseSentiment === 'bullish' ? 'Bullish' : 'Bearish'} outlook for ${currency}. `;\n    marketImpactAnalysis += rule.description;\n  }\n  \n  return {\n    expertSentiment,\n    preReleaseSentiment,\n    postReleaseSentiment,\n    currencyPairImpacts,\n    stockImpacts,\n    marketImpactAnalysis,\n    surpriseFactor\n  };\n}\n\nexport function updateEventWithSentiment(event: Partial<EconomicEvent>): Partial<EconomicEvent> {\n  const analysis = analyzeEventSentiment(event);\n  \n  return {\n    ...event,\n    expertSentiment: analysis.expertSentiment,\n    preReleaseSentiment: analysis.preReleaseSentiment,\n    postReleaseSentiment: analysis.postReleaseSentiment || undefined,\n    surpriseFactor: analysis.surpriseFactor || undefined,\n    marketImpactAnalysis: analysis.marketImpactAnalysis,\n    currencyPairImpacts: JSON.stringify(analysis.currencyPairImpacts),\n    stockImpacts: JSON.stringify(analysis.stockImpacts)\n  };\n}\n","size_bytes":10602},"server/scrapers/cacheService.ts":{"content":"import { db } from '../db';\nimport { economicEvents, InsertEconomicEvent } from '@shared/schema';\nimport { eq, gte, and, sql } from 'drizzle-orm';\nimport { ScrapedEvent } from './economicCalendarScraper';\nimport { scraperSettings } from './config';\n\nexport class CacheService {\n  private cacheDuration = scraperSettings.cacheSettings.cacheDuration;\n  private dataRetentionDays = scraperSettings.cacheSettings.dataRetentionDays;\n\n  async isCacheFresh(): Promise<boolean> {\n    try {\n      const recentEvent = await db\n        .select()\n        .from(economicEvents)\n        .where(\n          gte(\n            economicEvents.lastScraped,\n            new Date(Date.now() - this.cacheDuration)\n          )\n        )\n        .limit(1);\n\n      return recentEvent.length > 0;\n    } catch (error) {\n      console.error('Error checking cache freshness:', error);\n      return false;\n    }\n  }\n\n  async storeEvents(scrapedEvents: ScrapedEvent[]): Promise<void> {\n    if (scrapedEvents.length === 0) {\n      console.log('No events to store');\n      return;\n    }\n\n    try {\n      const eventsToInsert: InsertEconomicEvent[] = scrapedEvents.map(event => ({\n        title: event.title,\n        description: null,\n        eventType: 'economic',\n        country: event.country,\n        countryCode: event.countryCode || null,\n        region: this.getRegionFromCountry(event.country),\n        currency: event.currency || event.countryCode || 'USD',\n        impactLevel: event.impactLevel,\n        eventTime: event.eventTime,\n        expectedValue: event.expectedValue || null,\n        previousValue: event.previousValue || null,\n        actualValue: event.actualValue || null,\n        unit: null,\n        futuresImpliedExpectation: null,\n        surpriseFactor: null,\n        marketImpactAnalysis: null,\n        affectedCurrencies: event.currency ? [event.currency] : null,\n        affectedStocks: null,\n        isReleased: !!event.actualValue,\n        sourceSite: event.sourceSite,\n        sourceUrl: event.sourceUrl,\n      }));\n\n      await db.delete(economicEvents).where(\n        and(\n          gte(economicEvents.eventTime, new Date()),\n          eq(economicEvents.sourceSite, scrapedEvents[0].sourceSite)\n        )\n      );\n\n      await db.insert(economicEvents).values(eventsToInsert);\n\n      console.log(`Stored ${eventsToInsert.length} events in cache`);\n    } catch (error) {\n      console.error('Error storing events:', error);\n      throw error;\n    }\n  }\n\n  async getUpcomingEvents(hoursAhead: number = 24): Promise<typeof economicEvents.$inferSelect[]> {\n    try {\n      const now = new Date();\n      const futureTime = new Date(now.getTime() + hoursAhead * 60 * 60 * 1000);\n\n      const events = await db\n        .select()\n        .from(economicEvents)\n        .where(\n          and(\n            gte(economicEvents.eventTime, now),\n            sql`${economicEvents.eventTime} <= ${futureTime}`\n          )\n        )\n        .orderBy(economicEvents.eventTime);\n\n      return events;\n    } catch (error) {\n      console.error('Error fetching upcoming events:', error);\n      return [];\n    }\n  }\n\n  async getTodayEvents(): Promise<typeof economicEvents.$inferSelect[]> {\n    try {\n      const now = new Date();\n      const startOfDay = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n      const endOfDay = new Date(startOfDay);\n      endOfDay.setDate(endOfDay.getDate() + 1);\n\n      const events = await db\n        .select()\n        .from(economicEvents)\n        .where(\n          and(\n            gte(economicEvents.eventTime, startOfDay),\n            sql`${economicEvents.eventTime} < ${endOfDay}`\n          )\n        )\n        .orderBy(economicEvents.eventTime);\n\n      return events;\n    } catch (error) {\n      console.error('Error fetching today events:', error);\n      return [];\n    }\n  }\n\n  async getWeekEvents(): Promise<typeof economicEvents.$inferSelect[]> {\n    try {\n      const now = new Date();\n      const weekLater = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000);\n\n      const events = await db\n        .select()\n        .from(economicEvents)\n        .where(\n          and(\n            gte(economicEvents.eventTime, now),\n            sql`${economicEvents.eventTime} <= ${weekLater}`\n          )\n        )\n        .orderBy(economicEvents.eventTime);\n\n      return events;\n    } catch (error) {\n      console.error('Error fetching week events:', error);\n      return [];\n    }\n  }\n\n  async cleanupOldEvents(): Promise<void> {\n    try {\n      const cutoffDate = new Date();\n      cutoffDate.setDate(cutoffDate.getDate() - this.dataRetentionDays);\n\n      await db\n        .delete(economicEvents)\n        .where(sql`${economicEvents.eventTime} < ${cutoffDate}`);\n\n      console.log(`Cleaned up events older than ${this.dataRetentionDays} days`);\n    } catch (error) {\n      console.error('Error cleaning up old events:', error);\n    }\n  }\n\n  private getRegionFromCountry(country: string): string {\n    const regionMap: Record<string, string> = {\n      'United States': 'Americas',\n      'Canada': 'Americas',\n      'Eurozone': 'Europe',\n      'Euro Zone': 'Europe',\n      'United Kingdom': 'Europe',\n      'Switzerland': 'Europe',\n      'Japan': 'Asia',\n      'China': 'Asia',\n      'Australia': 'Asia Pacific',\n      'New Zealand': 'Asia Pacific',\n    };\n\n    return regionMap[country] || 'Global';\n  }\n\n  async getOrFetchEvents(\n    type: 'today' | 'week' | 'upcoming',\n    scraper: any\n  ): Promise<typeof economicEvents.$inferSelect[]> {\n    const isFresh = await this.isCacheFresh();\n\n    if (!isFresh) {\n      console.log('Cache is stale, fetching new data...');\n      const scrapedEvents = await scraper.scrapeWithRetry();\n      await this.storeEvents(scrapedEvents);\n    }\n\n    switch (type) {\n      case 'today':\n        return this.getTodayEvents();\n      case 'week':\n        return this.getWeekEvents();\n      case 'upcoming':\n        return this.getUpcomingEvents(24);\n      default:\n        return this.getTodayEvents();\n    }\n  }\n\n  async getEventById(id: string): Promise<typeof economicEvents.$inferSelect | undefined> {\n    try {\n      const event = await db\n        .select()\n        .from(economicEvents)\n        .where(eq(economicEvents.id, id))\n        .limit(1);\n\n      return event[0];\n    } catch (error) {\n      console.error('Error fetching event by ID:', error);\n      return undefined;\n    }\n  }\n}\n\nexport const cacheService = new CacheService();\n","size_bytes":6403},"client/src/components/HeroSection.tsx":{"content":"import { motion } from 'framer-motion';\nimport { ArrowRight, TrendingUp, TrendingDown, Clock, Calendar } from 'lucide-react';\nimport { useQuery } from '@tanstack/react-query';\nimport { useEffect, useState } from 'react';\n\ninterface TradingSignal {\n  symbol: string;\n  direction: 'BUY' | 'SELL';\n  confidence: number;\n}\n\ninterface EconomicEvent {\n  title: string;\n  country: string;\n  impactLevel: string;\n  eventTime: string;\n}\n\nexport function HeroSection() {\n  const [currentTime, setCurrentTime] = useState(new Date());\n\n  useEffect(() => {\n    const timer = setInterval(() => setCurrentTime(new Date()), 1000);\n    return () => clearInterval(timer);\n  }, []);\n\n  const { data: signals } = useQuery<TradingSignal[]>({\n    queryKey: ['/api/trading-signals'],\n  });\n\n  const { data: events } = useQuery<EconomicEvent[]>({\n    queryKey: ['/api/economic-events'],\n  });\n\n  const getCurrentSession = () => {\n    const hour = currentTime.getUTCHours();\n    if (hour >= 0 && hour < 8) return { name: 'Sydney', color: 'bg-yellow-500', active: true };\n    if (hour >= 0 && hour < 9) return { name: 'Tokyo', color: 'bg-red-500', active: true };\n    if (hour >= 8 && hour < 16) return { name: 'London', color: 'bg-blue-500', active: true };\n    if (hour >= 13 && hour < 21) return { name: 'New York', color: 'bg-green-500', active: true };\n    return { name: 'Off Hours', color: 'bg-gray-500', active: false };\n  };\n\n  const session = getCurrentSession();\n\n  return (\n    <header className=\"bg-blue-600 py-16 sm:py-20 lg:py-24 text-white\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col lg:flex-row items-center justify-between gap-12\">\n        \n        {/* Left Side: Text Content and Buttons */}\n        <motion.div \n          className=\"lg:w-1/2 text-center lg:text-left\"\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.6 }}\n        >\n          <motion.h1 \n            className=\"text-4xl sm:text-5xl lg:text-6xl font-extrabold leading-tight tracking-tight\"\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6, delay: 0.1 }}\n          >\n            Less Charting. No worries. Only precision.\n          </motion.h1>\n          <motion.p \n            className=\"mt-6 text-lg sm:text-xl text-blue-100 max-w-xl mx-auto lg:mx-0\"\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6, delay: 0.2 }}\n          >\n            Access premium signals, real-time analytics, and expert research to confidently navigate global financial markets.\n          </motion.p>\n          <motion.div \n            className=\"mt-10 flex flex-col sm:flex-row gap-4 justify-center lg:justify-start\"\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6, delay: 0.3 }}\n          >\n            <button className=\"px-8 py-3 text-lg font-extrabold text-blue-600 bg-white rounded-full border-2 border-white hero-dotted-outline hover:bg-blue-50 transition duration-150 ease-in-out transform hover:scale-[1.02] active:scale-[0.98] flex items-center justify-center gap-2\">\n              Subscribe <ArrowRight className=\"w-5 h-5\" />\n            </button>\n            <button className=\"px-8 py-3 text-lg font-extrabold text-white bg-transparent rounded-full border-2 border-white hover:bg-white/10 transition duration-150 ease-in-out transform hover:scale-[1.02] active:scale-[0.98]\">\n              Learn More\n            </button>\n          </motion.div>\n        </motion.div>\n\n        {/* Right Side: Live Data Grid */}\n        <motion.div \n          className=\"lg:w-1/2 grid grid-cols-2 gap-4\"\n          initial={{ opacity: 0, scale: 0.95 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ duration: 0.6, delay: 0.2 }}\n        >\n          {/* 1. Trading Signals Scroller */}\n          <div className=\"col-span-2 overflow-hidden rounded-xl shadow-lg bg-gradient-to-br from-blue-500 to-blue-700\">\n            <div className=\"px-4 py-3 flex items-center gap-2 border-b border-white/20\">\n              <div className=\"w-3 h-3 bg-yellow-400 rounded-full animate-pulse\"></div>\n              <span className=\"text-white text-xl font-bold\">Live Signals</span>\n            </div>\n            <div className=\"w-full h-52 overflow-hidden px-4 py-3\">\n              <div className=\"space-y-2 animate-scroll-up\">\n                {signals && signals.slice(0, 8).map((signal, idx) => (\n                  <div\n                    key={idx}\n                    className=\"bg-white/20 backdrop-blur-sm rounded-lg p-3 flex items-center justify-between\"\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      {signal.direction === 'BUY' ? (\n                        <TrendingUp className=\"w-5 h-5 text-green-300\" />\n                      ) : (\n                        <TrendingDown className=\"w-5 h-5 text-red-300\" />\n                      )}\n                      <span className=\"text-white font-bold text-sm\">{signal.symbol}</span>\n                    </div>\n                    <span className={`px-3 py-1 rounded-full text-xs font-bold ${signal.direction === 'BUY' ? 'bg-green-500' : 'bg-red-500'} text-white`}>\n                      {signal.direction}\n                    </span>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n\n          {/* 2. Trading Session Tracker */}\n          <div className=\"overflow-hidden rounded-xl shadow-lg bg-gradient-to-br from-green-500 to-green-700\">\n            <div className=\"w-full h-48 p-4 flex flex-col items-center justify-center text-white\">\n              <Clock className=\"w-12 h-12 mb-3\" />\n              <div className=\"text-2xl font-bold mb-2\">{session.name}</div>\n              <div className=\"text-sm opacity-90 mb-3\">\n                {currentTime.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })} UTC\n              </div>\n              <div className={`${session.color} px-4 py-2 rounded-full text-xs font-bold flex items-center gap-2`}>\n                <span className=\"w-2 h-2 bg-white rounded-full animate-pulse\"></span>\n                {session.active ? 'ACTIVE' : 'CLOSED'}\n              </div>\n            </div>\n          </div>\n\n          {/* 3. High Impact News Tracker */}\n          <div className=\"overflow-hidden rounded-xl shadow-lg bg-gradient-to-br from-red-500 to-red-700 relative\">\n            <div className=\"absolute top-3 left-3 flex items-center gap-2 z-10\">\n              <Calendar className=\"w-4 h-4 text-white\" />\n              <span className=\"text-white text-sm font-bold\">High Impact</span>\n            </div>\n            <div className=\"w-full h-48 overflow-hidden pt-12 px-3 pb-3\">\n              <div className=\"space-y-2 animate-scroll-up-slow\">\n                {events && events.filter(e => e.impactLevel === 'high').slice(0, 5).map((event, idx) => (\n                  <div\n                    key={idx}\n                    className=\"bg-white/20 backdrop-blur-sm rounded-lg p-2\"\n                  >\n                    <div className=\"text-white font-bold text-xs truncate\">{event.title}</div>\n                    <div className=\"text-white/80 text-xs flex items-center gap-1 mt-1\">\n                      <span className=\"font-semibold\">{event.country}</span>\n                      <span>•</span>\n                      <span>{new Date(event.eventTime).toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })}</span>\n                    </div>\n                  </div>\n                ))}\n                {(!events || events.filter(e => e.impactLevel === 'high').length === 0) && (\n                  <div className=\"text-white/80 text-xs text-center py-4\">\n                    No high impact events scheduled\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </motion.div>\n      </div>\n    </header>\n  );\n}\n","size_bytes":8067},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"server/services/signalScanner.ts":{"content":"import { storage } from \"../storage\";\nimport { notificationService } from \"./notificationService\";\nimport { telegramNotificationService } from \"./telegramNotification\";\nimport { strategyRegistry, initializeStrategies, StrategySignal, InstrumentData } from \"../strategies\";\nimport { fetchMultiTimeframeData } from \"../strategies/shared/multiTimeframe\";\nimport { getPrice } from \"../lib/priceService\";\n\nconst TRADEABLE_INSTRUMENTS = [\n  { symbol: 'EUR/USD', assetClass: 'forex', currentPrice: 1.0850 },\n  { symbol: 'GBP/USD', assetClass: 'forex', currentPrice: 1.2650 },\n  { symbol: 'USD/JPY', assetClass: 'forex', currentPrice: 149.50 },\n  { symbol: 'USD/CHF', assetClass: 'forex', currentPrice: 0.8750 },\n  { symbol: 'AUD/USD', assetClass: 'forex', currentPrice: 0.6580 },\n  { symbol: 'USD/CAD', assetClass: 'forex', currentPrice: 1.3550 },\n  { symbol: 'NZD/USD', assetClass: 'forex', currentPrice: 0.6150 },\n  \n  { symbol: 'EUR/GBP', assetClass: 'forex', currentPrice: 0.8580 },\n  { symbol: 'EUR/JPY', assetClass: 'forex', currentPrice: 162.00 },\n  { symbol: 'EUR/CHF', assetClass: 'forex', currentPrice: 0.9500 },\n  { symbol: 'EUR/AUD', assetClass: 'forex', currentPrice: 1.6500 },\n  { symbol: 'EUR/CAD', assetClass: 'forex', currentPrice: 1.4700 },\n  { symbol: 'EUR/NZD', assetClass: 'forex', currentPrice: 1.7650 },\n  \n  { symbol: 'GBP/JPY', assetClass: 'forex', currentPrice: 185.50 },\n  { symbol: 'GBP/CHF', assetClass: 'forex', currentPrice: 1.1050 },\n  { symbol: 'GBP/AUD', assetClass: 'forex', currentPrice: 1.9250 },\n  { symbol: 'GBP/CAD', assetClass: 'forex', currentPrice: 1.7150 },\n  { symbol: 'GBP/NZD', assetClass: 'forex', currentPrice: 2.0550 },\n  \n  { symbol: 'AUD/JPY', assetClass: 'forex', currentPrice: 98.50 },\n  { symbol: 'CAD/JPY', assetClass: 'forex', currentPrice: 110.50 },\n  { symbol: 'CHF/JPY', assetClass: 'forex', currentPrice: 170.75 },\n  { symbol: 'NZD/JPY', assetClass: 'forex', currentPrice: 92.00 },\n  \n  { symbol: 'AUD/CAD', assetClass: 'forex', currentPrice: 0.8920 },\n  { symbol: 'AUD/CHF', assetClass: 'forex', currentPrice: 0.5750 },\n  { symbol: 'AUD/NZD', assetClass: 'forex', currentPrice: 1.0700 },\n  { symbol: 'CAD/CHF', assetClass: 'forex', currentPrice: 0.6450 },\n  { symbol: 'NZD/CAD', assetClass: 'forex', currentPrice: 0.8340 },\n  { symbol: 'NZD/CHF', assetClass: 'forex', currentPrice: 0.5380 },\n  \n  { symbol: 'US100', assetClass: 'index', currentPrice: 21200.00 },\n  { symbol: 'US500', assetClass: 'index', currentPrice: 5950.00 },\n  { symbol: 'US30', assetClass: 'index', currentPrice: 43800.00 },\n  { symbol: 'RUSSELL2000', assetClass: 'index', currentPrice: 2350.00 },\n  { symbol: 'VIX', assetClass: 'index', currentPrice: 14.50 },\n  \n  { symbol: 'AAPL', assetClass: 'stock', currentPrice: 175.50 },\n  { symbol: 'MSFT', assetClass: 'stock', currentPrice: 378.25 },\n  { symbol: 'GOOGL', assetClass: 'stock', currentPrice: 140.85 },\n  { symbol: 'AMZN', assetClass: 'stock', currentPrice: 152.30 },\n  { symbol: 'NVDA', assetClass: 'stock', currentPrice: 495.75 },\n  { symbol: 'TSLA', assetClass: 'stock', currentPrice: 245.60 },\n  { symbol: 'META', assetClass: 'stock', currentPrice: 485.20 },\n  { symbol: 'NFLX', assetClass: 'stock', currentPrice: 475.80 },\n  { symbol: 'AMD', assetClass: 'stock', currentPrice: 155.40 },\n  { symbol: 'ORCL', assetClass: 'stock', currentPrice: 115.25 },\n  \n  { symbol: 'JPM', assetClass: 'stock', currentPrice: 165.70 },\n  { symbol: 'BAC', assetClass: 'stock', currentPrice: 32.85 },\n  { symbol: 'GS', assetClass: 'stock', currentPrice: 385.40 },\n  { symbol: 'V', assetClass: 'stock', currentPrice: 265.30 },\n  { symbol: 'MA', assetClass: 'stock', currentPrice: 425.60 },\n  { symbol: 'JNJ', assetClass: 'stock', currentPrice: 158.90 },\n  { symbol: 'UNH', assetClass: 'stock', currentPrice: 512.75 },\n  { symbol: 'WMT', assetClass: 'stock', currentPrice: 165.40 },\n  { symbol: 'PG', assetClass: 'stock', currentPrice: 152.30 },\n  { symbol: 'DIS', assetClass: 'stock', currentPrice: 95.85 },\n  \n  { symbol: 'XAU/USD', assetClass: 'commodity', currentPrice: 2035.00 },\n  { symbol: 'XAG/USD', assetClass: 'commodity', currentPrice: 24.50 },\n  { symbol: 'WTI', assetClass: 'commodity', currentPrice: 82.50 },\n  { symbol: 'BRENT', assetClass: 'commodity', currentPrice: 86.75 },\n  \n  { symbol: 'BTC/USD', assetClass: 'crypto', currentPrice: 43200 },\n  { symbol: 'ETH/USD', assetClass: 'crypto', currentPrice: 2280 },\n  { symbol: 'BNB/USD', assetClass: 'crypto', currentPrice: 315.50 },\n  { symbol: 'SOL/USD', assetClass: 'crypto', currentPrice: 98.75 },\n];\n\nlet strategiesInitialized = false;\n\nexport class SignalScannerService {\n  private isScanning: boolean = false;\n\n  constructor() {\n    if (!strategiesInitialized) {\n      initializeStrategies();\n      strategiesInitialized = true;\n    }\n  }\n\n  async scanMarkets(): Promise<void> {\n    if (this.isScanning) {\n      console.log('Signal scan already in progress, skipping...');\n      return;\n    }\n\n    try {\n      this.isScanning = true;\n      console.log('[SignalScanner] Starting modular market scan...');\n\n      const stats = strategyRegistry.getStats();\n      console.log(`[SignalScanner] Running ${stats.enabledStrategies} enabled strategies`);\n\n      const newSignals: StrategySignal[] = [];\n      const allPendingSetups: any[] = [];\n\n      for (const instrument of TRADEABLE_INSTRUMENTS) {\n        try {\n          const result = await this.analyzeWithStrategies(instrument);\n          newSignals.push(...result.signals);\n          allPendingSetups.push(...result.pendingSetups);\n        } catch (error) {\n          console.error(`Error analyzing ${instrument.symbol}:`, error);\n        }\n      }\n\n      if (newSignals.length > 0) {\n        console.log(`[SignalScanner] Generated ${newSignals.length} new trading signals`);\n        \n        for (const signal of newSignals) {\n          await this.saveAndNotifySignal(signal);\n        }\n      } else {\n        console.log('[SignalScanner] No high-confidence signals found in this scan');\n      }\n\n      if (allPendingSetups.length > 0) {\n        console.log(`[SignalScanner] Found ${allPendingSetups.length} pending setups for watchlist`);\n        for (const setup of allPendingSetups) {\n          await this.saveWatchlistSignal(setup);\n        }\n      }\n\n    } catch (error) {\n      console.error('[SignalScanner] Error during market scan:', error);\n    } finally {\n      this.isScanning = false;\n    }\n  }\n\n  private async analyzeWithStrategies(instrument: { symbol: string; assetClass: string; currentPrice: number }): Promise<{ signals: StrategySignal[]; pendingSetups: any[] }> {\n    const { symbol, assetClass, currentPrice } = instrument;\n\n    let livePrice = currentPrice;\n    try {\n      const validAssetClass = assetClass as 'forex' | 'stock' | 'commodity' | 'crypto';\n      const priceResult = await getPrice(symbol, validAssetClass);\n      if (priceResult && priceResult.price) {\n        livePrice = priceResult.price;\n      }\n    } catch (error) {\n    }\n\n    const data = await fetchMultiTimeframeData(symbol, assetClass, livePrice);\n\n    const instrumentData: InstrumentData = {\n      symbol,\n      assetClass,\n      currentPrice: livePrice,\n      data,\n    };\n\n    const existingActiveSignals = await storage.getTradingSignals({ \n      symbol, \n      status: 'active' \n    });\n\n    if (existingActiveSignals.length > 0) {\n      return { signals: [], pendingSetups: [] };\n    }\n\n    const result = await strategyRegistry.runAllStrategiesWithPending(instrumentData);\n\n    return result;\n  }\n\n  private async saveWatchlistSignal(setup: any): Promise<void> {\n    try {\n      const existingWatchlist = await storage.getTradingSignals({\n        symbol: setup.symbol,\n        status: 'watchlist'\n      });\n\n      if (existingWatchlist.length > 0) {\n        return;\n      }\n\n      const now = new Date();\n      const expiresAt = new Date(now.getTime() + 4 * 60 * 60 * 1000);\n\n      await storage.createTradingSignal({\n        symbol: setup.symbol,\n        assetClass: setup.assetClass || 'forex',\n        type: setup.direction || 'buy',\n        strategy: 'Smart Money Concepts',\n        primaryTimeframe: setup.timeframe || '15M',\n        confirmationTimeframe: '1M',\n        entryPrice: setup.entryZone?.midPrice?.toString() || '0',\n        stopLoss: setup.stopLoss?.toString() || '0',\n        takeProfit: setup.takeProfit?.toString() || '0',\n        riskRewardRatio: setup.riskRewardRatio?.toString() || '2',\n        overallConfidence: setup.confidence || 50,\n        trendDirection: setup.trendDirection || 'sideways',\n        trendScore: (setup.confidence || 50).toString(),\n        smcScore: (setup.confidence || 50).toString(),\n        smcFactors: setup.confirmations || [],\n        orderBlockType: setup.entryZone?.type || 'demand',\n        orderBlockLevel: setup.entryZone?.topPrice?.toString() || '0',\n        fvgDetected: false,\n        fvgLevel: null,\n        liquiditySweep: false,\n        bocChochDetected: null,\n        technicalReasons: setup.confirmations || ['Pending LTF confirmation'],\n        marketContext: `Watchlist: ${setup.symbol} - awaiting entry confirmation`,\n        strength: setup.confidence >= 60 ? 'moderate' : 'weak',\n        status: 'watchlist',\n        expiresAt,\n      });\n\n      console.log(`[SignalScanner] Added to watchlist: ${setup.symbol} (${setup.confidence}% confidence)`);\n    } catch (error) {\n      console.error(`[SignalScanner] Error saving watchlist signal:`, error);\n    }\n  }\n\n  private async saveAndNotifySignal(signal: StrategySignal): Promise<void> {\n    try {\n      const now = new Date();\n      const expiresAt = new Date(signal.expiresAt);\n\n      const dbSignal = await storage.createTradingSignal({\n        symbol: signal.symbol,\n        assetClass: signal.assetClass || 'forex',\n        type: signal.direction,\n        strategy: signal.strategyName,\n        primaryTimeframe: signal.timeframe,\n        confirmationTimeframe: '1M',\n        entryPrice: signal.entryPrice.toString(),\n        stopLoss: signal.stopLoss.toString(),\n        takeProfit: signal.takeProfit.toString(),\n        riskRewardRatio: signal.riskRewardRatio.toString(),\n        overallConfidence: signal.confidence,\n        trendDirection: signal.marketContext.h4TrendDirection,\n        trendScore: signal.confidence.toString(),\n        smcScore: signal.confidence.toString(),\n        smcFactors: signal.entrySetup.confirmations,\n        orderBlockType: signal.entrySetup.entryZone.type,\n        orderBlockLevel: signal.entrySetup.entryZone.topPrice.toString(),\n        fvgDetected: false,\n        fvgLevel: null,\n        liquiditySweep: signal.entryType === 'liquidity_sweep',\n        bocChochDetected: signal.entryType === 'choch' ? signal.direction === 'buy' ? 'bullish' : 'bearish' : null,\n        technicalReasons: signal.reasoning.slice(0, 10),\n        marketContext: `${signal.strategyName} - ${signal.entryType} entry at ${signal.timeframe} zone`,\n        strength: signal.confidence >= 80 ? 'strong' : signal.confidence >= 60 ? 'moderate' : 'weak',\n        status: 'active',\n        expiresAt,\n      });\n\n      await notificationService.createNotification({\n        type: 'trading_signal',\n        title: `${signal.direction === 'buy' ? '🟢' : '🔴'} ${signal.symbol} - ${signal.direction.toUpperCase()}`,\n        message: `Strategy: ${signal.strategyName} | Entry: ${signal.entryType} | Confidence: ${signal.confidence}% | R:R: 1:${signal.riskRewardRatio}`,\n        metadata: JSON.stringify({\n          ...signal,\n          dbSignalId: dbSignal.id,\n        }),\n      });\n\n      const legacySignal = {\n        symbol: signal.symbol,\n        type: signal.direction,\n        strategy: signal.strategyName,\n        entryPrice: signal.entryPrice,\n        stopLoss: signal.stopLoss,\n        takeProfit: signal.takeProfit,\n        riskRewardRatio: signal.riskRewardRatio,\n        overallConfidence: signal.confidence,\n        technicalReasons: signal.reasoning,\n      };\n\n      await telegramNotificationService.sendTradingSignalNotification(legacySignal);\n\n      console.log(`[SignalScanner] Signal saved and notifications sent: ${signal.symbol} ${signal.direction}`);\n\n    } catch (error) {\n      console.error(`[SignalScanner] Error saving signal for ${signal.symbol}:`, error);\n    }\n  }\n\n  async cleanupExpiredSignals(): Promise<void> {\n    try {\n      const allSignals = await storage.getTradingSignals({ status: 'active' });\n      const now = new Date();\n\n      for (const signal of allSignals) {\n        if (signal.expiresAt && new Date(signal.expiresAt) <= now) {\n          const timeDuration = Math.floor((now.getTime() - new Date(signal.createdAt!).getTime()) / (1000 * 60));\n          const durationText = `${Math.floor(timeDuration / 60)}h ${timeDuration % 60}m`;\n\n          await storage.createTrade({\n            userId: null,\n            symbol: signal.symbol,\n            type: signal.type,\n            strategy: signal.strategy,\n            entryPrice: signal.entryPrice,\n            exitPrice: signal.entryPrice,\n            quantity: '1',\n            pnl: '0',\n            pnlPercent: '0',\n            outcome: 'expired',\n            timeframe: signal.primaryTimeframe,\n            entryReason: signal.marketContext || `${signal.strategy} setup - ${signal.overallConfidence}% confidence`,\n            exitDate: now,\n            duration: durationText\n          });\n\n          await storage.deleteTradingSignal(signal.id);\n\n          console.log(`[SignalScanner] Expired signal archived: ${signal.symbol} - ${signal.type} (Duration: ${durationText})`);\n        }\n      }\n    } catch (error) {\n      console.error('[SignalScanner] Error cleaning up expired signals:', error);\n    }\n  }\n\n  getStrategyStats() {\n    return strategyRegistry.getStats();\n  }\n\n  enableStrategy(strategyId: string): boolean {\n    return strategyRegistry.enableStrategy(strategyId);\n  }\n\n  disableStrategy(strategyId: string): boolean {\n    return strategyRegistry.disableStrategy(strategyId);\n  }\n}\n\nexport const signalScannerService = new SignalScannerService();\n","size_bytes":13991},"server/services/liquiditySweepDetection.ts":{"content":"import { type Candle } from './marketData';\n\nexport interface LiquidityPool {\n  price: number;\n  type: 'high' | 'low';\n  poolType: 'equal_levels' | 'swing' | 'session' | 'daily' | 'weekly' | 'monthly';\n  sessionName?: string; // For session pools: 'Asian', 'London', 'NY'\n  occurrences?: number; // For equal levels\n  indices: number[];\n  swept: boolean;\n  sweepIndex?: number;\n  strength: 'strong' | 'moderate' | 'weak';\n}\n\n// Legacy type alias for backward compatibility\nexport type EqualLevel = LiquidityPool;\n\nexport interface SupplyDemandZone {\n  type: 'supply' | 'demand';\n  topPrice: number;\n  bottomPrice: number;\n  formationIndex: number;\n  strength: 'strong' | 'moderate' | 'weak';\n  mitigated: boolean;\n  mitigationIndex?: number;\n}\n\nexport interface LiquiditySweepResult {\n  sweepDetected: boolean;\n  sweepType?: 'bullish_sweep' | 'bearish_sweep';\n  sweptLevel?: EqualLevel;\n  supplyDemandZone?: SupplyDemandZone;\n  entryPrice?: number;\n  stopLoss?: number;\n  confidence: number;\n  reasoning: string[];\n}\n\nexport interface SwingPoint {\n  price: number;\n  index: number;\n  type: 'HH' | 'HL' | 'LH' | 'LL'; // Higher High, Higher Low, Lower High, Lower Low\n}\n\nexport interface CHoCHResult {\n  detected: boolean;\n  chochType?: 'bullish_choch' | 'bearish_choch'; // Bullish CHoCH = trend changed to bullish\n  chochIndex?: number;\n  chochPrice?: number;\n  previousTrend?: 'uptrend' | 'downtrend';\n  targetZone?: SupplyDemandZone;\n  levelsBroken?: number; // Number of levels broken without mitigation\n  entryValid: boolean;\n  confidence: number;\n  reasoning: string[];\n}\n\nexport class LiquiditySweepDetector {\n  private readonly EQUAL_LEVEL_TOLERANCE = 0.0015; // 0.15% tolerance for equal highs/lows\n  private readonly MIN_OCCURRENCES = 2; // Minimum equal highs/lows to form liquidity pool\n  private readonly SWEEP_CONFIRMATION_PIPS = 5; // Pips beyond level to confirm sweep\n  \n  /**\n   * Detect equal highs or lows that form liquidity pools\n   */\n  detectEqualLevels(candles: Candle[], lookback: number = 20): EqualLevel[] {\n    const levels: EqualLevel[] = [];\n    const recentCandles = candles.slice(-lookback);\n    const startIndex = candles.length - recentCandles.length; // Handle any size\n    \n    // Find equal highs\n    const highs = recentCandles.map((c, i) => ({ price: c.high, index: startIndex + i }));\n    const equalHighs = this.findEqualPrices(highs, 'high');\n    levels.push(...equalHighs);\n    \n    // Find equal lows\n    const lows = recentCandles.map((c, i) => ({ price: c.low, index: startIndex + i }));\n    const equalLows = this.findEqualPrices(lows, 'low');\n    levels.push(...equalLows);\n    \n    return levels.filter(level => (level.occurrences || 0) >= this.MIN_OCCURRENCES);\n  }\n  \n  /**\n   * Find prices that are equal within tolerance\n   */\n  private findEqualPrices(\n    priceData: { price: number; index: number }[],\n    type: 'high' | 'low'\n  ): EqualLevel[] {\n    const levels: Map<number, EqualLevel> = new Map();\n    \n    for (let i = 0; i < priceData.length; i++) {\n      const { price, index } = priceData[i];\n      let foundLevel = false;\n      \n      // Check if this price matches any existing level\n      for (const [key, level] of Array.from(levels.entries())) {\n        const tolerance = key * this.EQUAL_LEVEL_TOLERANCE;\n        if (Math.abs(price - key) <= tolerance) {\n          level.occurrences = (level.occurrences || 0) + 1;\n          level.indices.push(index);\n          foundLevel = true;\n          break;\n        }\n      }\n      \n      // Create new level if no match found\n      if (!foundLevel) {\n        levels.set(price, {\n          price,\n          type,\n          poolType: 'equal_levels',\n          occurrences: 1,\n          indices: [index],\n          swept: false,\n          strength: 'moderate', // Will be calculated based on occurrences later\n        });\n      }\n    }\n    \n    return Array.from(levels.values());\n  }\n  \n  /**\n   * Detect swing highs and lows (local peaks/troughs)\n   */\n  detectSwingLevels(candles: Candle[], lookback: number = 20): LiquidityPool[] {\n    const pools: LiquidityPool[] = [];\n    const recentCandles = candles.slice(-lookback);\n    const startIndex = candles.length - recentCandles.length; // Handle any size\n    \n    for (let i = 2; i < recentCandles.length - 2; i++) {\n      const current = recentCandles[i];\n      \n      // Check for swing high\n      if (current.high > recentCandles[i-1].high && \n          current.high > recentCandles[i-2].high &&\n          current.high > recentCandles[i+1].high &&\n          current.high > recentCandles[i+2].high) {\n        pools.push({\n          price: current.high,\n          type: 'high',\n          poolType: 'swing',\n          indices: [startIndex + i], // ✅ Absolute index\n          swept: false,\n          strength: 'moderate',\n        });\n      }\n      \n      // Check for swing low\n      if (current.low < recentCandles[i-1].low && \n          current.low < recentCandles[i-2].low &&\n          current.low < recentCandles[i+1].low &&\n          current.low < recentCandles[i+2].low) {\n        pools.push({\n          price: current.low,\n          type: 'low',\n          poolType: 'swing',\n          indices: [startIndex + i], // ✅ Absolute index\n          swept: false,\n          strength: 'moderate',\n        });\n      }\n    }\n    \n    return pools;\n  }\n\n  /**\n   * Detect session highs and lows (Asian, London, NY)\n   */\n  detectSessionLevels(candles: Candle[]): LiquidityPool[] {\n    const pools: LiquidityPool[] = [];\n    \n    // Get last 24 hours of data (or whatever is available)\n    const last24h = candles.slice(-24);\n    const startIndex = candles.length - last24h.length; // Handle < 24 candles\n    \n    // Session times in UTC\n    const sessions = [\n      { name: 'Asian', startHour: 0, endHour: 9 },\n      { name: 'London', startHour: 8, endHour: 17 },\n      { name: 'NY', startHour: 13, endHour: 22 },\n    ];\n    \n    for (const session of sessions) {\n      // Filter candles using actual timestamp UTC hours\n      const sessionCandlesWithIndex = last24h\n        .map((c, i) => ({\n          candle: c,\n          originalIndex: startIndex + i, // Correct index calculation\n        }))\n        .filter(({ candle }) => {\n          const utcHour = candle.timestamp.getUTCHours(); // Already a Date object\n          return utcHour >= session.startHour && utcHour < session.endHour;\n        });\n      \n      if (sessionCandlesWithIndex.length > 0) {\n        const sessionHigh = Math.max(...sessionCandlesWithIndex.map(s => s.candle.high));\n        const sessionLow = Math.min(...sessionCandlesWithIndex.map(s => s.candle.low));\n        \n        const highItem = sessionCandlesWithIndex.find(s => s.candle.high === sessionHigh);\n        const lowItem = sessionCandlesWithIndex.find(s => s.candle.low === sessionLow);\n        \n        if (highItem) {\n          pools.push({\n            price: sessionHigh,\n            type: 'high',\n            poolType: 'session',\n            sessionName: session.name,\n            indices: [highItem.originalIndex],\n            swept: false,\n            strength: 'strong', // Session levels are considered strong\n          });\n        }\n        \n        if (lowItem) {\n          pools.push({\n            price: sessionLow,\n            type: 'low',\n            poolType: 'session',\n            sessionName: session.name,\n            indices: [lowItem.originalIndex],\n            swept: false,\n            strength: 'strong',\n          });\n        }\n      }\n    }\n    \n    return pools;\n  }\n\n  /**\n   * Detect daily, weekly, and monthly highs/lows\n   */\n  detectTimeframeLevels(candles: Candle[]): LiquidityPool[] {\n    const pools: LiquidityPool[] = [];\n    \n    // Daily high/low (last 24 H1 candles or whatever is available)\n    const dailyCandles = candles.slice(-24);\n    if (dailyCandles.length > 0) {\n      const dailyStartIndex = candles.length - dailyCandles.length;\n      const dailyHigh = Math.max(...dailyCandles.map(c => c.high));\n      const dailyLow = Math.min(...dailyCandles.map(c => c.low));\n      const highIndex = dailyCandles.findIndex(c => c.high === dailyHigh);\n      const lowIndex = dailyCandles.findIndex(c => c.low === dailyLow);\n      \n      pools.push({\n        price: dailyHigh,\n        type: 'high',\n        poolType: 'daily',\n        indices: [dailyStartIndex + highIndex],\n        swept: false,\n        strength: 'strong',\n      });\n      \n      pools.push({\n        price: dailyLow,\n        type: 'low',\n        poolType: 'daily',\n        indices: [dailyStartIndex + lowIndex],\n        swept: false,\n        strength: 'strong',\n      });\n    }\n    \n    // Weekly high/low (last 120 H1 candles ~5 days or whatever is available)\n    const weeklyCandles = candles.slice(-120);\n    if (weeklyCandles.length > 0) {\n      const weeklyStartIndex = candles.length - weeklyCandles.length;\n      const weeklyHigh = Math.max(...weeklyCandles.map(c => c.high));\n      const weeklyLow = Math.min(...weeklyCandles.map(c => c.low));\n      const highIndex = weeklyCandles.findIndex(c => c.high === weeklyHigh);\n      const lowIndex = weeklyCandles.findIndex(c => c.low === weeklyLow);\n      \n      pools.push({\n        price: weeklyHigh,\n        type: 'high',\n        poolType: 'weekly',\n        indices: [weeklyStartIndex + highIndex],\n        swept: false,\n        strength: 'strong',\n      });\n      \n      pools.push({\n        price: weeklyLow,\n        type: 'low',\n        poolType: 'weekly',\n        indices: [weeklyStartIndex + lowIndex],\n        swept: false,\n        strength: 'strong',\n      });\n    }\n    \n    // Monthly high/low (last 500 H1 candles ~20 days or whatever is available)\n    const monthlyCandles = candles.slice(-500);\n    if (monthlyCandles.length > 0) {\n      const monthlyStartIndex = candles.length - monthlyCandles.length;\n      const monthlyHigh = Math.max(...monthlyCandles.map(c => c.high));\n      const monthlyLow = Math.min(...monthlyCandles.map(c => c.low));\n      const highIndex = monthlyCandles.findIndex(c => c.high === monthlyHigh);\n      const lowIndex = monthlyCandles.findIndex(c => c.low === monthlyLow);\n      \n      pools.push({\n        price: monthlyHigh,\n        type: 'high',\n        poolType: 'monthly',\n        indices: [monthlyStartIndex + highIndex],\n        swept: false,\n        strength: 'strong',\n      });\n      \n      pools.push({\n        price: monthlyLow,\n        type: 'low',\n        poolType: 'monthly',\n        indices: [monthlyStartIndex + lowIndex],\n        swept: false,\n        strength: 'strong',\n      });\n    }\n    \n    return pools;\n  }\n\n  /**\n   * Detect if a liquidity level has been swept\n   */\n  detectLiquiditySweep(\n    candles: Candle[],\n    equalLevels: EqualLevel[]\n  ): EqualLevel | null {\n    const latestCandles = candles.slice(-10);\n    \n    for (const level of equalLevels) {\n      if (level.swept) continue;\n      \n      for (let i = 0; i < latestCandles.length; i++) {\n        const candle = latestCandles[i];\n        \n        if (level.type === 'high') {\n          // Check if price swept above equal highs\n          if (candle.high > level.price + (this.SWEEP_CONFIRMATION_PIPS * 0.0001)) {\n            level.swept = true;\n            level.sweepIndex = candles.length - latestCandles.length + i;\n            return level;\n          }\n        } else {\n          // Check if price swept below equal lows\n          if (candle.low < level.price - (this.SWEEP_CONFIRMATION_PIPS * 0.0001)) {\n            level.swept = true;\n            level.sweepIndex = candles.length - latestCandles.length + i;\n            return level;\n          }\n        }\n      }\n    }\n    \n    return null;\n  }\n  \n  /**\n   * Identify supply and demand zones\n   * Marks zones at the BASE candle (last candle before impulse) per SMC methodology\n   */\n  identifySupplyDemandZones(candles: Candle[], lookback: number = 50): SupplyDemandZone[] {\n    const zones: SupplyDemandZone[] = [];\n    const recentCandles = candles.slice(-lookback);\n    const startIndex = candles.length - recentCandles.length;\n    \n    for (let i = 1; i < recentCandles.length - 1; i++) {\n      const base = recentCandles[i - 1]; // Last candle before impulse\n      const impulse = recentCandles[i]; // The impulse candle\n      const confirmation = recentCandles[i + 1]; // Confirmation candle\n      \n      // Detect supply zone: Mark zone on BASE candle before bearish impulse\n      // Base candle can be bullish or bearish - use FULL RANGE (high to low)\n      if (this.isSupplyZone(base, impulse, confirmation)) {\n        const zone: SupplyDemandZone = {\n          type: 'supply',\n          topPrice: base.high, // Full high of base candle\n          bottomPrice: base.low, // Full low of base candle\n          formationIndex: startIndex + (i - 1), // Index of BASE candle\n          strength: this.calculateZoneStrength(impulse, recentCandles.slice(i + 1)),\n          mitigated: false, // Fresh/unmitigated zone\n        };\n        zones.push(zone);\n      }\n      \n      // Detect demand zone: Mark zone on BASE candle before bullish impulse\n      // Base candle can be bullish or bearish - use FULL RANGE (high to low)\n      if (this.isDemandZone(base, impulse, confirmation)) {\n        const zone: SupplyDemandZone = {\n          type: 'demand',\n          topPrice: base.high, // Full high of base candle\n          bottomPrice: base.low, // Full low of base candle\n          formationIndex: startIndex + (i - 1), // Index of BASE candle\n          strength: this.calculateZoneStrength(impulse, recentCandles.slice(i + 1)),\n          mitigated: false, // Fresh/unmitigated zone\n        };\n        zones.push(zone);\n      }\n    }\n    \n    return zones;\n  }\n  \n  /**\n   * Check if pattern forms a supply zone\n   */\n  private isSupplyZone(prev: Candle, curr: Candle, next: Candle): boolean {\n    // Strong bearish candle after consolidation/bullish move\n    const isBearish = curr.close < curr.open;\n    const hasImpulse = (curr.open - curr.close) > (curr.high - curr.low) * 0.6;\n    const followThrough = next.close < curr.close;\n    \n    return isBearish && hasImpulse && followThrough;\n  }\n  \n  /**\n   * Check if pattern forms a demand zone\n   */\n  private isDemandZone(prev: Candle, curr: Candle, next: Candle): boolean {\n    // Strong bullish candle after consolidation/bearish move\n    const isBullish = curr.close > curr.open;\n    const hasImpulse = (curr.close - curr.open) > (curr.high - curr.low) * 0.6;\n    const followThrough = next.close > curr.close;\n    \n    return isBullish && hasImpulse && followThrough;\n  }\n  \n  /**\n   * Calculate zone strength based on subsequent price action\n   */\n  private calculateZoneStrength(\n    formationCandle: Candle,\n    subsequentCandles: Candle[]\n  ): 'strong' | 'moderate' | 'weak' {\n    const bodySize = Math.abs(formationCandle.close - formationCandle.open);\n    const wickSize = formationCandle.high - formationCandle.low - bodySize;\n    const bodyToWickRatio = bodySize / (bodySize + wickSize);\n    \n    // Check if zone has been respected\n    const touches = subsequentCandles.filter(c => \n      c.low <= formationCandle.high && c.high >= formationCandle.low\n    ).length;\n    \n    if (bodyToWickRatio > 0.7 && touches === 0) return 'strong';\n    if (bodyToWickRatio > 0.5 && touches <= 1) return 'moderate';\n    return 'weak';\n  }\n  \n  /**\n   * Detect zone mitigation (when price revisits supply/demand zone)\n   * Requires structural confirmation: close within zone + reaction\n   */\n  detectZoneMitigation(\n    candles: Candle[],\n    zone: SupplyDemandZone,\n    afterSweep: boolean = false\n  ): boolean {\n    const relevantCandles = afterSweep ? candles.slice(-5) : candles.slice(-10);\n    \n    for (let i = 0; i < relevantCandles.length - 1; i++) {\n      const current = relevantCandles[i];\n      const next = relevantCandles[i + 1];\n      \n      // Check if candle CLOSES within the zone (not just wicks)\n      const closeInZone = current.close >= zone.bottomPrice && current.close <= zone.topPrice;\n      \n      if (!closeInZone) continue;\n      \n      // Verify structural reaction based on zone type\n      let hasReaction = false;\n      \n      if (zone.type === 'supply') {\n        // For supply zone: next candle should move down (rejection from supply)\n        hasReaction = next.close < current.close;\n      } else {\n        // For demand zone: next candle should move up (bounce from demand)\n        hasReaction = next.close > current.close;\n      }\n      \n      // Mitigation confirmed only when close is in zone AND there's a reaction\n      if (hasReaction) {\n        zone.mitigated = true;\n        zone.mitigationIndex = candles.length - relevantCandles.length + i;\n        return true;\n      }\n    }\n    \n    return false;\n  }\n  \n  /**\n   * Detect ALL liquidity pools (equal levels, swing, session, timeframe)\n   */\n  detectAllLiquidityPools(candles: Candle[]): LiquidityPool[] {\n    const allPools: LiquidityPool[] = [];\n    \n    // 1. Equal highs/lows\n    const equalLevels = this.detectEqualLevels(candles, 30);\n    allPools.push(...equalLevels);\n    \n    // 2. Swing highs/lows\n    const swingLevels = this.detectSwingLevels(candles, 20);\n    allPools.push(...swingLevels);\n    \n    // 3. Session highs/lows\n    const sessionLevels = this.detectSessionLevels(candles);\n    allPools.push(...sessionLevels);\n    \n    // 4. Daily/Weekly/Monthly highs/lows\n    const timeframeLevels = this.detectTimeframeLevels(candles);\n    allPools.push(...timeframeLevels);\n    \n    return allPools;\n  }\n\n  /**\n   * Main function: Analyze for liquidity sweep with supply/demand entry\n   */\n  analyzeLiquiditySweep(candles: Candle[]): LiquiditySweepResult {\n    const reasoning: string[] = [];\n    \n    // Step 1: Identify ALL liquidity pools\n    const allPools = this.detectAllLiquidityPools(candles);\n    \n    if (allPools.length === 0) {\n      return {\n        sweepDetected: false,\n        confidence: 0,\n        reasoning: ['No liquidity pools detected'],\n      };\n    }\n    \n    // Count pools by type for reporting\n    const poolCounts = {\n      equal_levels: allPools.filter(p => p.poolType === 'equal_levels').length,\n      swing: allPools.filter(p => p.poolType === 'swing').length,\n      session: allPools.filter(p => p.poolType === 'session').length,\n      daily: allPools.filter(p => p.poolType === 'daily').length,\n      weekly: allPools.filter(p => p.poolType === 'weekly').length,\n      monthly: allPools.filter(p => p.poolType === 'monthly').length,\n    };\n    \n    const poolTypesSummary = Object.entries(poolCounts)\n      .filter(([_, count]) => count > 0)\n      .map(([type, count]) => `${count} ${type.replace('_', ' ')}`)\n      .join(', ');\n    \n    reasoning.push(`Identified liquidity pools: ${poolTypesSummary}`);\n    \n    // Step 2: Detect liquidity sweep\n    const sweptLevel = this.detectLiquiditySweep(candles, allPools);\n    \n    if (!sweptLevel) {\n      return {\n        sweepDetected: false,\n        confidence: 0,\n        reasoning: [...reasoning, 'No liquidity sweep detected'],\n      };\n    }\n    \n    // Create descriptive label for the swept pool\n    let poolLabel = '';\n    if (sweptLevel.poolType === 'equal_levels') {\n      poolLabel = sweptLevel.type === 'high' ? 'Equal Highs' : 'Equal Lows';\n    } else if (sweptLevel.poolType === 'swing') {\n      poolLabel = sweptLevel.type === 'high' ? 'Swing High' : 'Swing Low';\n    } else if (sweptLevel.poolType === 'session') {\n      poolLabel = `${sweptLevel.sessionName} ${sweptLevel.type === 'high' ? 'High' : 'Low'}`;\n    } else if (sweptLevel.poolType === 'daily') {\n      poolLabel = sweptLevel.type === 'high' ? 'Daily High' : 'Daily Low';\n    } else if (sweptLevel.poolType === 'weekly') {\n      poolLabel = sweptLevel.type === 'high' ? 'Weekly High' : 'Weekly Low';\n    } else if (sweptLevel.poolType === 'monthly') {\n      poolLabel = sweptLevel.type === 'high' ? 'Monthly High' : 'Monthly Low';\n    }\n    \n    reasoning.push(\n      `Liquidity sweep detected at ${sweptLevel.price.toFixed(5)} (${poolLabel})`\n    );\n    \n    // Step 3: Identify supply/demand zones\n    const zones = this.identifySupplyDemandZones(candles, 50);\n    \n    if (zones.length === 0) {\n      return {\n        sweepDetected: true,\n        sweepType: sweptLevel.type === 'high' ? 'bearish_sweep' : 'bullish_sweep',\n        sweptLevel,\n        confidence: 40,\n        reasoning: [...reasoning, 'No supply/demand zones identified for entry'],\n      };\n    }\n    \n    // Step 4: Find valid zone for entry AFTER sweep\n    const sweepType = sweptLevel.type === 'high' ? 'bearish_sweep' : 'bullish_sweep';\n    const targetZoneType = sweepType === 'bearish_sweep' ? 'supply' : 'demand';\n    \n    // Look for zones that were formed before the sweep\n    const validZones = zones.filter(z => \n      z.type === targetZoneType && \n      z.formationIndex < (sweptLevel.sweepIndex || 0) &&\n      !z.mitigated\n    );\n    \n    if (validZones.length === 0) {\n      return {\n        sweepDetected: true,\n        sweepType,\n        sweptLevel,\n        confidence: 45,\n        reasoning: [...reasoning, `No valid ${targetZoneType} zones found before sweep`],\n      };\n    }\n    \n    // Step 5: Check for zone mitigation AFTER sweep\n    const latestCandles = candles.slice(-5);\n    let mitigatedZone: SupplyDemandZone | undefined;\n    \n    for (const zone of validZones) {\n      if (this.detectZoneMitigation(candles, zone, true)) {\n        mitigatedZone = zone;\n        break;\n      }\n    }\n    \n    if (!mitigatedZone) {\n      return {\n        sweepDetected: true,\n        sweepType,\n        sweptLevel,\n        supplyDemandZone: validZones[0],\n        confidence: 55,\n        reasoning: [\n          ...reasoning,\n          `${validZones.length} ${targetZoneType} zone(s) identified`,\n          'Waiting for price to mitigate zone after sweep'\n        ],\n      };\n    }\n    \n    // Step 6: Calculate entry and stop loss based on mitigated zone\n    const latestCandle = candles[candles.length - 1];\n    let entryPrice: number;\n    let stopLoss: number;\n    \n    if (sweepType === 'bearish_sweep') {\n      // Enter short at supply zone mitigation\n      entryPrice = (mitigatedZone.topPrice + mitigatedZone.bottomPrice) / 2;\n      stopLoss = mitigatedZone.topPrice + (mitigatedZone.topPrice - mitigatedZone.bottomPrice) * 0.2;\n      \n      reasoning.push(\n        'Supply zone mitigation confirmed after liquidity sweep',\n        `Entry: ${entryPrice.toFixed(5)} (Supply zone)`,\n        `Stop: ${stopLoss.toFixed(5)} (Above supply zone)`\n      );\n    } else {\n      // Enter long at demand zone mitigation\n      entryPrice = (mitigatedZone.topPrice + mitigatedZone.bottomPrice) / 2;\n      stopLoss = mitigatedZone.bottomPrice - (mitigatedZone.topPrice - mitigatedZone.bottomPrice) * 0.2;\n      \n      reasoning.push(\n        'Demand zone mitigation confirmed after liquidity sweep',\n        `Entry: ${entryPrice.toFixed(5)} (Demand zone)`,\n        `Stop: ${stopLoss.toFixed(5)} (Below demand zone)`\n      );\n    }\n    \n    // Calculate confidence based on zone strength and sweep clarity\n    let confidence = 70;\n    if (mitigatedZone.strength === 'strong') confidence += 15;\n    else if (mitigatedZone.strength === 'moderate') confidence += 8;\n    \n    // Multiple equal levels = stronger liquidity pool\n    if (sweptLevel.poolType === 'equal_levels' && (sweptLevel.occurrences || 0) >= 3) {\n      confidence += 10;\n    }\n    \n    return {\n      sweepDetected: true,\n      sweepType,\n      sweptLevel,\n      supplyDemandZone: mitigatedZone,\n      entryPrice,\n      stopLoss,\n      confidence: Math.min(confidence, 95),\n      reasoning,\n    };\n  }\n\n  /**\n   * Identify swing points (HH, HL, LH, LL) for trend analysis\n   */\n  private identifySwingPoints(candles: Candle[], lookback: number = 30): SwingPoint[] {\n    const swingPoints: SwingPoint[] = [];\n    const recentCandles = candles.slice(-lookback);\n    const startIndex = candles.length - recentCandles.length;\n    \n    // Need at least 5 candles to identify swing points\n    if (recentCandles.length < 5) return swingPoints;\n    \n    let prevHigh: { price: number; index: number } | null = null;\n    let prevLow: { price: number; index: number } | null = null;\n    \n    for (let i = 2; i < recentCandles.length - 2; i++) {\n      const current = recentCandles[i];\n      const absoluteIndex = startIndex + i;\n      \n      // Detect swing high (local peak)\n      if (current.high > recentCandles[i-1].high && \n          current.high > recentCandles[i-2].high &&\n          current.high > recentCandles[i+1].high &&\n          current.high > recentCandles[i+2].high) {\n        \n        if (prevHigh) {\n          // Compare with previous high to determine HH or LH\n          if (current.high > prevHigh.price) {\n            swingPoints.push({\n              price: current.high,\n              index: absoluteIndex,\n              type: 'HH', // Higher High\n            });\n          } else {\n            swingPoints.push({\n              price: current.high,\n              index: absoluteIndex,\n              type: 'LH', // Lower High\n            });\n          }\n        }\n        prevHigh = { price: current.high, index: absoluteIndex };\n      }\n      \n      // Detect swing low (local trough)\n      if (current.low < recentCandles[i-1].low && \n          current.low < recentCandles[i-2].low &&\n          current.low < recentCandles[i+1].low &&\n          current.low < recentCandles[i+2].low) {\n        \n        if (prevLow) {\n          // Compare with previous low to determine HL or LL\n          if (current.low > prevLow.price) {\n            swingPoints.push({\n              price: current.low,\n              index: absoluteIndex,\n              type: 'HL', // Higher Low\n            });\n          } else {\n            swingPoints.push({\n              price: current.low,\n              index: absoluteIndex,\n              type: 'LL', // Lower Low\n            });\n          }\n        }\n        prevLow = { price: current.low, index: absoluteIndex };\n      }\n    }\n    \n    return swingPoints;\n  }\n\n  /**\n   * Detect CHoCH (Change of Character) - trend reversal signal\n   * Bullish CHoCH: Downtrend breaks (LH, LL → HH)\n   * Bearish CHoCH: Uptrend breaks (HH, HL → LL)\n   */\n  detectCHoCH(candles: Candle[], zones: SupplyDemandZone[]): CHoCHResult {\n    const reasoning: string[] = [];\n    const swingPoints = this.identifySwingPoints(candles);\n    \n    if (swingPoints.length < 3) {\n      return {\n        detected: false,\n        entryValid: false,\n        confidence: 0,\n        reasoning: ['Insufficient swing points for CHoCH detection'],\n      };\n    }\n    \n    // Analyze recent swing points to detect trend change\n    const recentSwings = swingPoints.slice(-5); // Look at last 5 swing points\n    \n    // Detect Bullish CHoCH: Downtrend (LH, LL) breaks with HH\n    const hasLH = recentSwings.some(s => s.type === 'LH');\n    const hasLL = recentSwings.some(s => s.type === 'LL');\n    const latestHH = recentSwings.filter(s => s.type === 'HH').pop();\n    \n    if (hasLH && hasLL && latestHH) {\n      reasoning.push('Bearish trend detected (LH, LL pattern)');\n      reasoning.push(`Bullish CHoCH: Price made Higher High at ${latestHH.price.toFixed(5)}`);\n      \n      return this.validateCHoCHEntry(\n        candles,\n        zones,\n        'bullish_choch',\n        latestHH.index,\n        latestHH.price,\n        'downtrend',\n        reasoning\n      );\n    }\n    \n    // Detect Bearish CHoCH: Uptrend (HH, HL) breaks with LL\n    const hasHH = recentSwings.some(s => s.type === 'HH');\n    const hasHL = recentSwings.some(s => s.type === 'HL');\n    const latestLL = recentSwings.filter(s => s.type === 'LL').pop();\n    \n    if (hasHH && hasHL && latestLL) {\n      reasoning.push('Bullish trend detected (HH, HL pattern)');\n      reasoning.push(`Bearish CHoCH: Price made Lower Low at ${latestLL.price.toFixed(5)}`);\n      \n      return this.validateCHoCHEntry(\n        candles,\n        zones,\n        'bearish_choch',\n        latestLL.index,\n        latestLL.price,\n        'uptrend',\n        reasoning\n      );\n    }\n    \n    return {\n      detected: false,\n      entryValid: false,\n      confidence: 0,\n      reasoning: ['No CHoCH pattern detected in recent price action'],\n    };\n  }\n\n  /**\n   * Validate CHoCH entry conditions\n   */\n  private validateCHoCHEntry(\n    candles: Candle[],\n    zones: SupplyDemandZone[],\n    chochType: 'bullish_choch' | 'bearish_choch',\n    chochIndex: number,\n    chochPrice: number,\n    previousTrend: 'uptrend' | 'downtrend',\n    reasoning: string[]\n  ): CHoCHResult {\n    // Determine target zone type based on CHoCH direction\n    const targetZoneType = chochType === 'bullish_choch' ? 'demand' : 'supply';\n    \n    // Find unmitigated zones BEFORE the CHoCH\n    const unmitigatedZones = zones.filter(z => \n      z.type === targetZoneType && \n      z.formationIndex < chochIndex &&\n      !z.mitigated\n    );\n    \n    if (unmitigatedZones.length === 0) {\n      reasoning.push(`No unmitigated ${targetZoneType} zones found before CHoCH`);\n      return {\n        detected: true,\n        chochType,\n        chochIndex,\n        chochPrice,\n        previousTrend,\n        entryValid: false,\n        confidence: 40,\n        levelsBroken: 0,\n        reasoning,\n      };\n    }\n    \n    // Get most recent unmitigated zone\n    const targetZone = unmitigatedZones[unmitigatedZones.length - 1];\n    \n    // Count levels broken between zone and CHoCH WITHOUT mitigation\n    const levelsBroken = this.countLevelsBrokenWithoutMitigation(\n      candles,\n      zones,\n      targetZone.formationIndex,\n      chochIndex,\n      targetZoneType\n    );\n    \n    reasoning.push(`Found unmitigated ${targetZoneType} zone from index ${targetZone.formationIndex}`);\n    reasoning.push(`Price broke ${levelsBroken} level(s) without mitigation`);\n    \n    // Entry is INVALID if price comes FROM an unmitigated zone (zone still in control)\n    if (this.priceComesFromUnmitigatedZone(candles, targetZone, chochIndex)) {\n      reasoning.push(`Entry INVALID: Price comes from unmitigated ${targetZoneType} zone (still in control)`);\n      return {\n        detected: true,\n        chochType,\n        chochIndex,\n        chochPrice,\n        previousTrend,\n        targetZone,\n        levelsBroken,\n        entryValid: false,\n        confidence: 35,\n        reasoning,\n      };\n    }\n    \n    // Entry requires 2+ levels broken\n    if (levelsBroken < 2) {\n      reasoning.push('Entry INVALID: Must break 2+ levels without mitigation');\n      return {\n        detected: true,\n        chochType,\n        chochIndex,\n        chochPrice,\n        previousTrend,\n        targetZone,\n        levelsBroken,\n        entryValid: false,\n        confidence: 45,\n        reasoning,\n      };\n    }\n    \n    // Valid CHoCH entry setup\n    reasoning.push(`✅ Valid CHoCH entry: ${levelsBroken}+ levels broken, targeting unmitigated ${targetZoneType} zone`);\n    \n    let confidence = 75;\n    if (levelsBroken >= 3) confidence += 10;\n    if (targetZone.strength === 'strong') confidence += 10;\n    \n    return {\n      detected: true,\n      chochType,\n      chochIndex,\n      chochPrice,\n      previousTrend,\n      targetZone,\n      levelsBroken,\n      entryValid: true,\n      confidence: Math.min(confidence, 95),\n      reasoning,\n    };\n  }\n\n  /**\n   * Count demand/supply levels broken without mitigation\n   */\n  private countLevelsBrokenWithoutMitigation(\n    candles: Candle[],\n    zones: SupplyDemandZone[],\n    startIndex: number,\n    endIndex: number,\n    targetZoneType: 'demand' | 'supply'\n  ): number {\n    const relevantZones = zones.filter(z => \n      z.type === targetZoneType &&\n      z.formationIndex > startIndex &&\n      z.formationIndex < endIndex &&\n      !z.mitigated\n    );\n    \n    return relevantZones.length;\n  }\n\n  /**\n   * Check if price comes FROM an unmitigated zone (invalid entry)\n   */\n  private priceComesFromUnmitigatedZone(\n    candles: Candle[],\n    zone: SupplyDemandZone,\n    chochIndex: number\n  ): boolean {\n    // Check candles between zone formation and CHoCH\n    const relevantCandles = candles.slice(zone.formationIndex, chochIndex + 1);\n    \n    // If price was inside zone in the last 3-5 candles before CHoCH, it \"comes from\" the zone\n    const recentCandles = relevantCandles.slice(-5);\n    \n    for (const candle of recentCandles) {\n      if (candle.low <= zone.topPrice && candle.high >= zone.bottomPrice) {\n        return true; // Price was inside zone recently\n      }\n    }\n    \n    return false;\n  }\n}\n","size_bytes":32346},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/Header.tsx":{"content":"import { useState } from 'react';\nimport { Link, useLocation } from 'wouter';\nimport { TrendingUp } from 'lucide-react';\n\nconst subNavLinks = [\n  { name: 'Signals Feed', path: '/' },\n  { name: 'Calendar', path: '/calendar' },\n  { name: 'Major Pairs', path: '/major-pairs' },\n  { name: 'US Stocks', path: '/stocks' },\n  { name: 'Commodities', path: '/commodities' },\n  { name: 'Cryptocurrency', path: '/crypto' },\n];\n\nexport default function Header() {\n  const [location] = useLocation();\n\n  const isActivePath = (path: string) => {\n    if (path === '/') return location === '/';\n    return location.startsWith(path);\n  };\n\n  return (\n    <header className=\"bg-card border-b border-border sticky top-0 z-50 shadow-sm\">\n      {/* TOP NAVIGATION BAR */}\n      <nav className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex items-center justify-between\">\n        \n        {/* Left Section: Logo and Signals Link */}\n        <div className=\"flex items-center space-x-4\">\n          {/* Logo: FindBuyandSellZones.com */}\n          <Link \n            href=\"/\" \n            className=\"flex items-center text-xl font-extrabold\"\n            data-testid=\"link-logo\"\n          >\n            <TrendingUp className=\"h-6 w-6 mr-2 text-bull-green\" />\n            <span className=\"text-bull-green\">Find</span>\n            <span className=\"text-foreground\">Buy</span>\n            <span className=\"text-foreground\">and</span>\n            <span className=\"text-bear-red\">Sell</span>\n            <span className=\"text-foreground\">Zones.com</span>\n          </Link>\n          \n          {/* Separator and Signals Link */}\n          <div className=\"flex items-center space-x-4\">\n            <span className=\"h-6 w-px bg-border hidden sm:block\"></span>\n            <Link \n              href=\"/\" \n              className=\"text-base font-semibold text-muted-foreground hover:text-primary transition-colors hidden sm:block\"\n              data-testid=\"link-signals\"\n            >\n              Signals\n            </Link>\n          </div>\n        </div>\n\n        {/* Right Section: Action Buttons */}\n        <div className=\"flex items-center space-x-3\">\n          <button \n            className=\"px-5 py-2.5 text-base font-extrabold text-primary bg-card dark:bg-background rounded-full border-2 border-primary dotted-outline hover:bg-muted dark:hover:bg-muted transition duration-150 transform hover:scale-[1.02] active:scale-[0.98]\"\n            data-testid=\"button-login\"\n          >\n            Login\n          </button>\n          <button \n            className=\"px-6 py-2.5 text-base font-extrabold text-primary bg-card dark:bg-background rounded-full border-2 border-primary dotted-outline hover:bg-muted dark:hover:bg-muted transition duration-150 transform hover:scale-[1.02] active:scale-[0.98]\"\n            data-testid=\"button-subscribe\"\n          >\n            Subscribe\n          </button>\n        </div>\n      </nav>\n\n      {/* SUB-NAVIGATION BAR */}\n      <nav className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 bg-card dark:bg-background\">\n        <div className=\"flex flex-wrap gap-x-8 gap-y-2 text-sm font-medium border-t border-border pt-2\">\n          {subNavLinks.map((link) => (\n            <Link\n              key={link.path}\n              href={link.path}\n              className={`py-3 px-1 transition-colors ${\n                isActivePath(link.path)\n                  ? 'text-primary border-b-3 border-primary sub-nav-active'\n                  : 'text-muted-foreground hover:text-foreground'\n              }`}\n              data-testid={`link-${link.name.toLowerCase().replace(/\\s+/g, '-')}`}\n            >\n              {link.name}\n            </Link>\n          ))}\n        </div>\n      </nav>\n    </header>\n  );\n}\n","size_bytes":3712},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { insertTradeSchema, insertEconomicEventSchema, insertTradingSignalSchema } from \"@shared/schema\";\nimport { getEconomicCalendar } from \"./services/fmp\";\nimport { cacheService } from \"./scrapers/cacheService\";\nimport { economicCalendarScraper } from \"./scrapers/economicCalendarScraper\";\nimport { analyzeEventSentiment, updateEventWithSentiment } from \"./services/sentimentAnalysis\";\nimport { telegramNotificationService } from \"./services/telegramNotification\";\nimport { notificationService } from \"./services/notificationService\";\nimport { signalDetectionService } from \"./services/signalDetection\";\nimport { getInterestRateData, getInflationData, parseCurrencyPair, generateMockTimeframeData } from \"./services/marketData\";\nimport { getCachedPrice, getCachedMultiplePrices, pingPriceService } from \"./lib/priceService\";\nimport { validateSignalWithGemini, quickMarketScan, testGeminiConnection, isGeminiConfigured, analyzeWithGemini, quickAnalyzeWithGemini } from \"./services/geminiAnalysis\";\nimport { generateTradingSignalChart, isChartGeneratorAvailable, cleanupOldCharts } from \"./services/chartGenerator\";\nimport { signalMonitor } from \"./services/signalMonitor\";\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  app.get(\"/api/trades\", async (req, res) => {\n    try {\n      const userId = req.query.userId as string | undefined;\n      const trades = await storage.getTrades(userId);\n      res.json(trades);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch trades\" });\n    }\n  });\n\n  app.get(\"/api/trades/:id\", async (req, res) => {\n    try {\n      const trade = await storage.getTradeById(req.params.id);\n      if (!trade) {\n        return res.status(404).json({ error: \"Trade not found\" });\n      }\n      res.json(trade);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch trade\" });\n    }\n  });\n\n  app.post(\"/api/trades\", async (req, res) => {\n    try {\n      const validatedData = insertTradeSchema.parse(req.body);\n      const trade = await storage.createTrade(validatedData);\n      res.status(201).json(trade);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid trade data\" });\n    }\n  });\n\n  app.put(\"/api/trades/:id\", async (req, res) => {\n    try {\n      const trade = await storage.updateTrade(req.params.id, req.body);\n      if (!trade) {\n        return res.status(404).json({ error: \"Trade not found\" });\n      }\n      res.json(trade);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update trade\" });\n    }\n  });\n\n  app.delete(\"/api/trades/:id\", async (req, res) => {\n    try {\n      const success = await storage.deleteTrade(req.params.id);\n      if (!success) {\n        return res.status(404).json({ error: \"Trade not found\" });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete trade\" });\n    }\n  });\n\n  app.get(\"/api/analytics\", async (req, res) => {\n    try {\n      const userId = req.query.userId as string | undefined;\n      const trades = await storage.getTrades(userId);\n      \n      const totalTrades = trades.length;\n      const winningTrades = trades.filter(t => t.outcome === 'win');\n      const losingTrades = trades.filter(t => t.outcome === 'loss');\n      \n      const totalPnL = trades.reduce((sum, t) => sum + parseFloat(t.pnl), 0);\n      const averagePnL = totalTrades > 0 ? totalPnL / totalTrades : 0;\n      const winRate = totalTrades > 0 ? (winningTrades.length / totalTrades) * 100 : 0;\n      \n      const averageWin = winningTrades.length > 0 \n        ? winningTrades.reduce((sum, t) => sum + parseFloat(t.pnl), 0) / winningTrades.length \n        : 0;\n      const averageLoss = losingTrades.length > 0 \n        ? losingTrades.reduce((sum, t) => sum + parseFloat(t.pnl), 0) / losingTrades.length \n        : 0;\n\n      const analytics = {\n        totalTrades,\n        winningTrades: winningTrades.length,\n        losingTrades: losingTrades.length,\n        totalPnL: totalPnL.toFixed(2),\n        averagePnL: averagePnL.toFixed(2),\n        winRate: winRate.toFixed(2),\n        averageWin: averageWin.toFixed(2),\n        averageLoss: averageLoss.toFixed(2),\n      };\n\n      res.json(analytics);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to calculate analytics\" });\n    }\n  });\n\n  app.get(\"/api/calendar/today\", async (req, res) => {\n    try {\n      const events = await cacheService.getOrFetchEvents('today', economicCalendarScraper);\n      \n      const filters = {\n        region: req.query.region as string | undefined,\n        impactLevel: req.query.impactLevel as string | undefined,\n        currency: req.query.currency as string | undefined,\n      };\n      \n      let filteredEvents = events;\n      if (filters.region) {\n        filteredEvents = filteredEvents.filter(e => e.region === filters.region);\n      }\n      if (filters.impactLevel) {\n        filteredEvents = filteredEvents.filter(e => e.impactLevel === filters.impactLevel);\n      }\n      if (filters.currency) {\n        filteredEvents = filteredEvents.filter(e => e.currency === filters.currency);\n      }\n      \n      res.json(filteredEvents);\n    } catch (error) {\n      console.error('Error in /api/calendar/today:', error);\n      res.json([]);\n    }\n  });\n\n  app.get(\"/api/calendar/week\", async (req, res) => {\n    try {\n      const events = await cacheService.getOrFetchEvents('week', economicCalendarScraper);\n      \n      const filters = {\n        region: req.query.region as string | undefined,\n        impactLevel: req.query.impactLevel as string | undefined,\n        currency: req.query.currency as string | undefined,\n      };\n      \n      let filteredEvents = events;\n      if (filters.region) {\n        filteredEvents = filteredEvents.filter(e => e.region === filters.region);\n      }\n      if (filters.impactLevel) {\n        filteredEvents = filteredEvents.filter(e => e.impactLevel === filters.impactLevel);\n      }\n      if (filters.currency) {\n        filteredEvents = filteredEvents.filter(e => e.currency === filters.currency);\n      }\n      \n      res.json(filteredEvents);\n    } catch (error) {\n      console.error('Error in /api/calendar/week:', error);\n      res.json([]);\n    }\n  });\n\n  app.get(\"/api/economic-events\", async (req, res) => {\n    try {\n      const events = await cacheService.getOrFetchEvents('upcoming', economicCalendarScraper);\n      \n      const filters = {\n        region: req.query.region as string | undefined,\n        impactLevel: req.query.impactLevel as string | undefined,\n        currency: req.query.currency as string | undefined,\n      };\n      \n      let filteredEvents = events;\n      if (filters.region) {\n        filteredEvents = filteredEvents.filter(e => e.region === filters.region);\n      }\n      if (filters.impactLevel) {\n        filteredEvents = filteredEvents.filter(e => e.impactLevel === filters.impactLevel);\n      }\n      if (filters.currency) {\n        filteredEvents = filteredEvents.filter(e => e.currency === filters.currency);\n      }\n      \n      const eventsWithSentiment = filteredEvents.map(event => updateEventWithSentiment(event));\n      \n      res.json(eventsWithSentiment);\n    } catch (error) {\n      console.error('Error in /api/economic-events:', error);\n      res.json([]);\n    }\n  });\n\n  app.get(\"/api/economic-events/:id\", async (req, res) => {\n    try {\n      const event = await cacheService.getEventById(req.params.id);\n      if (!event) {\n        return res.status(404).json({ error: \"Event not found\" });\n      }\n      const eventWithSentiment = updateEventWithSentiment(event);\n      res.json(eventWithSentiment);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch event\" });\n    }\n  });\n\n  app.get(\"/api/economic-events/:id/analysis\", async (req, res) => {\n    try {\n      const event = await cacheService.getEventById(req.params.id);\n      if (!event) {\n        return res.status(404).json({ error: \"Event not found\" });\n      }\n      const analysis = analyzeEventSentiment(event);\n      res.json({\n        event: updateEventWithSentiment(event),\n        analysis\n      });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch event analysis\" });\n    }\n  });\n\n  app.post(\"/api/economic-events\", async (req, res) => {\n    try {\n      const validatedData = insertEconomicEventSchema.parse(req.body);\n      const event = await storage.createEconomicEvent(validatedData);\n      res.status(201).json(event);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid event data\" });\n    }\n  });\n\n  app.put(\"/api/economic-events/:id\", async (req, res) => {\n    try {\n      const event = await storage.updateEconomicEvent(req.params.id, req.body);\n      if (!event) {\n        return res.status(404).json({ error: \"Event not found\" });\n      }\n      res.json(event);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update event\" });\n    }\n  });\n\n  app.delete(\"/api/economic-events/:id\", async (req, res) => {\n    try {\n      const success = await storage.deleteEconomicEvent(req.params.id);\n      if (!success) {\n        return res.status(404).json({ error: \"Event not found\" });\n      }\n      res.status(204).send();\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete event\" });\n    }\n  });\n\n  app.post(\"/api/notifications/signal\", async (req, res) => {\n    try {\n      const signal = req.body;\n      \n      if (!signal.symbol || !signal.type || !signal.entry) {\n        return res.status(400).json({ error: \"Invalid signal data\" });\n      }\n\n      const typeEmoji = signal.type === 'buy' ? '🟢' : '🔴';\n      const title = `${typeEmoji} ${signal.symbol} - ${signal.type.toUpperCase()}`;\n      const message = `Strategy: ${signal.strategy} | Entry: ${signal.entry} | SL: ${signal.stopLoss} | TP: ${signal.takeProfit} | R/R: 1:${signal.riskReward}`;\n      \n      await notificationService.createNotification({\n        type: 'trading_signal',\n        title,\n        message,\n        metadata: JSON.stringify(signal),\n      });\n\n      res.json({ success: true, message: \"Signal notification created\" });\n    } catch (error) {\n      console.error(\"Error creating signal notification:\", error);\n      res.status(500).json({ error: \"Failed to create signal notification\" });\n    }\n  });\n\n  app.get(\"/api/notifications/status\", async (req, res) => {\n    try {\n      const isReady = telegramNotificationService.isReady();\n      res.json({ \n        telegramBotActive: isReady,\n        message: isReady \n          ? \"Telegram notifications are active\" \n          : \"Telegram bot is not configured\"\n      });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get notification status\" });\n    }\n  });\n\n  app.get(\"/api/notifications\", async (req, res) => {\n    try {\n      const limit = req.query.limit ? parseInt(req.query.limit as string) : 50;\n      const notifications = await notificationService.getNotifications(limit);\n      res.json(notifications);\n    } catch (error) {\n      console.error(\"Error fetching notifications:\", error);\n      res.status(500).json({ error: \"Failed to fetch notifications\" });\n    }\n  });\n\n  app.get(\"/api/notifications/unread\", async (req, res) => {\n    try {\n      const notifications = await notificationService.getUnreadNotifications();\n      res.json(notifications);\n    } catch (error) {\n      console.error(\"Error fetching unread notifications:\", error);\n      res.status(500).json({ error: \"Failed to fetch unread notifications\" });\n    }\n  });\n\n  app.patch(\"/api/notifications/:id/read\", async (req, res) => {\n    try {\n      await notificationService.markAsRead(req.params.id);\n      res.json({ success: true, message: \"Notification marked as read\" });\n    } catch (error) {\n      console.error(\"Error marking notification as read:\", error);\n      res.status(500).json({ error: \"Failed to mark notification as read\" });\n    }\n  });\n\n  app.patch(\"/api/notifications/read-all\", async (req, res) => {\n    try {\n      await notificationService.markAllAsRead();\n      res.json({ success: true, message: \"All notifications marked as read\" });\n    } catch (error) {\n      console.error(\"Error marking all notifications as read:\", error);\n      res.status(500).json({ error: \"Failed to mark all notifications as read\" });\n    }\n  });\n\n  app.delete(\"/api/notifications/:id\", async (req, res) => {\n    try {\n      await notificationService.deleteNotification(req.params.id);\n      res.json({ success: true, message: \"Notification deleted\" });\n    } catch (error) {\n      console.error(\"Error deleting notification:\", error);\n      res.status(500).json({ error: \"Failed to delete notification\" });\n    }\n  });\n\n  app.delete(\"/api/notifications/clear-all\", async (req, res) => {\n    try {\n      await notificationService.clearAllNotifications();\n      res.json({ success: true, message: \"All notifications cleared\" });\n    } catch (error) {\n      console.error(\"Error clearing all notifications:\", error);\n      res.status(500).json({ error: \"Failed to clear all notifications\" });\n    }\n  });\n\n  app.get(\"/api/trading-signals\", async (req, res) => {\n    try {\n      const filters = {\n        status: req.query.status as string | undefined,\n        assetClass: req.query.assetClass as string | undefined,\n        symbol: req.query.symbol as string | undefined,\n      };\n      const signals = await storage.getTradingSignals(filters);\n      res.json(signals);\n    } catch (error) {\n      console.error(\"Error fetching trading signals:\", error);\n      res.status(500).json({ error: \"Failed to fetch trading signals\" });\n    }\n  });\n\n  app.get(\"/api/trading-signals/:id\", async (req, res) => {\n    try {\n      const signal = await storage.getTradingSignalById(req.params.id);\n      if (!signal) {\n        return res.status(404).json({ error: \"Signal not found\" });\n      }\n      res.json(signal);\n    } catch (error) {\n      console.error(\"Error fetching signal:\", error);\n      res.status(500).json({ error: \"Failed to fetch signal\" });\n    }\n  });\n\n  app.post(\"/api/trading-signals/generate\", async (req, res) => {\n    try {\n      const { symbol, assetClass, trend } = req.body;\n      \n      if (!symbol || !assetClass) {\n        return res.status(400).json({ error: \"Symbol and assetClass are required\" });\n      }\n\n      let interestRateData = undefined;\n      let inflationData = undefined;\n\n      if (assetClass === 'forex') {\n        const pair = parseCurrencyPair(symbol);\n        if (pair) {\n          const baseIR = getInterestRateData(pair.base);\n          const quoteIR = getInterestRateData(pair.quote);\n          const baseInf = getInflationData(pair.base);\n          const quoteInf = getInflationData(pair.quote);\n\n          if (baseIR && quoteIR) {\n            interestRateData = { base: baseIR, quote: quoteIR };\n          }\n          if (baseInf && quoteInf) {\n            inflationData = { base: baseInf, quote: quoteInf };\n          }\n        }\n      }\n\n      const currentPrice = req.body.currentPrice || 1.0850;\n      const trendBias = trend || 'bullish';\n\n      const dailyData = generateMockTimeframeData(currentPrice, trendBias, 30);\n      const h4Data = generateMockTimeframeData(currentPrice, trendBias, 25);\n      const h1Data = generateMockTimeframeData(currentPrice, trendBias, 20);\n      const m15Data = generateMockTimeframeData(currentPrice, trendBias, 15);\n\n      const signal = signalDetectionService.generateTradingSignal({\n        symbol,\n        assetClass,\n        interestRateData,\n        inflationData,\n        dailyData,\n        h4Data,\n        h1Data,\n        m15Data,\n      });\n\n      if (!signal) {\n        return res.status(400).json({ error: \"Could not generate signal - confidence too low\" });\n      }\n\n      const createdSignal = await storage.createTradingSignal(signal);\n\n      await notificationService.createNotification({\n        type: 'trading_signal',\n        title: `${signal.type === 'buy' ? '🟢' : '🔴'} ${symbol} - ${signal.type.toUpperCase()}`,\n        message: `Confidence: ${signal.overallConfidence}% | Entry: ${signal.entryPrice} | R:R: 1:${signal.riskRewardRatio}`,\n        metadata: JSON.stringify(createdSignal),\n      });\n\n      res.json(createdSignal);\n    } catch (error) {\n      console.error(\"Error generating signal:\", error);\n      res.status(500).json({ error: \"Failed to generate signal\" });\n    }\n  });\n\n  app.post(\"/api/trading-signals\", async (req, res) => {\n    try {\n      const validatedData = insertTradingSignalSchema.parse(req.body);\n      const signal = await storage.createTradingSignal(validatedData);\n      res.status(201).json(signal);\n    } catch (error) {\n      console.error(\"Error creating signal:\", error);\n      res.status(400).json({ error: \"Invalid signal data\" });\n    }\n  });\n\n  app.patch(\"/api/trading-signals/:id\", async (req, res) => {\n    try {\n      const signal = await storage.updateTradingSignal(req.params.id, req.body);\n      if (!signal) {\n        return res.status(404).json({ error: \"Signal not found\" });\n      }\n      res.json(signal);\n    } catch (error) {\n      console.error(\"Error updating signal:\", error);\n      res.status(500).json({ error: \"Failed to update signal\" });\n    }\n  });\n\n  app.delete(\"/api/trading-signals/:id\", async (req, res) => {\n    try {\n      const success = await storage.deleteTradingSignal(req.params.id);\n      if (!success) {\n        return res.status(404).json({ error: \"Signal not found\" });\n      }\n      res.status(204).send();\n    } catch (error) {\n      console.error(\"Error deleting signal:\", error);\n      res.status(500).json({ error: \"Failed to delete signal\" });\n    }\n  });\n\n  // ============================================\n  // WATCHLIST & SIGNAL MONITORING ROUTES\n  // ============================================\n\n  app.get(\"/api/signals/watchlist\", async (req, res) => {\n    try {\n      const watchlistSignals = await signalMonitor.getWatchlistSignals();\n      res.json(watchlistSignals);\n    } catch (error) {\n      console.error(\"Error fetching watchlist:\", error);\n      res.status(500).json({ error: \"Failed to fetch watchlist\" });\n    }\n  });\n\n  app.get(\"/api/signals/active\", async (req, res) => {\n    try {\n      const activeSignals = await signalMonitor.getActiveSignals();\n      res.json(activeSignals);\n    } catch (error) {\n      console.error(\"Error fetching active signals:\", error);\n      res.status(500).json({ error: \"Failed to fetch active signals\" });\n    }\n  });\n\n  app.post(\"/api/signals/:id/promote\", async (req, res) => {\n    try {\n      const signal = await signalMonitor.promoteToActive(req.params.id);\n      if (!signal) {\n        return res.status(404).json({ error: \"Signal not found\" });\n      }\n      res.json(signal);\n    } catch (error) {\n      console.error(\"Error promoting signal:\", error);\n      res.status(500).json({ error: \"Failed to promote signal\" });\n    }\n  });\n\n  app.post(\"/api/signals/:id/watchlist\", async (req, res) => {\n    try {\n      const signal = await signalMonitor.moveToWatchlist(req.params.id);\n      if (!signal) {\n        return res.status(404).json({ error: \"Signal not found\" });\n      }\n      res.json(signal);\n    } catch (error) {\n      console.error(\"Error moving signal to watchlist:\", error);\n      res.status(500).json({ error: \"Failed to move signal to watchlist\" });\n    }\n  });\n\n  app.post(\"/api/signals/check-outcomes\", async (req, res) => {\n    try {\n      const outcomes = await signalMonitor.checkAllSignals();\n      res.json({ \n        checked: outcomes.length,\n        outcomes: outcomes.filter(o => o.outcome !== 'active'),\n        message: \"Signal outcomes checked\"\n      });\n    } catch (error) {\n      console.error(\"Error checking signal outcomes:\", error);\n      res.status(500).json({ error: \"Failed to check signal outcomes\" });\n    }\n  });\n\n  app.get(\"/api/signals/monitor/status\", async (req, res) => {\n    try {\n      res.json({ \n        status: \"running\",\n        message: \"Signal monitor is active\"\n      });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to get monitor status\" });\n    }\n  });\n\n  app.get(\"/api/pending-setups\", async (req, res) => {\n    try {\n      const filters = {\n        symbol: req.query.symbol as string | undefined,\n        readyForSignal: req.query.readyForSignal === 'true' ? true : undefined,\n        invalidated: req.query.invalidated === 'true' ? true : false,\n      };\n      const setups = await storage.getPendingSetups(filters);\n      res.json(setups);\n    } catch (error) {\n      console.error(\"Error fetching pending setups:\", error);\n      res.status(500).json({ error: \"Failed to fetch pending setups\" });\n    }\n  });\n\n  app.get(\"/api/pending-setups/:id\", async (req, res) => {\n    try {\n      const setup = await storage.getPendingSetupById(req.params.id);\n      if (!setup) {\n        return res.status(404).json({ error: \"Pending setup not found\" });\n      }\n      res.json(setup);\n    } catch (error) {\n      console.error(\"Error fetching pending setup:\", error);\n      res.status(500).json({ error: \"Failed to fetch pending setup\" });\n    }\n  });\n\n  // Real-time price data endpoints using Python/tessa\n  app.get(\"/api/prices/status\", async (req, res) => {\n    try {\n      const isOnline = await pingPriceService();\n      res.json({ \n        status: isOnline ? \"online\" : \"offline\",\n        message: isOnline ? \"Price service is running\" : \"Price service is not available\"\n      });\n    } catch (error) {\n      res.json({ status: \"offline\", message: \"Price service error\" });\n    }\n  });\n\n  app.get(\"/api/prices/:symbol\", async (req, res) => {\n    try {\n      const symbol = req.params.symbol;\n      const assetClass = (req.query.assetClass as string) || \"stock\";\n      \n      const validAssetClasses = [\"stock\", \"forex\", \"commodity\", \"crypto\"];\n      if (!validAssetClasses.includes(assetClass)) {\n        return res.status(400).json({ error: \"Invalid asset class\" });\n      }\n      \n      const priceData = await getCachedPrice(\n        symbol, \n        assetClass as \"stock\" | \"forex\" | \"commodity\" | \"crypto\"\n      );\n      \n      if (priceData.error) {\n        return res.status(404).json({ error: priceData.error });\n      }\n      \n      res.json(priceData);\n    } catch (error) {\n      console.error(\"Error fetching price:\", error);\n      res.status(500).json({ error: \"Failed to fetch price\" });\n    }\n  });\n\n  app.post(\"/api/prices/batch\", async (req, res) => {\n    try {\n      const { symbols } = req.body;\n      \n      if (!Array.isArray(symbols) || symbols.length === 0) {\n        return res.status(400).json({ error: \"Symbols array is required\" });\n      }\n      \n      if (symbols.length > 50) {\n        return res.status(400).json({ error: \"Maximum 50 symbols per request\" });\n      }\n      \n      const priceData = await getCachedMultiplePrices(symbols);\n      res.json(priceData);\n    } catch (error) {\n      console.error(\"Error fetching batch prices:\", error);\n      res.status(500).json({ error: \"Failed to fetch prices\" });\n    }\n  });\n\n  // ============================================\n  // GEMINI AI ANALYSIS ROUTES\n  // ============================================\n\n  // Test Gemini connection\n  app.get(\"/api/gemini/status\", async (req, res) => {\n    try {\n      const isConfigured = isGeminiConfigured();\n      if (!isConfigured) {\n        return res.json({ \n          configured: false, \n          connected: false, \n          message: \"GOOGLE_API_KEY not configured\" \n        });\n      }\n\n      const connectionTest = await testGeminiConnection();\n      res.json({\n        configured: true,\n        connected: connectionTest.success,\n        message: connectionTest.message,\n      });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to check Gemini status\" });\n    }\n  });\n\n  // Validate a signal from our SMC strategy using Gemini as assistant\n  app.post(\"/api/gemini/validate\", async (req, res) => {\n    try {\n      const { signal, priceData, chartImagePath } = req.body;\n\n      if (!signal || !priceData || !Array.isArray(priceData)) {\n        return res.status(400).json({ error: \"Signal and priceData array are required\" });\n      }\n\n      if (!isGeminiConfigured()) {\n        return res.status(503).json({ error: \"Gemini API not configured\" });\n      }\n\n      const result = await validateSignalWithGemini(signal, priceData, chartImagePath);\n      res.json(result);\n    } catch (error) {\n      console.error(\"Gemini validation error:\", error);\n      res.status(500).json({ error: \"Failed to validate signal with Gemini\" });\n    }\n  });\n\n  // Quick market scan to pre-screen instruments\n  app.post(\"/api/gemini/scan\", async (req, res) => {\n    try {\n      const { symbol, priceData } = req.body;\n\n      if (!symbol || !priceData || !Array.isArray(priceData)) {\n        return res.status(400).json({ error: \"Symbol and priceData array are required\" });\n      }\n\n      if (!isGeminiConfigured()) {\n        return res.status(503).json({ error: \"Gemini API not configured\" });\n      }\n\n      const result = await quickMarketScan(symbol, priceData);\n      res.json(result);\n    } catch (error) {\n      console.error(\"Market scan error:\", error);\n      res.status(500).json({ error: \"Failed to scan market\" });\n    }\n  });\n\n  // Legacy analyze endpoint (backward compatibility)\n  app.post(\"/api/gemini/analyze\", async (req, res) => {\n    try {\n      const { symbol, priceData, chartImagePath } = req.body;\n\n      if (!symbol || !priceData || !Array.isArray(priceData)) {\n        return res.status(400).json({ error: \"Symbol and priceData array are required\" });\n      }\n\n      if (!isGeminiConfigured()) {\n        return res.status(503).json({ error: \"Gemini API not configured\" });\n      }\n\n      const result = await analyzeWithGemini(symbol, priceData, chartImagePath);\n      res.json(result);\n    } catch (error) {\n      console.error(\"Gemini analysis error:\", error);\n      res.status(500).json({ error: \"Failed to analyze with Gemini\" });\n    }\n  });\n\n  // Legacy quick-scan endpoint (backward compatibility)\n  app.post(\"/api/gemini/quick-scan\", async (req, res) => {\n    try {\n      const { symbol, priceData } = req.body;\n\n      if (!symbol || !priceData || !Array.isArray(priceData)) {\n        return res.status(400).json({ error: \"Symbol and priceData array are required\" });\n      }\n\n      if (!isGeminiConfigured()) {\n        return res.status(503).json({ error: \"Gemini API not configured\" });\n      }\n\n      const result = await quickAnalyzeWithGemini(symbol, priceData);\n      \n      if (!result) {\n        return res.status(500).json({ error: \"Quick scan failed\" });\n      }\n\n      res.json(result);\n    } catch (error) {\n      console.error(\"Quick scan error:\", error);\n      res.status(500).json({ error: \"Failed to perform quick scan\" });\n    }\n  });\n\n  // ============================================\n  // CHART GENERATION ROUTES\n  // ============================================\n\n  // Check chart generator status\n  app.get(\"/api/charts/status\", async (req, res) => {\n    try {\n      const available = await isChartGeneratorAvailable();\n      res.json({ available });\n    } catch (error) {\n      res.json({ available: false, error: \"Failed to check chart generator status\" });\n    }\n  });\n\n  // Generate signal chart\n  app.post(\"/api/charts/generate\", async (req, res) => {\n    try {\n      const { symbol, timeframe, candles, signal, supplyZones, demandZones } = req.body;\n\n      if (!symbol || !timeframe || !candles || !Array.isArray(candles)) {\n        return res.status(400).json({ error: \"Symbol, timeframe, and candles array are required\" });\n      }\n\n      if (!signal || !signal.direction || !signal.entryPrice) {\n        return res.status(400).json({ error: \"Signal with direction and entryPrice is required\" });\n      }\n\n      const result = await generateTradingSignalChart(\n        symbol,\n        timeframe,\n        candles,\n        signal,\n        supplyZones || [],\n        demandZones || []\n      );\n\n      if (!result.success) {\n        return res.status(500).json({ error: result.error || \"Chart generation failed\" });\n      }\n\n      res.json({ success: true, path: result.path });\n    } catch (error) {\n      console.error(\"Chart generation error:\", error);\n      res.status(500).json({ error: \"Failed to generate chart\" });\n    }\n  });\n\n  // Cleanup old charts\n  app.post(\"/api/charts/cleanup\", async (req, res) => {\n    try {\n      const maxAgeMs = req.body.maxAgeMs || 3600000; // Default 1 hour\n      cleanupOldCharts(maxAgeMs);\n      res.json({ success: true, message: \"Old charts cleaned up\" });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to cleanup charts\" });\n    }\n  });\n\n  // Start the signal monitor (checks SL/TP hits every 30 seconds)\n  signalMonitor.start(30000);\n  console.log('[Server] Signal monitor started - checking SL/TP every 30 seconds');\n\n  const httpServer = createServer(app);\n\n  return httpServer;\n}\n","size_bytes":28919},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nconst availableEnvVars = Object.keys(process.env).filter(key => \n  key.includes('DATABASE') || key.includes('PG') || key.includes('DB') || key.includes('POSTGRES')\n);\n\nif (!process.env.DATABASE_URL) {\n  console.error('=== Database Configuration Error ===');\n  console.error('DATABASE_URL environment variable is not set.');\n  console.error('');\n  console.error('Available database-related environment variables:', availableEnvVars.length > 0 ? availableEnvVars.join(', ') : 'NONE');\n  console.error('');\n  console.error('For Coolify deployment, ensure:');\n  console.error('1. DATABASE_URL is set in Environment Variables (not Build Args)');\n  console.error('2. The value format is: postgresql://user:password@host:port/database');\n  console.error('3. No quotes around the value');\n  console.error('4. Redeploy after setting the variable');\n  console.error('=====================================');\n  \n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nconsole.log('[Database] Connecting to PostgreSQL...');\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });\nconsole.log('[Database] Database pool initialized');\n","size_bytes":1459},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n\n  /* Automatic computation of border around primary / danger buttons */\n  --opaque-button-border-intensity: -8; /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n\n  --background: 210 15% 98%;\n\n  --foreground: 210 15% 15%;\n\n  --border: 210 10% 88%;\n\n  --card: 210 10% 95%;\n\n  --card-foreground: 210 15% 15%;\n\n  --card-border: 210 12% 90%;\n\n  --sidebar: 210 8% 92%;\n\n  --sidebar-foreground: 210 15% 15%;\n\n  --sidebar-border: 210 10% 87%;\n\n  --sidebar-primary: 210 100% 50%;\n\n  --sidebar-primary-foreground: 210 15% 98%;\n\n  --sidebar-accent: 210 12% 88%;\n\n  --sidebar-accent-foreground: 210 15% 15%;\n\n  --sidebar-ring: 210 100% 60%;\n\n  --popover: 210 8% 90%;\n\n  --popover-foreground: 210 15% 15%;\n\n  --popover-border: 210 10% 85%;\n\n  --primary: 210 100% 50%;\n\n  --primary-foreground: 210 15% 98%;\n\n  --secondary: 210 8% 87%;\n\n  --secondary-foreground: 210 15% 15%;\n\n  --muted: 210 6% 85%;\n\n  --muted-foreground: 210 10% 45%;\n\n  --accent: 210 12% 88%;\n\n  --accent-foreground: 210 15% 15%;\n\n  --destructive: 0 75% 55%;\n\n  --destructive-foreground: 0 15% 98%;\n\n  --input: 210 15% 75%;\n  --ring: 210 100% 60%;\n  --chart-1: 210 100% 45%;\n  --chart-2: 120 60% 40%;\n  --chart-3: 0 75% 50%;\n  --chart-4: 45 90% 50%;\n  --chart-5: 280 85% 55%;\n\n  --font-sans: Poppins, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: JetBrains Mono, Menlo, monospace;\n  --radius: .5rem; /* 8px */\n  --shadow-2xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 2px 4px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 4px 6px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 8px 10px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n  /* Automatically computed borders - intensity can be controlled by the user by the --opaque-button-border-intensity setting */\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n\n  --opaque-button-border-intensity: 9;  /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n\n  --background: 0 0% 69%;\n\n  --foreground: 210 15% 15%;\n\n  --border: 0 0% 55%;\n\n  --card: 0 0% 75%;\n\n  --card-foreground: 210 15% 15%;\n\n  --card-border: 0 0% 60%;\n\n  --sidebar: 0 0% 65%;\n\n  --sidebar-foreground: 210 15% 15%;\n\n  --sidebar-border: 0 0% 55%;\n\n  --sidebar-primary: 210 100% 50%;\n\n  --sidebar-primary-foreground: 210 15% 98%;\n\n  --sidebar-accent: 0 0% 60%;\n\n  --sidebar-accent-foreground: 210 15% 15%;\n\n  --sidebar-ring: 210 100% 50%;\n\n  --popover: 0 0% 65%;\n\n  --popover-foreground: 210 15% 15%;\n\n  --popover-border: 0 0% 55%;\n\n  --primary: 210 100% 50%;\n\n  --primary-foreground: 210 15% 98%;\n\n  --secondary: 0 0% 60%;\n\n  --secondary-foreground: 210 15% 15%;\n\n  --muted: 0 0% 60%;\n\n  --muted-foreground: 210 10% 30%;\n\n  --accent: 0 0% 62%;\n\n  --accent-foreground: 210 15% 15%;\n\n  --destructive: 0 75% 55%;\n\n  --destructive-foreground: 0 15% 98%;\n\n  --input: 210 15% 25%;\n  --ring: 210 100% 60%;\n  --chart-1: 210 100% 65%;\n  --chart-2: 120 60% 60%;\n  --chart-3: 0 75% 65%;\n  --chart-4: 45 90% 65%;\n  --chart-5: 280 85% 70%;\n\n  --shadow-2xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 2px 4px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 4px 6px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 8px 10px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n\n  /* Hide scrollbar utility for cleaner horizontal scrolling */\n  .scrollbar-hide {\n    -ms-overflow-style: none;\n    scrollbar-width: none;\n  }\n\n  .scrollbar-hide::-webkit-scrollbar {\n    display: none;\n  }\n\n  /* Nav Link Underline Hover Effect */\n  .nav-link {\n    transition: all 0.2s ease-in-out;\n    position: relative;\n    white-space: nowrap;\n  }\n\n  .nav-link::after {\n    content: '';\n    position: absolute;\n    bottom: -4px;\n    left: 0;\n    width: 0;\n    height: 2px;\n    background-color: #e75518;\n    transition: width 0.3s ease-in-out;\n  }\n\n  .nav-link:hover::after,\n  .active-nav-link::after {\n    width: 100%;\n  }\n\n  /* Hide scrollbar for the secondary nav bar */\n  .no-scrollbar::-webkit-scrollbar {\n    display: none;\n  }\n\n  .no-scrollbar {\n    -ms-overflow-style: none;\n    scrollbar-width: none;\n  }\n\n  /* Marquee Animation */\n  .marquee-container {\n    overflow: hidden;\n    position: relative;\n    white-space: nowrap;\n    flex-grow: 1;\n    min-width: 0;\n  }\n\n  .marquee-track {\n    display: inline-flex;\n    min-width: max-content;\n    animation: marquee 50s linear infinite;\n  }\n\n  .marquee-track:hover {\n    animation-play-state: paused;\n  }\n\n  @keyframes marquee {\n    from {\n      transform: translateX(0);\n    }\n    to {\n      transform: translateX(-50%);\n    }\n  }\n\n  /* Pulse Dot Animation */\n  .signal-pulse-container {\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    border-radius: 9999px;\n    background-color: var(--pulse-color, #10b981);\n    animation: pulse-ring 1.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) infinite;\n  }\n\n  @keyframes pulse-ring {\n    0% {\n      transform: scale(0.6);\n      opacity: 1;\n    }\n    100% {\n      transform: scale(2);\n      opacity: 0;\n    }\n  }\n\n  /* Telegram Link Styling */\n  .telegram-link {\n    transition: all 0.2s ease-in-out;\n    border-bottom: 2px solid transparent;\n    display: flex;\n    align-items: center;\n  }\n\n  .telegram-link:hover {\n    color: #1d90e6;\n    border-color: #1d90e6;\n  }\n\n  /* Footer link hover effect */\n  .footer-link:hover {\n    color: #10b981;\n  }\n\n  /* TikTok icon hover fix */\n  .tiktok-hover-fix:hover {\n    opacity: 0.85;\n  }\n\n  /* Dotted outline effect for header buttons */\n  .dotted-outline {\n    outline: 1.5px dashed #3b82f6;\n    outline-offset: 3px;\n  }\n\n  /* Hero dotted outline effect */\n  .hero-dotted-outline {\n    outline: 2px dashed white;\n    outline-offset: 4px;\n  }\n\n  /* Active sub-nav item */\n  .sub-nav-active {\n    color: #3b82f6;\n    border-bottom: 3px solid #3b82f6;\n  }\n\n  /* Scroll animations for hero signals and news */\n  @keyframes scroll-up {\n    0% {\n      transform: translateY(0);\n    }\n    100% {\n      transform: translateY(-50%);\n    }\n  }\n\n  .animate-scroll-up {\n    animation: scroll-up 20s linear infinite;\n  }\n\n  .animate-scroll-up:hover {\n    animation-play-state: paused;\n  }\n\n  .animate-scroll-up-slow {\n    animation: scroll-up 30s linear infinite;\n  }\n\n  .animate-scroll-up-slow:hover {\n    animation-play-state: paused;\n  }\n}","size_bytes":13228},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","size_bytes":1904},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic, log } from \"./static\";\nimport { scraperScheduler } from \"./scrapers/scheduler\";\n\nconst app = express();\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n    \n    scraperScheduler.start();\n  });\n\n  process.on('SIGTERM', () => {\n    log('SIGTERM signal received: closing HTTP server');\n    scraperScheduler.stop();\n    server.close(() => {\n      log('HTTP server closed');\n    });\n  });\n\n  process.on('SIGINT', () => {\n    log('SIGINT signal received: closing HTTP server');\n    scraperScheduler.stop();\n    server.close(() => {\n      log('HTTP server closed');\n    });\n  });\n})();\n","size_bytes":2579},"client/src/components/EventDetailsDialog.tsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport { Badge } from '@/components/ui/badge';\nimport { Separator } from '@/components/ui/separator';\nimport { TrendingUp, TrendingDown, Minus, Calendar, AlertTriangle } from 'lucide-react';\nimport { format } from 'date-fns';\n\ninterface CurrencyPairImpact {\n  pair: string;\n  sentiment: 'bullish' | 'bearish' | 'neutral';\n  reasoning: string;\n}\n\ninterface StockImpact {\n  sector: string;\n  sentiment: 'bullish' | 'bearish' | 'neutral';\n  reasoning: string;\n}\n\ninterface EventAnalysis {\n  expertSentiment: 'bullish' | 'bearish' | 'neutral';\n  preReleaseSentiment: 'bullish' | 'bearish' | 'neutral';\n  postReleaseSentiment: 'bullish' | 'bearish' | 'neutral' | null;\n  currencyPairImpacts: CurrencyPairImpact[];\n  stockImpacts: StockImpact[];\n  marketImpactAnalysis: string;\n  surpriseFactor: string | null;\n}\n\ninterface EventDetailsDialogProps {\n  eventId: string | null;\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\nconst getSentimentIcon = (sentiment: 'bullish' | 'bearish' | 'neutral') => {\n  if (sentiment === 'bullish') return <TrendingUp className=\"w-4 h-4 text-green-500\" />;\n  if (sentiment === 'bearish') return <TrendingDown className=\"w-4 h-4 text-red-500\" />;\n  return <Minus className=\"w-4 h-4 text-muted-foreground\" />;\n};\n\nconst getSentimentColor = (sentiment: 'bullish' | 'bearish' | 'neutral') => {\n  if (sentiment === 'bullish') return 'text-green-500';\n  if (sentiment === 'bearish') return 'text-red-500';\n  return 'text-muted-foreground';\n};\n\ninterface EventAnalysisResponse {\n  event: any;\n  analysis: EventAnalysis;\n}\n\nexport default function EventDetailsDialog({ eventId, open, onOpenChange }: EventDetailsDialogProps) {\n  const { data, isLoading } = useQuery<EventAnalysisResponse>({\n    queryKey: ['/api/economic-events', eventId, 'analysis'],\n    enabled: !!eventId && open,\n  });\n\n  if (!eventId) return null;\n\n  const event = data?.event;\n  const analysis = data?.analysis;\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-3xl max-h-[85vh] overflow-y-auto\" data-testid=\"dialog-event-details\">\n        {isLoading ? (\n          <div className=\"p-8 text-center text-muted-foreground\">Loading event details...</div>\n        ) : event && analysis ? (\n          <>\n            <DialogHeader>\n              <div className=\"flex items-start justify-between gap-4\">\n                <div className=\"flex-1\">\n                  <DialogTitle className=\"text-xl font-bold mb-2\" data-testid=\"text-event-title\">\n                    {event.title}\n                  </DialogTitle>\n                  <div className=\"flex items-center gap-2 flex-wrap\">\n                    <Badge variant=\"secondary\" data-testid=\"badge-currency\">\n                      {event.currency || event.countryCode}\n                    </Badge>\n                    <Badge \n                      variant={event.impactLevel?.toLowerCase() === 'high' ? 'default' : 'outline'}\n                      data-testid=\"badge-impact\"\n                    >\n                      {event.impactLevel?.toUpperCase()}\n                    </Badge>\n                    {event.isReleased && (\n                      <Badge variant=\"outline\" className=\"bg-blue-500/10 text-blue-500\" data-testid=\"badge-released\">\n                        Released\n                      </Badge>\n                    )}\n                    <div className=\"flex items-center gap-1 text-sm text-muted-foreground\">\n                      <Calendar className=\"w-3 h-3\" />\n                      <span data-testid=\"text-event-time\">\n                        {format(new Date(event.eventTime), 'MMM dd, yyyy HH:mm')}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n                {event.impactLevel?.toLowerCase() === 'high' && (\n                  <AlertTriangle className=\"w-6 h-6 text-destructive\" />\n                )}\n              </div>\n            </DialogHeader>\n\n            <Separator className=\"my-4\" />\n\n            <div className=\"space-y-6\">\n              <div>\n                <h3 className=\"font-semibold mb-3 flex items-center gap-2\">\n                  Market Sentiment\n                  {getSentimentIcon(event.isReleased && analysis.postReleaseSentiment \n                    ? analysis.postReleaseSentiment \n                    : analysis.preReleaseSentiment)}\n                </h3>\n                <div className=\"grid grid-cols-3 gap-4\">\n                  <div className=\"space-y-1\">\n                    <div className=\"text-sm text-muted-foreground\">Expert Sentiment</div>\n                    <div className={`font-medium capitalize ${getSentimentColor(analysis.expertSentiment)}`} data-testid=\"text-expert-sentiment\">\n                      {analysis.expertSentiment}\n                    </div>\n                  </div>\n                  <div className=\"space-y-1\">\n                    <div className=\"text-sm text-muted-foreground\">Pre-Release</div>\n                    <div className={`font-medium capitalize ${getSentimentColor(analysis.preReleaseSentiment)}`} data-testid=\"text-pre-release-sentiment\">\n                      {analysis.preReleaseSentiment}\n                    </div>\n                  </div>\n                  {event.isReleased && analysis.postReleaseSentiment && (\n                    <div className=\"space-y-1\">\n                      <div className=\"text-sm text-muted-foreground\">Post-Release</div>\n                      <div className={`font-medium capitalize ${getSentimentColor(analysis.postReleaseSentiment)}`} data-testid=\"text-post-release-sentiment\">\n                        {analysis.postReleaseSentiment}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              <Separator />\n\n              <div>\n                <h3 className=\"font-semibold mb-3\">Economic Data</h3>\n                <div className=\"grid grid-cols-3 gap-4\">\n                  {event.previousValue && (\n                    <div className=\"space-y-1\">\n                      <div className=\"text-sm text-muted-foreground\">Previous</div>\n                      <div className=\"font-mono font-medium\" data-testid=\"text-previous-value\">\n                        {event.previousValue}\n                      </div>\n                    </div>\n                  )}\n                  {event.expectedValue && (\n                    <div className=\"space-y-1\">\n                      <div className=\"text-sm text-muted-foreground\">Expected</div>\n                      <div className=\"font-mono font-medium\" data-testid=\"text-expected-value\">\n                        {event.expectedValue}\n                      </div>\n                    </div>\n                  )}\n                  {event.actualValue && (\n                    <div className=\"space-y-1\">\n                      <div className=\"text-sm text-muted-foreground\">Actual</div>\n                      <div className=\"font-mono font-medium\" data-testid=\"text-actual-value\">\n                        {event.actualValue}\n                      </div>\n                    </div>\n                  )}\n                </div>\n                {analysis.surpriseFactor && (\n                  <div className=\"mt-3 p-3 bg-muted rounded-md\">\n                    <div className=\"text-sm font-medium\" data-testid=\"text-surprise-factor\">\n                      Surprise Factor: {analysis.surpriseFactor}\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <Separator />\n\n              <div>\n                <h3 className=\"font-semibold mb-3\">Market Impact Analysis</h3>\n                <p className=\"text-sm leading-relaxed\" data-testid=\"text-market-impact\">\n                  {analysis.marketImpactAnalysis}\n                </p>\n              </div>\n\n              <Separator />\n\n              <div>\n                <h3 className=\"font-semibold mb-3\">Currency Pair Impacts</h3>\n                <div className=\"space-y-2\">\n                  {analysis.currencyPairImpacts.map((impact, index) => (\n                    <div \n                      key={index} \n                      className=\"p-3 rounded-md border border-border hover-elevate\"\n                      data-testid={`card-currency-${impact.pair}`}\n                    >\n                      <div className=\"flex items-center justify-between mb-1\">\n                        <span className=\"font-medium\" data-testid={`text-pair-${impact.pair}`}>{impact.pair}</span>\n                        <div className=\"flex items-center gap-1\">\n                          {getSentimentIcon(impact.sentiment)}\n                          <span className={`text-sm font-medium capitalize ${getSentimentColor(impact.sentiment)}`}>\n                            {impact.sentiment}\n                          </span>\n                        </div>\n                      </div>\n                      <p className=\"text-xs text-muted-foreground\">{impact.reasoning}</p>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              <Separator />\n\n              <div>\n                <h3 className=\"font-semibold mb-3\">Stock/Sector Impacts</h3>\n                <div className=\"space-y-2\">\n                  {analysis.stockImpacts.map((impact, index) => (\n                    <div \n                      key={index} \n                      className=\"p-3 rounded-md border border-border hover-elevate\"\n                      data-testid={`card-stock-${impact.sector}`}\n                    >\n                      <div className=\"flex items-center justify-between mb-1\">\n                        <span className=\"font-medium\" data-testid={`text-sector-${impact.sector}`}>{impact.sector}</span>\n                        <div className=\"flex items-center gap-1\">\n                          {getSentimentIcon(impact.sentiment)}\n                          <span className={`text-sm font-medium capitalize ${getSentimentColor(impact.sentiment)}`}>\n                            {impact.sentiment}\n                          </span>\n                        </div>\n                      </div>\n                      <p className=\"text-xs text-muted-foreground\">{impact.reasoning}</p>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n          </>\n        ) : (\n          <div className=\"p-8 text-center text-muted-foreground\">Event not found</div>\n        )}\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":10609},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1383},"server/services/notificationService.ts":{"content":"import { db } from '../db';\nimport { notifications, InsertNotification } from '@shared/schema';\nimport { eq, desc } from 'drizzle-orm';\n\nexport class NotificationService {\n  async createNotification(data: InsertNotification) {\n    try {\n      const [notification] = await db\n        .insert(notifications)\n        .values(data)\n        .returning();\n      \n      console.log(`Created notification: ${data.type} - ${data.title}`);\n      return notification;\n    } catch (error) {\n      console.error('Error creating notification:', error);\n      throw error;\n    }\n  }\n\n  async getNotifications(limit: number = 50) {\n    try {\n      return await db\n        .select()\n        .from(notifications)\n        .orderBy(desc(notifications.createdAt))\n        .limit(limit);\n    } catch (error) {\n      console.error('Error fetching notifications:', error);\n      throw error;\n    }\n  }\n\n  async getUnreadNotifications() {\n    try {\n      return await db\n        .select()\n        .from(notifications)\n        .where(eq(notifications.isRead, false))\n        .orderBy(desc(notifications.createdAt));\n    } catch (error) {\n      console.error('Error fetching unread notifications:', error);\n      throw error;\n    }\n  }\n\n  async markAsRead(notificationId: string) {\n    try {\n      await db\n        .update(notifications)\n        .set({ isRead: true })\n        .where(eq(notifications.id, notificationId));\n      \n      console.log(`Marked notification ${notificationId} as read`);\n    } catch (error) {\n      console.error('Error marking notification as read:', error);\n      throw error;\n    }\n  }\n\n  async markAllAsRead() {\n    try {\n      await db\n        .update(notifications)\n        .set({ isRead: true })\n        .where(eq(notifications.isRead, false));\n      \n      console.log('Marked all notifications as read');\n    } catch (error) {\n      console.error('Error marking all notifications as read:', error);\n      throw error;\n    }\n  }\n\n  async deleteNotification(notificationId: string) {\n    try {\n      await db\n        .delete(notifications)\n        .where(eq(notifications.id, notificationId));\n      \n      console.log(`Deleted notification ${notificationId}`);\n    } catch (error) {\n      console.error('Error deleting notification:', error);\n      throw error;\n    }\n  }\n\n  async clearAllNotifications() {\n    try {\n      await db.delete(notifications);\n      console.log('Cleared all notifications');\n    } catch (error) {\n      console.error('Error clearing all notifications:', error);\n      throw error;\n    }\n  }\n}\n\nexport const notificationService = new NotificationService();\n","size_bytes":2592},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport Header from \"@/components/Header\";\nimport Footer from \"@/components/Footer\";\nimport Dashboard from \"@/pages/Dashboard\";\nimport TradeHistoryPage from \"@/pages/TradeHistoryPage\";\nimport Analytics from \"@/pages/Analytics\";\nimport EconomicCalendar from \"@/pages/EconomicCalendar\";\nimport Stocks from \"@/pages/Stocks\";\nimport MajorPairs from \"@/pages/MajorPairs\";\nimport Commodities from \"@/pages/Commodities\";\nimport Cryptocurrency from \"@/pages/Cryptocurrency\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Dashboard} />\n      <Route path=\"/dashboard\" component={Dashboard} />\n      <Route path=\"/history\" component={TradeHistoryPage} />\n      <Route path=\"/analytics\" component={Analytics} />\n      <Route path=\"/calendar\" component={EconomicCalendar} />\n      <Route path=\"/stocks\" component={Stocks} />\n      <Route path=\"/major-pairs\" component={MajorPairs} />\n      <Route path=\"/commodities\" component={Commodities} />\n      <Route path=\"/crypto\" component={Cryptocurrency} />\n      <Route path=\"/markets\" component={Stocks} />\n      <Route path=\"/signals\" component={Stocks} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nexport default function App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <div className=\"flex flex-col min-h-screen w-full\">\n          <Header />\n          <main className=\"flex-1 bg-background\">\n            <Router />\n          </main>\n          <Footer />\n        </div>\n        <Toaster />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n","size_bytes":1884},"client/src/components/examples/AppSidebar.tsx":{"content":"import { SidebarProvider } from '@/components/ui/sidebar';\nimport AppSidebar from '../AppSidebar';\n\nexport default function AppSidebarExample() {\n  const style = {\n    \"--sidebar-width\": \"16rem\",\n    \"--sidebar-width-icon\": \"3rem\",\n  };\n\n  return (\n    <SidebarProvider style={style as React.CSSProperties}>\n      <div className=\"flex h-64 w-full\">\n        <AppSidebar />\n        <div className=\"flex-1 p-4 bg-background\">\n          <p className=\"text-muted-foreground\">Main content area</p>\n        </div>\n      </div>\n    </SidebarProvider>\n  );\n}","size_bytes":549},"client/src/components/StockSignals.tsx":{"content":"import { useState } from 'react';\nimport { Badge } from '@/components/ui/badge';\nimport { TrendingUp, TrendingDown, Clock } from 'lucide-react';\nimport { format } from 'date-fns';\n\ninterface StockSignal {\n  id: string;\n  symbol: string;\n  companyName: string;\n  type: 'buy' | 'sell';\n  entry: number;\n  stopLoss: number;\n  takeProfit: number;\n  riskReward: number;\n  timeframe: string;\n  confidence: number;\n  timestamp: Date;\n  status: 'active' | 'pending';\n}\n\nexport default function StockSignals() {\n  const [selectedSignalId, setSelectedSignalId] = useState<string | null>(null);\n\n  const stockSignals: StockSignal[] = [\n    {\n      id: '1',\n      symbol: 'AAPL',\n      companyName: 'Apple Inc.',\n      type: 'buy',\n      entry: 178.50,\n      stopLoss: 175.00,\n      takeProfit: 185.00,\n      riskReward: 1.86,\n      timeframe: '1D',\n      confidence: 82,\n      timestamp: new Date(Date.now() - 10 * 60 * 1000),\n      status: 'active'\n    },\n    {\n      id: '2',\n      symbol: 'TSLA',\n      companyName: 'Tesla Inc.',\n      type: 'sell',\n      entry: 248.50,\n      stopLoss: 252.00,\n      takeProfit: 241.00,\n      riskReward: 2.1,\n      timeframe: '4H',\n      confidence: 78,\n      timestamp: new Date(Date.now() - 25 * 60 * 1000),\n      status: 'pending'\n    },\n    {\n      id: '3',\n      symbol: 'NVDA',\n      companyName: 'NVIDIA Corp.',\n      type: 'buy',\n      entry: 485.00,\n      stopLoss: 478.00,\n      takeProfit: 499.00,\n      riskReward: 2.0,\n      timeframe: '1D',\n      confidence: 88,\n      timestamp: new Date(Date.now() - 35 * 60 * 1000),\n      status: 'active'\n    },\n    {\n      id: '4',\n      symbol: 'MSFT',\n      companyName: 'Microsoft Corp.',\n      type: 'buy',\n      entry: 378.25,\n      stopLoss: 373.00,\n      takeProfit: 388.50,\n      riskReward: 1.95,\n      timeframe: '4H',\n      confidence: 75,\n      timestamp: new Date(Date.now() - 45 * 60 * 1000),\n      status: 'pending'\n    },\n    {\n      id: '5',\n      symbol: 'AMZN',\n      companyName: 'Amazon.com Inc.',\n      type: 'sell',\n      entry: 145.80,\n      stopLoss: 148.50,\n      takeProfit: 140.10,\n      riskReward: 2.1,\n      timeframe: '1D',\n      confidence: 80,\n      timestamp: new Date(Date.now() - 55 * 60 * 1000),\n      status: 'active'\n    }\n  ];\n\n  const formatTimeAgo = (timestamp: Date) => {\n    const now = new Date();\n    const diffMs = now.getTime() - timestamp.getTime();\n    const diffMins = Math.floor(diffMs / (1000 * 60));\n    \n    if (diffMins < 60) return `${diffMins}m ago`;\n    const diffHours = Math.floor(diffMins / 60);\n    if (diffHours < 24) return `${diffHours}h ago`;\n    return `${Math.floor(diffHours / 24)}d ago`;\n  };\n\n  const getSignalTypeColor = (type: string) => {\n    return type === 'buy' ? 'hsl(120 60% 50%)' : 'hsl(0 75% 60%)';\n  };\n\n  const getConfidenceColor = (confidence: number) => {\n    if (confidence >= 80) return 'text-green-500';\n    if (confidence >= 60) return 'text-yellow-500';\n    return 'text-red-500';\n  };\n\n  return (\n    <div data-testid=\"card-stock-signals\" className=\"bg-white dark:bg-background\">\n      <div className=\"pb-4 mb-4 border-b border-border/50\">\n        <div className=\"flex items-center gap-2 text-lg font-semibold\">\n          <TrendingUp className=\"w-5 h-5\" />\n          Stock Signals\n          <Badge variant=\"secondary\" className=\"ml-auto mr-2\">\n            {stockSignals.filter(s => s.status === 'active').length} Active\n          </Badge>\n        </div>\n      </div>\n      <div>\n        <div className=\"divide-y divide-border/50\">\n          {stockSignals.map((signal, index) => (\n            <div\n              key={signal.id}\n              onClick={() => setSelectedSignalId(selectedSignalId === signal.id ? null : signal.id)}\n              className={`py-4 transition-all cursor-pointer ${\n                selectedSignalId === signal.id ? 'bg-primary/5' : 'hover-elevate'\n              }`}\n              data-testid={`card-stock-${signal.id}`}\n            >\n              <div className=\"flex items-start justify-between gap-3 mb-3\">\n                <div className=\"flex items-center gap-3 flex-1 min-w-0\">\n                  <div className=\"relative\">\n                    <div className=\"absolute left-0 top-0 bottom-0 w-0.5\" style={{ backgroundColor: getSignalTypeColor(signal.type) }} />\n                    <Badge \n                      variant=\"secondary\"\n                      className=\"text-xs font-medium shrink-0 ml-3\"\n                      style={{ \n                        backgroundColor: getSignalTypeColor(signal.type) + '20', \n                        color: getSignalTypeColor(signal.type) \n                      }}\n                    >\n                      {signal.type.toUpperCase()}\n                    </Badge>\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center gap-2\">\n                      <h4 className=\"font-semibold text-sm\" data-testid={`text-symbol-${signal.id}`}>\n                        {signal.symbol}\n                      </h4>\n                      {signal.type === 'buy' ? (\n                        <TrendingUp className=\"w-3 h-3 text-green-500 shrink-0\" />\n                      ) : (\n                        <TrendingDown className=\"w-3 h-3 text-red-500 shrink-0\" />\n                      )}\n                    </div>\n                    <p className=\"text-xs text-muted-foreground truncate\">{signal.companyName}</p>\n                  </div>\n                </div>\n                \n                <div className=\"flex items-center gap-2 shrink-0 ml-2 mr-2\">\n                  <Badge \n                    variant=\"outline\"\n                    className={`text-xs ${getConfidenceColor(signal.confidence)}`}\n                  >\n                    {signal.confidence}%\n                  </Badge>\n                  <Badge variant={signal.status === 'active' ? 'default' : 'secondary'} className=\"text-xs\">\n                    {signal.status}\n                  </Badge>\n                </div>\n              </div>\n\n              <div className=\"flex items-stretch gap-0 text-xs mb-3 ml-3\">\n                <div className=\"flex-1 pr-4 border-r border-border/50\">\n                  <span className=\"text-muted-foreground\">Entry:</span>\n                  <div className=\"font-mono font-semibold\" data-testid={`text-entry-${signal.id}`}>\n                    ${signal.entry.toFixed(2)}\n                  </div>\n                </div>\n                <div className=\"flex-1 px-4 border-r border-border/50\">\n                  <span className=\"text-muted-foreground\">Stop:</span>\n                  <div className=\"font-mono font-semibold text-red-500\">\n                    ${signal.stopLoss.toFixed(2)}\n                  </div>\n                </div>\n                <div className=\"flex-1 pl-4\">\n                  <span className=\"text-muted-foreground\">Target:</span>\n                  <div className=\"font-mono font-semibold text-green-500\">\n                    ${signal.takeProfit.toFixed(2)}\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"flex items-center justify-between text-xs ml-3 pt-2 border-t border-border/30\">\n                <div className=\"flex items-center gap-2 text-muted-foreground\">\n                  <span>{signal.timeframe}</span>\n                  <span>•</span>\n                  <span className=\"flex items-center gap-1\">\n                    <Clock className=\"w-3 h-3\" />\n                    {formatTimeAgo(signal.timestamp)}\n                  </span>\n                </div>\n                <div className=\"text-muted-foreground\">\n                  R:R 1:{signal.riskReward}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":7758},"client/src/components/examples/Dashboard.tsx":{"content":"import Dashboard from '../../pages/Dashboard';\n\nexport default function DashboardExample() {\n  return <Dashboard />;\n}","size_bytes":118},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/pages/Analytics.tsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { BarChart3, TrendingUp, TrendingDown, DollarSign, Target } from 'lucide-react';\n\ninterface Analytics {\n  totalTrades: number;\n  winningTrades: number;\n  losingTrades: number;\n  totalPnL: string;\n  averagePnL: string;\n  winRate: string;\n  averageWin: string;\n  averageLoss: string;\n}\n\nexport default function Analytics() {\n  const { data: analytics, isLoading } = useQuery<Analytics>({\n    queryKey: ['/api/analytics'],\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"container mx-auto p-6\">\n        <div className=\"text-center py-8 text-muted-foreground\">\n          Loading analytics...\n        </div>\n      </div>\n    );\n  }\n\n  if (!analytics) {\n    return (\n      <div className=\"container mx-auto p-6\">\n        <div className=\"text-center py-8 text-muted-foreground\">\n          No analytics data available\n        </div>\n      </div>\n    );\n  }\n\n  const stats = [\n    {\n      title: 'Total Trades',\n      value: analytics.totalTrades,\n      icon: BarChart3,\n      color: 'text-blue-500',\n    },\n    {\n      title: 'Total P&L',\n      value: `$${analytics.totalPnL}`,\n      icon: DollarSign,\n      color: parseFloat(analytics.totalPnL) >= 0 ? 'text-green-500' : 'text-red-500',\n    },\n    {\n      title: 'Win Rate',\n      value: `${analytics.winRate}%`,\n      icon: Target,\n      color: 'text-purple-500',\n    },\n    {\n      title: 'Average Win',\n      value: `$${analytics.averageWin}`,\n      icon: TrendingUp,\n      color: 'text-green-500',\n    },\n    {\n      title: 'Average Loss',\n      value: `$${analytics.averageLoss}`,\n      icon: TrendingDown,\n      color: 'text-red-500',\n    },\n  ];\n\n  return (\n    <div className=\"container mx-auto p-6 space-y-6\" data-testid=\"page-analytics\">\n      <div className=\"flex items-center gap-2 mb-6\">\n        <BarChart3 className=\"w-8 h-8\" />\n        <h1 className=\"text-3xl font-bold\">Trading Analytics</h1>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n        {stats.map((stat) => (\n          <Card key={stat.title} data-testid={`card-${stat.title.toLowerCase().replace(' ', '-')}`}>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n                {stat.title}\n              </CardTitle>\n              <stat.icon className={`w-4 h-4 ${stat.color}`} />\n            </CardHeader>\n            <CardContent>\n              <div className={`text-2xl font-bold ${stat.color}`} data-testid={`value-${stat.title.toLowerCase().replace(' ', '-')}`}>\n                {stat.value}\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        <Card data-testid=\"card-performance-breakdown\">\n          <CardHeader>\n            <CardTitle>Performance Breakdown</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-muted-foreground\">Winning Trades</span>\n              <span className=\"font-semibold text-green-500\" data-testid=\"text-winning-trades\">\n                {analytics.winningTrades}\n              </span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-muted-foreground\">Losing Trades</span>\n              <span className=\"font-semibold text-red-500\" data-testid=\"text-losing-trades\">\n                {analytics.losingTrades}\n              </span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-muted-foreground\">Average P&L</span>\n              <span className={`font-semibold ${parseFloat(analytics.averagePnL) >= 0 ? 'text-green-500' : 'text-red-500'}`}>\n                ${analytics.averagePnL}\n              </span>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-risk-reward\">\n          <CardHeader>\n            <CardTitle>Risk/Reward Analysis</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-muted-foreground\">Win Rate</span>\n              <span className=\"font-semibold\" data-testid=\"text-win-rate\">{analytics.winRate}%</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-muted-foreground\">Avg Win</span>\n              <span className=\"font-semibold text-green-500\">${analytics.averageWin}</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-muted-foreground\">Avg Loss</span>\n              <span className=\"font-semibold text-red-500\">${analytics.averageLoss}</span>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":5126},"server/services/signalDetection.ts":{"content":"import { type InsertTradingSignal } from \"@shared/schema\";\nimport { LiquiditySweepDetector, type LiquiditySweepResult, type CHoCHResult } from './liquiditySweepDetection';\nimport { type Candle } from './marketData';\n\nexport interface TimeframeData {\n  timeframe: string;\n  open: number;\n  high: number;\n  low: number;\n  close: number;\n  volume?: number;\n  timestamp: Date;\n}\n\nexport interface InstitutionalCandleData {\n  timeframe: string;\n  candleType: 'bullish' | 'bearish';\n  open: number;\n  close: number;\n  high: number;\n  low: number;\n  mth: number;\n  timestamp: Date;\n  structureBreak: boolean;\n  impulseMagnitude: number;\n}\n\nexport interface InterestRateData {\n  currency: string;\n  rate: number;\n  lastUpdate: Date;\n}\n\nexport interface InflationData {\n  country: string;\n  currency: string;\n  rate: number;\n  lastUpdate: Date;\n}\n\nconst SCORING_WEIGHTS = {\n  interestRateDifferential: 0.40,\n  inflation: 0.25,\n  trend: 0.20,\n  smartMoneyConcepts: 0.15,\n};\n\nconst TIMEFRAME_HIERARCHY = {\n  macroContext: ['1D'],\n  tradingIdea: ['4H', '2H', '1H'],\n  confirmation: ['30M', '15M'],\n  execution: ['5M', '1M'],\n};\n\nexport class SignalDetectionService {\n  private liquiditySweepDetector: LiquiditySweepDetector;\n\n  constructor() {\n    this.liquiditySweepDetector = new LiquiditySweepDetector();\n  }\n  \n  calculateInterestRateDifferential(\n    baseCurrency: string,\n    quoteCurrency: string,\n    baseRate: number,\n    quoteRate: number\n  ): { score: number; differential: number; notes: string } {\n    const differential = baseRate - quoteRate;\n    \n    let score = 0;\n    if (Math.abs(differential) >= 3.0) {\n      score = 100;\n    } else if (Math.abs(differential) >= 2.0) {\n      score = 85;\n    } else if (Math.abs(differential) >= 1.0) {\n      score = 70;\n    } else if (Math.abs(differential) >= 0.5) {\n      score = 50;\n    } else {\n      score = 25;\n    }\n    \n    const direction = differential > 0 ? 'favorable for long' : 'favorable for short';\n    const notes = `${baseCurrency}/${quoteCurrency}: ${differential.toFixed(2)}% differential, ${direction}`;\n    \n    return {\n      score: score * SCORING_WEIGHTS.interestRateDifferential,\n      differential,\n      notes,\n    };\n  }\n\n  calculateInflationImpact(\n    baseCurrency: string,\n    quoteCurrency: string,\n    baseInflation: number,\n    quoteInflation: number\n  ): { score: number; differential: number; notes: string } {\n    const differential = quoteInflation - baseInflation;\n    \n    let score = 0;\n    if (Math.abs(differential) >= 3.0) {\n      score = 95;\n    } else if (Math.abs(differential) >= 2.0) {\n      score = 80;\n    } else if (Math.abs(differential) >= 1.0) {\n      score = 65;\n    } else if (Math.abs(differential) >= 0.5) {\n      score = 45;\n    } else {\n      score = 20;\n    }\n    \n    const impact = differential > 0 \n      ? `Higher inflation in ${quoteCurrency} pressures depreciation` \n      : `Lower inflation in ${quoteCurrency} supports appreciation`;\n    \n    const notes = `Inflation differential: ${differential.toFixed(2)}%. ${impact}`;\n    \n    return {\n      score: score * SCORING_WEIGHTS.inflation,\n      differential,\n      notes,\n    };\n  }\n\n  detectTrend(\n    dailyData: TimeframeData[],\n    h4Data: TimeframeData[],\n    h1Data: TimeframeData[]\n  ): { score: number; direction: string; strength: string; timeframes: string[] } {\n    const trends = {\n      daily: this.analyzeSingleTimeframeTrend(dailyData),\n      h4: this.analyzeSingleTimeframeTrend(h4Data),\n      h1: this.analyzeSingleTimeframeTrend(h1Data),\n    };\n    \n    const alignedTimeframes: string[] = [];\n    let dominantDirection = trends.daily.direction;\n    \n    if (trends.daily.direction === trends.h4.direction) alignedTimeframes.push('1D', '4H');\n    if (trends.h4.direction === trends.h1.direction) alignedTimeframes.push('4H', '1H');\n    if (trends.daily.direction === trends.h1.direction) alignedTimeframes.push('1D', '1H');\n    \n    const alignmentScore = alignedTimeframes.length >= 2 ? 90 : alignedTimeframes.length === 1 ? 60 : 30;\n    \n    const strength = alignmentScore >= 80 ? 'strong' : alignmentScore >= 60 ? 'moderate' : 'weak';\n    \n    return {\n      score: alignmentScore * SCORING_WEIGHTS.trend,\n      direction: dominantDirection,\n      strength,\n      timeframes: Array.from(new Set(alignedTimeframes)),\n    };\n  }\n\n  private analyzeSingleTimeframeTrend(data: TimeframeData[]): { direction: string; strength: number } {\n    if (data.length < 3) return { direction: 'neutral', strength: 0 };\n    \n    const recentData = data.slice(-10);\n    const closes = recentData.map(d => d.close);\n    \n    let upMoves = 0;\n    let downMoves = 0;\n    \n    for (let i = 1; i < closes.length; i++) {\n      if (closes[i] > closes[i - 1]) upMoves++;\n      else if (closes[i] < closes[i - 1]) downMoves++;\n    }\n    \n    const direction = upMoves > downMoves ? 'bullish' : downMoves > upMoves ? 'bearish' : 'neutral';\n    const strength = Math.max(upMoves, downMoves) / (closes.length - 1);\n    \n    return { direction, strength };\n  }\n\n  detectInstitutionalCandle(\n    data: TimeframeData[],\n    timeframe: string\n  ): InstitutionalCandleData | null {\n    if (data.length < 3) return null;\n    \n    for (let i = data.length - 2; i >= Math.max(1, data.length - 20); i--) {\n      const oppositeCandle = data[i - 1];\n      const impulseCandle = data[i];\n      \n      const oppositeIsBearish = oppositeCandle.close < oppositeCandle.open;\n      const oppositeIsBullish = oppositeCandle.close > oppositeCandle.open;\n      \n      const impulseIsBullish = impulseCandle.close > impulseCandle.open;\n      const impulseIsBearish = impulseCandle.close < impulseCandle.open;\n      \n      const oppositeBody = Math.abs(oppositeCandle.close - oppositeCandle.open);\n      const impulseBody = Math.abs(impulseCandle.close - impulseCandle.open);\n      \n      const isStrongImpulse = impulseBody > oppositeBody * 1.5;\n      \n      if (oppositeIsBearish && impulseIsBullish && isStrongImpulse) {\n        const prevHighs = data.slice(0, i - 1).map(d => d.high);\n        const prevStructureHigh = prevHighs.length > 0 ? Math.max(...prevHighs) : 0;\n        const structureBreak = impulseCandle.close > prevStructureHigh;\n        \n        if (structureBreak) {\n          return {\n            timeframe,\n            candleType: 'bullish',\n            open: oppositeCandle.open,\n            close: oppositeCandle.close,\n            high: oppositeCandle.high,\n            low: oppositeCandle.low,\n            mth: (oppositeCandle.open + oppositeCandle.close) / 2,\n            timestamp: oppositeCandle.timestamp,\n            structureBreak: true,\n            impulseMagnitude: impulseBody,\n          };\n        }\n      }\n      \n      if (oppositeIsBullish && impulseIsBearish && isStrongImpulse) {\n        const prevLows = data.slice(0, i - 1).map(d => d.low);\n        const prevStructureLow = prevLows.length > 0 ? Math.min(...prevLows) : Infinity;\n        const structureBreak = impulseCandle.close < prevStructureLow;\n        \n        if (structureBreak) {\n          return {\n            timeframe,\n            candleType: 'bearish',\n            open: oppositeCandle.open,\n            close: oppositeCandle.close,\n            high: oppositeCandle.high,\n            low: oppositeCandle.low,\n            mth: (oppositeCandle.open + oppositeCandle.close) / 2,\n            timestamp: oppositeCandle.timestamp,\n            structureBreak: true,\n            impulseMagnitude: impulseBody,\n          };\n        }\n      }\n    }\n    \n    return null;\n  }\n\n  detectSmartMoneyFactors(\n    data: TimeframeData[],\n    institutionalCandle: InstitutionalCandleData | null\n  ): { \n    score: number; \n    factors: string[]; \n    orderBlock: any; \n    fvg: any; \n    liquiditySweep: boolean; \n    liquiditySweepData?: LiquiditySweepResult;\n    chochData?: CHoCHResult;\n  } {\n    const factors: string[] = [];\n    let score = 0;\n    let orderBlock = null;\n    let fvg = null;\n    let liquiditySweep = false;\n    \n    if (institutionalCandle) {\n      factors.push(`Institutional candle detected at ${institutionalCandle.mth.toFixed(5)}`);\n      score += 40;\n      \n      orderBlock = {\n        type: institutionalCandle.candleType,\n        level: institutionalCandle.mth,\n      };\n    }\n    \n    const recentData = data.slice(-5);\n    for (let i = 1; i < recentData.length - 1; i++) {\n      const prev = recentData[i - 1];\n      const current = recentData[i];\n      const next = recentData[i + 1];\n      \n      if (prev.low > next.high) {\n        factors.push(`FVG (Fair Value Gap) identified: ${next.high.toFixed(5)} - ${prev.low.toFixed(5)}`);\n        fvg = { level: (prev.low + next.high) / 2 };\n        score += 25;\n        break;\n      }\n      \n      if (prev.high < next.low) {\n        factors.push(`FVG (Fair Value Gap) identified: ${prev.high.toFixed(5)} - ${next.low.toFixed(5)}`);\n        fvg = { level: (prev.high + next.low) / 2 };\n        score += 25;\n        break;\n      }\n    }\n    \n    // Convert TimeframeData to Candle format for liquidity sweep detection\n    const candles: Candle[] = data.map(d => ({\n      timeframe: d.timeframe,\n      open: d.open,\n      high: d.high,\n      low: d.low,\n      close: d.close,\n      volume: d.volume || 0,\n      timestamp: d.timestamp,\n    }));\n    \n    // Use advanced liquidity sweep detection\n    const liquiditySweepResult = this.liquiditySweepDetector.analyzeLiquiditySweep(candles);\n    \n    if (liquiditySweepResult.sweepDetected) {\n      liquiditySweep = true;\n      \n      // Add liquidity sweep reasoning to factors\n      liquiditySweepResult.reasoning.forEach(reason => {\n        factors.push(reason);\n      });\n      \n      // Enhanced scoring based on sweep quality AND confirmed mitigation\n      if (liquiditySweepResult.supplyDemandZone && \n          liquiditySweepResult.supplyDemandZone.mitigated &&\n          liquiditySweepResult.entryPrice && \n          liquiditySweepResult.stopLoss) {\n        // High-quality setup: sweep + CONFIRMED zone mitigation with entry\n        score += 35;\n        if (liquiditySweepResult.supplyDemandZone.strength === 'strong') {\n          score += 15;\n        } else if (liquiditySweepResult.supplyDemandZone.strength === 'moderate') {\n          score += 8;\n        }\n      } else {\n        // Basic sweep detected, but no confirmed mitigation entry yet\n        score += 15;\n      }\n    }\n    \n    // Detect CHoCH (Change of Character) - trend reversal\n    const zones = this.liquiditySweepDetector.identifySupplyDemandZones(candles);\n    const chochResult = this.liquiditySweepDetector.detectCHoCH(candles, zones);\n    \n    if (chochResult.detected) {\n      // Add CHoCH reasoning to factors\n      chochResult.reasoning.forEach(reason => {\n        factors.push(reason);\n      });\n      \n      // Score based on CHoCH entry validity\n      if (chochResult.entryValid) {\n        // Valid CHoCH entry setup (high-probability)\n        score += 40;\n        if (chochResult.levelsBroken && chochResult.levelsBroken >= 3) {\n          score += 10;\n        }\n        if (chochResult.targetZone?.strength === 'strong') {\n          score += 10;\n        }\n      } else if (chochResult.detected) {\n        // CHoCH detected but entry not yet valid\n        score += 15;\n      }\n    }\n    \n    const finalScore = Math.min(100, score) * SCORING_WEIGHTS.smartMoneyConcepts;\n    \n    return {\n      score: finalScore,\n      factors,\n      orderBlock,\n      fvg,\n      liquiditySweep,\n      liquiditySweepData: liquiditySweepResult.sweepDetected ? liquiditySweepResult : undefined,\n      chochData: chochResult.detected ? chochResult : undefined,\n    };\n  }\n\n  calculateOverallConfidence(\n    interestRateScore: number,\n    inflationScore: number,\n    trendScore: number,\n    smcScore: number\n  ): number {\n    const totalScore = interestRateScore + inflationScore + trendScore + smcScore;\n    return Math.min(100, Math.round(totalScore));\n  }\n\n  generateTradingSignal(params: {\n    symbol: string;\n    assetClass: string;\n    interestRateData?: { base: InterestRateData; quote: InterestRateData };\n    inflationData?: { base: InflationData; quote: InflationData };\n    dailyData: TimeframeData[];\n    h4Data: TimeframeData[];\n    h1Data: TimeframeData[];\n    m15Data: TimeframeData[];\n  }): InsertTradingSignal | null {\n    const { symbol, assetClass, interestRateData, inflationData, dailyData, h4Data, h1Data, m15Data } = params;\n    \n    let interestRateScore = 0;\n    let interestRateDiff = null;\n    let interestRateNotes = null;\n    \n    if (interestRateData) {\n      const irResult = this.calculateInterestRateDifferential(\n        interestRateData.base.currency,\n        interestRateData.quote.currency,\n        interestRateData.base.rate,\n        interestRateData.quote.rate\n      );\n      interestRateScore = irResult.score;\n      interestRateDiff = irResult.differential;\n      interestRateNotes = irResult.notes;\n    } else if (assetClass === 'stock' || assetClass === 'crypto' || assetClass === 'commodity') {\n      interestRateScore = 75 * SCORING_WEIGHTS.interestRateDifferential;\n      interestRateNotes = `${assetClass.toUpperCase()} analysis uses market momentum instead of IR differential`;\n    }\n    \n    let inflationScore = 0;\n    let inflationDiff = null;\n    let inflationNotes = null;\n    \n    if (inflationData) {\n      const infResult = this.calculateInflationImpact(\n        inflationData.base.currency,\n        inflationData.quote.currency,\n        inflationData.base.rate,\n        inflationData.quote.rate\n      );\n      inflationScore = infResult.score;\n      inflationDiff = infResult.differential;\n      inflationNotes = infResult.notes;\n    } else if (assetClass === 'stock' || assetClass === 'crypto' || assetClass === 'commodity') {\n      inflationScore = 70 * SCORING_WEIGHTS.inflation;\n      inflationNotes = `${assetClass.toUpperCase()} analysis uses sector momentum instead of inflation differential`;\n    }\n    \n    const trendResult = this.detectTrend(dailyData, h4Data, h1Data);\n    \n    const institutionalCandle = this.detectInstitutionalCandle(h4Data, '4H') || \n                                 this.detectInstitutionalCandle(h1Data, '1H');\n    \n    const smcResult = this.detectSmartMoneyFactors(h4Data, institutionalCandle);\n    \n    const overallConfidence = this.calculateOverallConfidence(\n      interestRateScore,\n      inflationScore,\n      trendResult.score,\n      smcResult.score\n    );\n    \n    if (overallConfidence < 50) {\n      return null;\n    }\n    \n    const latestPrice = h1Data[h1Data.length - 1].close;\n    let type = trendResult.direction === 'bullish' ? 'buy' : 'sell';\n    let entryPrice = latestPrice;\n    let stopLoss: number;\n    let takeProfit: number;\n    let strategyType: 'liquidity_sweep_mitigation' | 'choch_reversal' | 'institutional_backbone' = 'institutional_backbone';\n    \n    // Priority 1: Check for VALID CHoCH entry (trend reversal with unmitigated zone)\n    if (smcResult.chochData?.entryValid && smcResult.chochData.targetZone) {\n      const zone = smcResult.chochData.targetZone;\n      \n      // Use CHoCH entry logic\n      entryPrice = (zone.topPrice + zone.bottomPrice) / 2;\n      \n      // Override type based on CHoCH direction\n      type = smcResult.chochData.chochType === 'bullish_choch' ? 'buy' : 'sell';\n      \n      if (type === 'buy') {\n        stopLoss = zone.bottomPrice - (zone.topPrice - zone.bottomPrice) * 0.3;\n        const risk = Math.abs(entryPrice - stopLoss);\n        takeProfit = entryPrice + (risk * 3); // 1:3 R:R for CHoCH setups\n      } else {\n        stopLoss = zone.topPrice + (zone.topPrice - zone.bottomPrice) * 0.3;\n        const risk = Math.abs(entryPrice - stopLoss);\n        takeProfit = entryPrice - (risk * 3);\n      }\n      \n      strategyType = 'choch_reversal';\n    } \n    // Priority 2: Check for CONFIRMED liquidity sweep with mitigated zone entry\n    else if (smcResult.liquiditySweepData?.supplyDemandZone && \n        smcResult.liquiditySweepData.supplyDemandZone.mitigated &&\n        smcResult.liquiditySweepData.entryPrice &&\n        smcResult.liquiditySweepData.stopLoss) {\n      // Use liquidity sweep entry logic (only when zone is mitigated)\n      entryPrice = smcResult.liquiditySweepData.entryPrice;\n      stopLoss = smcResult.liquiditySweepData.stopLoss;\n      \n      // Override type based on sweep direction\n      type = smcResult.liquiditySweepData.sweepType === 'bearish_sweep' ? 'sell' : 'buy';\n      \n      // Calculate take profit based on risk-reward\n      const risk = Math.abs(entryPrice - stopLoss);\n      takeProfit = type === 'buy' \n        ? entryPrice + (risk * 2.5) // 1:2.5 R:R for sweep setups\n        : entryPrice - (risk * 2.5);\n      \n      strategyType = 'liquidity_sweep_mitigation';\n    } \n    // Fallback: Use traditional ATR-based entry\n    else {\n      const atr = this.calculateATR(h1Data.slice(-14));\n      stopLoss = type === 'buy' \n        ? latestPrice - (atr * 1.5)\n        : latestPrice + (atr * 1.5);\n      \n      takeProfit = type === 'buy'\n        ? latestPrice + (atr * 3)\n        : latestPrice - (atr * 3);\n    }\n    \n    const riskRewardRatio = Math.abs(takeProfit - entryPrice) / Math.abs(entryPrice - stopLoss);\n    \n    const technicalReasons: string[] = [];\n    if (trendResult.timeframes.length > 0) {\n      technicalReasons.push(`Multi-timeframe trend alignment: ${trendResult.timeframes.join(', ')}`);\n    }\n    if (interestRateData) {\n      technicalReasons.push(`Interest rate differential: ${interestRateDiff?.toFixed(2)}%`);\n    }\n    if (inflationData) {\n      technicalReasons.push(`Inflation differential supports ${type} bias`);\n    }\n    \n    // Check for CHoCH entry (highest priority)\n    if (strategyType === 'choch_reversal' && smcResult.chochData) {\n      const trend = smcResult.chochData.previousTrend === 'uptrend' ? 'Uptrend' : 'Downtrend';\n      const levelsBroken = smcResult.chochData.levelsBroken || 0;\n      const zoneType = smcResult.chochData.targetZone?.type || 'zone';\n      technicalReasons.push(\n        `CHoCH (Change of Character): ${trend} reversed with ${levelsBroken}+ levels broken`,\n        `Targeting unmitigated ${zoneType} zone (High-probability reversal setup)`\n      );\n    }\n    \n    // Check if we have a confirmed liquidity sweep mitigation entry\n    const hasConfirmedSweepEntry = !!(\n      smcResult.liquiditySweepData?.supplyDemandZone && \n      smcResult.liquiditySweepData.supplyDemandZone.mitigated &&\n      smcResult.liquiditySweepData.entryPrice && \n      smcResult.liquiditySweepData.stopLoss\n    );\n    \n    // Add liquidity sweep information to technical reasons only if confirmed\n    if (hasConfirmedSweepEntry && strategyType === 'liquidity_sweep_mitigation') {\n      const zoneType = smcResult.liquiditySweepData!.supplyDemandZone!.type;\n      const zoneStrength = smcResult.liquiditySweepData!.supplyDemandZone!.strength;\n      technicalReasons.push(\n        `Liquidity sweep followed by ${zoneStrength} ${zoneType} zone mitigation (High-probability setup)`\n      );\n    }\n    \n    // Determine market context based on strategy\n    let marketContext: string;\n    if (strategyType === 'choch_reversal') {\n      const trend = smcResult.chochData?.previousTrend === 'uptrend' ? 'uptrend' : 'downtrend';\n      marketContext = `CHoCH reversal from ${trend} targeting unmitigated zone`;\n    } else if (strategyType === 'liquidity_sweep_mitigation') {\n      marketContext = `Post-liquidity sweep ${smcResult.liquiditySweepData!.supplyDemandZone!.type} zone entry`;\n    } else {\n      marketContext = `${trendResult.strength} ${trendResult.direction} trend with ${overallConfidence}% confidence`;\n    }\n    \n    const signal: InsertTradingSignal = {\n      symbol,\n      assetClass,\n      type,\n      strategy: strategyType,\n      entryPrice: entryPrice.toString(),\n      stopLoss: stopLoss.toString(),\n      takeProfit: takeProfit.toString(),\n      riskRewardRatio: riskRewardRatio.toFixed(2),\n      primaryTimeframe: institutionalCandle?.timeframe || '4H',\n      confirmationTimeframe: '15M',\n      executionTimeframe: '5M',\n      overallConfidence,\n      interestRateDiffScore: interestRateScore.toString(),\n      interestRateDiffValue: interestRateDiff?.toString() || null,\n      interestRateNotes,\n      inflationImpactScore: inflationScore.toString(),\n      inflationDifferential: inflationDiff?.toString() || null,\n      inflationNotes,\n      trendScore: trendResult.score.toString(),\n      trendDirection: trendResult.direction,\n      trendStrength: trendResult.strength,\n      trendTimeframes: trendResult.timeframes,\n      smcScore: smcResult.score.toString(),\n      institutionalCandleDetected: !!institutionalCandle,\n      institutionalCandleData: institutionalCandle,\n      orderBlockType: smcResult.orderBlock?.type || null,\n      orderBlockLevel: smcResult.orderBlock?.level?.toString() || null,\n      fvgDetected: !!smcResult.fvg,\n      fvgLevel: smcResult.fvg?.level?.toString() || null,\n      liquiditySweep: smcResult.liquiditySweep,\n      smcFactors: smcResult.factors,\n      technicalReasons,\n      marketContext,\n      status: 'active',\n      strength: overallConfidence >= 80 ? 'strong' : overallConfidence >= 60 ? 'moderate' : 'weak',\n    };\n    \n    return signal;\n  }\n\n  private calculateATR(data: TimeframeData[], period: number = 14): number {\n    if (data.length < period) return 0;\n    \n    const trueRanges: number[] = [];\n    for (let i = 1; i < data.length; i++) {\n      const high = data[i].high;\n      const low = data[i].low;\n      const prevClose = data[i - 1].close;\n      \n      const tr = Math.max(\n        high - low,\n        Math.abs(high - prevClose),\n        Math.abs(low - prevClose)\n      );\n      trueRanges.push(tr);\n    }\n    \n    const atr = trueRanges.slice(-period).reduce((sum, tr) => sum + tr, 0) / period;\n    return atr;\n  }\n}\n\nexport const signalDetectionService = new SignalDetectionService();\n","size_bytes":21814},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"server/scrapers/config.ts":{"content":"export interface ScraperConfig {\n  name: string;\n  url: string;\n  enabled: boolean;\n  priority: number;\n  selectors: {\n    eventRow?: string;\n    eventName?: string;\n    country?: string;\n    date?: string;\n    time?: string;\n    impact?: string;\n    actual?: string;\n    forecast?: string;\n    previous?: string;\n    currency?: string;\n  };\n  dataMapping?: {\n    impactLevels?: Record<string, string>;\n    countryCodes?: Record<string, string>;\n  };\n}\n\nexport const scraperConfigs: Record<string, ScraperConfig> = {\n  investingCom: {\n    name: 'Investing.com',\n    url: 'https://www.investing.com/economic-calendar/',\n    enabled: true,\n    priority: 1,\n    selectors: {\n      eventRow: 'tr.js-event-item',\n      eventName: 'td.event a',\n      country: 'td.flagCur',\n      date: 'td.time',\n      time: 'td.time',\n      impact: 'td.sentiment',\n      actual: 'td#actual',\n      forecast: 'td#forecast',\n      previous: 'td#previous',\n    },\n    dataMapping: {\n      impactLevels: {\n        'bull1': 'Low',\n        'bull2': 'Medium',\n        'bull3': 'High',\n        'grayFullBullishIcon': 'Holiday',\n      },\n      countryCodes: {\n        'United States': 'USD',\n        'Eurozone': 'EUR',\n        'United Kingdom': 'GBP',\n        'Japan': 'JPY',\n        'Canada': 'CAD',\n        'Australia': 'AUD',\n        'New Zealand': 'NZD',\n        'Switzerland': 'CHF',\n        'China': 'CNY',\n      },\n    },\n  },\n  \n  forexFactory: {\n    name: 'ForexFactory',\n    url: 'https://www.forexfactory.com/calendar',\n    enabled: true,\n    priority: 2,\n    selectors: {\n      eventRow: 'tr.calendar__row',\n      eventName: 'td.calendar__event span.calendar__event-title',\n      country: 'td.calendar__currency',\n      time: 'td.calendar__time',\n      impact: 'td.calendar__impact span',\n      actual: 'td.calendar__actual',\n      forecast: 'td.calendar__forecast',\n      previous: 'td.calendar__previous',\n    },\n    dataMapping: {\n      impactLevels: {\n        'icon--ff-impact-yel': 'Low',\n        'icon--ff-impact-ora': 'Medium',\n        'icon--ff-impact-red': 'High',\n        'icon--ff-impact-gra': 'Holiday',\n      },\n      countryCodes: {\n        'USD': 'USD',\n        'EUR': 'EUR',\n        'GBP': 'GBP',\n        'JPY': 'JPY',\n        'CAD': 'CAD',\n        'AUD': 'AUD',\n        'NZD': 'NZD',\n        'CHF': 'CHF',\n        'CNY': 'CNY',\n      },\n    },\n  },\n\n  fxStreet: {\n    name: 'FXStreet',\n    url: 'https://www.fxstreet.com/economic-calendar',\n    enabled: true,\n    priority: 3,\n    selectors: {\n      eventRow: 'div.fxs_calendar_row',\n      eventName: 'div.fxs_event_title',\n      country: 'div.fxs_c_currency',\n      time: 'div.fxs_c_time',\n      impact: 'div.fxs_c_volatility',\n      actual: 'div.fxs_c_actual',\n      forecast: 'div.fxs_c_consensus',\n      previous: 'div.fxs_c_previous',\n    },\n    dataMapping: {\n      impactLevels: {\n        'low': 'Low',\n        'medium': 'Medium',\n        'high': 'High',\n      },\n    },\n  },\n\n  tradingEconomics: {\n    name: 'TradingEconomics',\n    url: 'https://tradingeconomics.com/calendar',\n    enabled: false,\n    priority: 4,\n    selectors: {\n      eventRow: 'tr[data-event]',\n      eventName: 'td.calendar-event a',\n      country: 'td.calendar-country',\n      time: 'td.calendar-time',\n      impact: 'td.calendar-importance',\n      actual: 'td.calendar-actual',\n      forecast: 'td.calendar-forecast',\n      previous: 'td.calendar-previous',\n    },\n    dataMapping: {\n      impactLevels: {\n        '1': 'Low',\n        '2': 'Medium',\n        '3': 'High',\n      },\n    },\n  },\n};\n\nexport const scraperSettings = {\n  requestDelay: 3000,\n  timeout: 30000,\n  retryAttempts: 3,\n  retryDelay: 5000,\n  userAgents: [\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',\n    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',\n    'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0',\n  ],\n  cacheSettings: {\n    cacheDuration: 15 * 60 * 1000,\n    dataRetentionDays: 7,\n    cleanupInterval: 60 * 60 * 1000,\n  },\n  schedules: {\n    upcomingEventsInterval: 15 * 60 * 1000,\n    fullWeekScrapeTime: '0 0 * * *',\n  },\n};\n\nexport function getRandomUserAgent(): string {\n  return scraperSettings.userAgents[\n    Math.floor(Math.random() * scraperSettings.userAgents.length)\n  ];\n}\n\nexport function getActiveScrapers(): ScraperConfig[] {\n  return Object.values(scraperConfigs)\n    .filter(config => config.enabled)\n    .sort((a, b) => a.priority - b.priority);\n}\n","size_bytes":4666},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":2359},"client/src/lib/tradingSessions.ts":{"content":"export interface TradingSession {\n  name: string;\n  city: string;\n  timezone: string;\n  openTime: string;\n  closeTime: string;\n  isActive: boolean;\n  color: string;\n  openUTC: number;\n  closeUTC: number;\n}\n\nconst SESSION_DEFINITIONS = [\n  {\n    name: 'Sydney',\n    city: 'Sydney',\n    timezone: 'AEDT (UTC+11)',\n    openUTC: 22,\n    closeUTC: 7,\n    color: 'hsl(280 85% 70%)',\n  },\n  {\n    name: 'Tokyo',\n    city: 'Tokyo',\n    timezone: 'JST (UTC+9)',\n    openUTC: 0,\n    closeUTC: 9,\n    color: 'hsl(45 90% 60%)',\n  },\n  {\n    name: 'London',\n    city: 'London',\n    timezone: 'BST (UTC+1)',\n    openUTC: 7,\n    closeUTC: 15.5,\n    color: 'hsl(120 60% 50%)',\n  },\n  {\n    name: 'New York',\n    city: 'New York',\n    timezone: 'EDT (UTC-4)',\n    openUTC: 12,\n    closeUTC: 21,\n    color: 'hsl(210 100% 60%)',\n  },\n];\n\nfunction formatUTCTime(hours: number): string {\n  const h = Math.floor(hours);\n  const m = Math.round((hours - h) * 60);\n  return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}`;\n}\n\nfunction isSessionActive(openUTC: number, closeUTC: number, currentUTC: number): boolean {\n  if (openUTC < closeUTC) {\n    return currentUTC >= openUTC && currentUTC < closeUTC;\n  } else {\n    return currentUTC >= openUTC || currentUTC < closeUTC;\n  }\n}\n\nexport function getActiveSessions(): TradingSession[] {\n  const now = new Date();\n  const currentUTC = now.getUTCHours() + now.getUTCMinutes() / 60;\n  const dayOfWeek = now.getUTCDay();\n  \n  const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;\n  \n  return SESSION_DEFINITIONS.map(session => {\n    const isActive = !isWeekend && isSessionActive(session.openUTC, session.closeUTC, currentUTC);\n    \n    return {\n      ...session,\n      openTime: formatUTCTime(session.openUTC),\n      closeTime: formatUTCTime(session.closeUTC),\n      isActive,\n    };\n  });\n}\n\nexport function getActiveSessionNames(): string[] {\n  return getActiveSessions()\n    .filter(s => s.isActive)\n    .map(s => s.name);\n}\n\nexport function getSessionStartTime(session: TradingSession): Date {\n  const now = new Date();\n  const sessionStart = new Date(now);\n  \n  const hours = Math.floor(session.openUTC);\n  const minutes = Math.round((session.openUTC - hours) * 60);\n  \n  sessionStart.setUTCHours(hours, minutes, 0, 0);\n  \n  if (session.openUTC > session.closeUTC && now.getUTCHours() < session.closeUTC) {\n    sessionStart.setUTCDate(sessionStart.getUTCDate() - 1);\n  }\n  \n  return sessionStart;\n}\n\nexport function getSessionTimeRemaining(session: TradingSession): number {\n  if (!session.isActive) return 0;\n  \n  const now = new Date();\n  const currentUTC = now.getUTCHours() + now.getUTCMinutes() / 60;\n  \n  let timeRemaining: number;\n  \n  if (session.openUTC < session.closeUTC) {\n    timeRemaining = session.closeUTC - currentUTC;\n  } else {\n    if (currentUTC >= session.openUTC) {\n      timeRemaining = 24 - currentUTC + session.closeUTC;\n    } else {\n      timeRemaining = session.closeUTC - currentUTC;\n    }\n  }\n  \n  return Math.max(0, Math.floor(timeRemaining * 60));\n}\n\nexport function getSessionElapsedMinutes(session: TradingSession): number {\n  if (!session.isActive) return 0;\n  \n  const sessionStart = getSessionStartTime(session);\n  const now = new Date();\n  \n  return Math.floor((now.getTime() - sessionStart.getTime()) / (1000 * 60));\n}\n\nexport function formatMinutesToHoursAndMinutes(totalMinutes: number): string {\n  const hours = Math.floor(totalMinutes / 60);\n  const minutes = totalMinutes % 60;\n  \n  if (hours === 0) {\n    return `${minutes}m`;\n  } else if (minutes === 0) {\n    return `${hours}h`;\n  } else {\n    return `${hours}h ${minutes}m`;\n  }\n}\n\nexport function getMinutesUntilSessionOpen(session: TradingSession): number {\n  if (session.isActive) return 0;\n  \n  const now = new Date();\n  const dayOfWeek = now.getUTCDay();\n  const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;\n  \n  if (isWeekend) {\n    // Calculate time until Monday 00:00 UTC, then add time to session open\n    const daysUntilMonday = dayOfWeek === 0 ? 1 : 2;\n    const hoursUntilMonday = (24 - now.getUTCHours() - 1) + (daysUntilMonday - 1) * 24;\n    const minutesUntilMonday = (60 - now.getUTCMinutes()) + hoursUntilMonday * 60;\n    \n    // Add time from Monday 00:00 to session open\n    const sessionOpenMinutes = Math.floor(session.openUTC * 60);\n    return minutesUntilMonday + sessionOpenMinutes;\n  }\n  \n  const currentUTC = now.getUTCHours() + now.getUTCMinutes() / 60;\n  let hoursUntilOpen: number;\n  \n  if (session.openUTC > currentUTC) {\n    // Session opens later today\n    hoursUntilOpen = session.openUTC - currentUTC;\n  } else {\n    // Session opens tomorrow\n    hoursUntilOpen = 24 - currentUTC + session.openUTC;\n  }\n  \n  return Math.floor(hoursUntilOpen * 60);\n}\n","size_bytes":4731},"server/services/fmp.ts":{"content":"import type { EconomicEvent } from '@shared/schema';\nimport { format, addDays } from 'date-fns';\n\nconst FMP_API_KEY = process.env.FMP_API_KEY;\nconst BASE_URL = 'https://financialmodelingprep.com/api/v3';\n\nfunction hashString(str: string): string {\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash;\n  }\n  return Math.abs(hash).toString(36);\n}\n\nconst countryToRegion: Record<string, string> = {\n  'US': 'Americas',\n  'CA': 'Americas',\n  'BR': 'Americas',\n  'MX': 'Americas',\n  'GB': 'Europe',\n  'DE': 'Europe',\n  'FR': 'Europe',\n  'IT': 'Europe',\n  'ES': 'Europe',\n  'CH': 'Europe',\n  'SE': 'Europe',\n  'NO': 'Europe',\n  'DK': 'Europe',\n  'PL': 'Europe',\n  'NL': 'Europe',\n  'BE': 'Europe',\n  'AT': 'Europe',\n  'FI': 'Europe',\n  'IE': 'Europe',\n  'PT': 'Europe',\n  'GR': 'Europe',\n  'CZ': 'Europe',\n  'HU': 'Europe',\n  'RO': 'Europe',\n  'JP': 'Asia',\n  'CN': 'Asia',\n  'AU': 'Asia',\n  'NZ': 'Asia',\n  'SG': 'Asia',\n  'HK': 'Asia',\n  'KR': 'Asia',\n  'IN': 'Asia',\n  'TH': 'Asia',\n  'MY': 'Asia',\n  'ID': 'Asia',\n  'PH': 'Asia',\n  'VN': 'Asia',\n  'TW': 'Asia',\n};\n\nconst countryToCurrency: Record<string, string> = {\n  'US': 'USD',\n  'GB': 'GBP',\n  'EU': 'EUR',\n  'DE': 'EUR',\n  'FR': 'EUR',\n  'IT': 'EUR',\n  'ES': 'EUR',\n  'JP': 'JPY',\n  'CN': 'CNY',\n  'AU': 'AUD',\n  'CA': 'CAD',\n  'CH': 'CHF',\n  'NZ': 'NZD',\n  'SE': 'SEK',\n  'NO': 'NOK',\n  'DK': 'DKK',\n  'PL': 'PLN',\n  'NL': 'EUR',\n  'BE': 'EUR',\n  'AT': 'EUR',\n  'FI': 'EUR',\n  'IE': 'EUR',\n  'PT': 'EUR',\n  'GR': 'EUR',\n  'SG': 'SGD',\n  'HK': 'HKD',\n  'KR': 'KRW',\n  'IN': 'INR',\n  'BR': 'BRL',\n  'MX': 'MXN',\n};\n\nfunction determineMarketImpact(event: any): string {\n  if (!event.estimate || event.actual === null) {\n    return 'Impact pending - awaiting actual data release';\n  }\n\n  const actual = parseFloat(event.actual);\n  const estimate = parseFloat(event.estimate);\n  const previous = event.previous ? parseFloat(event.previous) : null;\n\n  if (isNaN(actual) || isNaN(estimate)) {\n    return 'Market impact analysis unavailable';\n  }\n\n  const surprise = ((actual - estimate) / Math.abs(estimate)) * 100;\n  const currency = event.currency || 'currency';\n\n  if (Math.abs(surprise) < 1) {\n    return `Minimal market impact - ${currency} actual value aligned with expectations`;\n  }\n\n  if (actual > estimate) {\n    if (event.event.toLowerCase().includes('unemployment') || \n        event.event.toLowerCase().includes('inflation') ||\n        event.event.toLowerCase().includes('cpi')) {\n      return `Bearish for ${currency} - worse than expected (+${surprise.toFixed(1)}% surprise), potential pressure on currency`;\n    }\n    return `Bullish for ${currency} - beat expectations (+${surprise.toFixed(1)}% surprise), positive market sentiment`;\n  } else {\n    if (event.event.toLowerCase().includes('unemployment') || \n        event.event.toLowerCase().includes('inflation') ||\n        event.event.toLowerCase().includes('cpi')) {\n      return `Bullish for ${currency} - better than expected (${surprise.toFixed(1)}% surprise), supportive for currency`;\n    }\n    return `Bearish for ${currency} - missed expectations (${surprise.toFixed(1)}% surprise), negative pressure`;\n  }\n}\n\nexport async function getEconomicCalendar(\n  fromDate?: Date,\n  toDate?: Date\n): Promise<EconomicEvent[]> {\n  if (!FMP_API_KEY) {\n    console.error('FMP_API_KEY not configured');\n    return [];\n  }\n\n  const from = fromDate || new Date();\n  const to = toDate || addDays(new Date(), 7);\n\n  const fromStr = format(from, 'yyyy-MM-dd');\n  const toStr = format(to, 'yyyy-MM-dd');\n\n  try {\n    const url = `${BASE_URL}/economic_calendar?from=${fromStr}&to=${toStr}&apikey=${FMP_API_KEY}`;\n    \n    const response = await fetch(url);\n    \n    if (!response.ok) {\n      console.error(`FMP API error: ${response.status} ${response.statusText}`);\n      return [];\n    }\n\n    const data = await response.json();\n\n    if (!Array.isArray(data)) {\n      console.error('FMP API returned invalid data format');\n      return [];\n    }\n\n    const events: EconomicEvent[] = data\n      .filter(item => {\n        const impact = item.impact?.toLowerCase() || 'low';\n        return impact === 'high' || impact === 'medium';\n      })\n      .map(item => {\n        const eventTime = new Date(item.date);\n        const country = item.country || 'US';\n        const currency = item.currency || countryToCurrency[country] || 'USD';\n        \n        const id = hashString(`${item.date}-${item.event}-${country}`);\n\n        const marketImpact = determineMarketImpact(item);\n\n        return {\n          id,\n          title: item.event || 'Economic Event',\n          description: null,\n          eventType: item.event || 'Economic Data Release',\n          country,\n          region: countryToRegion[country] || 'Other',\n          eventTime,\n          currency,\n          impactLevel: item.impact || 'Medium',\n          previousValue: item.previous?.toString() || null,\n          expectedValue: item.estimate?.toString() || null,\n          actualValue: item.actual?.toString() || null,\n          unit: null,\n          futuresImpliedExpectation: null,\n          surpriseFactor: item.change ? item.change.toString() : null,\n          marketImpactAnalysis: marketImpact,\n          affectedCurrencies: [currency],\n          affectedStocks: [],\n          isReleased: item.actual !== null,\n          createdAt: null,\n        };\n      })\n      .sort((a, b) => new Date(a.eventTime).getTime() - new Date(b.eventTime).getTime());\n\n    return events;\n  } catch (error) {\n    console.error('Error fetching FMP economic calendar:', error);\n    return [];\n  }\n}\n","size_bytes":5654},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"server/services/telegramNotification.ts":{"content":"import TelegramBot from 'node-telegram-bot-api';\nimport { db } from '../db';\nimport { telegramSubscribers, economicEvents } from '@shared/schema';\nimport { eq, and, lte, gte } from 'drizzle-orm';\nimport { format } from 'date-fns';\nimport { notificationService } from './notificationService';\nimport { \n  generateTradingSignalChart, \n  readChartAsBuffer, \n  ChartCandle, \n  ZoneInfo \n} from './chartGenerator';\nimport { fetchMultiTimeframeData } from '../strategies/shared/multiTimeframe';\n\ninterface TradingSession {\n  name: string;\n  openUTC: number;\n  closeUTC: number;\n}\n\nconst HIGH_VOLUME_SESSIONS: TradingSession[] = [\n  { name: 'London', openUTC: 8, closeUTC: 16.5 },\n  { name: 'New York', openUTC: 13, closeUTC: 22 }\n];\n\nexport class TelegramNotificationService {\n  private bot: TelegramBot | null = null;\n  private isInitialized = false;\n  private notifiedSessions = new Set<string>();\n\n  constructor() {\n    this.initialize();\n  }\n\n  private initialize(): void {\n    const token = process.env.TELEGRAM_BOT_TOKEN;\n    \n    if (!token) {\n      console.error('TELEGRAM_BOT_TOKEN not found. Telegram notifications disabled.');\n      return;\n    }\n\n    try {\n      this.bot = new TelegramBot(token, { polling: true });\n      this.isInitialized = true;\n      this.setupCommands();\n      console.log('Telegram bot initialized successfully');\n    } catch (error) {\n      console.error('Failed to initialize Telegram bot:', error);\n    }\n  }\n\n  private setupCommands(): void {\n    if (!this.bot) return;\n\n    this.bot.onText(/\\/start/, async (msg) => {\n      const chatId = msg.chat.id.toString();\n      const user = msg.from;\n\n      try {\n        const existingSubscriber = await db\n          .select()\n          .from(telegramSubscribers)\n          .where(eq(telegramSubscribers.chatId, chatId))\n          .limit(1);\n\n        if (existingSubscriber.length === 0) {\n          await db.insert(telegramSubscribers).values({\n            chatId,\n            username: user?.username || null,\n            firstName: user?.first_name || null,\n            lastName: user?.last_name || null,\n            phoneNumber: null,\n            isActive: true,\n          });\n\n          await this.bot?.sendMessage(\n            chatId,\n            `✅ Welcome to Infod Trading Alerts!\\n\\n` +\n            `You're now subscribed to receive Telegram notifications for:\\n` +\n            `🔔 Trading Sessions - 5 min before London & NY open\\n` +\n            `📊 High impact economic events\\n` +\n            `📈 Medium impact economic events\\n\\n` +\n            `ℹ️ Other notifications (like trading signals) can be viewed on the dashboard.\\n\\n` +\n            `Commands:\\n` +\n            `/stop - Pause notifications\\n` +\n            `/resume - Resume notifications\\n` +\n            `/status - Check subscription status`\n          );\n        } else if (!existingSubscriber[0].isActive) {\n          await db\n            .update(telegramSubscribers)\n            .set({ isActive: true })\n            .where(eq(telegramSubscribers.chatId, chatId));\n\n          await this.bot?.sendMessage(\n            chatId,\n            `✅ Welcome back! Your notifications have been resumed.`\n          );\n        } else {\n          await this.bot?.sendMessage(\n            chatId,\n            `👋 You're already subscribed to trading alerts!\\n\\n` +\n            `Use /status to check your subscription.`\n          );\n        }\n      } catch (error) {\n        console.error('Error handling /start command:', error);\n        await this.bot?.sendMessage(\n          chatId,\n          '❌ Something went wrong. Please try again later.'\n        );\n      }\n    });\n\n    this.bot.onText(/\\/stop/, async (msg) => {\n      const chatId = msg.chat.id.toString();\n\n      try {\n        await db\n          .update(telegramSubscribers)\n          .set({ isActive: false })\n          .where(eq(telegramSubscribers.chatId, chatId));\n\n        await this.bot?.sendMessage(\n          chatId,\n          `⏸️ Notifications paused.\\n\\nUse /resume to start receiving alerts again.`\n        );\n      } catch (error) {\n        console.error('Error handling /stop command:', error);\n      }\n    });\n\n    this.bot.onText(/\\/resume/, async (msg) => {\n      const chatId = msg.chat.id.toString();\n\n      try {\n        await db\n          .update(telegramSubscribers)\n          .set({ isActive: true })\n          .where(eq(telegramSubscribers.chatId, chatId));\n\n        await this.bot?.sendMessage(\n          chatId,\n          `▶️ Notifications resumed!\\n\\nYou'll receive alerts for upcoming economic events.`\n        );\n      } catch (error) {\n        console.error('Error handling /resume command:', error);\n      }\n    });\n\n    this.bot.onText(/\\/status/, async (msg) => {\n      const chatId = msg.chat.id.toString();\n\n      try {\n        const subscriber = await db\n          .select()\n          .from(telegramSubscribers)\n          .where(eq(telegramSubscribers.chatId, chatId))\n          .limit(1);\n\n        if (subscriber.length === 0) {\n          await this.bot?.sendMessage(\n            chatId,\n            `❌ You're not subscribed yet.\\n\\nUse /start to subscribe to trading alerts.`\n          );\n        } else {\n          const status = subscriber[0].isActive ? '✅ Active' : '⏸️ Paused';\n          const subDate = format(new Date(subscriber[0].createdAt!), 'MMM dd, yyyy');\n          \n          await this.bot?.sendMessage(\n            chatId,\n            `📊 Subscription Status: ${status}\\n` +\n            `📅 Subscribed since: ${subDate}\\n\\n` +\n            `Receiving Telegram notifications for:\\n` +\n            `• Trading sessions (London & NY)\\n` +\n            `• High impact economic events\\n` +\n            `• Medium impact economic events\\n\\n` +\n            `ℹ️ View all notifications on the dashboard`\n          );\n        }\n      } catch (error) {\n        console.error('Error handling /status command:', error);\n      }\n    });\n  }\n\n  private formatEventMessage(event: any): string {\n    const impactEmoji = event.impactLevel === 'High' ? '🔴' : '🟡';\n    const impactLabel = event.impactLevel === 'High' ? 'HIGH IMPACT' : 'MEDIUM IMPACT';\n    const timeStr = format(new Date(event.eventTime), 'MMM dd, HH:mm');\n    \n    let message = `${impactEmoji} ${impactLabel} NEWS\\n`;\n    message += `━━━━━━━━━━━━━━━━━━━━\\n`;\n    message += `📰 ${event.title}\\n`;\n    message += `🌍 ${event.country} (${event.currency})\\n`;\n    message += `⏰ ${timeStr} UTC\\n`;\n    message += `━━━━━━━━━━━━━━━━━━━━\\n`;\n\n    if (event.expectedValue || event.previousValue) {\n      message += `📊 Forecast: ${event.expectedValue || 'N/A'}\\n`;\n      message += `📉 Previous: ${event.previousValue || 'N/A'}\\n`;\n      message += `━━━━━━━━━━━━━━━━━━━━\\n`;\n    }\n    \n    const impactSummary = this.generateImpactSummary(event);\n    message += `💡 Expected Impact:\\n${impactSummary}\\n`;\n    message += `━━━━━━━━━━━━━━━━━━━━\\n`;\n    message += `🔗 More info: www.findbuyandsellzones.com/calendar\\n\\n`;\n    message += `⚠️ Educational only — not financial advice.`;\n\n    return message;\n  }\n\n  private formatHighImpactEventMessage(event: any): string {\n    const timeStr = format(new Date(event.eventTime), 'MMM dd, HH:mm');\n    const now = new Date();\n    const eventTime = new Date(event.eventTime);\n    const minutesUntil = Math.ceil((eventTime.getTime() - now.getTime()) / (1000 * 60));\n    \n    let message = `🚨 *HIGH IMPACT NEWS ALERT*\\n`;\n    message += `━━━━━━━━━━━━━━━━━━━━\\n`;\n    message += `📰 *${event.title}*\\n`;\n    message += `🌍 ${event.country} (${event.currency})\\n`;\n    message += `⏰ In ${minutesUntil} minutes (${timeStr} UTC)\\n`;\n    message += `━━━━━━━━━━━━━━━━━━━━\\n`;\n\n    if (event.expectedValue || event.previousValue) {\n      message += `📊 Forecast: ${event.expectedValue || 'N/A'}\\n`;\n      message += `📉 Previous: ${event.previousValue || 'N/A'}\\n`;\n      message += `━━━━━━━━━━━━━━━━━━━━\\n`;\n    }\n    \n    message += `⚠️ *Expect high volatility!*\\n`;\n    message += `Consider closing or reducing positions.\\n\\n`;\n    message += `🔗 www.findbuyandsellzones.com/calendar`;\n\n    return message;\n  }\n\n  private generateImpactSummary(event: any): string {\n    const currency = event.currency || 'USD';\n    const title = (event.title || '').toLowerCase();\n    \n    if (title.includes('interest rate') || title.includes('fomc') || title.includes('rate decision')) {\n      return `Rate decisions directly impact ${currency} strength. Higher rates = bullish ${currency}, lower rates = bearish ${currency}.`;\n    }\n    if (title.includes('nfp') || title.includes('non-farm') || title.includes('employment') || title.includes('jobs')) {\n      return `Employment data affects ${currency} significantly. Strong jobs = bullish ${currency}, weak jobs = bearish ${currency}.`;\n    }\n    if (title.includes('cpi') || title.includes('inflation') || title.includes('ppi')) {\n      return `Inflation data influences rate expectations. Higher inflation = potential rate hikes = bullish ${currency}.`;\n    }\n    if (title.includes('gdp') || title.includes('growth')) {\n      return `GDP reflects economic health. Strong growth = bullish ${currency}, weak growth = bearish ${currency}.`;\n    }\n    if (title.includes('pmi') || title.includes('manufacturing') || title.includes('services')) {\n      return `PMI above 50 = expansion (bullish ${currency}), below 50 = contraction (bearish ${currency}).`;\n    }\n    if (title.includes('retail') || title.includes('consumer')) {\n      return `Consumer spending drives growth. Strong retail = bullish ${currency}, weak retail = bearish ${currency}.`;\n    }\n    if (title.includes('trade') || title.includes('balance')) {\n      return `Trade surplus = bullish ${currency}, trade deficit = bearish ${currency}.`;\n    }\n    if (title.includes('housing') || title.includes('home')) {\n      return `Housing data reflects economic confidence. Strong housing = bullish ${currency}.`;\n    }\n    \n    return `${event.impactLevel} impact event for ${currency}. Watch for volatility around release time.`;\n  }\n\n  async sendEventNotification(event: any): Promise<void> {\n    try {\n      const impactEmoji = event.impactLevel === 'High' ? '🔴' : event.impactLevel === 'Medium' ? '🟡' : '🟢';\n      const timeStr = format(new Date(event.eventTime), 'MMM dd, HH:mm');\n      \n      const title = `${impactEmoji} ${event.impactLevel} Impact: ${event.title}`;\n      let message = `${event.country} (${event.currency}) - ${timeStr} UTC`;\n      \n      if (event.expectedValue || event.previousValue) {\n        const parts = [];\n        if (event.expectedValue) parts.push(`Expected: ${event.expectedValue}`);\n        if (event.previousValue) parts.push(`Previous: ${event.previousValue}`);\n        message += ` | ${parts.join(', ')}`;\n      }\n      \n      await notificationService.createNotification({\n        type: 'economic_event',\n        title,\n        message,\n        impactLevel: event.impactLevel,\n        metadata: JSON.stringify(event),\n      });\n\n      if (this.isInitialized && this.bot && event.impactLevel === 'High') {\n        const subscribers = await db\n          .select()\n          .from(telegramSubscribers)\n          .where(eq(telegramSubscribers.isActive, true));\n\n        if (subscribers.length > 0) {\n          const telegramMessage = this.formatHighImpactEventMessage(event);\n\n          for (const subscriber of subscribers) {\n            try {\n              await this.bot.sendMessage(subscriber.chatId, telegramMessage, {\n                parse_mode: 'Markdown',\n              });\n              console.log(`High impact event notification sent to ${subscriber.chatId}`);\n            } catch (error) {\n              console.error(`Failed to send Telegram notification to ${subscriber.chatId}:`, error);\n            }\n          }\n        }\n      }\n\n      await db\n        .update(economicEvents)\n        .set({ telegramNotified: true })\n        .where(eq(economicEvents.id, event.id));\n\n    } catch (error) {\n      console.error('Error sending event notifications:', error);\n    }\n  }\n\n  async checkAndNotifyUpcomingEvents(): Promise<void> {\n    try {\n      const now = new Date();\n      const notificationWindow = new Date(now.getTime() + 30 * 60 * 1000);\n\n      const upcomingEvents = await db\n        .select()\n        .from(economicEvents)\n        .where(\n          and(\n            eq(economicEvents.telegramNotified, false),\n            eq(economicEvents.isReleased, false),\n            gte(economicEvents.eventTime, now),\n            lte(economicEvents.eventTime, notificationWindow)\n          )\n        );\n\n      console.log(`Found ${upcomingEvents.length} events to notify`);\n\n      for (const event of upcomingEvents) {\n        await this.sendEventNotification(event);\n        await new Promise(resolve => setTimeout(resolve, 1000));\n      }\n    } catch (error) {\n      console.error('Error checking upcoming events:', error);\n    }\n  }\n\n  async checkAndNotifyTradingSessions(): Promise<void> {\n    try {\n      const now = new Date();\n      const currentUTC = now.getUTCHours() + now.getUTCMinutes() / 60;\n      const dayOfWeek = now.getUTCDay();\n      \n      const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;\n      if (isWeekend) {\n        return;\n      }\n\n      for (const session of HIGH_VOLUME_SESSIONS) {\n        const sessionKey = `${session.name}-${now.toISOString().split('T')[0]}-${Math.floor(session.openUTC)}`;\n        \n        if (this.notifiedSessions.has(sessionKey)) {\n          continue;\n        }\n\n        const minutesToOpen = (session.openUTC - currentUTC) * 60;\n        \n        if (minutesToOpen > 0 && minutesToOpen <= 5) {\n          const title = `🔔 ${session.name} Session Opening in 5 Minutes!`;\n          const message = `Opens in ${Math.ceil(minutesToOpen)} minutes - High volume trading session with increased volatility expected`;\n          \n          await notificationService.createNotification({\n            type: 'trading_session',\n            title,\n            message,\n            metadata: JSON.stringify({ session: session.name, minutesToOpen: Math.ceil(minutesToOpen) }),\n          });\n\n          if (this.isInitialized && this.bot) {\n            const subscribers = await db\n              .select()\n              .from(telegramSubscribers)\n              .where(eq(telegramSubscribers.isActive, true));\n\n            if (subscribers.length > 0) {\n              const telegramMessage = \n                `🔔 *${session.name} Session Opening in 5 Minutes!*\\n\\n` +\n                `⏰ Opens in ${Math.ceil(minutesToOpen)} minutes\\n` +\n                `🌍 High volume trading session\\n` +\n                `💹 Increased volatility expected\\n` +\n                `📊 Prepare your setups!\\n\\n` +\n                `🔗 www.findbuyandsellzones.com`;\n\n              for (const subscriber of subscribers) {\n                try {\n                  await this.bot.sendMessage(subscriber.chatId, telegramMessage, {\n                    parse_mode: 'Markdown',\n                  });\n                } catch (error) {\n                  console.error(`Failed to send session alert to ${subscriber.chatId}:`, error);\n                }\n              }\n            }\n          }\n\n          this.notifiedSessions.add(sessionKey);\n          console.log(`Sent ${session.name} session alert`);\n        }\n      }\n\n      const yesterday = new Date(now.getTime() - 24 * 60 * 60 * 1000);\n      Array.from(this.notifiedSessions).forEach(key => {\n        const dateStr = key.split('-').slice(1, 4).join('-');\n        if (new Date(dateStr) < yesterday) {\n          this.notifiedSessions.delete(key);\n        }\n      });\n\n    } catch (error) {\n      console.error('Error checking trading sessions:', error);\n    }\n  }\n\n\n  private escapeMarkdown(text: string): string {\n    if (!text) return '';\n    return text.replace(/[_*[\\]()~`>#+=|{}.!-]/g, '\\\\$&');\n  }\n\n  private formatPrice(price: any): string {\n    if (price === null || price === undefined) return 'N/A';\n    const num = parseFloat(price);\n    if (isNaN(num)) return String(price);\n    return num < 10 ? num.toFixed(5) : num.toFixed(2);\n  }\n\n  async sendTradingSignalNotification(signal: any): Promise<void> {\n    try {\n      if (!this.isInitialized || !this.bot) {\n        console.log('Telegram bot not initialized, skipping signal notification');\n        return;\n      }\n\n      const subscribers = await db\n        .select()\n        .from(telegramSubscribers)\n        .where(eq(telegramSubscribers.isActive, true));\n\n      if (subscribers.length === 0) {\n        console.log('No active Telegram subscribers for signal notification');\n        return;\n      }\n\n      const direction = signal.type || signal.direction || 'buy';\n      const typeEmoji = direction === 'buy' ? '🟢' : '🔴';\n      \n      const entryPrice = this.formatPrice(signal.entryPrice);\n      const stopLoss = this.formatPrice(signal.stopLoss);\n      const takeProfit = this.formatPrice(signal.takeProfit);\n      const riskReward = signal.riskRewardRatio ? parseFloat(signal.riskRewardRatio).toFixed(2) : '2.00';\n      const confidence = signal.overallConfidence || signal.confidence || 70;\n      const timeframe = signal.timeframe || '15M';\n      \n      const now = new Date();\n      const timeStr = format(now, 'MMM dd, HH:mm');\n      \n      const telegramCaption = \n        `${typeEmoji} *${signal.symbol}* │ ${direction.toUpperCase()}\\n` +\n        `━━━━━━━━━━━━━━━━━━━━\\n` +\n        `💰 Entry: ${entryPrice}\\n` +\n        `🛑 SL: ${stopLoss}\\n` +\n        `🎯 TP: ${takeProfit}\\n` +\n        `📊 R:R 1:${riskReward} │ ${confidence}% confidence\\n` +\n        `⏱ Timeframe: ${timeframe}\\n` +\n        `━━━━━━━━━━━━━━━━━━━━\\n` +\n        `🔗 www.findbuyandsellzones.com/signals\\n\\n` +\n        `⚠️ Educational only — not financial advice.`;\n\n      let chartBuffer: Buffer | null = null;\n      \n      try {\n        console.log(`[Telegram] Generating chart for ${signal.symbol}...`);\n        \n        const currentPrice = parseFloat(signal.entryPrice) || 0;\n        const mtfData = await fetchMultiTimeframeData(signal.symbol, signal.assetClass || 'forex', currentPrice);\n        \n        if (mtfData && mtfData.m15 && mtfData.m15.length > 0) {\n          const candles: ChartCandle[] = mtfData.m15.slice(-60).map(c => ({\n            date: new Date(c.timestamp).toISOString(),\n            open: c.open,\n            high: c.high,\n            low: c.low,\n            close: c.close,\n            volume: c.volume || 0,\n          }));\n          \n          const supplyZones: ZoneInfo[] = [];\n          const demandZones: ZoneInfo[] = [];\n          \n          if (signal.zones) {\n            if (signal.zones.m15) {\n              signal.zones.m15.forEach((zone: any) => {\n                if (zone.type === 'supply') {\n                  supplyZones.push({ top: zone.topPrice, bottom: zone.bottomPrice });\n                } else {\n                  demandZones.push({ top: zone.topPrice, bottom: zone.bottomPrice });\n                }\n              });\n            }\n            if (signal.zones.h4) {\n              signal.zones.h4.forEach((zone: any) => {\n                if (zone.type === 'supply') {\n                  supplyZones.push({ top: zone.topPrice, bottom: zone.bottomPrice });\n                } else {\n                  demandZones.push({ top: zone.topPrice, bottom: zone.bottomPrice });\n                }\n              });\n            }\n          }\n          \n          const chartResult = await generateTradingSignalChart(\n            signal.symbol,\n            timeframe,\n            candles,\n            {\n              direction: direction.toUpperCase() as 'BUY' | 'SELL',\n              entryPrice: parseFloat(signal.entryPrice) || 0,\n              stopLoss: parseFloat(signal.stopLoss) || 0,\n              takeProfit: parseFloat(signal.takeProfit) || 0,\n              confidence: confidence,\n            },\n            supplyZones,\n            demandZones\n          );\n          \n          if (chartResult.success && chartResult.path) {\n            chartBuffer = readChartAsBuffer(chartResult.path);\n            console.log(`[Telegram] Chart generated successfully: ${chartResult.path}`);\n          } else {\n            console.log(`[Telegram] Chart generation failed: ${chartResult.error}`);\n          }\n        }\n      } catch (chartError) {\n        console.error('[Telegram] Error generating chart:', chartError);\n      }\n\n      for (const subscriber of subscribers) {\n        try {\n          if (chartBuffer) {\n            await this.bot.sendPhoto(subscriber.chatId, chartBuffer, {\n              caption: telegramCaption,\n              parse_mode: 'Markdown',\n            });\n            console.log(`Trading signal with chart sent to Telegram subscriber ${subscriber.chatId}`);\n          } else {\n            await this.bot.sendMessage(subscriber.chatId, telegramCaption, {\n              parse_mode: 'Markdown',\n            });\n            console.log(`Trading signal (text only) sent to Telegram subscriber ${subscriber.chatId}`);\n          }\n        } catch (error) {\n          console.error(`Failed to send signal to Telegram ${subscriber.chatId}:`, error);\n        }\n      }\n\n    } catch (error) {\n      console.error('Error sending trading signal to Telegram:', error);\n    }\n  }\n\n  getBot(): TelegramBot | null {\n    return this.bot;\n  }\n\n  isReady(): boolean {\n    return this.isInitialized;\n  }\n}\n\nexport const telegramNotificationService = new TelegramNotificationService();\n","size_bytes":21796},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/components/examples/TradeHistory.tsx":{"content":"import TradeHistory from '../TradeHistory';\n\nexport default function TradeHistoryExample() {\n  return <TradeHistory />;\n}","size_bytes":121},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1592},"server/scrapers/economicCalendarScraper.ts":{"content":"import axios from 'axios';\nimport * as cheerio from 'cheerio';\nimport { ScraperConfig, scraperSettings, getRandomUserAgent, getActiveScrapers } from './config';\n\nexport interface ScrapedEvent {\n  title: string;\n  country: string;\n  countryCode?: string;\n  eventTime: Date;\n  impactLevel: string;\n  expectedValue?: string;\n  previousValue?: string;\n  actualValue?: string;\n  currency?: string;\n  sourceSite: string;\n  sourceUrl: string;\n}\n\nexport class EconomicCalendarScraper {\n  private lastRequestTime = 0;\n\n  private async delay(ms: number): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n\n  private async respectRateLimit(): Promise<void> {\n    const now = Date.now();\n    const timeSinceLastRequest = now - this.lastRequestTime;\n    \n    if (timeSinceLastRequest < scraperSettings.requestDelay) {\n      await this.delay(scraperSettings.requestDelay - timeSinceLastRequest);\n    }\n    \n    this.lastRequestTime = Date.now();\n  }\n\n  private async fetchHTML(url: string): Promise<string> {\n    await this.respectRateLimit();\n\n    try {\n      const response = await axios.get(url, {\n        headers: {\n          'User-Agent': getRandomUserAgent(),\n          'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',\n          'Accept-Language': 'en-US,en;q=0.9',\n          'Accept-Encoding': 'gzip, deflate, br',\n          'Connection': 'keep-alive',\n          'Upgrade-Insecure-Requests': '1',\n        },\n        timeout: scraperSettings.timeout,\n      });\n\n      return response.data;\n    } catch (error) {\n      console.error(`Failed to fetch ${url}:`, error);\n      throw error;\n    }\n  }\n\n  private parseInvestingCom(html: string, config: ScraperConfig): ScrapedEvent[] {\n    const $ = cheerio.load(html);\n    const events: ScrapedEvent[] = [];\n    const today = new Date();\n\n    $(config.selectors.eventRow!).each((_, element) => {\n      try {\n        const $row = $(element);\n        \n        const title = $row.find(config.selectors.eventName!).text().trim();\n        if (!title) return;\n\n        const countryText = $row.find(config.selectors.country!).attr('title') || '';\n        const timeText = $row.find(config.selectors.time!).text().trim();\n        const impactClass = $row.find(config.selectors.impact!).find('i').attr('class') || '';\n        const actual = $row.find(config.selectors.actual!).text().trim();\n        const forecast = $row.find(config.selectors.forecast!).text().trim();\n        const previous = $row.find(config.selectors.previous!).text().trim();\n\n        let impactLevel = 'Low';\n        if (impactClass.includes('bull3')) impactLevel = 'High';\n        else if (impactClass.includes('bull2')) impactLevel = 'Medium';\n\n        const eventTime = this.parseTimeString(timeText, today);\n        const countryCode = config.dataMapping?.countryCodes?.[countryText];\n\n        events.push({\n          title,\n          country: countryText,\n          countryCode: countryCode || this.extractCurrencyFromCountry(countryText),\n          eventTime,\n          impactLevel,\n          expectedValue: forecast || undefined,\n          previousValue: previous || undefined,\n          actualValue: actual || undefined,\n          currency: countryCode,\n          sourceSite: config.name,\n          sourceUrl: config.url,\n        });\n      } catch (error) {\n        console.error('Error parsing event row:', error);\n      }\n    });\n\n    return events;\n  }\n\n  private parseForexFactory(html: string, config: ScraperConfig): ScrapedEvent[] {\n    const $ = cheerio.load(html);\n    const events: ScrapedEvent[] = [];\n    const today = new Date();\n\n    $(config.selectors.eventRow!).each((_, element) => {\n      try {\n        const $row = $(element);\n        \n        const title = $row.find(config.selectors.eventName!).text().trim();\n        if (!title) return;\n\n        const currency = $row.find(config.selectors.country!).text().trim();\n        const timeText = $row.find(config.selectors.time!).text().trim();\n        const impactClass = $row.find(config.selectors.impact!).attr('class') || '';\n        const actual = $row.find(config.selectors.actual!).text().trim();\n        const forecast = $row.find(config.selectors.forecast!).text().trim();\n        const previous = $row.find(config.selectors.previous!).text().trim();\n\n        let impactLevel = 'Low';\n        if (impactClass.includes('red')) impactLevel = 'High';\n        else if (impactClass.includes('ora')) impactLevel = 'Medium';\n\n        const eventTime = this.parseTimeString(timeText, today);\n\n        events.push({\n          title,\n          country: this.getCurrencyCountry(currency),\n          countryCode: currency,\n          eventTime,\n          impactLevel,\n          expectedValue: forecast || undefined,\n          previousValue: previous || undefined,\n          actualValue: actual || undefined,\n          currency,\n          sourceSite: config.name,\n          sourceUrl: config.url,\n        });\n      } catch (error) {\n        console.error('Error parsing event row:', error);\n      }\n    });\n\n    return events;\n  }\n\n  private parseTimeString(timeStr: string, baseDate: Date): Date {\n    const time = new Date(baseDate);\n    \n    const timeMatch = timeStr.match(/(\\d{1,2}):(\\d{2})\\s*(AM|PM)?/i);\n    if (timeMatch) {\n      let hours = parseInt(timeMatch[1]);\n      const minutes = parseInt(timeMatch[2]);\n      const isPM = timeMatch[3]?.toUpperCase() === 'PM';\n      \n      if (isPM && hours < 12) hours += 12;\n      if (!isPM && hours === 12) hours = 0;\n      \n      time.setHours(hours, minutes, 0, 0);\n    }\n    \n    return time;\n  }\n\n  private extractCurrencyFromCountry(country: string): string {\n    const currencyMap: Record<string, string> = {\n      'United States': 'USD',\n      'Eurozone': 'EUR',\n      'Euro Zone': 'EUR',\n      'United Kingdom': 'GBP',\n      'Japan': 'JPY',\n      'Canada': 'CAD',\n      'Australia': 'AUD',\n      'New Zealand': 'NZD',\n      'Switzerland': 'CHF',\n      'China': 'CNY',\n    };\n    \n    return currencyMap[country] || 'USD';\n  }\n\n  private getCurrencyCountry(currency: string): string {\n    const countryMap: Record<string, string> = {\n      'USD': 'United States',\n      'EUR': 'Eurozone',\n      'GBP': 'United Kingdom',\n      'JPY': 'Japan',\n      'CAD': 'Canada',\n      'AUD': 'Australia',\n      'NZD': 'New Zealand',\n      'CHF': 'Switzerland',\n      'CNY': 'China',\n    };\n    \n    return countryMap[currency] || currency;\n  }\n\n  private parseEvents(html: string, config: ScraperConfig): ScrapedEvent[] {\n    switch (config.name) {\n      case 'Investing.com':\n        return this.parseInvestingCom(html, config);\n      case 'ForexFactory':\n        return this.parseForexFactory(html, config);\n      default:\n        console.warn(`No parser implemented for ${config.name}`);\n        return [];\n    }\n  }\n\n  async scrape(): Promise<ScrapedEvent[]> {\n    const scrapers = getActiveScrapers();\n    let allEvents: ScrapedEvent[] = [];\n    \n    for (const config of scrapers) {\n      try {\n        console.log(`Attempting to scrape from ${config.name}...`);\n        const html = await this.fetchHTML(config.url);\n        const events = this.parseEvents(html, config);\n        \n        console.log(`Successfully scraped ${events.length} events from ${config.name}`);\n        allEvents = allEvents.concat(events);\n        \n        if (events.length > 0) {\n          break;\n        }\n      } catch (error) {\n        console.error(`Failed to scrape ${config.name}:`, error);\n        \n        if (config.priority === scrapers[scrapers.length - 1].priority) {\n          console.error('All scrapers failed');\n        } else {\n          console.log('Falling back to next scraper...');\n        }\n      }\n    }\n\n    return this.deduplicateEvents(allEvents);\n  }\n\n  private deduplicateEvents(events: ScrapedEvent[]): ScrapedEvent[] {\n    const seen = new Set<string>();\n    const unique: ScrapedEvent[] = [];\n\n    for (const event of events) {\n      const key = `${event.title}-${event.eventTime.toISOString()}-${event.country}`;\n      if (!seen.has(key)) {\n        seen.add(key);\n        unique.push(event);\n      }\n    }\n\n    return unique;\n  }\n\n  async scrapeWithRetry(maxAttempts: number = scraperSettings.retryAttempts): Promise<ScrapedEvent[]> {\n    for (let attempt = 1; attempt <= maxAttempts; attempt++) {\n      try {\n        const events = await this.scrape();\n        if (events.length > 0) {\n          return events;\n        }\n      } catch (error) {\n        console.error(`Scrape attempt ${attempt} failed:`, error);\n        \n        if (attempt < maxAttempts) {\n          console.log(`Retrying in ${scraperSettings.retryDelay / 1000} seconds...`);\n          await this.delay(scraperSettings.retryDelay);\n        }\n      }\n    }\n\n    console.error('All scrape attempts failed');\n    return [];\n  }\n}\n\nexport const economicCalendarScraper = new EconomicCalendarScraper();\n","size_bytes":8870},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/components/TradingSession.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Badge } from '@/components/ui/badge';\nimport { Clock, Timer, Calendar } from 'lucide-react';\nimport { getActiveSessions, getSessionElapsedMinutes, getSessionTimeRemaining, formatMinutesToHoursAndMinutes, getMinutesUntilSessionOpen } from '@/lib/tradingSessions';\nimport { Card } from '@/components/ui/card';\n\nexport default function TradingSession() {\n  const [currentTime, setCurrentTime] = useState(new Date());\n  const [sessions, setSessions] = useState(getActiveSessions());\n  \n  useEffect(() => {\n    const timer = setInterval(() => {\n      setCurrentTime(new Date());\n      setSessions(getActiveSessions());\n    }, 1000);\n    return () => clearInterval(timer);\n  }, []);\n\n  const activeSessions = sessions.filter(s => s.isActive);\n\n  return (\n    <Card data-testid=\"card-trading-session\" className=\"border-blue-500/50\">\n      <div className=\"p-6\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-6\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"flex items-center justify-center w-10 h-10 rounded-md bg-blue-500/10\">\n              <Clock className=\"w-5 h-5 text-blue-500\" />\n            </div>\n            <div>\n              <h2 className=\"text-base font-extrabold text-foreground uppercase tracking-wide\">Trading Sessions</h2>\n              <p className=\"text-xs text-muted-foreground font-semibold tabular-nums\" data-testid=\"text-current-time\">\n                {currentTime.toLocaleTimeString('en-US', { timeZone: 'UTC', hour12: false })} UTC\n              </p>\n            </div>\n          </div>\n          \n          {activeSessions.length > 0 && (\n            <div className=\"flex gap-2 flex-wrap\">\n              {activeSessions.map(session => (\n                <Badge \n                  key={session.name}\n                  variant=\"default\" \n                  className=\"text-[10px] font-bold uppercase tracking-wider px-2 py-1\"\n                  style={{ backgroundColor: session.color }}\n                  data-testid={`badge-active-${session.name.toLowerCase()}`}\n                >\n                  {session.name}\n                </Badge>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Session Grid */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3\">\n          {sessions.map((session) => {\n            const elapsed = getSessionElapsedMinutes(session);\n            const remaining = getSessionTimeRemaining(session);\n            const total = elapsed + remaining;\n            const progress = total > 0 ? (elapsed / total) * 100 : 0;\n            const minutesUntilOpen = getMinutesUntilSessionOpen(session);\n            \n            return (\n              <div\n                key={session.name}\n                className={`relative overflow-hidden rounded-lg border-2 p-4 transition-all ${\n                  session.isActive \n                    ? 'bg-card border-border hover-elevate' \n                    : 'bg-muted/30 border-border/50 opacity-60'\n                }`}\n                style={session.isActive ? { borderLeftColor: session.color, borderLeftWidth: '4px' } : {}}\n                data-testid={`card-session-${session.name.toLowerCase()}`}\n              >\n                {/* Session Name and Status */}\n                <div className=\"mb-3\">\n                  <div className=\"flex items-center justify-between mb-1\">\n                    <h3 className=\"text-sm font-extrabold text-foreground uppercase tracking-tight\">\n                      {session.name}\n                    </h3>\n                    <Badge \n                      variant={session.isActive ? \"default\" : \"secondary\"}\n                      className=\"text-[9px] font-bold uppercase px-1.5 py-0.5\"\n                      style={session.isActive ? { backgroundColor: session.color } : {}}\n                    >\n                      {session.isActive ? 'LIVE' : 'CLOSED'}\n                    </Badge>\n                  </div>\n                  <p className=\"text-[10px] text-muted-foreground font-mono font-semibold\">\n                    {session.openTime} - {session.closeTime} UTC\n                  </p>\n                </div>\n\n                {/* Active Session Timer */}\n                {session.isActive && (\n                  <div className=\"space-y-3\" data-testid=\"card-session-details\">\n                    {/* Elapsed and Remaining Time */}\n                    <div className=\"grid grid-cols-2 gap-2\">\n                      <div className=\"bg-muted/30 rounded-md p-2\">\n                        <div className=\"flex items-center gap-1 mb-1\">\n                          <Timer className=\"w-3 h-3 text-emerald-600 dark:text-emerald-400\" />\n                          <span className=\"text-[9px] text-muted-foreground font-bold uppercase tracking-wide\">Elapsed</span>\n                        </div>\n                        <div className=\"text-xs font-extrabold text-foreground tabular-nums\" data-testid={`text-elapsed-time-${session.name.toLowerCase()}`}>\n                          {formatMinutesToHoursAndMinutes(elapsed)}\n                        </div>\n                      </div>\n                      <div className=\"bg-muted/30 rounded-md p-2\">\n                        <div className=\"flex items-center gap-1 mb-1\">\n                          <Clock className=\"w-3 h-3 text-amber-600 dark:text-amber-400\" />\n                          <span className=\"text-[9px] text-muted-foreground font-bold uppercase tracking-wide\">Remaining</span>\n                        </div>\n                        <div className=\"text-xs font-extrabold text-foreground tabular-nums\" data-testid={`text-remaining-time-${session.name.toLowerCase()}`}>\n                          {formatMinutesToHoursAndMinutes(remaining)}\n                        </div>\n                      </div>\n                    </div>\n                    \n                    {/* Progress Bar */}\n                    <div className=\"space-y-1\">\n                      <div className=\"h-1.5 bg-muted rounded-full overflow-hidden\">\n                        <div \n                          className=\"h-full transition-all duration-1000\"\n                          style={{ \n                            width: `${progress}%`,\n                            backgroundColor: session.color\n                          }}\n                        />\n                      </div>\n                      <div className=\"text-center\">\n                        <span className=\"text-[10px] font-bold text-muted-foreground\">{Math.round(progress)}% Complete</span>\n                      </div>\n                    </div>\n                  </div>\n                )}\n                \n                {/* Closed Session Timer */}\n                {!session.isActive && (\n                  <div className=\"space-y-2\" data-testid=\"card-session-closed\">\n                    <div className=\"bg-muted/30 rounded-md p-3\">\n                      <div className=\"flex items-center gap-2 mb-2\">\n                        <Calendar className=\"w-4 h-4 text-muted-foreground opacity-50\" />\n                        <span className=\"text-[9px] text-muted-foreground font-bold uppercase tracking-wide\">Opens In</span>\n                      </div>\n                      <div className=\"text-sm font-extrabold text-foreground tabular-nums\">\n                        {formatMinutesToHoursAndMinutes(minutesUntilOpen)}\n                      </div>\n                    </div>\n                  </div>\n                )}\n              </div>\n            );\n          })}\n        </div>\n      </div>\n    </Card>\n  );\n}","size_bytes":7604},"client/src/components/TradingSignals.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Target, Clock, Eye, BarChart3, Timer } from 'lucide-react';\n\ninterface TradingSignal {\n  id: string;\n  symbol: string;\n  assetClass: string;\n  type: string;\n  strategy: string;\n  entryPrice: string;\n  stopLoss: string;\n  takeProfit: string;\n  riskRewardRatio: string;\n  primaryTimeframe: string;\n  overallConfidence: number;\n  interestRateDiffScore?: string;\n  inflationImpactScore?: string;\n  trendScore?: string;\n  smcScore?: string;\n  institutionalCandleDetected?: boolean;\n  smcFactors?: string[];\n  technicalReasons?: string[];\n  marketContext?: string;\n  status: string;\n  strength?: string;\n  createdAt: Date;\n  expiresAt?: Date;\n}\n\nfunction CountdownTimer({ expiresAt }: { expiresAt?: Date }) {\n  const [timeRemaining, setTimeRemaining] = useState<string>('');\n\n  useEffect(() => {\n    if (!expiresAt) return;\n\n    const updateTimer = () => {\n      const now = new Date();\n      const expiry = new Date(expiresAt);\n      const diffMs = expiry.getTime() - now.getTime();\n\n      if (diffMs <= 0) {\n        setTimeRemaining('EXPIRED');\n        return;\n      }\n\n      const hours = Math.floor(diffMs / (1000 * 60 * 60));\n      const minutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));\n      const seconds = Math.floor((diffMs % (1000 * 60)) / 1000);\n\n      setTimeRemaining(`${hours}h ${minutes}m ${seconds}s`);\n    };\n\n    updateTimer();\n    const interval = setInterval(updateTimer, 1000);\n\n    return () => clearInterval(interval);\n  }, [expiresAt]);\n\n  if (!expiresAt) return <span className=\"text-muted-foreground\">No expiry</span>;\n\n  return (\n    <span className={timeRemaining === 'EXPIRED' ? 'text-red-500 font-semibold' : 'text-foreground'}>\n      {timeRemaining}\n    </span>\n  );\n}\n\ninterface TradingSignalsProps {\n  assetClassFilter?: string;\n  title?: string;\n}\n\nexport default function TradingSignals({ assetClassFilter, title }: TradingSignalsProps = {}) {\n  const [selectedSignal, setSelectedSignal] = useState<string | null>(null);\n  \n  const { data: allSignals = [], isLoading } = useQuery<TradingSignal[]>({\n    queryKey: ['/api/trading-signals'],\n    refetchInterval: 10000,\n  });\n\n  const signals = assetClassFilter \n    ? allSignals.filter(s => s.assetClass === assetClassFilter)\n    : allSignals;\n\n  const activeSignals = signals.filter(s => s.status === 'active');\n  const previousSignals = signals.filter(s => s.status === 'expired' || s.status === 'invalidated');\n\n  const displayTitle = title || 'Currency, Gold, Oil and Crypto Signals';\n\n  const getSignalTypeColor = (type: string) => {\n    return type === 'buy' ? 'hsl(120 60% 50%)' : 'hsl(0 75% 60%)';\n  };\n\n  const getConfidenceColor = (confidence: number) => {\n    if (confidence >= 80) return 'hsl(120 60% 50%)';\n    if (confidence >= 60) return 'hsl(45 90% 60%)';\n    return 'hsl(0 75% 60%)';\n  };\n\n  const formatTimeAgo = (timestamp: Date) => {\n    const now = new Date();\n    const diffMs = now.getTime() - new Date(timestamp).getTime();\n    const diffMins = Math.floor(diffMs / (1000 * 60));\n    \n    if (diffMins < 60) return `${diffMins}m ago`;\n    const diffHours = Math.floor(diffMins / 60);\n    if (diffHours < 24) return `${diffHours}h ago`;\n    return `${Math.floor(diffHours / 24)}d ago`;\n  };\n\n  if (isLoading) {\n    return (\n      <div data-testid=\"card-trading-signals\" className=\"bg-white dark:bg-background\">\n        <div className=\"pb-4 mb-4 border-b border-border/50\">\n          <div className=\"flex items-center gap-2 text-lg font-semibold\">\n            <Target className=\"w-5 h-5\" />\n            {displayTitle}\n            <Badge variant=\"secondary\" className=\"ml-auto mr-2\">Loading...</Badge>\n          </div>\n        </div>\n        <div className=\"text-center py-8 text-muted-foreground\">Scanning markets for signals...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div data-testid=\"card-trading-signals\" className=\"bg-white dark:bg-background\">\n      <div className=\"pb-4 mb-4 border-b border-border/50\">\n        <div className=\"flex items-center gap-2 text-lg font-semibold\">\n          <Target className=\"w-5 h-5\" />\n          {displayTitle}\n          <Badge variant=\"secondary\" className=\"ml-auto mr-2\">\n            {activeSignals.length}/{signals.length} Active\n          </Badge>\n        </div>\n      </div>\n      <div>\n        {activeSignals.length === 0 && previousSignals.length === 0 ? (\n          <div className=\"text-center py-8 text-muted-foreground\">\n            <p>No signals detected yet</p>\n            <p className=\"text-sm mt-2\">Scanning 62 instruments every minute...</p>\n          </div>\n        ) : (\n          <div>\n            {/* Active Signals Section */}\n            {activeSignals.length > 0 && (\n              <div>\n                <div className=\"divide-y divide-border/50\">\n                  {activeSignals.map((signal) => (\n                    <div\n                      key={signal.id}\n                      className={`py-4 transition-all ${\n                        selectedSignal === signal.id ? 'bg-primary/5' : 'hover-elevate'\n                      }`}\n                      data-testid={`card-signal-${signal.id}`}\n                    >\n                      <div className=\"flex items-start justify-between mb-3\">\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"relative\">\n                            <div className=\"absolute left-0 top-0 bottom-0 w-0.5\" style={{ backgroundColor: getSignalTypeColor(signal.type) }} />\n                            <Badge \n                              variant=\"secondary\"\n                              className=\"text-xs font-medium ml-3\"\n                              style={{ \n                                backgroundColor: getSignalTypeColor(signal.type) + '20', \n                                color: getSignalTypeColor(signal.type) \n                              }}\n                            >\n                              {signal.type.toUpperCase()}\n                            </Badge>\n                          </div>\n                          <div>\n                            <h4 className=\"font-semibold text-sm\" data-testid={`text-symbol-${signal.id}`}>\n                              {signal.symbol}\n                            </h4>\n                            <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                              <span>{signal.strategy}</span>\n                              <span>•</span>\n                              <span>{signal.primaryTimeframe}</span>\n                              <span>•</span>\n                              <span className=\"flex items-center gap-1\">\n                                <Clock className=\"w-3 h-3\" />\n                                {formatTimeAgo(signal.createdAt)}\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n                        \n                        <div className=\"flex flex-col items-end gap-1.5 mr-2\">\n                          <div className=\"flex items-center gap-2\">\n                            <Badge \n                              variant=\"outline\"\n                              className=\"text-xs\"\n                              style={{ \n                                borderColor: getConfidenceColor(signal.overallConfidence), \n                                color: getConfidenceColor(signal.overallConfidence) \n                              }}\n                            >\n                              {signal.overallConfidence}%\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center gap-1 text-xs\">\n                            <Timer className=\"w-3 h-3 text-muted-foreground\" />\n                            <CountdownTimer expiresAt={signal.expiresAt} />\n                          </div>\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-stretch gap-0 text-xs mb-3 ml-3\">\n                        <div className=\"flex-1 pr-4 border-r border-border/50\">\n                          <span className=\"text-muted-foreground\">Entry:</span>\n                          <div className=\"font-mono font-semibold\" data-testid={`text-entry-${signal.id}`}>\n                            {parseFloat(signal.entryPrice).toLocaleString()}\n                          </div>\n                        </div>\n                        <div className=\"flex-1 px-4 border-r border-border/50\">\n                          <span className=\"text-muted-foreground\">Stop Loss:</span>\n                          <div className=\"font-mono font-semibold text-red-500\">\n                            {parseFloat(signal.stopLoss).toLocaleString()}\n                          </div>\n                        </div>\n                        <div className=\"flex-1 px-4 border-r border-border/50\">\n                          <span className=\"text-muted-foreground\">Take Profit:</span>\n                          <div className=\"font-mono font-semibold text-green-500\">\n                            {parseFloat(signal.takeProfit).toLocaleString()}\n                          </div>\n                        </div>\n                        <div className=\"flex-1 pl-4\">\n                          <span className=\"text-muted-foreground\">R:R Ratio:</span>\n                          <div className=\"font-mono font-semibold\" data-testid={`text-rr-${signal.id}`}>\n                            1:{signal.riskRewardRatio}\n                          </div>\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-center justify-between ml-3 pt-3 border-t border-border/30\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => setSelectedSignal(selectedSignal === signal.id ? null : signal.id)}\n                          className=\"text-xs\"\n                          data-testid={`button-details-${signal.id}`}\n                        >\n                          <Eye className=\"w-3 h-3 mr-1\" />\n                          {selectedSignal === signal.id ? 'Hide' : 'Show'} Details\n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => console.log(`Viewing chart for ${signal.symbol}`)}\n                          className=\"text-xs\"\n                          data-testid={`button-chart-${signal.id}`}\n                        >\n                          <BarChart3 className=\"w-3 h-3 mr-1\" />\n                          View Chart\n                        </Button>\n                      </div>\n\n                      {selectedSignal === signal.id && (\n                        <div className=\"mt-4 pt-4 ml-3 border-t border-border space-y-4\" data-testid={`details-${signal.id}`}>\n                          <div className=\"grid grid-cols-2 gap-4\">\n                            <div className=\"space-y-2\">\n                              <h5 className=\"font-medium text-sm\">Scoring Breakdown</h5>\n                              <div className=\"space-y-1.5 text-xs\">\n                                {signal.interestRateDiffScore && (\n                                  <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-muted-foreground\">Interest Rate (40%):</span>\n                                    <Badge variant=\"outline\" className=\"text-xs\">\n                                      {parseFloat(signal.interestRateDiffScore).toFixed(1)}\n                                    </Badge>\n                                  </div>\n                                )}\n                                {signal.inflationImpactScore && (\n                                  <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-muted-foreground\">Inflation (25%):</span>\n                                    <Badge variant=\"outline\" className=\"text-xs\">\n                                      {parseFloat(signal.inflationImpactScore).toFixed(1)}\n                                    </Badge>\n                                  </div>\n                                )}\n                                {signal.trendScore && (\n                                  <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-muted-foreground\">Trend (20%):</span>\n                                    <Badge variant=\"outline\" className=\"text-xs\">\n                                      {parseFloat(signal.trendScore).toFixed(1)}\n                                    </Badge>\n                                  </div>\n                                )}\n                                {signal.smcScore && (\n                                  <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-muted-foreground\">SMC (15%):</span>\n                                    <Badge variant=\"outline\" className=\"text-xs\">\n                                      {parseFloat(signal.smcScore).toFixed(1)}\n                                    </Badge>\n                                  </div>\n                                )}\n                              </div>\n                            </div>\n\n                            <div className=\"space-y-2\">\n                              <h5 className=\"font-medium text-sm\">Signal Attributes</h5>\n                              <div className=\"space-y-1.5 text-xs\">\n                                {signal.strength && (\n                                  <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-muted-foreground\">Strength:</span>\n                                    <Badge variant=\"secondary\" className=\"text-xs capitalize\">\n                                      {signal.strength}\n                                    </Badge>\n                                  </div>\n                                )}\n                                {signal.institutionalCandleDetected !== undefined && (\n                                  <div className=\"flex justify-between items-center\">\n                                    <span className=\"text-muted-foreground\">Institutional Candle:</span>\n                                    <Badge \n                                      variant={signal.institutionalCandleDetected ? \"default\" : \"outline\"} \n                                      className=\"text-xs\"\n                                    >\n                                      {signal.institutionalCandleDetected ? 'Detected' : 'None'}\n                                    </Badge>\n                                  </div>\n                                )}\n                                <div className=\"flex justify-between items-center\">\n                                  <span className=\"text-muted-foreground\">Asset Class:</span>\n                                  <Badge variant=\"outline\" className=\"text-xs capitalize\">\n                                    {signal.assetClass}\n                                  </Badge>\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n\n                          <div>\n                            <h5 className=\"font-medium text-sm mb-2\">Technical Analysis Reasoning:</h5>\n                            <ul className=\"space-y-1 text-xs\">\n                              {signal.technicalReasons?.map((reason, index) => (\n                                <li key={index} className=\"flex items-center gap-2\">\n                                  <div className=\"w-1 h-1 rounded-full bg-primary\" />\n                                  {reason}\n                                </li>\n                              ))}\n                            </ul>\n                          </div>\n                          \n                          {signal.smcFactors && signal.smcFactors.length > 0 && (\n                            <div>\n                              <h5 className=\"font-medium text-sm mb-2\">Smart Money Concepts:</h5>\n                              <ul className=\"space-y-1 text-xs\">\n                                {signal.smcFactors.map((factor, index) => (\n                                  <li key={index} className=\"flex items-center gap-2\">\n                                    <div className=\"w-1 h-1 rounded-full bg-secondary\" />\n                                    {factor}\n                                  </li>\n                                ))}\n                              </ul>\n                            </div>\n                          )}\n\n                          {signal.marketContext && (\n                            <div>\n                              <h5 className=\"font-medium text-sm mb-2\">Market Context:</h5>\n                              <p className=\"text-xs text-muted-foreground\">{signal.marketContext}</p>\n                            </div>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Previous Signals Section */}\n            {previousSignals.length > 0 && (\n              <div className=\"mt-6 pt-6 border-t-2 border-border/60\">\n                <h3 className=\"text-sm font-semibold mb-4 pb-2 text-muted-foreground uppercase tracking-wide border-b-2 border-border/60\">\n                  Recently Expired\n                  <span className=\"ml-2 text-xs font-normal normal-case\">(Before Archive)</span>\n                </h3>\n                <div className=\"divide-y divide-border/50\">\n                  {previousSignals.map((signal) => (\n                    <div\n                      key={signal.id}\n                      className=\"py-3 opacity-75\"\n                      data-testid={`card-prev-signal-${signal.id}`}\n                    >\n                      <div className=\"flex items-start justify-between mb-2\">\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"relative\">\n                            <div className=\"absolute left-0 top-0 bottom-0 w-0.5 opacity-50\" style={{ backgroundColor: getSignalTypeColor(signal.type) }} />\n                            <Badge \n                              variant=\"secondary\"\n                              className=\"text-xs font-medium opacity-75 ml-3\"\n                              style={{ \n                                backgroundColor: getSignalTypeColor(signal.type) + '20', \n                                color: getSignalTypeColor(signal.type) \n                              }}\n                            >\n                              {signal.type.toUpperCase()}\n                            </Badge>\n                          </div>\n                          <div>\n                            <h4 className=\"font-semibold text-sm\">\n                              {signal.symbol}\n                            </h4>\n                            <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                              <span>{signal.strategy}</span>\n                              <span>•</span>\n                              <span>{signal.primaryTimeframe}</span>\n                              <span>•</span>\n                              <span className=\"flex items-center gap-1\">\n                                <Clock className=\"w-3 h-3\" />\n                                {formatTimeAgo(signal.createdAt)}\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n                        \n                        <Badge variant=\"outline\" className=\"text-xs mr-2\">\n                          EXPIRED\n                        </Badge>\n                      </div>\n\n                      <div className=\"flex items-stretch gap-0 text-xs ml-3 pt-2 border-t border-border/30\">\n                        <div className=\"flex-1 pr-4 border-r border-border/50\">\n                          <span className=\"text-muted-foreground\">Entry:</span>\n                          <div className=\"font-mono font-semibold\">\n                            {parseFloat(signal.entryPrice).toLocaleString()}\n                          </div>\n                        </div>\n                        <div className=\"flex-1 px-4 border-r border-border/50\">\n                          <span className=\"text-muted-foreground\">R:R:</span>\n                          <div className=\"font-mono font-semibold\">\n                            1:{signal.riskRewardRatio}\n                          </div>\n                        </div>\n                        <div className=\"flex-1 px-4 border-r border-border/50\">\n                          <span className=\"text-muted-foreground\">Confidence:</span>\n                          <div className=\"font-mono font-semibold\">\n                            {signal.overallConfidence}%\n                          </div>\n                        </div>\n                        <div className=\"flex-1 pl-4\">\n                          <span className=\"text-muted-foreground\">Status:</span>\n                          <div className=\"font-semibold text-green-500\">\n                            {signal.status.toUpperCase()}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":21916},"client/src/components/InstrumentsToWatch.tsx":{"content":"import { useState } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Eye, TrendingUp, TrendingDown, Target, Layers } from 'lucide-react';\n\ninterface PendingSetup {\n  id: string;\n  symbol: string;\n  assetClass: string;\n  type: string;\n  setupStage: string;\n  potentialStrategy?: string;\n  currentPrice: string;\n  primaryTimeframe: string;\n  confirmationTimeframe?: string;\n  interestRateBias?: string;\n  inflationBias?: string;\n  trendBias?: string;\n  chochDetected?: boolean;\n  chochDirection?: string;\n  liquiditySweepDetected?: boolean;\n  supplyDemandZoneTargeted?: boolean;\n  zoneLevel?: string;\n  zoneMitigated?: boolean;\n  levelsBroken?: number;\n  confirmationsPending?: string[];\n  setupNotes?: string[];\n  marketContext?: string;\n  lastCheckedAt: Date;\n  readyForSignal?: boolean;\n  createdAt: Date;\n}\n\ninterface InstrumentsToWatchProps {\n  assetClassFilter?: string;\n}\n\nexport default function InstrumentsToWatch({ assetClassFilter }: InstrumentsToWatchProps = {}) {\n  const [selectedSetupId, setSelectedSetupId] = useState<string | null>(null);\n  \n  const { data: allPendingSetups = [], isLoading } = useQuery<PendingSetup[]>({\n    queryKey: ['/api/pending-setups'],\n    refetchInterval: 15000,\n  });\n\n  const pendingSetups = assetClassFilter\n    ? allPendingSetups.filter(s => s.assetClass === assetClassFilter)\n    : allPendingSetups;\n\n  const activeSetups = pendingSetups.filter(s => !s.readyForSignal);\n\n  const getSetupTypeColor = (type: string) => {\n    return type === 'buy' ? 'hsl(120 60% 50%)' : 'hsl(0 75% 60%)';\n  };\n\n  const getStageColor = (stage: string) => {\n    if (stage === 'forming') return 'text-yellow-500';\n    if (stage === 'monitoring') return 'text-blue-500';\n    return 'text-purple-500';\n  };\n\n  const formatTimeAgo = (timestamp: Date) => {\n    const now = new Date();\n    const diffMs = now.getTime() - new Date(timestamp).getTime();\n    const diffMins = Math.floor(diffMs / (1000 * 60));\n    \n    if (diffMins < 60) return `${diffMins}m ago`;\n    const diffHours = Math.floor(diffMins / 60);\n    if (diffHours < 24) return `${diffHours}h ago`;\n    return `${Math.floor(diffHours / 24)}d ago`;\n  };\n\n  if (isLoading) {\n    return (\n      <div data-testid=\"card-instruments-watch\" className=\"bg-white dark:bg-background p-6\">\n        <div className=\"flex items-center gap-2 text-lg font-semibold mb-4\">\n          <Eye className=\"w-5 h-5\" />\n          Instruments to Watch\n        </div>\n        <div className=\"text-center py-8 text-muted-foreground\">\n          <p>Loading pending setups...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div data-testid=\"card-instruments-watch\" className=\"bg-white dark:bg-background\">\n      <div className=\"pb-4 mb-4 border-b-2 border-border/60\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2 text-lg font-semibold\">\n            <Eye className=\"w-5 h-5\" />\n            Instruments to Watch\n          </div>\n          <Badge variant=\"secondary\" className=\"mr-2\">\n            {activeSetups.length} Forming\n          </Badge>\n        </div>\n        <p className=\"text-xs text-muted-foreground mt-1\">\n          Setups pending confirmation - price action developing\n        </p>\n      </div>\n\n      <div>\n        {activeSetups.length === 0 ? (\n          <div className=\"text-center py-8 text-muted-foreground\">\n            <p>No pending setups at the moment</p>\n            <p className=\"text-sm mt-2\">Watching for potential opportunities...</p>\n          </div>\n        ) : (\n          <div className=\"divide-y divide-border/50\">\n            {activeSetups.map((setup) => (\n              <div\n                key={setup.id}\n                className=\"py-4\"\n                data-testid={`card-setup-${setup.id}`}\n              >\n                <div className=\"flex items-start justify-between mb-3\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"relative\">\n                      <div \n                        className=\"absolute left-0 top-0 bottom-0 w-0.5\" \n                        style={{ backgroundColor: getSetupTypeColor(setup.type) }} \n                      />\n                      <Badge \n                        variant=\"secondary\"\n                        className=\"text-xs font-medium ml-3\"\n                        style={{ \n                          backgroundColor: getSetupTypeColor(setup.type) + '20', \n                          color: getSetupTypeColor(setup.type) \n                        }}\n                      >\n                        {setup.type.toUpperCase()}\n                      </Badge>\n                    </div>\n                    <div>\n                      <h4 className=\"font-semibold text-sm\" data-testid={`text-symbol-${setup.id}`}>\n                        {setup.symbol}\n                      </h4>\n                      <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                        <span className={getStageColor(setup.setupStage)}>\n                          {setup.setupStage.toUpperCase()}\n                        </span>\n                        {setup.potentialStrategy && (\n                          <>\n                            <span>•</span>\n                            <span>{setup.potentialStrategy}</span>\n                          </>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <Badge variant=\"outline\" className=\"text-xs mr-2 capitalize\">\n                    {setup.assetClass}\n                  </Badge>\n                </div>\n\n                <div className=\"flex items-stretch gap-0 text-xs mb-3 ml-3\">\n                  <div className=\"flex-1 pr-4 border-r border-border/50\">\n                    <span className=\"text-muted-foreground\">Current:</span>\n                    <div className=\"font-mono font-semibold\">\n                      {parseFloat(setup.currentPrice).toLocaleString()}\n                    </div>\n                  </div>\n                  {setup.zoneLevel && (\n                    <div className=\"flex-1 px-4 border-r border-border/50\">\n                      <span className=\"text-muted-foreground\">Zone:</span>\n                      <div className=\"font-mono font-semibold text-blue-500\">\n                        {parseFloat(setup.zoneLevel).toLocaleString()}\n                      </div>\n                    </div>\n                  )}\n                  <div className=\"flex-1 pl-4\">\n                    <span className=\"text-muted-foreground\">TF:</span>\n                    <div className=\"font-semibold\">\n                      {setup.primaryTimeframe}\n                    </div>\n                  </div>\n                </div>\n\n                {/* SMC Indicators */}\n                <div className=\"flex items-center gap-2 text-xs ml-3 mb-3\">\n                  {setup.chochDetected && (\n                    <Badge variant=\"default\" className=\"text-xs\">\n                      <Layers className=\"w-3 h-3 mr-1\" />\n                      CHoCH {setup.chochDirection}\n                    </Badge>\n                  )}\n                  {setup.liquiditySweepDetected && (\n                    <Badge variant=\"default\" className=\"text-xs\">\n                      <Target className=\"w-3 h-3 mr-1\" />\n                      Liquidity Sweep\n                    </Badge>\n                  )}\n                  {setup.supplyDemandZoneTargeted && (\n                    <Badge variant=\"secondary\" className=\"text-xs\">\n                      S/D Zone Targeted\n                    </Badge>\n                  )}\n                  {setup.levelsBroken && setup.levelsBroken > 0 && (\n                    <Badge variant=\"outline\" className=\"text-xs\">\n                      {setup.levelsBroken} Levels Broken\n                    </Badge>\n                  )}\n                </div>\n\n                {/* Confirmations Pending */}\n                {setup.confirmationsPending && setup.confirmationsPending.length > 0 && (\n                  <div className=\"ml-3 mb-3\">\n                    <p className=\"text-xs text-muted-foreground mb-1\">Waiting for:</p>\n                    <div className=\"flex flex-wrap gap-1.5\">\n                      {setup.confirmationsPending.map((confirmation, idx) => (\n                        <Badge key={idx} variant=\"outline\" className=\"text-xs\">\n                          {confirmation}\n                        </Badge>\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                {/* Setup Notes */}\n                {setup.setupNotes && setup.setupNotes.length > 0 && (\n                  <div className=\"ml-3 pt-3 border-t border-border/30\">\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => setSelectedSetupId(selectedSetupId === setup.id ? null : setup.id)}\n                      className=\"text-xs mb-2\"\n                      data-testid={`button-details-${setup.id}`}\n                    >\n                      <Eye className=\"w-3 h-3 mr-1\" />\n                      {selectedSetupId === setup.id ? 'Hide' : 'Show'} Analysis\n                    </Button>\n\n                    {selectedSetupId === setup.id && (\n                      <div className=\"space-y-2\" data-testid={`details-${setup.id}`}>\n                        <div>\n                          <h5 className=\"font-medium text-xs mb-1\">Setup Analysis:</h5>\n                          <ul className=\"space-y-1 text-xs\">\n                            {setup.setupNotes.map((note, index) => (\n                              <li key={index} className=\"flex items-start gap-2\">\n                                <div className=\"w-1 h-1 rounded-full bg-primary mt-1.5 shrink-0\" />\n                                <span className=\"text-muted-foreground\">{note}</span>\n                              </li>\n                            ))}\n                          </ul>\n                        </div>\n\n                        {setup.marketContext && (\n                          <div>\n                            <h5 className=\"font-medium text-xs mb-1\">Market Context:</h5>\n                            <p className=\"text-xs text-muted-foreground\">{setup.marketContext}</p>\n                          </div>\n                        )}\n\n                        {/* Bias Indicators */}\n                        {(setup.trendBias || setup.interestRateBias || setup.inflationBias) && (\n                          <div>\n                            <h5 className=\"font-medium text-xs mb-1\">Bias Analysis:</h5>\n                            <div className=\"flex flex-wrap gap-2\">\n                              {setup.trendBias && (\n                                <Badge variant=\"outline\" className=\"text-xs\">\n                                  Trend: {setup.trendBias}\n                                </Badge>\n                              )}\n                              {setup.interestRateBias && (\n                                <Badge variant=\"outline\" className=\"text-xs\">\n                                  IR: {setup.interestRateBias}\n                                </Badge>\n                              )}\n                              {setup.inflationBias && (\n                                <Badge variant=\"outline\" className=\"text-xs\">\n                                  Inflation: {setup.inflationBias}\n                                </Badge>\n                              )}\n                            </div>\n                          </div>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                )}\n\n                <div className=\"text-xs text-muted-foreground ml-3 mt-2\">\n                  Last checked: {formatTimeAgo(setup.lastCheckedAt)}\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":12046},"server/services/marketData.ts":{"content":"export interface InterestRateData {\n  currency: string;\n  rate: number;\n  lastUpdate: Date;\n}\n\nexport interface InflationData {\n  country: string;\n  currency: string;\n  rate: number;\n  lastUpdate: Date;\n}\n\nexport interface Candle {\n  timeframe: string;\n  open: number;\n  high: number;\n  low: number;\n  close: number;\n  volume: number;\n  timestamp: Date;\n}\n\nexport const CURRENT_INTEREST_RATES: Record<string, InterestRateData> = {\n  USD: { currency: 'USD', rate: 5.50, lastUpdate: new Date('2025-10-01') },\n  EUR: { currency: 'EUR', rate: 4.00, lastUpdate: new Date('2025-10-01') },\n  GBP: { currency: 'GBP', rate: 5.25, lastUpdate: new Date('2025-10-01') },\n  JPY: { currency: 'JPY', rate: 0.25, lastUpdate: new Date('2025-10-01') },\n  AUD: { currency: 'AUD', rate: 4.35, lastUpdate: new Date('2025-10-01') },\n  CAD: { currency: 'CAD', rate: 5.00, lastUpdate: new Date('2025-10-01') },\n  CHF: { currency: 'CHF', rate: 1.75, lastUpdate: new Date('2025-10-01') },\n  NZD: { currency: 'NZD', rate: 5.50, lastUpdate: new Date('2025-10-01') },\n};\n\nexport const CURRENT_INFLATION: Record<string, InflationData> = {\n  USD: { country: 'United States', currency: 'USD', rate: 3.2, lastUpdate: new Date('2025-09-01') },\n  EUR: { country: 'Eurozone', currency: 'EUR', rate: 2.4, lastUpdate: new Date('2025-09-01') },\n  GBP: { country: 'United Kingdom', currency: 'GBP', rate: 4.0, lastUpdate: new Date('2025-09-01') },\n  JPY: { country: 'Japan', currency: 'JPY', rate: 2.8, lastUpdate: new Date('2025-09-01') },\n  AUD: { country: 'Australia', currency: 'AUD', rate: 5.1, lastUpdate: new Date('2025-09-01') },\n  CAD: { country: 'Canada', currency: 'CAD', rate: 3.6, lastUpdate: new Date('2025-09-01') },\n  CHF: { country: 'Switzerland', currency: 'CHF', rate: 1.7, lastUpdate: new Date('2025-09-01') },\n  NZD: { country: 'New Zealand', currency: 'NZD', rate: 5.6, lastUpdate: new Date('2025-09-01') },\n};\n\nexport function parseCurrencyPair(symbol: string): { base: string; quote: string } | null {\n  const forexPattern = /^([A-Z]{3})\\/([A-Z]{3})$/;\n  const match = symbol.match(forexPattern);\n  \n  if (match) {\n    return { base: match[1], quote: match[2] };\n  }\n  \n  return null;\n}\n\nexport function getInterestRateData(currency: string): InterestRateData | null {\n  return CURRENT_INTEREST_RATES[currency] || null;\n}\n\nexport function getInflationData(currency: string): InflationData | null {\n  return CURRENT_INFLATION[currency] || null;\n}\n\nexport function generateMockTimeframeData(\n  currentPrice: number,\n  trend: 'bullish' | 'bearish' | 'neutral',\n  candles: number = 20\n): any[] {\n  const data = [];\n  let price = currentPrice;\n  \n  const trendBias = trend === 'bullish' ? 0.0005 : trend === 'bearish' ? -0.0005 : 0;\n  \n  for (let i = 0; i < candles; i++) {\n    const open = price;\n    const volatility = price * 0.002;\n    const direction = Math.random() > 0.5 ? 1 : -1;\n    const move = (Math.random() * volatility + trendBias * price) * direction;\n    const close = open + move;\n    const high = Math.max(open, close) + Math.random() * volatility * 0.5;\n    const low = Math.min(open, close) - Math.random() * volatility * 0.5;\n    \n    data.push({\n      timeframe: '1H',\n      open,\n      high,\n      low,\n      close,\n      volume: Math.random() * 10000,\n      timestamp: new Date(Date.now() - (candles - i) * 3600000),\n    });\n    \n    price = close;\n  }\n  \n  return data;\n}\n","size_bytes":3376},"client/src/components/Notifications.tsx":{"content":"import { Bell, Check, Trash2, X } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover';\nimport { Badge } from '@/components/ui/badge';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { Separator } from '@/components/ui/separator';\nimport { useQuery, useMutation } from '@tanstack/react-query';\nimport { queryClient, apiRequest } from '@/lib/queryClient';\nimport { format } from 'date-fns';\nimport type { Notification } from '@shared/schema';\n\nexport function Notifications() {\n  const { data: notifications = [], isLoading } = useQuery<Notification[]>({\n    queryKey: ['/api/notifications'],\n  });\n\n  const { data: unreadNotifications = [] } = useQuery<Notification[]>({\n    queryKey: ['/api/notifications/unread'],\n    refetchInterval: 30000,\n  });\n\n  const markAsReadMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest('PATCH', `/api/notifications/${id}/read`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications/unread'] });\n    },\n  });\n\n  const markAllAsReadMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest('PATCH', '/api/notifications/read-all');\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications/unread'] });\n    },\n  });\n\n  const deleteNotificationMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest('DELETE', `/api/notifications/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications/unread'] });\n    },\n  });\n\n  const clearAllMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest('DELETE', '/api/notifications/clear-all');\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications/unread'] });\n    },\n  });\n\n  const getNotificationColor = (notification: Notification) => {\n    if (notification.impactLevel === 'High') return 'text-red-500';\n    if (notification.impactLevel === 'Medium') return 'text-yellow-500';\n    if (notification.impactLevel === 'Low') return 'text-green-500';\n    if (notification.type === 'trading_session') return 'text-blue-500';\n    if (notification.type === 'trading_signal') return 'text-purple-500';\n    return 'text-muted-foreground';\n  };\n\n  const getTypeLabel = (type: string) => {\n    switch (type) {\n      case 'economic_event':\n        return 'Economic Event';\n      case 'trading_session':\n        return 'Trading Session';\n      case 'trading_signal':\n        return 'Trading Signal';\n      default:\n        return 'Notification';\n    }\n  };\n\n  const unreadCount = unreadNotifications.length;\n\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        <Button \n          variant=\"ghost\" \n          size=\"icon\" \n          className=\"relative\" \n          data-testid=\"button-notifications\"\n        >\n          <Bell className=\"w-5 h-5\" />\n          {unreadCount > 0 && (\n            <Badge \n              className=\"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-xs\"\n              data-testid=\"badge-notification-count\"\n            >\n              {unreadCount > 9 ? '9+' : unreadCount}\n            </Badge>\n          )}\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-96 p-0\" align=\"end\" data-testid=\"popover-notifications\">\n        <div className=\"flex items-center justify-between p-4 border-b\">\n          <h3 className=\"font-semibold text-sm\">Notifications</h3>\n          <div className=\"flex items-center gap-1\">\n            {unreadCount > 0 && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => markAllAsReadMutation.mutate()}\n                disabled={markAllAsReadMutation.isPending}\n                data-testid=\"button-mark-all-read\"\n              >\n                <Check className=\"w-4 h-4 mr-1\" />\n                Mark all read\n              </Button>\n            )}\n            {notifications.length > 0 && (\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                onClick={() => clearAllMutation.mutate()}\n                disabled={clearAllMutation.isPending}\n                data-testid=\"button-clear-all\"\n              >\n                <Trash2 className=\"w-4 h-4\" />\n              </Button>\n            )}\n          </div>\n        </div>\n\n        <ScrollArea className=\"h-96\">\n          {isLoading ? (\n            <div className=\"flex items-center justify-center p-8\">\n              <p className=\"text-sm text-muted-foreground\">Loading notifications...</p>\n            </div>\n          ) : notifications.length === 0 ? (\n            <div className=\"flex items-center justify-center p-8\">\n              <p className=\"text-sm text-muted-foreground\">No notifications</p>\n            </div>\n          ) : (\n            <div className=\"divide-y\">\n              {notifications.map((notification) => (\n                <div\n                  key={notification.id}\n                  className={`p-4 hover-elevate transition-colors ${\n                    !notification.isRead ? 'bg-accent/50' : ''\n                  }`}\n                  onClick={() => {\n                    if (!notification.isRead) {\n                      markAsReadMutation.mutate(notification.id);\n                    }\n                  }}\n                  data-testid={`notification-item-${notification.id}`}\n                >\n                  <div className=\"flex items-start justify-between gap-2\">\n                    <div className=\"flex-1 space-y-1\">\n                      <div className=\"flex items-center gap-2\">\n                        <Badge variant=\"outline\" className=\"text-xs\">\n                          {getTypeLabel(notification.type)}\n                        </Badge>\n                        {!notification.isRead && (\n                          <div className=\"w-2 h-2 rounded-full bg-primary\" data-testid=\"indicator-unread\" />\n                        )}\n                      </div>\n                      <p className={`text-sm font-medium ${getNotificationColor(notification)}`}>\n                        {notification.title}\n                      </p>\n                      <p className=\"text-xs text-muted-foreground line-clamp-2\">\n                        {notification.message}\n                      </p>\n                      <p className=\"text-xs text-muted-foreground\">\n                        {format(new Date(notification.createdAt!), 'MMM dd, HH:mm')}\n                      </p>\n                    </div>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      className=\"h-6 w-6\"\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        deleteNotificationMutation.mutate(notification.id);\n                      }}\n                      data-testid={`button-delete-${notification.id}`}\n                    >\n                      <X className=\"w-3 h-3\" />\n                    </Button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </ScrollArea>\n      </PopoverContent>\n    </Popover>\n  );\n}\n","size_bytes":7658},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, timestamp, decimal, boolean, integer, jsonb } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\n\nexport const trades = pgTable(\"trades\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").references(() => users.id),\n  symbol: text(\"symbol\").notNull(),\n  type: text(\"type\").notNull(),\n  strategy: text(\"strategy\").notNull(),\n  entryPrice: decimal(\"entry_price\", { precision: 10, scale: 5 }).notNull(),\n  exitPrice: decimal(\"exit_price\", { precision: 10, scale: 5 }).notNull(),\n  quantity: decimal(\"quantity\", { precision: 10, scale: 5 }).notNull(),\n  pnl: decimal(\"pnl\", { precision: 10, scale: 2 }).notNull(),\n  pnlPercent: decimal(\"pnl_percent\", { precision: 10, scale: 2 }).notNull(),\n  outcome: text(\"outcome\").notNull(),\n  timeframe: text(\"timeframe\").notNull(),\n  entryReason: text(\"entry_reason\").notNull(),\n  exitDate: timestamp(\"exit_date\").notNull(),\n  duration: text(\"duration\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertTradeSchema = createInsertSchema(trades).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertTrade = z.infer<typeof insertTradeSchema>;\nexport type Trade = typeof trades.$inferSelect;\n\nexport const economicEvents = pgTable(\"economic_events\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  eventType: text(\"event_type\").notNull(),\n  country: text(\"country\").notNull(),\n  countryCode: text(\"country_code\"),\n  region: text(\"region\").notNull(),\n  currency: text(\"currency\").notNull(),\n  impactLevel: text(\"impact_level\").notNull(),\n  eventTime: timestamp(\"event_time\", { withTimezone: true }).notNull(),\n  expectedValue: text(\"expected_value\"),\n  previousValue: text(\"previous_value\"),\n  actualValue: text(\"actual_value\"),\n  unit: text(\"unit\"),\n  futuresImpliedExpectation: text(\"futures_implied_expectation\"),\n  expertSentiment: text(\"expert_sentiment\"),\n  preReleaseSentiment: text(\"pre_release_sentiment\"),\n  postReleaseSentiment: text(\"post_release_sentiment\"),\n  surpriseFactor: text(\"surprise_factor\"),\n  marketImpactAnalysis: text(\"market_impact_analysis\"),\n  currencyPairImpacts: text(\"currency_pair_impacts\"),\n  stockImpacts: text(\"stock_impacts\"),\n  affectedCurrencies: text(\"affected_currencies\").array(),\n  affectedStocks: text(\"affected_stocks\").array(),\n  isReleased: boolean(\"is_released\").default(false),\n  telegramNotified: boolean(\"telegram_notified\").default(false),\n  sourceSite: text(\"source_site\"),\n  sourceUrl: text(\"source_url\"),\n  lastScraped: timestamp(\"last_scraped\").defaultNow(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertEconomicEventSchema = createInsertSchema(economicEvents).omit({\n  id: true,\n  createdAt: true,\n  lastScraped: true,\n  telegramNotified: true,\n});\n\nexport type InsertEconomicEvent = z.infer<typeof insertEconomicEventSchema>;\nexport type EconomicEvent = typeof economicEvents.$inferSelect;\n\nexport const telegramSubscribers = pgTable(\"telegram_subscribers\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  chatId: text(\"chat_id\").notNull().unique(),\n  phoneNumber: text(\"phone_number\"),\n  username: text(\"username\"),\n  firstName: text(\"first_name\"),\n  lastName: text(\"last_name\"),\n  isActive: boolean(\"is_active\").default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertTelegramSubscriberSchema = createInsertSchema(telegramSubscribers).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertTelegramSubscriber = z.infer<typeof insertTelegramSubscriberSchema>;\nexport type TelegramSubscriber = typeof telegramSubscribers.$inferSelect;\n\nexport const notifications = pgTable(\"notifications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  type: text(\"type\").notNull(),\n  title: text(\"title\").notNull(),\n  message: text(\"message\").notNull(),\n  impactLevel: text(\"impact_level\"),\n  metadata: text(\"metadata\"),\n  isRead: boolean(\"is_read\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertNotificationSchema = createInsertSchema(notifications).omit({\n  id: true,\n  createdAt: true,\n  isRead: true,\n});\n\nexport type InsertNotification = z.infer<typeof insertNotificationSchema>;\nexport type Notification = typeof notifications.$inferSelect;\n\nexport const tradingSignals = pgTable(\"trading_signals\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  symbol: text(\"symbol\").notNull(),\n  assetClass: text(\"asset_class\").notNull(),\n  type: text(\"type\").notNull(),\n  strategy: text(\"strategy\").notNull(),\n  \n  entryPrice: decimal(\"entry_price\", { precision: 12, scale: 5 }).notNull(),\n  stopLoss: decimal(\"stop_loss\", { precision: 12, scale: 5 }).notNull(),\n  takeProfit: decimal(\"take_profit\", { precision: 12, scale: 5 }).notNull(),\n  riskRewardRatio: decimal(\"risk_reward_ratio\", { precision: 5, scale: 2 }).notNull(),\n  \n  primaryTimeframe: text(\"primary_timeframe\").notNull(),\n  confirmationTimeframe: text(\"confirmation_timeframe\"),\n  executionTimeframe: text(\"execution_timeframe\"),\n  \n  overallConfidence: integer(\"overall_confidence\").notNull(),\n  \n  interestRateDiffScore: decimal(\"interest_rate_diff_score\", { precision: 5, scale: 2 }),\n  interestRateDiffValue: decimal(\"interest_rate_diff_value\", { precision: 5, scale: 2 }),\n  interestRateNotes: text(\"interest_rate_notes\"),\n  \n  inflationImpactScore: decimal(\"inflation_impact_score\", { precision: 5, scale: 2 }),\n  inflationDifferential: decimal(\"inflation_differential\", { precision: 5, scale: 2 }),\n  inflationNotes: text(\"inflation_notes\"),\n  \n  trendScore: decimal(\"trend_score\", { precision: 5, scale: 2 }),\n  trendDirection: text(\"trend_direction\"),\n  trendStrength: text(\"trend_strength\"),\n  trendTimeframes: text(\"trend_timeframes\").array(),\n  \n  smcScore: decimal(\"smc_score\", { precision: 5, scale: 2 }),\n  institutionalCandleDetected: boolean(\"institutional_candle_detected\").default(false),\n  institutionalCandleData: jsonb(\"institutional_candle_data\"),\n  orderBlockType: text(\"order_block_type\"),\n  orderBlockLevel: decimal(\"order_block_level\", { precision: 12, scale: 5 }),\n  fvgDetected: boolean(\"fvg_detected\").default(false),\n  fvgLevel: decimal(\"fvg_level\", { precision: 12, scale: 5 }),\n  liquiditySweep: boolean(\"liquidity_sweep\").default(false),\n  liquiditySweepLevel: decimal(\"liquidity_sweep_level\", { precision: 12, scale: 5 }),\n  breakerBlockDetected: boolean(\"breaker_block_detected\").default(false),\n  bocChochDetected: text(\"boc_choch_detected\"),\n  smcFactors: text(\"smc_factors\").array(),\n  \n  technicalReasons: text(\"technical_reasons\").array(),\n  marketContext: text(\"market_context\"),\n  \n  status: text(\"status\").notNull().default('active'),\n  strength: text(\"strength\"),\n  zonesTested: integer(\"zones_tested\").default(0),\n  \n  expiresAt: timestamp(\"expires_at\"),\n  executedAt: timestamp(\"executed_at\"),\n  invalidatedAt: timestamp(\"invalidated_at\"),\n  \n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertTradingSignalSchema = createInsertSchema(tradingSignals).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertTradingSignal = z.infer<typeof insertTradingSignalSchema>;\nexport type TradingSignal = typeof tradingSignals.$inferSelect;\n\nexport const pendingSetups = pgTable(\"pending_setups\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  symbol: text(\"symbol\").notNull(),\n  assetClass: text(\"asset_class\").notNull(),\n  type: text(\"type\").notNull(),\n  \n  setupStage: text(\"setup_stage\").notNull(),\n  \n  potentialStrategy: text(\"potential_strategy\"),\n  currentPrice: decimal(\"current_price\", { precision: 12, scale: 5 }).notNull(),\n  \n  primaryTimeframe: text(\"primary_timeframe\").notNull(),\n  confirmationTimeframe: text(\"confirmation_timeframe\"),\n  \n  interestRateBias: text(\"interest_rate_bias\"),\n  inflationBias: text(\"inflation_bias\"),\n  trendBias: text(\"trend_bias\"),\n  \n  chochDetected: boolean(\"choch_detected\").default(false),\n  chochDirection: text(\"choch_direction\"),\n  liquiditySweepDetected: boolean(\"liquidity_sweep_detected\").default(false),\n  supplyDemandZoneTargeted: boolean(\"supply_demand_zone_targeted\").default(false),\n  zoneLevel: decimal(\"zone_level\", { precision: 12, scale: 5 }),\n  zoneMitigated: boolean(\"zone_mitigated\").default(false),\n  \n  levelsBroken: integer(\"levels_broken\").default(0),\n  confirmationsPending: text(\"confirmations_pending\").array(),\n  \n  setupNotes: text(\"setup_notes\").array(),\n  marketContext: text(\"market_context\"),\n  \n  lastCheckedPrice: decimal(\"last_checked_price\", { precision: 12, scale: 5 }),\n  lastCheckedAt: timestamp(\"last_checked_at\").defaultNow(),\n  \n  readyForSignal: boolean(\"ready_for_signal\").default(false),\n  invalidated: boolean(\"invalidated\").default(false),\n  invalidationReason: text(\"invalidation_reason\"),\n  \n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertPendingSetupSchema = createInsertSchema(pendingSetups).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertPendingSetup = z.infer<typeof insertPendingSetupSchema>;\nexport type PendingSetup = typeof pendingSetups.$inferSelect;\n","size_bytes":9858},"client/src/components/MarketOverview.tsx":{"content":"import { Badge } from '@/components/ui/badge';\nimport { TrendingUp, TrendingDown, Activity, AlertTriangle, BarChart3, Calendar } from 'lucide-react';\n\ninterface WatchlistItem {\n  symbol: string;\n  name: string;\n  price: number;\n  change: number;\n  changePercent: number;\n  category: 'forex' | 'stocks' | 'crypto';\n  watchReason: 'technical' | 'fundamental' | 'news';\n  reasoning: string;\n  priority: 'high' | 'medium' | 'low';\n  keyLevel: number;\n  timeframe: string;\n}\n\nexport default function MarketOverview() {\n  // TODO: Remove mock data - replace with real watchlist data\n  const watchlistData: WatchlistItem[] = [\n    {\n      symbol: 'EUR/USD',\n      name: 'Euro / US Dollar',\n      price: 1.0845,\n      change: 0.0012,\n      changePercent: 0.11,\n      category: 'forex',\n      watchReason: 'technical',\n      reasoning: 'Approaching key resistance at 1.0870, potential breakout setup',\n      priority: 'high',\n      keyLevel: 1.0870,\n      timeframe: '4H'\n    },\n    {\n      symbol: 'GBP/USD',\n      name: 'British Pound / US Dollar',\n      price: 1.2678,\n      change: -0.0045,\n      changePercent: -0.35,\n      category: 'forex',\n      watchReason: 'fundamental',\n      reasoning: 'BoE policy decision tomorrow, volatility expected',\n      priority: 'high',\n      keyLevel: 1.2650,\n      timeframe: '1D'\n    },\n    {\n      symbol: 'USD/JPY',\n      name: 'US Dollar / Japanese Yen',\n      price: 150.25,\n      change: 0.85,\n      changePercent: 0.57,\n      category: 'forex',\n      watchReason: 'news',\n      reasoning: 'BoJ intervention risk above 150.50 level',\n      priority: 'medium',\n      keyLevel: 150.50,\n      timeframe: '1H'\n    },\n    {\n      symbol: 'AAPL',\n      name: 'Apple Inc.',\n      price: 185.92,\n      change: 2.15,\n      changePercent: 1.17,\n      category: 'stocks',\n      watchReason: 'technical',\n      reasoning: 'Breaking above 50MA, momentum building',\n      priority: 'medium',\n      keyLevel: 188.00,\n      timeframe: '1D'\n    },\n    {\n      symbol: 'BTC/USD',\n      name: 'Bitcoin',\n      price: 43250,\n      change: 850,\n      changePercent: 2.01,\n      category: 'crypto',\n      watchReason: 'technical',\n      reasoning: 'Testing major resistance zone, high volume confirmation',\n      priority: 'high',\n      keyLevel: 44000,\n      timeframe: '4H'\n    },\n    {\n      symbol: 'GOLD',\n      name: 'Gold Spot',\n      price: 2035.50,\n      change: -12.30,\n      changePercent: -0.60,\n      category: 'forex',\n      watchReason: 'fundamental',\n      reasoning: 'Fed dovish pivot expectations, safe haven demand',\n      priority: 'medium',\n      keyLevel: 2050.00,\n      timeframe: '1D'\n    }\n  ];\n\n  const getCategoryBadgeColor = (category: string) => {\n    switch(category) {\n      case 'forex': return 'hsl(210 100% 60%)';\n      case 'stocks': return 'hsl(120 60% 50%)';\n      case 'crypto': return 'hsl(45 90% 60%)';\n      default: return '';\n    }\n  };\n\n  const getReasonIcon = (reason: string) => {\n    switch(reason) {\n      case 'technical': return <BarChart3 className=\"w-3 h-3\" />;\n      case 'fundamental': return <Activity className=\"w-3 h-3\" />;\n      case 'news': return <Calendar className=\"w-3 h-3\" />;\n      default: return null;\n    }\n  };\n\n  const getPriorityColor = (priority: string) => {\n    switch(priority) {\n      case 'high': return 'hsl(0 75% 60%)';\n      case 'medium': return 'hsl(45 90% 60%)';\n      case 'low': return 'hsl(120 60% 50%)';\n      default: return '';\n    }\n  };\n\n  const formatPrice = (price: number, symbol: string) => {\n    if (symbol.includes('/') || symbol === 'GOLD') {\n      return price < 10 ? price.toFixed(4) : price.toFixed(2);\n    }\n    return price.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });\n  };\n\n  return (\n    <div data-testid=\"card-market-overview\" className=\"bg-white dark:bg-background\">\n      <div className=\"pb-4 mb-4 border-b border-border/50\">\n        <div className=\"flex items-center gap-2 text-lg font-semibold\">\n          <Activity className=\"w-5 h-5\" />\n          Instruments to Watch\n        </div>\n      </div>\n      <div>\n        <div className=\"divide-y divide-border/50\">\n          {watchlistData.map((item) => (\n            <div\n              key={item.symbol}\n              className=\"py-4 hover-elevate transition-colors\"\n              data-testid={`card-watchlist-${item.symbol.replace('/', '-')}`}\n            >\n              <div className=\"flex items-start justify-between mb-2\">\n                <div className=\"flex items-center gap-3 ml-2\">\n                  <Badge \n                    variant=\"secondary\"\n                    className=\"text-xs font-medium\"\n                    style={{ backgroundColor: getCategoryBadgeColor(item.category) + '20', color: getCategoryBadgeColor(item.category) }}\n                  >\n                    {item.category.toUpperCase()}\n                  </Badge>\n                  <div>\n                    <div className=\"font-semibold text-sm\" data-testid={`text-symbol-${item.symbol.replace('/', '-')}`}>\n                      {item.symbol}\n                    </div>\n                    <div className=\"text-xs text-muted-foreground\">\n                      {item.timeframe} • Key: {formatPrice(item.keyLevel, item.symbol)}\n                    </div>\n                  </div>\n                </div>\n                \n                <div className=\"flex items-center gap-2 mr-2\">\n                  <Badge \n                    variant=\"outline\"\n                    className=\"text-xs\"\n                    style={{ borderColor: getPriorityColor(item.priority), color: getPriorityColor(item.priority) }}\n                  >\n                    {item.priority === 'high' && <AlertTriangle className=\"w-3 h-3 mr-1\" />}\n                    {item.priority.toUpperCase()}\n                  </Badge>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center justify-between mb-2 ml-2\">\n                <div className=\"text-left\">\n                  <div className=\"font-mono font-semibold text-sm\" data-testid={`text-price-${item.symbol.replace('/', '-')}`}>\n                    {formatPrice(item.price, item.symbol)}\n                  </div>\n                  <div className=\"flex items-center gap-1 text-xs\">\n                    {item.change > 0 ? (\n                      <TrendingUp className=\"w-3 h-3 text-green-500\" />\n                    ) : (\n                      <TrendingDown className=\"w-3 h-3 text-red-500\" />\n                    )}\n                    <span className={`font-mono ${item.change > 0 ? 'text-green-500' : 'text-red-500'}`}>\n                      {item.change > 0 ? '+' : ''}{item.changePercent.toFixed(2)}%\n                    </span>\n                  </div>\n                </div>\n              </div>\n              \n              <div className=\"flex items-start gap-2 text-xs ml-2\">\n                <div className=\"flex items-center gap-1\">\n                  {getReasonIcon(item.watchReason)}\n                  <Badge variant=\"secondary\" className=\"text-xs\">\n                    {item.watchReason.toUpperCase()}\n                  </Badge>\n                </div>\n                <div className=\"flex-1 text-muted-foreground\">\n                  {item.reasoning}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":7348},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        trading: {\n          profit: \"120 60% 50%\",\n          loss: \"0 75% 60%\",\n          warning: \"45 90% 60%\",\n          neutral: \"210 10% 70%\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n        session: {\n          london: \"120 60% 50%\",\n          newyork: \"210 100% 60%\",\n          tokyo: \"45 90% 60%\",\n          sydney: \"280 85% 70%\",\n          closed: \"210 10% 50%\",\n        },\n        \"primary-accent\": \"#e75518\",\n        \"bull-green\": \"#10b981\",\n        \"bear-red\": \"#ef4444\",\n      },\n      fontFamily: {\n        sans: [\"Poppins\", \"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"JetBrains Mono\", \"var(--font-mono)\"],\n      },\n      spacing: {\n        '18': '4.5rem',\n        '22': '5.5rem',\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4608},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/Footer.tsx":{"content":"import { Link } from 'wouter';\nimport { Facebook, Instagram, Send } from 'lucide-react';\n\nexport default function Footer() {\n  return (\n    <footer className=\"bg-gray-100 text-gray-700 border-t border-gray-300 mt-12\">\n      <div className=\"max-w-7xl mx-auto px-6 py-12 md:py-16\">\n\n        {/* Grid Layout for Links */}\n        <div className=\"grid grid-cols-2 gap-y-10 gap-x-6 sm:grid-cols-4 lg:grid-cols-6 xl:gap-x-8\">\n\n          {/* Column 1: Markets & Data */}\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Markets & Data</h3>\n            <ul role=\"list\" className=\"space-y-3\">\n              <li><Link href=\"/\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Major Pairs</Link></li>\n              <li><Link href=\"/stocks\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Stocks & Equities</Link></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Commodities</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Crypto Currencies</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">High Impact News</a></li>\n            </ul>\n          </div>\n\n          {/* Column 2: Platform */}\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Platform</h3>\n            <ul role=\"list\" className=\"space-y-3\">\n              <li><Link href=\"/signals\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Signals & Alerts</Link></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Trading Strategies</a></li>\n              <li><Link href=\"/analytics\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Analytics</Link></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">API Access</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Documentation</a></li>\n            </ul>\n          </div>\n\n          {/* Column 3: Company */}\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Company</h3>\n            <ul role=\"list\" className=\"space-y-3\">\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">About Us</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Careers (We're Hiring)</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Our Team</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Blog</a></li>\n            </ul>\n          </div>\n\n          {/* Column 4: Partners */}\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Partners</h3>\n            <ul role=\"list\" className=\"space-y-3\">\n              {/* Add future partner links here */}\n            </ul>\n          </div>\n\n          {/* Column 5: Legal & Support */}\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Legal & Support</h3>\n            <ul role=\"list\" className=\"space-y-3\">\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Terms of Service</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Privacy Policy</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Risk Disclaimer</a></li>\n              <li><a href=\"#\" className=\"text-sm text-gray-600 hover:text-blue-600 transition duration-150\">Contact Us</a></li>\n            </ul>\n          </div>\n\n          {/* Column 6: Branding & Social */}\n          <div className=\"col-span-2 sm:col-span-4 lg:col-span-1 border-t sm:border-t-0 pt-6 sm:pt-0 border-gray-300 lg:border-none\">\n            <div className=\"flex flex-wrap items-center mb-3\">\n              <span className=\"text-base font-extrabold text-bull-green\">Find</span>\n              <span className=\"text-base font-extrabold text-gray-900\">Buy</span>\n              <span className=\"text-base font-extrabold text-gray-900\">and</span>\n              <span className=\"text-base font-extrabold text-bear-red\">Sell</span>\n              <span className=\"text-base font-extrabold text-gray-900\">Zones.com</span>\n            </div>\n            <p className=\"text-xs text-gray-500 mb-6\">Less Charting. No worries. Only precision.</p>\n            \n            {/* Social Media Icons */}\n            <div className=\"flex space-x-5 items-center\">\n              \n              {/* Facebook */}\n              <a href=\"#\" className=\"text-[#1877F2] hover:opacity-80 transition duration-150\" aria-label=\"Facebook\">\n                <Facebook className=\"w-6 h-6\" fill=\"currentColor\" />\n              </a>\n              \n              {/* Instagram */}\n              <a href=\"#\" className=\"text-[#DD2A7B] hover:opacity-80 transition duration-150\" aria-label=\"Instagram\">\n                <Instagram className=\"w-6 h-6\" />\n              </a>\n              \n              {/* Telegram */}\n              <a href=\"#\" className=\"text-[#26A5E4] hover:opacity-80 transition duration-150\" aria-label=\"Telegram\">\n                <Send className=\"w-6 h-6\" fill=\"currentColor\" />\n              </a>\n              \n              {/* TikTok */}\n              <a href=\"#\" className=\"hover:opacity-80 transition duration-150\" aria-label=\"TikTok\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                  <path fill=\"#010101\" d=\"M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z\"/>\n                </svg>\n              </a>\n            </div>\n          </div>\n\n        </div>\n\n        {/* Separator Line */}\n        <div className=\"mt-12 mb-8 border-t border-gray-300\"></div>\n\n        {/* Copyright */}\n        <div className=\"text-center\">\n          <p className=\"text-sm text-gray-600\">\n            &copy; 2025 <span className=\"font-extrabold text-bull-green\">Find</span>\n            <span className=\"font-extrabold text-gray-900\">Buy</span>\n            <span className=\"font-extrabold text-gray-900\">and</span>\n            <span className=\"font-extrabold text-bear-red\">Sell</span>\n            <span className=\"font-extrabold text-gray-900\">Zones.com</span>. All rights reserved.\n          </p>\n        </div>\n\n      </div>\n    </footer>\n  );\n}\n","size_bytes":6955},"client/src/components/StockSignalCard.tsx":{"content":"import { useState } from 'react';\nimport { \n  ArrowUpRight, \n  ArrowDownRight, \n  DollarSign,\n  Info,\n  TrendingUp,\n  TrendingDown,\n  Clock,\n  ChevronUp,\n  Target,\n  BarChart2,\n  Shield\n} from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\nimport type { TradingSignal } from '@shared/schema';\nimport { LivePriceWithEntry } from './LivePriceDisplay';\n\nconst formatTimeAgo = (timestamp: Date | string) => {\n  const now = new Date();\n  const created = new Date(timestamp);\n  const diffMs = now.getTime() - created.getTime();\n  const diffMins = Math.floor(diffMs / (1000 * 60));\n  \n  if (diffMins < 1) return 'Just now';\n  if (diffMins < 60) return `${diffMins} min ago`;\n  \n  const diffHours = Math.floor(diffMins / 60);\n  if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;\n  \n  const diffDays = Math.floor(diffHours / 24);\n  return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;\n};\n\ninterface StockSignalCardProps {\n  signal: TradingSignal;\n}\n\nconst StatBlock = ({ label, value, colorClass = \"text-foreground\", icon: Icon }: any) => (\n  <div className=\"flex flex-col min-w-0\">\n    <span className=\"text-[10px] uppercase tracking-wider text-muted-foreground font-semibold mb-1 flex items-center gap-1\">\n      {Icon && <Icon className=\"w-3 h-3\" />} {label}\n    </span>\n    <span className={`text-sm font-extrabold ${colorClass} break-all tabular-nums`}>{value}</span>\n  </div>\n);\n\nconst DetailsIcon = ({ className }: { className?: string }) => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" className={className}>\n    <rect x=\"2\" y=\"4\" width=\"4\" height=\"4\"/>\n    <rect x=\"8\" y=\"4\" width=\"14\" height=\"4\"/>\n    <rect x=\"2\" y=\"14\" width=\"4\" height=\"4\"/>\n    <rect x=\"8\" y=\"14\" width=\"14\" height=\"4\"/>\n  </svg>\n);\n\nconst getAssetClassForSymbol = (symbol: string, assetClass?: string): 'stock' | 'forex' | 'commodity' | 'crypto' => {\n  if (assetClass === 'crypto' || assetClass === 'cryptocurrency') return 'crypto';\n  if (assetClass === 'commodity' || assetClass === 'commodities') return 'commodity';\n  if (assetClass === 'forex' || assetClass === 'currency') return 'forex';\n  if (assetClass === 'stock' || assetClass === 'stocks') return 'stock';\n  \n  if (symbol.includes('/USD') && ['BTC', 'ETH', 'BNB', 'SOL', 'XRP'].some(c => symbol.startsWith(c))) return 'crypto';\n  if (symbol.includes('/')) return 'forex';\n  if (['XAU', 'XAG', 'WTI', 'BRENT', 'GOLD', 'SILVER', 'OIL'].some(c => symbol.includes(c))) return 'commodity';\n  \n  return 'stock';\n};\n\nexport default function StockSignalCard({ signal }: StockSignalCardProps) {\n  const [isExpanded, setIsExpanded] = useState(false);\n  \n  const isBuy = signal.type?.toLowerCase() === 'buy';\n  const assetClass = getAssetClassForSymbol(signal.symbol, signal.assetClass);\n  const trendColor = isBuy ? 'text-emerald-500 dark:text-emerald-400' : 'text-rose-500 dark:text-rose-400';\n  const TrendIcon = isBuy ? TrendingUp : TrendingDown;\n  const winRateColor = (signal.overallConfidence ?? 0) >= 90 \n    ? 'text-emerald-600 dark:text-emerald-400' \n    : (signal.overallConfidence ?? 0) >= 80 ? 'text-amber-600 dark:text-amber-400' : 'text-muted-foreground';\n\n  const entryPrice = signal.entryPrice?.toString() || '—';\n  const stopLoss = signal.stopLoss?.toString() || '—';\n  const takeProfit = signal.takeProfit?.toString() || '—';\n  \n  const hasCompleteData = entryPrice !== '—' && entryPrice !== 'N/A';\n\n  return (\n    <div \n      className=\"bg-card border-l-4 border-r border-b border-border p-0 relative group transition-all\" \n      style={{ borderLeftColor: isBuy ? 'hsl(var(--chart-1))' : 'hsl(var(--chart-5))' }}\n      data-testid={`card-stock-${signal.id}`}\n    >\n      <div className=\"p-6 grid grid-cols-1 md:grid-cols-12 items-center gap-4 md:gap-8\">\n        \n        {/* Ticker, Name, Type (Col 1-3) */}\n        <div className=\"md:col-span-3 flex flex-col gap-2\">\n          <Badge \n            variant={isBuy ? 'default' : 'destructive'} \n            className=\"w-fit px-3 py-1 text-xs font-bold uppercase tracking-widest\"\n            data-testid={`badge-type-${signal.id}`}\n          >\n            {signal.type}\n          </Badge>\n          <div className=\"flex items-center gap-2\">\n            <h3 className=\"text-2xl font-extrabold text-foreground tracking-tight\" data-testid={`text-symbol-${signal.id}`}>\n              {signal.symbol}\n            </h3>\n            <TrendIcon className={`w-5 h-5 ${trendColor}`} />\n          </div>\n        </div>\n\n        {/* Stats Grid (Col 4-9) */}\n        <div className=\"md:col-span-6 flex flex-wrap gap-4 border-l border-r border-border px-4 md:px-8 py-2\">\n          {hasCompleteData ? (\n            <>\n              <div className=\"flex-1 min-w-[90px]\">\n                <LivePriceWithEntry \n                  symbol={signal.symbol}\n                  assetClass={assetClass}\n                  entryPrice={signal.entryPrice}\n                  signalType={signal.type}\n                />\n              </div>\n              <div className=\"flex-1 min-w-[80px]\">\n                <StatBlock \n                  label=\"Entry\" \n                  value={entryPrice} \n                  icon={DollarSign} \n                />\n              </div>\n              <div className=\"flex-1 min-w-[80px]\">\n                <StatBlock \n                  label=\"Stop\" \n                  value={stopLoss} \n                  colorClass=\"text-destructive\" \n                  icon={ArrowDownRight} \n                />\n              </div>\n              <div className=\"flex-1 min-w-[80px]\">\n                <StatBlock \n                  label=\"Target\" \n                  value={takeProfit} \n                  colorClass=\"text-emerald-600 dark:text-emerald-400\" \n                  icon={ArrowUpRight} \n                />\n              </div>\n            </>\n          ) : (\n            <div className=\"w-full text-sm font-semibold text-amber-600 dark:text-amber-400 flex items-center\">\n              <Info className=\"w-4 h-4 mr-2\" /> Waiting for activation price.\n            </div>\n          )}\n        </div>\n\n        {/* Timeframe, Time Ago and Details Button (Col 10-12) */}\n        <div className=\"md:col-span-3 flex flex-col items-start md:items-end gap-2 pt-2\">\n          <div className=\"text-sm font-bold text-muted-foreground uppercase\">\n            {signal.primaryTimeframe || '4H'}\n          </div>\n          \n          {signal.createdAt && (\n            <div \n              className=\"text-xs text-muted-foreground flex items-center gap-1\"\n              data-testid={`time-ago-${signal.id}`}\n            >\n              <Clock className=\"w-3 h-3\" />\n              {formatTimeAgo(signal.createdAt)}\n            </div>\n          )}\n          \n          {/* Enhanced Details Button */}\n          <button \n            className=\"flex items-center justify-center px-4 py-2 text-sm font-bold text-white bg-blue-600 shadow-lg transition-all duration-300 ease-in-out transform hover:bg-blue-700 hover:scale-[1.02] hover:shadow-xl active:bg-blue-800 active:scale-100 focus:outline-none focus:ring-4 focus:ring-blue-300 focus:ring-opacity-50 lowercase\"\n            data-testid={`button-details-${signal.id}`}\n            onClick={() => setIsExpanded(!isExpanded)}\n          >\n            {isExpanded ? (\n              <>\n                <ChevronUp className=\"w-5 h-5 mr-2\" />\n                hide details\n              </>\n            ) : (\n              <>\n                <DetailsIcon className=\"w-5 h-5 mr-2\" />\n                show details\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Expanded Details Section */}\n      {isExpanded && (\n        <div className=\"px-6 pb-6 pt-2 border-t border-border animate-in fade-in duration-200\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {/* Market Context */}\n            {signal.marketContext && (\n              <div className=\"space-y-2\">\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <TrendingUp className=\"w-3 h-3\" /> Market Context\n                </h4>\n                <p className=\"text-sm\">{signal.marketContext}</p>\n              </div>\n            )}\n\n            {/* Technical Reasons */}\n            {signal.technicalReasons && signal.technicalReasons.length > 0 && (\n              <div className=\"space-y-2\">\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <Target className=\"w-3 h-3\" /> Technical Reasons\n                </h4>\n                <ul className=\"text-sm space-y-1\">\n                  {signal.technicalReasons.map((reason: string, idx: number) => (\n                    <li key={idx} className=\"flex items-start gap-2\">\n                      <span className=\"text-primary\">•</span>\n                      <span>{reason}</span>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            {/* SMC Factors */}\n            {signal.smcFactors && signal.smcFactors.length > 0 && (\n              <div className=\"space-y-2\">\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <Shield className=\"w-3 h-3\" /> SMC Factors\n                </h4>\n                <ul className=\"text-sm space-y-1\">\n                  {signal.smcFactors.map((factor: string, idx: number) => (\n                    <li key={idx} className=\"flex items-start gap-2\">\n                      <span className=\"text-primary\">•</span>\n                      <span>{factor}</span>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            {/* Additional Stats */}\n            <div className=\"space-y-2\">\n              <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                <BarChart2 className=\"w-3 h-3\" /> Signal Stats\n              </h4>\n              <div className=\"grid grid-cols-2 gap-3 text-sm\">\n                {signal.overallConfidence && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Confidence:</span>\n                    <span className={`ml-2 font-semibold ${winRateColor}`}>{signal.overallConfidence}%</span>\n                  </div>\n                )}\n                {signal.trendStrength && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Trend:</span>\n                    <span className=\"ml-2 font-semibold\">{signal.trendStrength}</span>\n                  </div>\n                )}\n                {signal.trendDirection && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Direction:</span>\n                    <span className=\"ml-2 font-semibold\">{signal.trendDirection}</span>\n                  </div>\n                )}\n                {signal.riskRewardRatio && (\n                  <div>\n                    <span className=\"text-muted-foreground\">R:R:</span>\n                    <span className=\"ml-2 font-semibold\">{signal.riskRewardRatio}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":11328},"client/src/components/SignalCard.tsx":{"content":"import { useState } from 'react';\nimport { \n  ArrowUpRight, \n  ArrowDownRight, \n  BarChart2, \n  DollarSign,\n  Info,\n  Clock,\n  ChevronUp,\n  Target,\n  TrendingUp,\n  Shield,\n  Activity\n} from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\nimport type { TradingSignal } from '@shared/schema';\nimport { LivePriceWithEntry } from './LivePriceDisplay';\n\nconst formatTimeAgo = (timestamp: Date | string) => {\n  const now = new Date();\n  const created = new Date(timestamp);\n  const diffMs = now.getTime() - created.getTime();\n  const diffMins = Math.floor(diffMs / (1000 * 60));\n  \n  if (diffMins < 1) return 'Just now';\n  if (diffMins < 60) return `${diffMins} min ago`;\n  \n  const diffHours = Math.floor(diffMins / 60);\n  if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;\n  \n  const diffDays = Math.floor(diffHours / 24);\n  return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;\n};\n\ninterface SignalCardProps {\n  signal: TradingSignal;\n}\n\nconst StatBlock = ({ label, value, colorClass = \"text-foreground\", icon: Icon }: any) => (\n  <div className=\"flex flex-col min-w-0\">\n    <span className=\"text-[10px] uppercase tracking-wider text-muted-foreground font-semibold mb-1 flex items-center gap-1\">\n      {Icon && <Icon className=\"w-3 h-3\" />} {label}\n    </span>\n    <span className={`text-sm font-extrabold ${colorClass} break-all tabular-nums`}>{value}</span>\n  </div>\n);\n\nconst DetailsIcon = ({ className }: { className?: string }) => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" className={className}>\n    <rect x=\"2\" y=\"4\" width=\"4\" height=\"4\"/>\n    <rect x=\"8\" y=\"4\" width=\"14\" height=\"4\"/>\n    <rect x=\"2\" y=\"14\" width=\"4\" height=\"4\"/>\n    <rect x=\"8\" y=\"14\" width=\"14\" height=\"4\"/>\n  </svg>\n);\n\nconst getAssetClassForSymbol = (symbol: string, assetClass?: string): 'stock' | 'forex' | 'commodity' | 'crypto' => {\n  if (assetClass === 'crypto' || assetClass === 'cryptocurrency') return 'crypto';\n  if (assetClass === 'commodity' || assetClass === 'commodities') return 'commodity';\n  if (assetClass === 'forex' || assetClass === 'currency') return 'forex';\n  if (assetClass === 'stock' || assetClass === 'stocks') return 'stock';\n  \n  if (symbol.includes('/USD') && ['BTC', 'ETH', 'BNB', 'SOL', 'XRP'].some(c => symbol.startsWith(c))) return 'crypto';\n  if (symbol.includes('/')) return 'forex';\n  if (['XAU', 'XAG', 'WTI', 'BRENT', 'GOLD', 'SILVER', 'OIL'].some(c => symbol.includes(c))) return 'commodity';\n  \n  return 'stock';\n};\n\nexport default function SignalCard({ signal }: SignalCardProps) {\n  const [isExpanded, setIsExpanded] = useState(false);\n  \n  const isBuy = signal.type?.toLowerCase() === 'buy';\n  const assetClass = getAssetClassForSymbol(signal.symbol, signal.assetClass);\n  const winRateColor = (signal.overallConfidence ?? 0) >= 90 \n    ? 'text-emerald-600 dark:text-emerald-400' \n    : (signal.overallConfidence ?? 0) >= 80 ? 'text-amber-600 dark:text-amber-400' : 'text-muted-foreground';\n\n  const entryPrice = signal.entryPrice?.toString() || '—';\n  const stopLoss = signal.stopLoss?.toString() || '—';\n  const takeProfit = signal.takeProfit?.toString() || '—';\n  const riskRewardRatio = signal.riskRewardRatio?.toString() || '—';\n  \n  const hasCompleteData = entryPrice !== '—' && entryPrice !== 'N/A';\n\n  return (\n    <div \n      className=\"bg-card border-l-4 border-r border-b border-border p-0 relative group transition-all\" \n      style={{ borderLeftColor: isBuy ? 'hsl(var(--chart-1))' : 'hsl(var(--chart-5))' }}\n      data-testid={`card-signal-${signal.id}`}\n    >\n      <div className=\"p-6 grid grid-cols-1 md:grid-cols-12 items-center gap-4 md:gap-8\">\n        \n        {/* Signal Pair and Type (Col 1-3) */}\n        <div className=\"md:col-span-3 flex flex-col gap-2\">\n          <Badge \n            variant={isBuy ? 'default' : 'destructive'} \n            className=\"w-fit px-3 py-1 text-xs font-bold uppercase tracking-widest\"\n            data-testid={`badge-type-${signal.id}`}\n          >\n            {signal.type}\n          </Badge>\n          <h3 className=\"text-2xl font-extrabold text-foreground tracking-tight\" data-testid={`text-symbol-${signal.id}`}>\n            {signal.symbol}\n          </h3>\n        </div>\n\n        {/* Stats Grid (Col 4-9) */}\n        <div className=\"md:col-span-6 flex flex-wrap gap-4 border-l border-r border-border px-4 md:px-8 py-2\">\n          {hasCompleteData ? (\n            <>\n              <div className=\"flex-1 min-w-[90px]\">\n                <LivePriceWithEntry \n                  symbol={signal.symbol}\n                  assetClass={assetClass}\n                  entryPrice={signal.entryPrice}\n                  signalType={signal.type}\n                />\n              </div>\n              <div className=\"flex-1 min-w-[80px]\">\n                <StatBlock \n                  label=\"Entry\" \n                  value={entryPrice} \n                  icon={DollarSign} \n                />\n              </div>\n              <div className=\"flex-1 min-w-[80px]\">\n                <StatBlock \n                  label=\"Stop\" \n                  value={stopLoss} \n                  colorClass=\"text-destructive\" \n                  icon={ArrowDownRight} \n                />\n              </div>\n              <div className=\"flex-1 min-w-[80px]\">\n                <StatBlock \n                  label=\"Target\" \n                  value={takeProfit} \n                  colorClass=\"text-emerald-600 dark:text-emerald-400\" \n                  icon={ArrowUpRight} \n                />\n              </div>\n              <div className=\"flex-1 min-w-[60px]\">\n                <StatBlock \n                  label=\"R:R\" \n                  value={riskRewardRatio} \n                  icon={BarChart2} \n                  colorClass=\"text-foreground\" \n                />\n              </div>\n            </>\n          ) : (\n            <div className=\"w-full text-sm font-semibold text-amber-600 dark:text-amber-400 flex items-center\">\n              <Info className=\"w-4 h-4 mr-2\" /> Bias awaiting confirmation or entry.\n            </div>\n          )}\n        </div>\n\n        {/* Timeframe, Time Ago and Details Button (Col 10-12) */}\n        <div className=\"md:col-span-3 flex flex-col items-start md:items-end gap-2 pt-2\">\n          {/* Timeframe */}\n          <div className=\"text-sm font-bold text-muted-foreground uppercase\">\n            {signal.primaryTimeframe || '4H'}\n          </div>\n          \n          {/* Time Since Posted */}\n          {signal.createdAt && (\n            <div \n              className=\"text-xs text-muted-foreground flex items-center gap-1\"\n              data-testid={`time-ago-${signal.id}`}\n            >\n              <Clock className=\"w-3 h-3\" />\n              {formatTimeAgo(signal.createdAt)}\n            </div>\n          )}\n          \n          {/* Enhanced Details Button */}\n          <button \n            className=\"flex items-center justify-center px-4 py-2 text-sm font-bold text-white bg-blue-600 shadow-lg transition-all duration-300 ease-in-out transform hover:bg-blue-700 hover:scale-[1.02] hover:shadow-xl active:bg-blue-800 active:scale-100 focus:outline-none focus:ring-4 focus:ring-blue-300 focus:ring-opacity-50 lowercase\"\n            data-testid={`button-details-${signal.id}`}\n            onClick={() => setIsExpanded(!isExpanded)}\n          >\n            {isExpanded ? (\n              <>\n                <ChevronUp className=\"w-5 h-5 mr-2\" />\n                hide details\n              </>\n            ) : (\n              <>\n                <DetailsIcon className=\"w-5 h-5 mr-2\" />\n                show details\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Expanded Details Section */}\n      {isExpanded && (\n        <div className=\"px-6 pb-6 pt-2 border-t border-border animate-in fade-in duration-200\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {/* Market Context */}\n            {signal.marketContext && (\n              <div className=\"space-y-2\">\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <TrendingUp className=\"w-3 h-3\" /> Market Context\n                </h4>\n                <p className=\"text-sm\">{signal.marketContext}</p>\n              </div>\n            )}\n\n            {/* Technical Reasons */}\n            {signal.technicalReasons && signal.technicalReasons.length > 0 && (\n              <div className=\"space-y-2\">\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <Target className=\"w-3 h-3\" /> Technical Reasons\n                </h4>\n                <ul className=\"text-sm space-y-1\">\n                  {signal.technicalReasons.map((reason: string, idx: number) => (\n                    <li key={idx} className=\"flex items-start gap-2\">\n                      <span className=\"text-primary\">•</span>\n                      <span>{reason}</span>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            {/* SMC Factors */}\n            {signal.smcFactors && signal.smcFactors.length > 0 && (\n              <div className=\"space-y-2\">\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <Shield className=\"w-3 h-3\" /> SMC Factors\n                </h4>\n                <ul className=\"text-sm space-y-1\">\n                  {signal.smcFactors.map((factor: string, idx: number) => (\n                    <li key={idx} className=\"flex items-start gap-2\">\n                      <span className=\"text-primary\">•</span>\n                      <span>{factor}</span>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            {/* Additional Stats */}\n            <div className=\"space-y-2\">\n              <h4 className=\"text-xs font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                <BarChart2 className=\"w-3 h-3\" /> Signal Stats\n              </h4>\n              <div className=\"grid grid-cols-2 gap-3 text-sm\">\n                {signal.overallConfidence && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Confidence:</span>\n                    <span className={`ml-2 font-semibold ${winRateColor}`}>{signal.overallConfidence}%</span>\n                  </div>\n                )}\n                {signal.trendStrength && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Trend:</span>\n                    <span className=\"ml-2 font-semibold\">{signal.trendStrength}</span>\n                  </div>\n                )}\n                {signal.trendDirection && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Direction:</span>\n                    <span className=\"ml-2 font-semibold\">{signal.trendDirection}</span>\n                  </div>\n                )}\n                {signal.orderBlockType && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Order Block:</span>\n                    <span className=\"ml-2 font-semibold\">{signal.orderBlockType}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":11439},"client/src/components/WatchlistCard.tsx":{"content":"import { useState } from 'react';\nimport { \n  ArrowUpRight, \n  ArrowDownRight, \n  Clock,\n  ChevronUp,\n  Target,\n  TrendingUp,\n  Shield,\n  BarChart2\n} from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\nimport type { PendingSetup } from '@shared/schema';\nimport LivePriceDisplay from './LivePriceDisplay';\n\nconst formatTimeAgo = (timestamp: Date | string) => {\n  const now = new Date();\n  const created = new Date(timestamp);\n  const diffMs = now.getTime() - created.getTime();\n  const diffMins = Math.floor(diffMs / (1000 * 60));\n  \n  if (diffMins < 1) return 'Just now';\n  if (diffMins < 60) return `${diffMins} min ago`;\n  \n  const diffHours = Math.floor(diffMins / 60);\n  if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;\n  \n  const diffDays = Math.floor(diffHours / 24);\n  return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;\n};\n\ninterface WatchlistCardProps {\n  item: PendingSetup;\n  showProbability?: boolean;\n}\n\nconst DetailsIcon = ({ className }: { className?: string }) => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" className={className}>\n    <rect x=\"2\" y=\"4\" width=\"4\" height=\"4\"/>\n    <rect x=\"8\" y=\"4\" width=\"14\" height=\"4\"/>\n    <rect x=\"2\" y=\"14\" width=\"4\" height=\"4\"/>\n    <rect x=\"8\" y=\"14\" width=\"14\" height=\"4\"/>\n  </svg>\n);\n\nconst getAssetClassForSymbol = (symbol: string, assetClass?: string): 'stock' | 'forex' | 'commodity' | 'crypto' => {\n  if (assetClass === 'crypto' || assetClass === 'cryptocurrency') return 'crypto';\n  if (assetClass === 'commodity' || assetClass === 'commodities') return 'commodity';\n  if (assetClass === 'forex' || assetClass === 'currency') return 'forex';\n  if (assetClass === 'stock' || assetClass === 'stocks') return 'stock';\n  \n  if (symbol.includes('/USD') && ['BTC', 'ETH', 'BNB', 'SOL', 'XRP'].some(c => symbol.startsWith(c))) return 'crypto';\n  if (symbol.includes('/')) return 'forex';\n  if (['XAU', 'XAG', 'WTI', 'BRENT', 'GOLD', 'SILVER', 'OIL'].some(c => symbol.includes(c))) return 'commodity';\n  \n  return 'stock';\n};\n\nexport default function WatchlistCard({ item, showProbability = false }: WatchlistCardProps) {\n  const [isExpanded, setIsExpanded] = useState(false);\n  \n  const assetClass = getAssetClassForSymbol(item.symbol, item.assetClass);\n  \n  const priority = item.setupStage === 'ready' ? 'HIGH' : 'MEDIUM';\n  const isHighPriority = priority === 'HIGH';\n  const priorityBadgeClass = isHighPriority \n    ? 'bg-destructive text-destructive-foreground border-destructive' \n    : 'bg-amber-600 text-white dark:bg-amber-700 dark:text-white border-amber-600 dark:border-amber-700';\n\n  return (\n    <div \n      className=\"bg-card border-b border-r border-l border-border p-0 group transition-colors\"\n      data-testid={`card-watchlist-${item.id}`}\n    >\n      <div className=\"grid grid-cols-12 items-center text-foreground\">\n        {/* Pair and Type (Col 1-4) */}\n        <div className=\"col-span-4 py-4 px-6 flex flex-col gap-1\">\n          <div className=\"flex items-center gap-2\">\n            <h3 className=\"text-lg font-bold tracking-tight\" data-testid={`text-symbol-${item.id}`}>\n              {item.symbol}\n            </h3>\n            <span className=\"text-xs text-muted-foreground font-medium\">\n              ({item.primaryTimeframe || '—'})\n            </span>\n          </div>\n          <p className=\"text-xs text-muted-foreground italic line-clamp-1\">\n            {(item.setupNotes && item.setupNotes.length > 0) ? item.setupNotes[0] : (item.marketContext || 'Monitoring for setup')}\n          </p>\n        </div>\n\n        {/* Live Price (Col 5-7) */}\n        <div className=\"col-span-3 py-4 px-6 border-l border-border\">\n          <LivePriceDisplay \n            symbol={item.symbol} \n            assetClass={assetClass}\n            size=\"md\"\n            showChange={true}\n          />\n        </div>\n\n        {showProbability ? (\n          <>\n            {/* Priority Level (Col 8-10) - Only shown when showProbability is true */}\n            <div className=\"col-span-3 py-4 px-6 border-l border-border flex flex-col justify-center\">\n              <Badge className={`w-fit px-3 py-1 text-xs font-bold uppercase tracking-widest border ${priorityBadgeClass}`}>\n                {priority}\n              </Badge>\n            </div>\n\n            {/* Time and Details Button (Col 11-12) */}\n            <div className=\"col-span-2 py-4 px-3 border-l border-border flex flex-col items-end gap-2\">\n              <div className=\"text-xs text-muted-foreground flex items-center gap-1\">\n                <Clock className=\"w-3 h-3\" /> \n                {item.createdAt ? formatTimeAgo(item.createdAt) : 'Monitoring'}\n              </div>\n              {/* Enhanced Details Button */}\n              <button \n                className=\"flex items-center justify-center px-3 py-1.5 text-xs font-bold text-white bg-blue-600 shadow-lg transition-all duration-300 ease-in-out transform hover:bg-blue-700 hover:scale-[1.02] hover:shadow-xl active:bg-blue-800 active:scale-100 focus:outline-none focus:ring-4 focus:ring-blue-300 focus:ring-opacity-50 lowercase\"\n                data-testid={`button-details-${item.id}`}\n                onClick={() => setIsExpanded(!isExpanded)}\n              >\n                {isExpanded ? (\n                  <>\n                    <ChevronUp className=\"w-4 h-4 mr-1\" />\n                    hide\n                  </>\n                ) : (\n                  <>\n                    <DetailsIcon className=\"w-4 h-4 mr-1\" />\n                    details\n                  </>\n                )}\n              </button>\n            </div>\n          </>\n        ) : (\n          /* Time and Details Button (Col 8-12) - Full width when no probability shown */\n          <div className=\"col-span-5 py-4 px-3 border-l border-border flex flex-col items-end gap-2\">\n            <div className=\"text-xs text-muted-foreground flex items-center gap-1\">\n              <Clock className=\"w-3 h-3\" /> \n              {item.createdAt ? formatTimeAgo(item.createdAt) : 'Monitoring'}\n            </div>\n            {/* Enhanced Details Button */}\n            <button \n              className=\"flex items-center justify-center px-3 py-1.5 text-xs font-bold text-white bg-blue-600 shadow-lg transition-all duration-300 ease-in-out transform hover:bg-blue-700 hover:scale-[1.02] hover:shadow-xl active:bg-blue-800 active:scale-100 focus:outline-none focus:ring-4 focus:ring-blue-300 focus:ring-opacity-50 lowercase\"\n              data-testid={`button-details-${item.id}`}\n              onClick={() => setIsExpanded(!isExpanded)}\n            >\n              {isExpanded ? (\n                <>\n                  <ChevronUp className=\"w-4 h-4 mr-1\" />\n                  hide\n                </>\n              ) : (\n                <>\n                  <DetailsIcon className=\"w-4 h-4 mr-1\" />\n                  details\n                </>\n              )}\n            </button>\n          </div>\n        )}\n      </div>\n\n      {/* Expanded Details Section */}\n      {isExpanded && (\n        <div className=\"px-4 pb-4 pt-3 border-t border-border animate-in fade-in duration-200\">\n          <div className=\"space-y-3\">\n            {/* Market Context */}\n            {item.marketContext && (\n              <div className=\"space-y-1\">\n                <h4 className=\"text-[10px] font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <TrendingUp className=\"w-3 h-3\" /> Market Context\n                </h4>\n                <p className=\"text-xs leading-relaxed\">{item.marketContext}</p>\n              </div>\n            )}\n\n            {/* Setup Notes */}\n            {item.setupNotes && item.setupNotes.length > 0 && (\n              <div className=\"space-y-1\">\n                <h4 className=\"text-[10px] font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <Target className=\"w-3 h-3\" /> Setup Notes\n                </h4>\n                <ul className=\"text-xs space-y-0.5\">\n                  {item.setupNotes.map((note: string, idx: number) => (\n                    <li key={idx} className=\"flex items-start gap-1\">\n                      <span className=\"text-primary\">•</span>\n                      <span className=\"break-words\">{note}</span>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            {/* Confirmations Pending */}\n            {item.confirmationsPending && item.confirmationsPending.length > 0 && (\n              <div className=\"space-y-1\">\n                <h4 className=\"text-[10px] font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                  <Shield className=\"w-3 h-3\" /> Confirmations Pending\n                </h4>\n                <ul className=\"text-xs space-y-0.5\">\n                  {item.confirmationsPending.map((conf: string, idx: number) => (\n                    <li key={idx} className=\"flex items-start gap-1\">\n                      <span className=\"text-amber-500\">•</span>\n                      <span className=\"break-words\">{conf}</span>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            {/* Setup Stats */}\n            <div className=\"space-y-1\">\n              <h4 className=\"text-[10px] font-semibold uppercase text-muted-foreground flex items-center gap-1\">\n                <BarChart2 className=\"w-3 h-3\" /> Setup Stats\n              </h4>\n              <div className=\"flex flex-wrap gap-x-4 gap-y-1 text-xs\">\n                <div>\n                  <span className=\"text-muted-foreground\">Stage:</span>\n                  <span className=\"ml-1 font-semibold capitalize\">{item.setupStage}</span>\n                </div>\n                {item.trendBias && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Trend:</span>\n                    <span className=\"ml-1 font-semibold\">{item.trendBias}</span>\n                  </div>\n                )}\n                {item.chochDetected && (\n                  <div>\n                    <span className=\"text-muted-foreground\">CHOCH:</span>\n                    <span className=\"ml-1 font-semibold text-emerald-500\">Yes</span>\n                  </div>\n                )}\n                {item.liquiditySweepDetected && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Sweep:</span>\n                    <span className=\"ml-1 font-semibold text-emerald-500\">Yes</span>\n                  </div>\n                )}\n                {item.zoneLevel && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Zone:</span>\n                    <span className=\"ml-1 font-semibold\">{item.zoneLevel}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":10905},"client/src/pages/Cryptocurrency.tsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport SignalCard from '@/components/SignalCard';\nimport WatchlistCard from '@/components/WatchlistCard';\nimport { Target, Eye } from 'lucide-react';\n\nconst SectionHeader = ({ icon: Icon, title, countLabel }: any) => (\n  <div className=\"flex items-center justify-between py-4 border-b-2 border-gray-900 bg-white px-6\">\n    <div className=\"flex items-center gap-3\">\n      <Icon className=\"w-5 h-5 text-gray-900\" />\n      <h2 className=\"text-xl font-extrabold text-gray-900 tracking-tight uppercase\">{title}</h2>\n    </div>\n    {countLabel && (\n      <span className=\"px-3 py-1 text-xs font-bold text-gray-900 bg-amber-200 uppercase tracking-widest border border-gray-900\">\n        {countLabel}\n      </span>\n    )}\n  </div>\n);\n\nexport default function Cryptocurrency() {\n  const { data: allSignals = [], isLoading: signalsLoading } = useQuery<any[]>({\n    queryKey: ['/api/trading-signals'],\n    refetchInterval: 10000,\n  });\n\n  const { data: pendingSetups = [], isLoading: setupsLoading } = useQuery<any[]>({\n    queryKey: ['/api/pending-setups'],\n    refetchInterval: 15000,\n  });\n\n  const cryptoSignals = allSignals.filter(s => s.assetClass === 'crypto');\n  const watchlistItems = pendingSetups.filter(s => !s.readyForSignal && s.assetClass === 'crypto');\n\n  return (\n    <div className=\"min-h-screen bg-[#f7f7f7] text-gray-800 p-4 md:p-8\">\n      <div className=\"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8\">\n        <div className=\"lg:col-span-8 flex flex-col gap-8\">\n          <section className=\"bg-white border-t-2 border-gray-900\">\n            <SectionHeader \n              icon={Target} \n              title=\"Cryptocurrency Signals\" \n              countLabel={`${cryptoSignals.length} Active`}\n            />\n            <div className=\"flex flex-col\">\n              {signalsLoading ? (\n                <div className=\"p-8 text-center text-gray-500\">Loading signals...</div>\n              ) : cryptoSignals.length === 0 ? (\n                <div className=\"p-8 text-center text-gray-500\">No active crypto signals</div>\n              ) : (\n                cryptoSignals.map(signal => (\n                  <SignalCard key={signal.id} signal={signal} />\n                ))\n              )}\n            </div>\n          </section>\n        </div>\n\n        <div className=\"lg:col-span-4\">\n          <section className=\"bg-white border-t-2 border-gray-900 sticky top-8\">\n            <SectionHeader icon={Eye} title=\"Crypto Watchlist\" />\n            <div className=\"flex flex-col\">\n              {setupsLoading ? (\n                <div className=\"p-8 text-center text-gray-500\">Loading watchlist...</div>\n              ) : watchlistItems.length === 0 ? (\n                <div className=\"p-8 text-center text-gray-500\">No instruments being monitored</div>\n              ) : (\n                watchlistItems.map(item => (\n                  <WatchlistCard key={item.id} item={item} />\n                ))\n              )}\n            </div>\n          </section>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3065},"client/src/components/SectionHeader.tsx":{"content":"import { LucideIcon } from 'lucide-react';\n\ninterface SectionHeaderProps {\n  icon: LucideIcon;\n  title: string;\n  countLabel?: string;\n}\n\nexport default function SectionHeader({ icon: Icon, title, countLabel }: SectionHeaderProps) {\n  return (\n    <div className=\"flex items-center justify-between py-4 border-b-2 border-gray-900 bg-card px-6\">\n      <div className=\"flex items-center gap-3\">\n        <Icon className=\"w-5 h-5 text-foreground\" />\n        <h2 className=\"text-xl font-extrabold text-foreground tracking-tight uppercase\">{title}</h2>\n      </div>\n      {countLabel && (\n        <span className=\"px-3 py-1 text-xs font-bold text-foreground bg-amber-200 dark:bg-amber-800 uppercase tracking-widest border border-foreground\">\n          {countLabel}\n        </span>\n      )}\n    </div>\n  );\n}\n","size_bytes":802},"client/src/pages/Commodities.tsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport SignalCard from '@/components/SignalCard';\nimport WatchlistCard from '@/components/WatchlistCard';\nimport { Target, Eye } from 'lucide-react';\n\nconst SectionHeader = ({ icon: Icon, title, countLabel }: any) => (\n  <div className=\"flex items-center justify-between py-4 border-b-2 border-gray-900 bg-white px-6\">\n    <div className=\"flex items-center gap-3\">\n      <Icon className=\"w-5 h-5 text-gray-900\" />\n      <h2 className=\"text-xl font-extrabold text-gray-900 tracking-tight uppercase\">{title}</h2>\n    </div>\n    {countLabel && (\n      <span className=\"px-3 py-1 text-xs font-bold text-gray-900 bg-amber-200 uppercase tracking-widest border border-gray-900\">\n        {countLabel}\n      </span>\n    )}\n  </div>\n);\n\nexport default function Commodities() {\n  const { data: allSignals = [], isLoading: signalsLoading } = useQuery<any[]>({\n    queryKey: ['/api/trading-signals'],\n    refetchInterval: 10000,\n  });\n\n  const { data: pendingSetups = [], isLoading: setupsLoading } = useQuery<any[]>({\n    queryKey: ['/api/pending-setups'],\n    refetchInterval: 15000,\n  });\n\n  const commoditySignals = allSignals.filter(s => s.assetClass === 'commodity');\n  const watchlistItems = pendingSetups.filter(s => !s.readyForSignal && s.assetClass === 'commodity');\n\n  return (\n    <div className=\"min-h-screen bg-[#f7f7f7] text-gray-800 p-4 md:p-8\">\n      <div className=\"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8\">\n        <div className=\"lg:col-span-8 flex flex-col gap-8\">\n          <section className=\"bg-white border-t-2 border-gray-900\">\n            <SectionHeader \n              icon={Target} \n              title=\"Commodity Signals (Gold, Oil, Metals)\" \n              countLabel={`${commoditySignals.length} Active`}\n            />\n            <div className=\"flex flex-col\">\n              {signalsLoading ? (\n                <div className=\"p-8 text-center text-gray-500\">Loading signals...</div>\n              ) : commoditySignals.length === 0 ? (\n                <div className=\"p-8 text-center text-gray-500\">No active commodity signals</div>\n              ) : (\n                commoditySignals.map(signal => (\n                  <SignalCard key={signal.id} signal={signal} />\n                ))\n              )}\n            </div>\n          </section>\n        </div>\n\n        <div className=\"lg:col-span-4\">\n          <section className=\"bg-white border-t-2 border-gray-900 sticky top-8\">\n            <SectionHeader icon={Eye} title=\"Commodity Watchlist\" />\n            <div className=\"flex flex-col\">\n              {setupsLoading ? (\n                <div className=\"p-8 text-center text-gray-500\">Loading watchlist...</div>\n              ) : watchlistItems.length === 0 ? (\n                <div className=\"p-8 text-center text-gray-500\">No instruments being monitored</div>\n              ) : (\n                watchlistItems.map(item => (\n                  <WatchlistCard key={item.id} item={item} />\n                ))\n              )}\n            </div>\n          </section>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3101},"client/src/pages/MajorPairs.tsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport SignalCard from '@/components/SignalCard';\nimport WatchlistCard from '@/components/WatchlistCard';\nimport { Target, Eye } from 'lucide-react';\n\nconst SectionHeader = ({ icon: Icon, title, countLabel }: any) => (\n  <div className=\"flex items-center justify-between py-4 border-b-2 border-gray-900 bg-white px-6\">\n    <div className=\"flex items-center gap-3\">\n      <Icon className=\"w-5 h-5 text-gray-900\" />\n      <h2 className=\"text-xl font-extrabold text-gray-900 tracking-tight uppercase\">{title}</h2>\n    </div>\n    {countLabel && (\n      <span className=\"px-3 py-1 text-xs font-bold text-gray-900 bg-amber-200 uppercase tracking-widest border border-gray-900\">\n        {countLabel}\n      </span>\n    )}\n  </div>\n);\n\nexport default function MajorPairs() {\n  const { data: allSignals = [], isLoading: signalsLoading } = useQuery<any[]>({\n    queryKey: ['/api/trading-signals'],\n    refetchInterval: 10000,\n  });\n\n  const { data: pendingSetups = [], isLoading: setupsLoading } = useQuery<any[]>({\n    queryKey: ['/api/pending-setups'],\n    refetchInterval: 15000,\n  });\n\n  const forexSignals = allSignals.filter(s => s.assetClass === 'forex');\n  const watchlistItems = pendingSetups.filter(s => !s.readyForSignal && s.assetClass === 'forex');\n\n  return (\n    <div className=\"min-h-screen bg-[#f7f7f7] text-gray-800 p-4 md:p-8\">\n      <div className=\"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8\">\n        <div className=\"lg:col-span-8 flex flex-col gap-8\">\n          <section className=\"bg-white border-t-2 border-gray-900\">\n            <SectionHeader \n              icon={Target} \n              title=\"Major Forex Pairs Signals\" \n              countLabel={`${forexSignals.length} Active`}\n            />\n            <div className=\"flex flex-col\">\n              {signalsLoading ? (\n                <div className=\"p-8 text-center text-gray-500\">Loading signals...</div>\n              ) : forexSignals.length === 0 ? (\n                <div className=\"p-8 text-center text-gray-500\">No active forex signals</div>\n              ) : (\n                forexSignals.map(signal => (\n                  <SignalCard key={signal.id} signal={signal} />\n                ))\n              )}\n            </div>\n          </section>\n        </div>\n\n        <div className=\"lg:col-span-4\">\n          <section className=\"bg-white border-t-2 border-gray-900 sticky top-8\">\n            <SectionHeader icon={Eye} title=\"Forex Watchlist\" />\n            <div className=\"flex flex-col\">\n              {setupsLoading ? (\n                <div className=\"p-8 text-center text-gray-500\">Loading watchlist...</div>\n              ) : watchlistItems.length === 0 ? (\n                <div className=\"p-8 text-center text-gray-500\">No instruments being monitored</div>\n              ) : (\n                watchlistItems.map(item => (\n                  <WatchlistCard key={item.id} item={item} />\n                ))\n              )}\n            </div>\n          </section>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3056},"client/src/components/LivePriceDisplay.tsx":{"content":"import { ArrowUpRight, ArrowDownRight, Loader2 } from 'lucide-react';\nimport { usePrice, formatPrice, formatChange } from '@/hooks/usePrices';\n\ninterface LivePriceDisplayProps {\n  symbol: string;\n  assetClass: 'stock' | 'forex' | 'commodity' | 'crypto';\n  showChange?: boolean;\n  size?: 'sm' | 'md' | 'lg';\n  className?: string;\n}\n\nexport default function LivePriceDisplay({ \n  symbol, \n  assetClass, \n  showChange = true,\n  size = 'md',\n  className = ''\n}: LivePriceDisplayProps) {\n  const { data: priceData, isLoading, isError } = usePrice(symbol, assetClass);\n  \n  const sizeClasses = {\n    sm: { price: 'text-sm', change: 'text-xs', icon: 'w-3 h-3' },\n    md: { price: 'text-xl', change: 'text-sm', icon: 'w-4 h-4' },\n    lg: { price: 'text-2xl', change: 'text-base', icon: 'w-5 h-5' }\n  };\n  \n  const sizes = sizeClasses[size];\n  \n  if (isLoading) {\n    return (\n      <div className={`flex items-center gap-2 ${className}`}>\n        <Loader2 className={`${sizes.icon} animate-spin text-muted-foreground`} />\n        <span className={`${sizes.price} font-bold text-muted-foreground`}>Loading...</span>\n      </div>\n    );\n  }\n  \n  if (isError || !priceData || priceData.error) {\n    return (\n      <div className={`flex items-center gap-2 ${className}`}>\n        <span className={`${sizes.price} font-bold text-muted-foreground`}>---</span>\n      </div>\n    );\n  }\n  \n  const { text: changeText, isPositive } = formatChange(priceData.change, priceData.changePercent);\n  const priceText = formatPrice(priceData.price, assetClass === 'forex' ? 5 : 2);\n  const changeColor = isPositive ? 'text-emerald-600 dark:text-emerald-400' : 'text-rose-600 dark:text-rose-400';\n  const ChangeIcon = isPositive ? ArrowUpRight : ArrowDownRight;\n  \n  return (\n    <div className={`flex flex-col ${className}`}>\n      <div className={`${sizes.price} font-extrabold tabular-nums`} data-testid=\"live-price-value\">\n        {priceText}\n      </div>\n      {showChange && (\n        <div className={`flex items-center gap-1 ${sizes.change} ${changeColor}`} data-testid=\"live-price-change\">\n          <ChangeIcon className={sizes.icon} />\n          <span className=\"font-semibold tabular-nums\">{changeText}</span>\n        </div>\n      )}\n    </div>\n  );\n}\n\ninterface CompactLivePriceProps {\n  symbol: string;\n  assetClass: 'stock' | 'forex' | 'commodity' | 'crypto';\n  className?: string;\n}\n\nexport function CompactLivePrice({ symbol, assetClass, className = '' }: CompactLivePriceProps) {\n  const { data: priceData, isLoading, isError } = usePrice(symbol, assetClass);\n  \n  if (isLoading) {\n    return <span className={`text-muted-foreground ${className}`}>...</span>;\n  }\n  \n  if (isError || !priceData || priceData.error) {\n    return <span className={`text-muted-foreground ${className}`}>---</span>;\n  }\n  \n  const priceText = formatPrice(priceData.price, assetClass === 'forex' ? 5 : 2);\n  const { isPositive } = formatChange(priceData.change, priceData.changePercent);\n  const changeColor = isPositive ? 'text-emerald-600 dark:text-emerald-400' : 'text-rose-600 dark:text-rose-400';\n  \n  return (\n    <span className={`font-bold tabular-nums ${changeColor} ${className}`} data-testid=\"compact-live-price\">\n      {priceText}\n    </span>\n  );\n}\n\ninterface LivePriceWithEntryProps {\n  symbol: string;\n  assetClass: 'stock' | 'forex' | 'commodity' | 'crypto';\n  entryPrice?: number | string | null;\n  signalType?: 'buy' | 'sell' | string;\n  className?: string;\n}\n\nexport function LivePriceWithEntry({ \n  symbol, \n  assetClass, \n  entryPrice,\n  signalType,\n  className = '' \n}: LivePriceWithEntryProps) {\n  const { data: priceData, isLoading, isError } = usePrice(symbol, assetClass);\n  \n  const entry = typeof entryPrice === 'string' ? parseFloat(entryPrice) : entryPrice;\n  const isBuy = signalType?.toLowerCase() === 'buy';\n  \n  if (isLoading) {\n    return (\n      <div className={`flex items-center gap-2 ${className}`}>\n        <Loader2 className=\"w-4 h-4 animate-spin text-muted-foreground\" />\n        <span className=\"text-sm text-muted-foreground\">Loading price...</span>\n      </div>\n    );\n  }\n  \n  if (isError || !priceData || priceData.error) {\n    return (\n      <div className={`flex flex-col ${className}`}>\n        <span className=\"text-[10px] uppercase tracking-wider text-muted-foreground font-semibold mb-1\">\n          Current Price\n        </span>\n        <span className=\"text-sm font-extrabold text-muted-foreground\">---</span>\n      </div>\n    );\n  }\n  \n  const currentPrice = priceData.price ?? 0;\n  const priceText = formatPrice(currentPrice, assetClass === 'forex' ? 5 : 2);\n  const { text: changeText, isPositive } = formatChange(priceData.change, priceData.changePercent);\n  const marketChangeColor = isPositive ? 'text-emerald-600 dark:text-emerald-400' : 'text-rose-600 dark:text-rose-400';\n  \n  let pnlColor = 'text-foreground';\n  let pnlText = '';\n  \n  if (entry && !isNaN(entry) && entry > 0) {\n    // For BUY: profit when current > entry (positive %)\n    // For SELL: profit when current < entry (show positive % for profit)\n    const rawPnlPercent = ((currentPrice - entry) / entry) * 100;\n    // Invert the percentage for SELL signals so profit shows as positive\n    const pnlPercent = isBuy ? rawPnlPercent : -rawPnlPercent;\n    const inProfit = pnlPercent > 0;\n    pnlColor = inProfit ? 'text-emerald-600 dark:text-emerald-400' : 'text-rose-600 dark:text-rose-400';\n    const sign = pnlPercent >= 0 ? '+' : '';\n    pnlText = `${sign}${pnlPercent.toFixed(2)}% from entry`;\n  }\n  \n  return (\n    <div className={`flex flex-col ${className}`}>\n      <span className=\"text-[10px] uppercase tracking-wider text-muted-foreground font-semibold mb-1 flex items-center gap-1\">\n        Current Price\n        <span className={`${marketChangeColor}`}>({changeText})</span>\n      </span>\n      <span className=\"text-sm font-extrabold tabular-nums\" data-testid=\"live-current-price\">\n        {priceText}\n      </span>\n      {pnlText && (\n        <span className={`text-xs ${pnlColor} mt-0.5`} data-testid=\"live-pnl-from-entry\">\n          {pnlText}\n        </span>\n      )}\n    </div>\n  );\n}\n","size_bytes":6095},"attached_assets/tradebot_1764097643860.py":{"content":"import os\r\nimport time\r\nfrom dotenv import load_dotenv\r\nimport google.generativeai as genai\r\nimport re\r\n\r\n\r\nload_dotenv()\r\nGOOGLE_API_KEY = os.getenv(\"GOOGLE_API_KEY\")\r\ngenai.configure(api_key=GOOGLE_API_KEY)\r\n\r\n\r\nclass GeminiMarketAnalyzer:\r\n    def __init__(self, file_paths, mime_types):\r\n        \"\"\"\r\n        Initializes the GeminiMarketAnalyzer with file paths and their mime types.\r\n\r\n        Args:\r\n            file_paths (list): List of file paths to be uploaded.\r\n            mime_types (list): List of mime types corresponding to the file paths.\r\n        \"\"\"\r\n\r\n        if len(file_paths) != len(mime_types):\r\n            raise ValueError(\"Length of file_paths and mime_types must be the same.\")\r\n\r\n        self.file_paths = file_paths\r\n        self.mime_types = mime_types\r\n        self.files = []\r\n        self.model = self._create_model()\r\n        \r\n        os.makedirs(r\"C:\\Users\\USER\\Downloads\\gen-ai\\fx_analysis\", exist_ok=True)\r\n        \r\n        self.file_name = os.path.splitext(os.path.basename(self.file_paths[0]))[0]\r\n        self.base_name = os.path.splitext(self.file_name)[0][:7]\r\n    \r\n         # Create the output directory using the extracted name\r\n        self.directory_path = os.path.join(r\"C:\\Users\\USER\\Downloads\\gen-ai\\fx_analysis\", self.base_name)\r\n        os.makedirs(self.directory_path, exist_ok=True)\r\n        self.pre_result = self.base_name+\"_analysis.md\"\r\n        self.resultFile = os.path.join(self.directory_path, self.pre_result)\r\n        \r\n\r\n    def _create_model(self):\r\n          \"\"\"Creates the Gemini model with specified configurations.\"\"\"\r\n          generation_config = {\r\n            \"temperature\": 2,\r\n            \"top_p\": 0.95,\r\n            \"top_k\": 40,\r\n            \"max_output_tokens\": 8192,\r\n            \"response_mime_type\": \"text/plain\",\r\n          }\r\n\r\n          model = genai.GenerativeModel(\r\n            model_name=\"gemini-2.0-flash-exp\",\r\n            generation_config=generation_config,\r\n            system_instruction=\"Role: You are a technical analysis expert who excels in using Smart money concepts to predict buy or sell zones. \\\\n**input: you will be given forex data, consume the hourly, daily and weekly price action (starting from the latest datapoints) - this is very important\\nProcess: Before you do anything, state the last hourly datapoint and walking backwards from there, Follow the SMC Strategy step by step \\\\noutput: You must state the **Optimal entry around current price** the next best price to buy or sell within the next few candlesticks. around the current price; always state the suggested prices\\\\n**Strategy: ```Precision SMC Scalping Strategy: Targeting Near-Term Price Action\\n1. Introduction\\n\\nStrategy Name: Precision SMC Scalping Strategy (PSSS)\\nPurpose: To identify the most probable next price point for a buy or sell within the next 1-5 candles on a very short-term timeframe, leveraging Smart Money Concepts for high-probability scalping opportunities.\\nTarget Audience: Experienced traders with a strong understanding of Smart Money Concepts, technical analysis, and risk management principles, comfortable with fast-paced market environments.\\nDisclaimer: Trading involves substantial risk of loss. This strategy is for educational purposes and does not guarantee profits. Live trading with this strategy should only be undertaken after thorough backtesting, demo trading, and a complete understanding of its nuances and risks.\\n\\n2. Core Concepts\\n\\nSmart Money Concepts (SMC): In this context, SMC refers to the methodologies used to interpret and anticipate the actions of large institutional traders (the \\\"smart money\\\"). This involves identifying their footprints in the market through:\\n\\nInstitutional Order Flow: Observing price action patterns that suggest the accumulation or distribution of large orders.\\n\\nLiquidity Manipulation: Recognizing instances where price movements are designed to induce retail traders into taking positions before reversing to capitalize on their stop losses.\\n\\nSupply and Demand Imbalances: Pinpointing areas where there's a significant disparity between buying and selling pressure, creating zones of potential future price reaction.\\n\\nKey SMC Elements Used:\\n\\nMarket Structure: Crucial for determining the current directional bias. We will identify:\\n\\nBullish Market Structure: Characterized by higher highs (HH) and higher lows (HL). Breaks of Structure (BOS) to the upside confirm continuation.\\n\\nBearish Market Structure: Characterized by lower lows (LL) and lower highs (LH). Breaks of Structure (BOS) to the downside confirm continuation.\\n\\nChange of Character (CHoCH): A crucial signal indicating a potential shift in market direction. A bearish CHoCH occurs when price breaks a recent higher low in a bullish trend. A bullish CHoCH occurs when price breaks a recent lower high in a bearish trend. This signals a potential temporary or sustained reversal.\\n\\nOrder Blocks: Represents the last candle before a significant impulsive move. These areas are where institutional orders were likely placed, making them potential zones of future support or resistance.\\n\\nBullish Order Block: The last down-close candle before a strong bullish impulsive move. Price revisiting this area may be met with buying pressure.\\n\\nBearish Order Block: The last up-close candle before a strong bearish impulsive move. Price revisiting this area may be met with selling pressure.\\n\\nRefined Order Blocks: On lower timeframes, further refinement of the order block can be done by identifying the inefficiencies or the origin of the impulsive move within the initial order block candle.\\n\\nImbalances (Fair Value Gaps - FVG): Represent inefficiencies in the market where price has moved rapidly, leaving a gap where no trading occurred. These gaps often get filled as price revisits these areas to restore market equilibrium.\\n\\nBullish FVG: A three-candle pattern where the high of the first candle is lower than the low of the third candle.\\n\\nBearish FVG: A three-candle pattern where the low of the first candle is higher than the high of the third candle.\\n\\nLiquidity Pools: Areas in the market where a concentration of stop losses or pending orders is likely present. Smart money often targets these areas to fill their large orders or induce volatility.\\n\\nEqual Highs/Lows: Obvious levels where many traders might place stop losses.\\n\\nTrendline Breaks: Areas where breakout traders might enter positions, placing their stops behind the trendline.\\n\\nPrevious Session Highs/Lows: Psychological levels where stop losses and take profit orders may accumulate.\\n\\nPremium and Discount Zones: Based on the Fibonacci retracement tool drawn from the most recent swing high to swing low (for bullish bias) or swing low to swing high (for bearish bias).\\n\\nDiscount Zone (Below 50% Fibonacci): Considered a desirable area to look for buy opportunities when the overall bias is bullish.\\n\\nPremium Zone (Above 50% Fibonacci): Considered a desirable area to look for sell opportunities when the overall bias is bearish.\\n\\n3. Strategy Rules\\n\\nTimeframe: Primarily 1-minute or 30-second chart for entries and immediate price action. A higher timeframe (e.g., 5-minute or 15-minute) is used to determine the overall market structure and bias.\\n\\nEntry Rules:\\n\\nLong Entry:\\n\\nEstablish Bullish Bias: Identify a bullish market structure on the higher timeframe (e.g., 5-minute) with recent BOS to the upside or a clear bullish CHoCH.\\n\\nIdentify a Valid Bullish Order Block: On the entry timeframe (1-minute or 30-second), locate a bullish order block that formed after the establishment of the bullish bias. The order block should ideally:\\n\\nBe the last down-close candle before an impulsive bullish move.\\n\\nHave caused a BOS or CHoCH on the entry timeframe.\\n\\nIdeally have an unmitigated FVG associated with the impulsive move.\\n\\nPrice Retraces to the Order Block within a Discount Zone: Observe price action retracing towards the identified bullish order block. The order block should ideally be located within a discount zone (below the 50% Fibonacci retracement level drawn from the recent swing high to swing low).\\n\\nConfirmation Signal: Look for a rapid, bullish candlestick confirmation signal within or near the order block on the entry timeframe. This could be:\\n\\nA strong bullish engulfing candle.\\n\\nA wick rejection at the order block.\\n\\nA small bullish BOS or CHoCH on an even lower timeframe (e.g., tick chart if available).\\n\\nAnticipated Next Price Target: The expected next price target will be a nearby unmitigated bearish FVG or a liquidity pool (equal highs, previous session high) above the entry point.\\n\\nShort Entry:\\n\\nEstablish Bearish Bias: Identify a bearish market structure on the higher timeframe (e.g., 5-minute) with recent BOS to the downside or a clear bearish CHoCH.\\n\\nIdentify a Valid Bearish Order Block: On the entry timeframe (1-minute or 30-second), locate a bearish order block that formed after the establishment of the bearish bias. The order block should ideally:\\n\\nBe the last up-close candle before an impulsive bearish move.\\n\\nHave caused a BOS or CHoCH on the entry timeframe.\\n\\nIdeally have an unmitigated FVG associated with the impulsive move.\\n\\nPrice Retraces to the Order Block within a Premium Zone: Observe price action retracing towards the identified bearish order block. The order block should ideally be located within a premium zone (above the 50% Fibonacci retracement level drawn from the recent swing low to swing high).\\n\\nConfirmation Signal: Look for a rapid, bearish candlestick confirmation signal within or near the order block on the entry timeframe. This could be:\\n\\nA strong bearish engulfing candle.\\n\\nA wick rejection at the order block.\\n\\nA small bearish BOS or CHoCH on an even lower timeframe (e.g., tick chart if available).\\n\\nAnticipated Next Price Target: The expected next price target will be a nearby unmitigated bullish FVG or a liquidity pool (equal lows, previous session low) below the entry point.\\n\\nStop Loss:\\n\\nLong Entry: Place the stop loss just below the low of the bullish order block or a recent significant swing low on the entry timeframe. Consider a small buffer to avoid being stopped out by insignificant wicks.\\n\\nShort Entry: Place the stop loss just above the high of the bearish order block or a recent significant swing high on the entry timeframe. Consider a small buffer.\\n\\nTake Profit:\\n\\nPrimary Target: The immediate target is the next identifiable unmitigated FVG or a liquidity pool in the direction of the trade. Since this is a scalping strategy, these targets will be relatively close.\\n\\nMultiple Take Profit Levels: Consider using multiple take profit levels to secure partial profits and manage risk:\\n\\nTP1: At the nearest FVG or liquidity pool. Take a significant portion (e.g., 70-80%) of the position off.\\n\\nTP2: At the next significant FVG or liquidity pool further in the direction of the trade. Move the stop loss to breakeven or in profit after hitting TP1.\\n\\nTrade Management:\\n\\nImmediate Action: Due to the short timeframe, decisions need to be made quickly.\\n\\nMove Stop Loss to Breakeven: After TP1 is hit, immediately move the stop loss to the entry price to eliminate risk on the remaining position.\\n\\nTrailing Stop Loss (Optional): For TP2, a trailing stop loss can be used to lock in profits as price moves further in your favor. However, be cautious with tight trailing stops in volatile conditions.\\n\\nAvoid Over-Leveraging: Due to the fast-paced nature, avoid using excessive leverage that can lead to significant losses with small price fluctuations.\\n\\n4. Chart Examples\\nSynthesize the chart for:\\n\\nHigher timeframe market structure and bias.\\n\\nIdentified order blocks.\\n\\nPremium/discount zones.\\n\\nFVGs and liquidity pools.\\n\\nEntry point based on confirmation signal.\\n\\nStop loss placement.\\n\\nTake profit targets.\\n\\nAnnotation explaining the reasoning behind the trade setup.\\n\\nExamples of losing trades would illustrate instances where the setup was valid but the market moved against the prediction, emphasizing the inherent risk.)\\n\\n5. Risk Management\\n\\nPosition Sizing: Determine position size based on a fixed percentage risk per trade. A conservative approach for scalping is recommended.\\n* Calculate Position Size: (Account Balance * Risk Percentage per Trade) / Stop Loss in Pips.\\nMaximum Risk per Trade: 0.5% to 1% of trading capital per trade is highly recommended for scalping due to the increased frequency of trades.\\nMaximum Daily/Weekly Risk: Set a limit on the total percentage of capital you are willing to risk within a day or week (e.g., 2-3% daily, 5% weekly). Once this limit is reached, stop trading for the period.\\nRisk-Reward Ratio: Aim for a minimum risk-reward ratio of 1:1.5 or higher on individual trades. While scalping involves smaller profits, maintaining a positive risk-reward is crucial for long-term profitability.\\n\\n\\n8. Conclusion\\n\\nThe Precision SMC Scalping Strategy (PSSS) offers a framework for identifying high-probability short-term buy/sell opportunities based on Smart Money Concepts. By focusing on institutional order flow, liquidity manipulation, and supply/demand imbalances, traders can anticipate near-term price movements with a high degree of accuracy when setups align.\\n\\n**Example Response: \\\"Okay, let's break down USD/JPY using the provided data and the Precision SMC Scalping Strategy.\\n\\n  **Current Market State (as of the last data point)** *   **Last Price:** 1.0248001814 *   **Last Date:** 2025-01-10T22:00:00.000Z (10 Jan 2025, 10 PM GMT) \\n\\n**1. Weekly Analysis:**\\n\\n*   **Overall Trend:** The weekly chart shows a clear uptrend from Jan 2024 until August when a large drop and some choppiness set in before uptrend resuming in the final data point on Jan 2025. However,  there are very small red candle after a few candles. This shows strong upward momentum\\n*   **Key Levels**: Support would be somewhere below 146.2. Resistance could be considered around 161.9\\n*   **Bias:** Still bullish bias, considering the overall upwards momentum. We must however consider a bearish shift is very possible at the level 161.9 considering this also constitutes the last weeks high. \\n  *   For the next few days to a week a retest to weekly candle bodies is expected\\n\\n**2. Daily Analysis:**\\n*   **Overall Trend:**  Uptrend\\n*  **Key Levels**: Resistance would be around 158.5. Support lies at the last lower high 157.2. It is important to see which daily candle high/low we will take out this can confirm uptrend and a short retracement target\\n*  **Bias**: Still bullish bias. A change of character has yet to present itself on the daily\\n\\n**3. Hourly Analysis**\\n*   **Recent Price Action**: Current price 158.00 . From our higher time frame it can be said a retracement to discount is still possible to then target another leg up, the hourly data has a change of character with the break of  the low at  around 158.3, showing a short term bearish potential with the break and retracement. there was another small break below 158, creating further lower lows.\\n*  **Key Levels**: a support lies at 157.7. Our hourly bias is bearish\\n*   **FVG/Order Block:** an order block with inefficiency presents itself on the latest red candle.\\n\\n**4.  SMC Analysis and Trade Recommendation:**\\n\\nBased on the analysis, here's my recommendation using the scalping strategy:\\n\\n*   **Current Situation:** price is retracing a bearish impulsive move, the retracement has been strong, we would not short this current area with risk reward ratios being low, an optimal short position will be as stated below\\n\\n*  **Optimal Entry around current price**: Short Entry the identified bearish order block exists on the most recent red candle wick within this  hourly candle body with inefficiencies also being left unmitigated there at  around **158.09**, this price aligns with the current candle wick.\\n  \\n\\n*  **Stop Loss**: A stop loss would be placed just above the high of that bearish order block, approximately at 158.12 with a 2-3 pip buffer for safety.\\n\\n*  **Target Price:** As this is a scalp, targets should be reasonably short. next area of interest would be the hourly bullish imbalance  at **157.97** acting as a near term TP level.. It can be anticipated that the bears will want to mitigate the bullish move within a few candles with these prices and will therefore act as target point. if TP is hit move to Breakeven to anticipate the move. If this break happens our next target becomes 157.7 a key daily and hourly support level .\\n\\n*   **Risk Management:** Risk should always be small around 0.5-1%. Given the tight stop, size accordingly so that loss will remain less than your risk per trade parameter\\n\\n**5. Additional Considerations:**\\n   *  Be nimble and prepared to cut losses quickly. Scalping is high-paced trading that need fast decisions. \\n    * if bullish candle breaks and rejects off  the initial area at 158.09 before trigger short target will no longer be valid for entry\\n  \\n\\n**Summary:**\\nCurrent position not suitable for trade but upon retracement entry short position on  the specified entry of  158.09 is preferable for short with a 1-3 pip sl, targetting 157.97 initially before potential targets to 157.7.\\n\\n**Disclaimer:** This analysis is for educational purposes only and not financial advice. Always manage your risk carefully when trading. Be aware market movements can still prove against what might seem like high probability trades. The mentioned strategy has a good level of probability but will always contain inherent risks. Trading is subjective and may or may not fit individual requirements and should only be done upon through research by traders themselves.\\n\\\"\",\r\n        )\r\n          return model\r\n\r\n    def _upload_file(self, path, mime_type):\r\n        \"\"\"Uploads a file to Gemini.\"\"\"\r\n        file = genai.upload_file(path, mime_type=mime_type)\r\n        print(f\"Uploaded file '{file.display_name}' as: {file.uri}\")\r\n        return file\r\n\r\n    def _wait_for_files_active(self):\r\n        \"\"\"Waits for the uploaded files to be active.\"\"\"\r\n        print(\"Waiting for file processing...\")\r\n        for file in self.files:\r\n          while file.state.name == \"PROCESSING\":\r\n              print(\".\", end=\"\", flush=True)\r\n              time.sleep(10)\r\n              file = genai.get_file(file.name)\r\n          if file.state.name != \"ACTIVE\":\r\n              raise Exception(f\"File {file.name} failed to process\")\r\n        print(\"...all files ready\")\r\n        print()\r\n\r\n    def upload_files(self):\r\n        \"\"\"Uploads all specified files to Gemini and waits for processing.\"\"\"\r\n        for path, mime_type in zip(self.file_paths, self.mime_types):\r\n            file = self._upload_file(path, mime_type)\r\n            self.files.append(file)\r\n        self._wait_for_files_active()\r\n\r\n    def analyze_market(self):\r\n        \r\n         \"\"\"Sends the message to gemini to perform the analysis and prints the result.\"\"\"\r\n         chat_session = self.model.start_chat(\r\n            history=[\r\n             \r\n            ]\r\n        )\r\n         \r\n        #  prompt = [\"when you analyse, strongly reference the json data for accurate price and date data, the image is only for reference and contains estimations and always state the date. starting from the last datapoints because they are the lastest, now Synthesize the market structure including chart patterns, historical areas of values,  liquidity and  the last price from the hourly in json data as is, and implement the strategy. get the resistance and support values and other market values from the json files, use it to understand the images, the final signals should contain signals and the type of orders for both buy and sell and you will state the probability of each entry from 1-100 percent, also state the last price from the hourly in json data as is\"]\r\n\r\n         input_prompt = self.files\r\n        \r\n         response = chat_session.send_message(\r\n             input_prompt\r\n            )\r\n         for chunk in response:\r\n             print(chunk.text, end=\"\")\r\n             text = chunk.text\r\n             match = re.search(r\"\\*\\*summary(.*?)(?=disclaimer)\", text, re.IGNORECASE | re.DOTALL)\r\n\r\n             print(\"Extracting Details!\")\r\n             if match:\r\n                # print(\"Match Found!\")\r\n                response_text = match.group()\r\n             else:\r\n                # print(\"No match found!\")\r\n                match = re.search(r\"summary(.*)\", text, re.IGNORECASE  | re.DOTALL)\r\n                response_text = match.group()\r\n             \r\n             match2 = re.search(r\"optimal entry(.*?)(?=\\*\\*stop)\", text, re.IGNORECASE | re.DOTALL)\r\n             \r\n             response2_text = match2.group()\r\n             \r\n             print(self.directory_path)\r\n             with open(self.resultFile, \"a\", encoding=\"utf-8\") as file:\r\n                file.write( \"\\n\\n\" + \"*\" * 95 + \"\\n\\n\" + \"\\n\\n**********************SMC  ENTRY *********************\\n\\n\" + response_text  + \"\\n\" + response2_text)\r\n        \r\n        \r\n        #  print(response.text)\r\n        # #  with open(r\"C:\\Users\\USER\\Downloads\\gen-ai\\Forex-Analysis.md\", \"a\", encoding=\"utf-8\") as file:\r\n        #     # file.write(response.text)\r\n        \r\n\r\n\r\nif __name__ == \"__main__\":\r\n    # Example usage:\r\n    file_paths = ['C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_3mo_1d_processed.json', 'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_6mo_1wk_processed.json', 'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_5d_1h_processed.json', 'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_3mo_1d_chart.png', 'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_6mo_1wk_chart.png', 'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_5d_1h_chart.png']\r\n\r\n    mime_types = [\r\n        \"text/plain\",\r\n        \"text/plain\",\r\n        \"text/plain\",\r\n        \"image/png\",\r\n        \"image/png\",\r\n        \"image/png\",\r\n    ]\r\n    try:\r\n      analyzer = GeminiMarketAnalyzer(file_paths, mime_types)\r\n      analyzer.upload_files()\r\n      analyzer.analyze_market()\r\n    except Exception as e:\r\n      print(f\"An error occurred: {e}\")","size_bytes":22363},"attached_assets/trade_1764097643860.py":{"content":"import yfinance as yf\r\nimport pandas as pd\r\nimport os\r\nimport concurrent.futures\r\nimport time\r\n\r\nclass ForexDataProcessor:\r\n    SUPPORTED_PERIODS = [\"1d\", \"5d\", \"1mo\", \"3mo\", \"6mo\", \"1y\", \"2y\", \"5y\", \"10y\", \"ytd\", \"max\"]\r\n\r\n    def __init__(self, pairs, output_dir=\"forex_data\"):\r\n        self.forex_pairs = pairs\r\n        # self.forex_pairs = {\r\n        #     \"EUR/USD\": \"EURUSD=X\",\r\n        #     \"USD/JPY\": \"JPY=X\",\r\n        #     \"GBP/USD\": \"GBPUSD=X\",\r\n        #     \"USD/CHF\": \"CHF=X\",\r\n        #     \"USD/CAD\": \"CAD=X\",\r\n        #     \"AUD/USD\": \"AUDUSD=X\",\r\n        #     \"NZD/USD\": \"NZDUSD=X\"\r\n        # }\r\n        \r\n        # self.forex_pairs = {\r\n        #     \"BTC/USD\": \"BTC-USD\",\r\n        #     \"ETH/USD\": \"ETH-USD\",\r\n        #     \"XRP/USD\": \"XRP-USD\",\r\n        #     \"LTC/USD\": \"LTC-USD\",\r\n        #     \"ADA/USD\": \"ADA-USD\",\r\n        #     \"DOGE/USD\": \"DOGE-USD\",\r\n        #     \"BNB/USD\": \"BNB-USD\",  # Binance Coin\r\n        #     \"SOL/USD\": \"SOL-USD\", # Solana\r\n        #     \"DOT/USD\": \"DOT-USD\", # Polkadot\r\n        #     \"MATIC/USD\": \"MATIC-USD\" # Polygon\r\n        # }\r\n        \r\n        self.output_dir = output_dir\r\n        os.makedirs(self.output_dir, exist_ok=True)\r\n\r\n    def get_forex_data(self, pair_name, ticker, period, interval):\r\n        try:\r\n            if period not in self.SUPPORTED_PERIODS:\r\n                print(f\"Warning: Period '{period}' is not directly supported. Using '3mo' as fallback for {pair_name} ({period}, {interval}).\")\r\n                period = '3mo'\r\n\r\n            data = yf.download(tickers=ticker, period=period, interval=interval, progress=False)\r\n\r\n            if data.empty:\r\n                print(f\"Warning: No data found for {pair_name} ({period}, {interval}).\")\r\n                return None, pair_name, period, interval\r\n\r\n            data_json = data.to_json(date_format=\"iso\", orient=\"index\")\r\n            return data_json, pair_name, period, interval\r\n\r\n        except Exception as e:\r\n            print(f\"Error fetching data for {pair_name} ({period}, {interval}): {e}\")\r\n            return None, pair_name, period, interval\r\n\r\n    def process_timeframe(self, timeframe):\r\n        period = timeframe[\"period\"]\r\n        interval = timeframe[\"interval\"]\r\n        file_paths = []\r\n\r\n        with concurrent.futures.ProcessPoolExecutor() as executor:\r\n            futures = [\r\n                executor.submit(self.get_forex_data, pair, ticker, period, interval)\r\n                for pair, ticker in self.forex_pairs.items()\r\n            ]\r\n\r\n            for future in concurrent.futures.as_completed(futures):\r\n                data_json, pair_name, period, interval = future.result()\r\n                if data_json:\r\n                    filename = f\"{pair_name.replace('/', '-')}_{period}_{interval}.json\"\r\n                    filepath = os.path.join(self.output_dir, filename)\r\n                    try:\r\n                        with open(filepath, 'w') as f:\r\n                            f.write(data_json)\r\n                        print(f\"Data for {pair_name} ({period}, {interval}) saved to {filepath}\")\r\n                        file_paths.append(filepath)\r\n                    except Exception as e:\r\n                        print(f\"Error saving {pair_name} data ({period}, {interval}) to file: {e}\")\r\n\r\n        return file_paths\r\n\r\n    def process_all_timeframes(self, timeframes):\r\n        all_file_paths = []\r\n\r\n        with concurrent.futures.ProcessPoolExecutor() as executor:\r\n            timeframe_futures = [\r\n                executor.submit(self.process_timeframe, timeframe) for timeframe in timeframes\r\n            ]\r\n            \r\n            for future in concurrent.futures.as_completed(timeframe_futures):\r\n                all_file_paths.extend(future.result())\r\n\r\n        sorted_paths = self.sort_paths_by_currency(all_file_paths)\r\n        return sorted_paths\r\n\r\n    def sort_paths_by_currency(self, file_paths):\r\n        sorted_paths = {pair: [] for pair in self.forex_pairs.keys()}\r\n\r\n        for path in file_paths:\r\n            for pair in self.forex_pairs.keys():\r\n                if pair.replace('/', '-') in path:\r\n                    sorted_paths[pair].append(path)\r\n\r\n        return list(sorted_paths.values())\r\n\r\ndef dataRetriever(pairs):\r\n    pair_group = pairs\r\n    processor = ForexDataProcessor(pair_group)\r\n    \r\n    timeframes = [\r\n        {\"period\": \"1y\", \"interval\": \"1wk\"},\r\n        {\"period\": \"3mo\", \"interval\": \"1d\"},\r\n        {\"period\": \"5d\", \"interval\": \"1h\"},\r\n    ]\r\n\r\n    start_time = time.time()\r\n    sorted_file_paths = processor.process_all_timeframes(timeframes)\r\n    end_time = time.time()\r\n\r\n    print(\"Sorted file paths by currency:\")\r\n    for currency_paths in sorted_file_paths:\r\n        print(currency_paths)\r\n\r\n    print(f\"Finished processing all timeframes in {end_time - start_time:.2f} seconds.\")\r\n    return sorted_file_paths\r\n","size_bytes":4852},"attached_assets/forex_mailer_1764097643859.py":{"content":"import mistune\r\nimport os\r\nimport smtplib\r\nfrom email.mime.text import MIMEText\r\nfrom email.mime.multipart import MIMEMultipart\r\nfrom email.mime.base import MIMEBase\r\nfrom email import encoders\r\n\r\ndef markdown_to_html_email(markdown_filepath, recipient_email, sender_email, sender_password, subject=\"Markdown to HTML Email\", attachments=None):\r\n    \"\"\"\r\n    Converts a Markdown file to HTML using mistune, then sends it as an email with optional attachments.\r\n\r\n    Args:\r\n        markdown_filepath: Path to the Markdown file.\r\n        recipient_email: Email address of the recipient.\r\n        sender_email: Email address of the sender.\r\n        sender_password: Password for the sender's email account (use app passwords or environment variables).\r\n        subject: Subject of the email.\r\n        attachments: List of file paths to attach to the email (default: None).\r\n    \"\"\"\r\n    try:\r\n        # Read the Markdown file\r\n        with open(markdown_filepath, 'r', encoding='utf-8') as f:\r\n            markdown_text = f.read()\r\n\r\n        # Convert Markdown to HTML\r\n        renderer = mistune.HTMLRenderer()  # Initialize the renderer\r\n        markdown = mistune.Markdown(renderer=renderer)  # Initialize the markdown parser with the renderer\r\n        html_content = markdown(markdown_text)  # Process the markdown\r\n\r\n        # Create the email message\r\n        message = MIMEMultipart(\"alternative\")\r\n        message['Subject'] = subject\r\n        message['From'] = sender_email\r\n        message['To'] = recipient_email\r\n\r\n        # Attach plain text and HTML versions of the email\r\n        part1 = MIMEText(markdown_text, \"plain\")\r\n        part2 = MIMEText(html_content, \"html\")\r\n        message.attach(part1)\r\n        message.attach(part2)\r\n\r\n        # Attach files if provided\r\n        if attachments:\r\n            for filepath in attachments:\r\n                try:\r\n                    with open(filepath, 'rb') as attachment:\r\n                        part = MIMEBase('application', 'octet-stream')\r\n                        part.set_payload(attachment.read())\r\n                    encoders.encode_base64(part)  # Encode the attachment in base64\r\n                    filename = os.path.basename(filepath)  # Extract the filename\r\n                    part.add_header(\r\n                        'Content-Disposition',\r\n                        f'attachment; filename=\"{filename}\"'\r\n                    )\r\n                    message.attach(part)\r\n                    print(f\"Attached: {filename}\")\r\n                except FileNotFoundError:\r\n                    print(f\"Error: Attachment not found: {filepath}\")\r\n                except Exception as e:\r\n                    print(f\"Error attaching {filepath}: {e}\")\r\n\r\n        # Send the email\r\n        with smtplib.SMTP_SSL('smtp.gmail.com', 465) as server:\r\n            server.login(sender_email, sender_password)\r\n            server.sendmail(sender_email, recipient_email, message.as_string())\r\n\r\n        print(f\"Email sent successfully to {recipient_email}\")\r\n\r\n    except FileNotFoundError:\r\n        print(f\"Error: File not found: {markdown_filepath}\")\r\n    except Exception as e:\r\n        print(f\"An error occurred: {e}\")\r\n\r\n# # Example usage\r\n# if __name__ == \"__main__\":\r\n#     markdown_file = r\"C:\\Users\\USER\\Downloads\\gen-ai\\Forex-Analysis.md\"\r\n#     recipient = \"recipient@example.com\"\r\n#     sender = \"sender@gmail.com\"\r\n#     password = \"your_app_password\"  # Use an app-specific password for Gmail\r\n#     subject_line = \"Daily Forex Analysis\"\r\n#     attachments = [\r\n#         r\"C:\\Users\\USER\\Downloads\\gen-ai\\attachment1.pdf\",\r\n#         r\"C:\\Users\\USER\\Downloads\\gen-ai\\image.png\"\r\n#     ]\r\n\r\n#     markdown_to_html_email(markdown_file, recipient, sender, password, subject_line, attachments)","size_bytes":3757},"attached_assets/tradde_1764097643860.py":{"content":"import pandas as pd\r\nimport numpy as np\r\nimport mplfinance as mpf\r\nfrom scipy.signal import argrelextrema\r\nimport os\r\n\r\n\r\ndef process_and_plot(file_path, output_dir):\r\n    \"\"\"Processes a single file, plots the data, and saves the chart.\"\"\"\r\n\r\n    print(f\"Processing: {file_path}\")\r\n    # Load historical price data with correct format\r\n    try:\r\n        df = pd.read_json(file_path).T  # Transpose to fix structure\r\n        df.index = pd.to_datetime(df.index)  # Convert index to DateTime\r\n        df = df.sort_index()  # Sort by date\r\n        df.reset_index(inplace=True)\r\n        df.rename(columns={\"index\": \"Date\"}, inplace=True)  # Rename index to Date\r\n    except Exception as e:\r\n        print(f\"Error reading JSON file {file_path}, skipping file with error: {e}\")\r\n        return None, None\r\n\r\n    # Compute Moving Averages (50 & 200 EMA for trends)\r\n    def ema(series, period):\r\n        return series.ewm(span=period, adjust=False).mean()\r\n\r\n    df[\"EMA_50\"] = ema(df[\"Close\"], 50)\r\n    df[\"EMA_200\"] = ema(df[\"Close\"], 200)\r\n\r\n    # Detect Trends\r\n    def detect_trend(row):\r\n        if row[\"EMA_50\"] > row[\"EMA_200\"]:\r\n            return \"Uptrend\"\r\n        elif row[\"EMA_50\"] < row[\"EMA_200\"]:\r\n            return \"Downtrend\"\r\n        else:\r\n            return \"Sideways\"\r\n\r\n    df[\"Trend\"] = df.apply(detect_trend, axis=1)\r\n\r\n    # Detect Support & Resistance (Using Local Extrema)\r\n    def find_support_resistance(df, order=5):\r\n        \"\"\"Finds local highs and lows for support & resistance detection.\"\"\"\r\n        df[\"Support\"] = np.nan\r\n        df[\"Resistance\"] = np.nan\r\n\r\n        # Local minima (Support)\r\n        local_min = argrelextrema(df[\"Low\"].values, np.less, order=order)[0]\r\n        df.loc[df.index[local_min], \"Support\"] = df[\"Low\"].iloc[local_min]\r\n\r\n        # Local maxima (Resistance)\r\n        local_max = argrelextrema(df[\"High\"].values, np.greater, order=order)[0]\r\n        df.loc[df.index[local_max], \"Resistance\"] = df[\"High\"].iloc[local_max]\r\n\r\n        return df\r\n\r\n    df = find_support_resistance(df)\r\n\r\n    # Detect Breakouts\r\n    df[\"Breakout\"] = np.where((df[\"Close\"] > df[\"Resistance\"].shift(1)), \"Yes\", \"No\")\r\n    df[\"Breakdown\"] = np.where((df[\"Close\"] < df[\"Support\"].shift(1)), \"Yes\", \"No\")\r\n\r\n    # Detect Consolidation (Using Bollinger Bands & ATR)\r\n    def atr(high, low, close, period=14):\r\n        tr = np.maximum(high - low, np.maximum(abs(high - close.shift()), abs(low - close.shift())))\r\n        return tr.rolling(window=period).mean()\r\n\r\n    df[\"ATR\"] = atr(df[\"High\"], df[\"Low\"], df[\"Close\"], period=14)\r\n\r\n    def bollinger_bands(series, period=20, std_dev=2):\r\n        sma = series.rolling(window=period).mean()\r\n        std = series.rolling(window=period).std()\r\n        upper_band = sma + (std_dev * std)\r\n        lower_band = sma - (std_dev * std)\r\n        return upper_band, sma, lower_band\r\n\r\n    upper_band, middle_band, lower_band = bollinger_bands(df[\"Close\"], period=20, std_dev=2)\r\n    df[\"Bollinger_Width\"] = (upper_band - lower_band) / middle_band  # Normalize width\r\n    df[\"Consolidation\"] = np.where(df[\"Bollinger_Width\"] < 0.05, \"Yes\", \"No\")  # Threshold for consolidation\r\n\r\n    # Extract currency pair from filename (assuming filename format like \"EUR-USD_5d_1h.json\")\r\n    base_name = os.path.splitext(os.path.basename(file_path))[0]\r\n    currency_pair = base_name.split('_')[0]\r\n\r\n    # Create currency pair specific output directory\r\n    currency_output_dir = os.path.join(output_dir, currency_pair)\r\n    os.makedirs(currency_output_dir, exist_ok=True)\r\n\r\n    # Save the processed data\r\n    output_json_path = os.path.join(currency_output_dir, f\"{base_name}_processed.json\")\r\n    df.to_json(output_json_path, orient=\"records\", date_format=\"iso\")\r\n\r\n    # Set 'Date' column as the index for mplfinance plotting\r\n    df.set_index('Date', inplace=True)\r\n\r\n    # Check for missing data\r\n    print(f\"Missing values before handling for: {file_path}\")\r\n    print(df[[\"Open\", \"High\", \"Low\", \"Close\"]].isnull().sum())\r\n\r\n    # Remove rows with NaN values\r\n    df = df.dropna(subset=['Open', 'High', 'Low', 'Close'])\r\n\r\n    # Check for missing data\r\n    print(f\"Missing values after handling for: {file_path}\")\r\n    print(df[[\"Open\", \"High\", \"Low\", \"Close\"]].isnull().sum())\r\n\r\n    # Ensure correct datetime index\r\n    print(f\"DataFrame Index for: {file_path}\")\r\n    print(df.index)\r\n    print(f\"DataFrame Index dtype: {df.index.dtype}\")\r\n\r\n    # File path for the saved image\r\n    image_filename = f\"{base_name}_chart.png\"\r\n    image_path = os.path.join(currency_output_dir, image_filename)\r\n\r\n    # Plot Market Structure with Support & Resistance and save as an image\r\n    mpf.plot(\r\n        df,\r\n        type=\"candle\",\r\n        style=\"charles\",\r\n        volume=False,\r\n        title=f\"Market Structure Analysis - {base_name}\",\r\n        addplot=[\r\n            mpf.make_addplot(df[\"Support\"], scatter=True, marker=\"v\", color=\"green\"),\r\n            mpf.make_addplot(df[\"Resistance\"], scatter=True, marker=\"^\", color=\"red\")\r\n        ],\r\n        savefig=dict(fname=image_path, dpi=300, bbox_inches=\"tight\"),\r\n        warn_too_much_data=False  # Avoid warnings for gaps (e.g., weekends)\r\n    )\r\n\r\n    print(f\"\\u2705 Market structure analysis complete for {file_path}. Processed data saved as '{output_json_path}'.\")\r\n    print(f\"\\u2705 Chart saved as: {image_path}\")\r\n\r\n    return output_json_path, image_path\r\n\r\n\r\ndef process_files_by_currency(file_lists, output_dir):\r\n    \"\"\"Processes files grouped by currency pairs.\"\"\"\r\n    processed_files_by_currency = []\r\n\r\n    for currency_files in file_lists:\r\n        processed_files = []\r\n        for file_path in currency_files:\r\n            processed_json, processed_image = process_and_plot(file_path, output_dir)\r\n            if processed_json and processed_image:\r\n                processed_files.append((processed_json, processed_image))\r\n        processed_files_by_currency.append(processed_files)\r\n\r\n    return processed_files_by_currency\r\n","size_bytes":5959},"attached_assets/README_1764097643859.md":{"content":"\n# Forex and Crypto Market Analyzer\n\nThis project provides a comprehensive market analysis tool for both Forex and Cryptocurrency pairs, leveraging the power of AI (specifically Google's Gemini) for technical analysis and generating trading signals. It retrieves historical data, performs technical analysis using Smart Money Concepts (SMC) and Wyckoff methodology, and delivers the results via email.\n\n## Table of Contents\n\n* [Project Overview](#project-overview)\n* [Features](#features)\n* [Getting Started](#getting-started)\n    * [Prerequisites](#prerequisites)\n    * [Installation](#installation)\n    * [Configuration](#configuration)\n    * [Usage](#usage)\n    * [Arguments](#arguments)\n* [Project Structure](#project-structure)\n* [Modules and Functionality](#modules-and-functionality)\n    * [`forex_mailer.py`](#forex_mailerpy)\n    * [`forexApp.py`](#forexapppy)\n    * [`fx.py`](#fxpy)\n    * [`price_channels.py`](#price_channelspy)\n    * [`tradebot.py`](#tradebotpy)\n    * [`trade.py`](#tradepypy)\n    * [`tradde.py`](#traddepypy)\n* [Technical Analysis Strategies](#technical-analysis-strategies)\n    * [Smart Money Concepts (SMC)](#smart-money-concepts-smc)\n    * [Wyckoff Method](#wyckoff-method)\n* [Parallel Processing](#parallel-processing)\n* [Email Integration](#email-integration)\n* [Error Handling](#error-handling)\n* [Contributing](#contributing)\n* [License](#license)\n* [Disclaimer](#disclaimer)\n* [Contact](#contact)\n* [Acknowledgements](#acknowledgements)\n\n\n\n## Project Overview\n\nThis project aims to automate the process of technical analysis for Forex and Crypto markets using AI-powered insights. It combines data retrieval, technical analysis using SMC and Wyckoff strategies, signal generation, and email delivery into a single, streamlined workflow. The analysis results are presented in an easy-to-understand format, enabling traders to make more informed decisions.\n\n## Features\n\n* **Automated Data Retrieval:** Retrieves historical market data for specified Forex and Crypto pairs using `yfinance`.\n* **AI-Powered Technical Analysis:** Employs Google's Gemini AI model to perform technical analysis based on SMC and Wyckoff principles.\n* **Smart Money Concepts (SMC) Analysis:** Identifies potential buy/sell zones by analyzing order flow, liquidity manipulation, and supply/demand imbalances.\n* **Wyckoff Method Analysis:** Predicts short-term market direction based on price and volume patterns, identifying accumulation and distribution phases.\n* **Signal Generation:** Generates trading signals with entry points, stop-loss levels, and target prices.\n* **Email Notifications:** Sends analysis results and charts as HTML emails with attachments.\n* **Parallel Processing:** Utilizes multiprocessing to speed up the analysis process.\n* **Customizable Parameters:** Allows for customization of analysis parameters, such as timeframes and trading pairs.\n* **Error Handling and Logging:** Includes error handling mechanisms to ensure robustness and provides logging for debugging.\n\n## Getting Started\n\n\n### Prerequisites\n\n* **Python 3.7 or higher:** Ensure you have a compatible Python version installed.\n* **Required Libraries:** Install the necessary Python packages using:\n```bash\npip install -r requirements.txt\n```\nThe `requirements.txt` file should contain the following:\n\n```\nmistune\nyfinance\npandas\nmplfinance\nscipy\ngoogle-generativeai\npython-dotenv\n```\n\n* **Google Cloud Project and API Key:** Create a Google Cloud project, enable the Gemini API, and obtain an API key. Store the API key in an environment variable named `GOOGLE_API_KEY`.  See the [Gemini documentation](https://developers.generativeai.google/) for details.\n* **(Optional) Gmail Account for Email:** If you want to use the email notification feature, you'll need a Gmail account and an app-specific password.\n\n\n### Installation\n\n1. Clone the repository:\n```bash\ngit clone https://github.com/your-username/forex-crypto-analyzer.git  # Replace with your repository URL\n```\n\n2. Navigate to the project directory:\n```bash\ncd forex-crypto-analyzer\n```\n\n\n### Configuration\n\n1. **API Key:** Set the `GOOGLE_API_KEY` environment variable with your Gemini API key. You can do this in your shell startup file (e.g., `.bashrc`, `.zshrc`) or by setting it directly in the terminal:\n\n   ```bash\n   export GOOGLE_API_KEY=\"YOUR_API_KEY\"  # Replace with your actual API key\n   ```\n\n2. **Email Credentials (Optional):** If using the email feature, update the `sender`, `password`, and `recipient` variables in `forexApp.py` and `fx.py` with your Gmail credentials.  It is **strongly recommended** to use an app-specific password for security.\n\n3. **File Paths:** Adjust the file paths in the scripts (`forexApp.py`, `fx.py`, `price_channels.py`, `tradebot.py`, `trade.py`, `tradde.py`) if you want to store data and results in different locations.\n\n\n### Usage\n\nTo run the analysis, execute the `fx.py` script with a command-line argument:\n\n* For Forex analysis:\n```bash\npython fx.py forex\n```\n\n* For Crypto analysis:\n```bash\npython fx.py btc\n```\n\n\n### Arguments\n\nThe `fx.py` script accepts one argument:\n\n* `forex` (or any other string except \"btc\"): Runs the analysis for Forex pairs.\n* `btc`: Runs the analysis for Cryptocurrency pairs.\n\n\n## Project Structure\n\n```\nforex-crypto-analyzer/\n├── forex_mailer.py       # Module for sending email notifications\n├── forexApp.py          # Main application script for Forex/Crypto analysis\n├── fx.py                 # Entry point script with argument handling\n├── price_channels.py     # Module for Wyckoff analysis\n├── tradebot.py          # Module for SMC analysis\n├── trade.py             # Module for data retrieval and processing\n├── tradde.py            # Module for chart generation and support/resistance detection\n└── requirements.txt       # List of project dependencies\n```\n\n\n\n\n## Modules and Functionality\n\n\n\n### `forex_mailer.py`\n\nThis module handles sending email notifications with HTML content and attachments.\n\n* **`markdown_to_html_email()`:** Converts a Markdown file to HTML and sends it as an email with optional attachments.\n\n\n\n### `forexApp.py`\n\nThis script orchestrates the market analysis process.\n\n* **`sort_files()`:** Sorts file paths, prioritizing JSON files.\n* **`firstStep()`:** Executes the SMC analysis using `tradebot.py`.\n* **`secondStep()`:** Executes the Wyckoff analysis using `price_channels.py`.\n* **`analyseFile()`:** Processes a single set of files (JSON and PNG).\n* **`fx_analyser()`:** Main function that retrieves data, processes it, performs analysis, and (optionally) sends emails.\n\n\n\n### `fx.py`\n\nThis script is the main entry point for the project.\n\n* **`forex_signals()`:** Uses Gemini to generate trading signals from the analysis results.\n* **`main()`:** Handles command-line arguments, runs the analysis, and sends email notifications.\n\n\n\n\n### `price_channels.py`\n\nThis module performs technical analysis based on the Wyckoff method using Gemini.\n\n* **`PriceChannelAnalyzer` class:**\n    * **`__init__()`:** Initializes the analyzer, creates the Gemini model, and sets up file paths.\n    * **`_create_model()`:** Creates the Gemini model with specified configurations.\n    * **`_upload_file()`:** Uploads a file to Gemini.\n    * **`_wait_for_files_active()`:** Waits for uploaded files to become active.\n    * **`upload_files()`:** Uploads all specified files.\n    * **`analyze_market()`:** Performs the Wyckoff analysis using Gemini and saves the results.\n\n\n\n\n### `tradebot.py`\n\nThis module performs technical analysis based on Smart Money Concepts using Gemini.\n\n* **`GeminiMarketAnalyzer` class:**  (Similar structure and methods as `PriceChannelAnalyzer` in `price_channels.py`)\n\n\n\n### `trade.py`\n\nThis module handles data retrieval and processing using `yfinance`.\n\n* **`ForexDataProcessor` class:**\n    * **`__init__()`:** Initializes the data processor.\n    * **`get_forex_data()`:** Downloads data for a specific pair, period, and interval.\n    * **`process_timeframe()`:** Processes data for a given timeframe (period and interval).\n    * **`process_all_timeframes()`:** Processes data for all specified timeframes.\n    * **`sort_paths_by_currency()`:** Sorts file paths by currency pair.\n* **`dataRetriever()`:** Retrieves data for specified pairs and timeframes.\n\n\n\n\n\n### `tradde.py`\n\nThis module handles plotting, support/resistance detection, and saving charts as images.\n\n* **`process_and_plot()`:** Processes a single data file, generates a chart, and saves it as a PNG image.\n* **`process_files_by_currency()`:** Processes a list of files grouped by currency pair.\n\n\n\n\n## Technical Analysis Strategies\n\n### Smart Money Concepts (SMC)\n\nThis strategy focuses on identifying the actions of institutional traders (\"smart money\") by analyzing order flow, liquidity, and supply/demand imbalances. It uses concepts like market structure, order blocks, imbalances, and liquidity pools to predict near-term price movements.\n\n### Wyckoff Method\n\nThis method predicts market direction by analyzing price and volume patterns, identifying accumulation and distribution phases. It looks for specific events like Preliminary Support (PS), Selling Climax (SC), Automatic Rally (AR), Secondary Test (ST), and Spring (in accumulation) or their distribution phase equivalents to predict price movements.\n\n## Parallel Processing\n\nThe project utilizes the `concurrent.futures` module to perform data retrieval and analysis in parallel, significantly reducing processing time. The `ProcessPoolExecutor` is used for process-based parallelism, taking advantage of multiple CPU cores.\n\n## Email Integration\n\nThe `forex_mailer.py` module provides functionality to send email notifications with HTML content and attachments. This allows users to receive the analysis results and charts directly in their inbox.  Uses `smtplib` and the `email` modules.  Requires a Gmail account (or other SMTP server configuration).\n\n\n## Error Handling\n\nThe code includes error handling mechanisms (`try...except` blocks) to gracefully handle potential errors during data retrieval, processing, and analysis. Error messages are printed to the console to assist with debugging.\n\n## Contributing\n\nContributions to this project are welcome. Please follow these guidelines:\n\n1. Fork the repository.\n2. Create a new branch for your feature or bug fix.\n3. Make your changes and commit them with clear commit messages.\n4. Push your branch to your forked repository.\n5. Create a pull request to the main repository.\n\n\n## License\n\nThis project is licensed under the [MIT License](LICENSE).\n\n\n## Disclaimer\n\nThis project is for educational and informational purposes only. It should not be considered financial advice. Trading in financial markets involves substantial risk, and you should consult with a qualified financial advisor before making any investment decisions.  The AI-generated analysis and trading signals are not guaranteed to be accurate and should not be solely relied upon for making trading decisions.\n\n\n## Contact\n\nFor any inquiries or feedback, please contact braimahgifted@gmail.com.\n\n\n## Acknowledgements\n\n* **yfinance:** For providing a convenient way to retrieve financial data.\n* **mplfinance:** For creating financial charts.\n* **scipy:** For scientific computing functions used in analysis.\n* **Google Gemini:** For powering the AI-driven technical analysis.\n\n","size_bytes":11380},"attached_assets/price_channels_1764097643859.py":{"content":"import os\r\nimport time\r\nfrom dotenv import load_dotenv\r\nimport google.generativeai as genai\r\nimport re\r\n\r\n\r\nload_dotenv()\r\nGOOGLE_API_KEY = os.getenv(\"GOOGLE_API_KEY\")\r\ngenai.configure(api_key=GOOGLE_API_KEY)\r\n\r\n\r\nclass PriceChannelAnalyzer:\r\n    def __init__(self, file_paths, mime_types):\r\n        \"\"\"\r\n        Initializes the GeminiMarketAnalyzer with file paths and their mime types.\r\n\r\n        Args:\r\n            file_paths (list): List of file paths to be uploaded.\r\n            mime_types (list): List of mime types corresponding to the file paths.\r\n        \"\"\"\r\n\r\n        if len(file_paths) != len(mime_types):\r\n            raise ValueError(\"Length of file_paths and mime_types must be the same.\")\r\n\r\n        self.file_paths = file_paths\r\n        self.mime_types = mime_types\r\n        self.files = []\r\n        self.model = self._create_model()\r\n        \r\n        os.makedirs(r\"C:\\Users\\USER\\Downloads\\gen-ai\\fx_analysis\", exist_ok=True)\r\n        \r\n        self.file_name = os.path.splitext(os.path.basename(self.file_paths[0]))[0]\r\n        self.base_name = os.path.splitext(self.file_name)[0][:7]\r\n    \r\n         # Create the output directory using the extracted name\r\n        self.directory_path = os.path.join(r\"C:\\Users\\USER\\Downloads\\gen-ai\\fx_analysis\", self.base_name)\r\n        os.makedirs(self.directory_path, exist_ok=True)\r\n        self.pre_result = self.base_name+\"_analysis.md\"\r\n        self.resultFile = os.path.join(self.directory_path, self.pre_result)\r\n\r\n    def _create_model(self):\r\n          \"\"\"Creates the Gemini model with specified configurations.\"\"\"\r\n          generation_config = {\r\n            \"temperature\": 2,\r\n            \"top_p\": 0.95,\r\n            \"top_k\": 40,\r\n            \"max_output_tokens\": 8192,\r\n            \"response_mime_type\": \"text/plain\",\r\n          }\r\n\r\n          model = genai.GenerativeModel(\r\n            model_name=\"gemini-2.0-flash-exp\",\r\n            generation_config=generation_config,\r\n            system_instruction=\"Role: You are a technical analysis expert who excels in using wyckoff analysis to tell if the market will go up next, or go down. ensure you first state the **current market state**\\\\\\\\n**input: you will be given forex data, consume the hourly, daily and weekly price action  starting from the latest data \\\\\\\\n**output: the next scenerio the market is about to enter in the next candlesticks whether up, down or sideways or short pullback. always state the suggested pricesprices\\\\\\\\n**Strategy: ```Wyckoff Method for Short-Term Market Direction Prediction\\nI. Executive Summary:\\n\\nThis document outlines a short-term trading strategy based on the Wyckoff method of market analysis. The Wyckoff method centers on understanding the interplay of supply and demand, recognizing the influence of the \\\"Composite Man\\\" (representing informed institutional investors), and identifying predictable market cycles. The primary objective of this strategy is to forecast whether the market (or a specific asset) is likely to move up, down, or sideways within the next few trading candles by analyzing price and volume action on candlestick charts. This strategy leverages key Wyckoff events within accumulation and distribution phases, coupled with volume and price action confirmation, to identify high-probability trading opportunities. Potential benefits include identifying potential turning points early, improving entry timing, and managing risk effectively.\\n\\nII. Background on Wyckoff Analysis:\\n\\nA. The \\\"Composite Man\\\":\\n\\nThe Wyckoff method posits the existence of a hypothetical entity called the \\\"Composite Man\\\" or \\\"Composite Operator.\\\" This represents the collective actions of large, informed institutional investors who strategically accumulate positions before a significant price increase (Markup) and distribute their holdings before a significant price decrease (Markdown). Understanding the actions of the Composite Man is crucial, as their footprints are often visible on the charts through specific price and volume patterns. The Composite Man intentionally manipulates the market to induce reactions from less informed traders, buying low during periods of panic selling and selling high during periods of exuberant buying. By recognizing these manipulative tactics, traders can align themselves with the Composite Man's anticipated moves.\\n\\nB. The Three Laws of Wyckoff:\\n\\nLaw of Supply and Demand: This fundamental law states that price movements are a direct result of the balance between buying (demand) and selling (supply) pressure. When demand exceeds supply, prices rise; when supply exceeds demand, prices fall. Wyckoff analysis focuses on interpreting volume in conjunction with price action to gauge the relative strength of supply and demand. High volume during a price rise suggests strong demand, while high volume during a price fall suggests strong supply. Conversely, low volume during a price rise might indicate a lack of genuine buying interest, and low volume during a price fall might suggest limited selling pressure, potentially leading to a reversal.\\n\\nLaw of Cause and Effect: This law suggests that price movements are not random but are preceded by periods of preparation. Accumulation is the \\\"cause\\\" that leads to an eventual Markup (the \\\"effect\\\"). Conversely, Distribution is the \\\"cause\\\" that leads to a subsequent Markdown (the \\\"effect\\\"). The horizontal trading range formed during accumulation or distribution represents the \\\"cause,\\\" and the extent of this range can be used to estimate the potential magnitude of the subsequent \\\"effect\\\" (price movement). For short-term predictions, identifying the stage of accumulation or distribution helps determine the likely direction of the next move. A breakout from an accumulation range suggests an upward move, while a breakdown from a distribution range suggests a downward move.\\n\\nLaw of Effort vs. Result: This law examines the relationship between the \\\"effort\\\" exerted (volume) and the \\\"result\\\" achieved (price movement). A discrepancy between effort and result can signal a potential change in the direction of the trend. For example, if there is high volume (significant effort) but only a small price movement (weak result) during an uptrend, it might indicate that buying pressure is waning and a reversal is possible. Conversely, if there is low volume (minimal effort) but a significant price drop (strong result) during a downtrend, it could suggest a lack of strong selling pressure and a potential for a bounce. This law is particularly useful for identifying \\\"traps\\\" set by the Composite Man, where high volume and price movement in one direction are quickly reversed.\\n\\nC. The Wyckoff Market Cycle:\\n\\nThe market cycle, according to Wyckoff, progresses through four distinct phases:\\n\\nAccumulation: This is a period of sideways trading where the Composite Man is strategically accumulating a large position without significantly driving up the price. Volume tends to increase towards the end of this phase as buying interest grows. The goal is to buy low before the broader market recognizes the potential for an upward move.\\n\\nMarkup: This is the upward trending phase where demand dominates. As the Composite Man releases their accumulated holdings into the market, the price steadily increases. Volume generally increases during advances and decreases during pullbacks.\\n\\nDistribution: This is another period of sideways trading, but this time the Composite Man is strategically selling their holdings into the market as demand reaches its peak. Volume tends to be high during this phase as selling pressure increases. The goal is to sell high before the broader market realizes the potential for a downward move.\\n\\nMarkdown: This is the downward trending phase where supply dominates. As the Composite Man unloads their positions, the price steadily decreases. Volume generally increases during declines and decreases during rallies.\\n\\nFor short-term trading, identifying the current phase within a smaller timeframe cycle is crucial. Is the market currently undergoing accumulation, showing signs of breaking into a markup? Or is it in distribution, poised for a markdown? Recognizing these patterns on shorter timeframes allows for anticipating the immediate direction.\\n\\nIII. Strategy Components:\\n\\nA. Chart Setup:\\n\\nPreferred Timeframe for Analysis: This strategy is designed for short-term predictions, focusing on moves within the next few candles. Therefore, the recommended timeframes are 5-minute, 15-minute, or 30-minute charts. These timeframes provide sufficient granularity to identify Wyckoff events while capturing short-term price fluctuations. Analyzing multiple timeframes (e.g., 15-minute for primary analysis and 5-minute for refined entry) can enhance accuracy.\\n\\nCandlestick Patterns: Key candlestick patterns to be used include:\\n\\nEngulfing Patterns (Bullish and Bearish): Signal potential reversals. A bullish engulfing pattern suggests the end of a downtrend, while a bearish engulfing pattern suggests the end of an uptrend.\\n\\nHammers and Hanging Men: Single candlestick reversal patterns. A hammer at the bottom of a downtrend indicates potential buying pressure, while a hanging man at the top of an uptrend suggests potential selling pressure.\\n\\nShooting Stars and Inverted Hammers: Similar to hammers and hanging men, but appear in different contexts. A shooting star at the top of an uptrend suggests selling pressure, while an inverted hammer at the bottom of a downtrend indicates potential buying interest.\\n\\nDojis: Indicate indecision in the market and can signal potential turning points, especially when appearing after a sustained move.\\n\\nVolume Indicators: Volume is a critical component of Wyckoff analysis.\\n\\nVolume Bars: Standard volume bars displayed below the price chart. Focus on the relative size of volume bars in relation to price movements and previous volume.\\n\\nOn-Balance Volume (OBV): A cumulative indicator that adds volume on up days and subtracts volume on down days. Divergence between OBV and price can signal potential trend changes. For example, if price makes new highs but OBV does not, it suggests weakening buying pressure.\\n\\nB. Identification of Wyckoff Events:\\n\\nAccumulation Phase:\\n\\nPreliminary Support (PS): Initial buying activity emerges after a downtrend, suggesting some buyers are starting to enter the market. Volume is typically moderate to high. This often manifests as a strong bounce off a low.\\n\\nSelling Climax (SC): Intense selling pressure culminates in a sharp price decline on very high volume. This signifies capitulation as weak holders exit their positions. The large volume and wide price spread indicate a potential bottom.\\n\\nAutomatic Rally (AR): A significant rebound after the SC, driven by short covering and initial buying from informed investors. This defines the upper boundary of the trading range. Volume is usually high but less than the SC.\\n\\nSecondary Test (ST): A re-testing of the SC low to gauge the remaining selling pressure. Successful STs show decreased volume compared to the SC, indicating that sellers are becoming exhausted. Multiple STs can occur. Look for bullish candlestick patterns during STs.\\n\\nSpring: A manipulative move where price temporarily breaks below the support level of the trading range (the low of the SC or ST) before quickly reversing and closing back within the range on increased volume. This \\\"shakes out\\\" remaining weak holders and confirms the Composite Man's accumulation. This is a key signal for potential long entries.\\n\\nDistribution Phase:\\n\\nPreliminary Supply (PSY): Initial selling pressure appears after an uptrend, suggesting some informed investors are starting to take profits. Volume is typically moderate to high. This might be seen as a stalling of the uptrend.\\n\\nBuying Climax (BC): High volume buying as the uptrend reaches its peak. This signifies exuberance and the entry of less informed buyers. The large volume and wide price spread indicate a potential top.\\n\\nAutomatic Reaction (AR): A significant decline after the BC, driven by profit-taking and initial selling from informed investors. This defines the lower boundary of the trading range. Volume is usually high but less than the BC.\\n\\nSecondary Test (ST): A re-testing of the BC high to gauge the remaining buying pressure. Successful STs show decreased volume compared to the BC, indicating that buyers are becoming exhausted. Look for bearish candlestick patterns during STs.\\n\\nUpthrust: A manipulative move where price temporarily breaks above the resistance level of the trading range (the high of the BC or ST) before quickly reversing and closing back within the range on increased volume. This \\\"traps\\\" late buyers and confirms the Composite Man's distribution. This is a key signal for potential short entries.\\n\\nMarkup and Markdown Phases:\\n\\nMarkup: Characterized by sustained upward price movement with increasing volume on advances and decreasing volume on pullbacks. Look for strong bullish candlestick patterns and consistent higher highs and higher lows.\\n\\nMarkdown: Characterized by sustained downward price movement with increasing volume on declines and decreasing volume on rallies. Look for strong bearish candlestick patterns and consistent lower highs and lower lows. Absence of significant Wyckoff accumulation events prior to the markdown confirms its strength.\\n\\nC. Confirmation Signals:\\n\\nVolume Analysis: This is paramount.\\n\\nIncreased volume on breakouts: A breakout above resistance after accumulation or below support after distribution should be accompanied by a significant increase in volume to confirm the strength of the move.\\n\\nDecreased volume on tests/retests: During Secondary Tests (STs) in both accumulation and distribution, decreasing volume on the retest is a positive sign.\\n\\nDivergence between price and volume: As mentioned with OBV, discrepancies can indicate potential trend changes.\\n\\nPrice Action: Specific candlestick patterns provide additional confirmation.\\n\\nReversal patterns at key Wyckoff events: Engulfing patterns, hammers/hanging men, shooting stars at SC, ST, BC, and ST provide strong confirmation.\\n\\nBreak of trendlines: Breaking above a downtrend line after accumulation or below an uptrend line after distribution.\\n\\nSuccessful tests of support and resistance: Bouncing off support after accumulation and rejecting resistance after distribution.\\n\\nTrendlines and Support/Resistance Levels: Use these tools to define the trading range during accumulation and distribution. Breakouts and breakdowns from these levels, confirmed by volume, are significant signals. Look for confluence: when a Wyckoff event occurs near a significant support or resistance level, the signal is strengthened.\\n\\nD. Trading Rules:\\n\\nEntry Rules:\\n\\nLong Entry (Anticipating Markup):\\n\\nSpring: Enter long on the close of the candle that reverses back into the trading range after a spring, especially if accompanied by high volume.\\n\\nBreakout from Accumulation: Enter long on a confirmed breakout above the resistance level of the accumulation range, accompanied by increased volume.\\n\\nSecondary Test (ST) in Accumulation: Enter long after a successful ST showing decreased volume and bullish candlestick patterns near the support level.\\n\\nShort Entry (Anticipating Markdown):\\n\\nUpthrust: Enter short on the close of the candle that reverses back into the trading range after an upthrust, especially if accompanied by high volume.\\n\\nBreakdown from Distribution: Enter short on a confirmed breakdown below the support level of the distribution range, accompanied by increased volume.\\n\\nSecondary Test (ST) in Distribution: Enter short after a successful ST showing decreased volume and bearish candlestick patterns near the resistance level.\\n\\nAvoid entries during the initial phases (PS, SC, AR, PSY, BC, AR) as these phases are primarily for identifying the trading range. Focus on entries after confirmation of the accumulation or distribution structure.\\n\\nStop-Loss Orders: Place stop-loss orders strategically to limit potential losses.\\n\\nLong Entry: Place the stop-loss slightly below the low of the spring or the support level of the accumulation range.\\n\\nShort Entry: Place the stop-loss slightly above the high of the upthrust or the resistance level of the distribution range.\\n\\nProfit Targets: Determine potential profit targets based on the projected price movement.\\n\\nMarkup: Target potential resistance levels or use Fibonacci extensions based on the accumulation range's height.\\n\\nMarkdown: Target potential support levels or use Fibonacci extensions based on the distribution range's height.\\n\\nFor short-term trades (next few candles), consider targeting the opposite end of the identified trading range or a smaller, predetermined profit target based on volatility.\\n\\nPosition Sizing: Risk a small percentage of your trading capital on each trade (e.g., 1-2%). Adjust position size based on your stop-loss distance to maintain consistent risk per trade.\\n\\nIV. Strategy Implementation:\\n\\nStep-by-step guide:\\n\\nChart Setup: Configure your charting platform with the preferred timeframe (5, 15, or 30 minutes), candlestick charts, and volume indicators (volume bars and optionally OBV).\\n\\nIdentify Potential Trading Ranges: Scan charts for periods of sideways price action that could represent accumulation or distribution phases.\\n\\nLook for Wyckoff Events: Actively look for the specific price and volume patterns associated with Preliminary Support (PS), Selling Climax (SC), Automatic Rally (AR), Secondary Tests (ST), and Springs during potential accumulation phases. Similarly, look for Preliminary Supply (PSY), Buying Climax (BC), Automatic Reaction (AR), Secondary Tests (ST), and Upthrusts during potential distribution phases.\\n\\nConfirm with Volume and Price Action: Analyze volume during each event. Increased volume on breakouts and decreased volume on tests are key confirmations. Look for confirming candlestick patterns and trendline breaks.\\n\\nDetermine the Stage of the Cycle: Based on the identified events, assess whether the market is likely in accumulation (preparing for markup) or distribution (preparing for markdown).\\n\\nApply Trading Rules: Based on the identified Wyckoff events and confirmations, set entry orders, stop-loss orders, and potential profit targets according to the defined trading rules.\\n\\nMonitor the Trade: Observe price action and volume after entering a trade. Be prepared to adjust stop-loss levels or take profits if the market moves favorably.\\n\\nRecord and Review: Maintain a trading journal to track your trades, noting the Wyckoff events identified, entry and exit points, and the outcome of the trade. Regularly review your journal to identify areas for improvement.\\n\\nExamples:\\n\\nExample 1: Identifying a Spring and Entering Long: On a 15-minute chart, after a downtrend, you observe a PS, SC with high volume, and an AR. Price then revisits the SC low (ST) with lower volume. Subsequently, price briefly breaks below the ST low on slightly increased volume but quickly reverses back into the range, closing strong. This is a Spring. You enter a long position on the close of this bullish reversal candle with a stop-loss below the low of the spring. Your profit target is the upper resistance of the trading range.\\n\\nExample 2: Identifying an Upthrust and Entering Short: On a 15-minute chart after an uptrend, you observe a PSY, BC with high volume, and an AR. Price then revisits the BC high (ST) with lower volume. Price then briefly breaks above the ST high on slightly increased volume but quickly reverses back into the range, closing weak. This is an Upthrust. You enter a short position on the close of this bearish reversal candle with a stop-loss above the high of the upthrust. Your profit target is the lower support of the trading range.\\n\\nTools and Resources:\\n\\nCharting Software: TradingView, MetaTrader 4/5, Thinkorswim (platforms that offer advanced charting features, volume indicators, and the ability to draw trendlines and support/resistance levels).\\n\\nVolume Indicators: Standard volume bars are essential. On-Balance Volume (OBV) can be a helpful supplementary indicator.\\n\\nEducational Materials: Books and online resources dedicated to the Wyckoff method (e.g., \\\"Trading in the Zone\\\" by Mark Douglas which, while not solely focused on Wyckoff, emphasizes the psychological aspects crucial for its successful application, and resources specifically on Wyckoff principles).\\n\\nV. Risk Management:\\n\\nRisk Tolerance: Define your maximum acceptable risk per trade as a percentage of your trading capital (e.g., 1-2%). Understand your overall portfolio risk tolerance.\\n\\nPosition Sizing: Calculate your position size for each trade based on your risk tolerance and the distance between your entry point and stop-loss order. This ensures you don't risk more than your predetermined amount on any single trade.\\n\\nStop-Loss Orders: Crucially important. Always use stop-loss orders to limit potential losses. Never trade without a stop-loss. Adjust stop-loss levels as the trade progresses favorably to lock in profits (trailing stops).\\n\\nMonitoring and Review: Continuously monitor your open positions and be prepared to adjust your strategy if market conditions change. Regularly review your trading performance to identify weaknesses and areas for improvement. Keep a detailed trading journal.\\n\\nVI. Strategy Evaluation and Refinement:\\n\\nBacktesting: Use historical chart data to manually or programmatically test the strategy's effectiveness. Identify historical instances of Wyckoff events and apply the trading rules to see how the strategy would have performed. Be mindful of potential biases in backtesting.\\n\\nForward Testing: Implement the strategy on a demo account or with a very small amount of real capital to evaluate its performance in real-time market conditions without risking significant capital. This helps to identify any practical challenges in applying the strategy.\\n\\nPerformance Metrics: Track key metrics such as:\\n\\nWin Rate: Percentage of winning trades.\\n\\nAverage Profit per Winning Trade: Average profit made on successful trades.\\n\\nAverage Loss per Losing Trade: Average loss incurred on unsuccessful trades.\\n\\nProfit Factor: Ratio of total gross profit to total gross loss.\\n\\nMaximum Drawdown: The largest peak-to-trough decline in your trading account.\\n\\nContinuous Improvement: Regularly analyze your performance metrics and trading journal to identify areas where the strategy can be refined. Adapt the strategy based on changing market conditions and your own trading experience. Be prepared to modify entry and exit rules, stop-loss placement, and profit targets based on data and observation.\\n\\nVII. Conclusion:\\n\\nThis short-term trading strategy, grounded in the Wyckoff method, offers a framework for predicting near-term market direction by understanding the interplay of supply and demand, the actions of the Composite Man, and recurring market cycles. By diligently identifying Wyckoff events, confirming them with volume and price action, and adhering to strict risk management principles, traders can improve their entry timing and potentially capitalize on short-term market fluctuations. However, successful implementation requires discipline, patience to wait for high-probability setups, and a commitment to continuous learning and refinement of the strategy. **Example response:** Okay, let's analyze this EUR/USD data using the Wyckoff method.\\n\\n**Overall Market Context**\\n\\n* **Current Market State (as of the last data point)** *   **Last Price:** 1.0248001814 *   **Last Date:** 2025-01-10T22:00:00.000Z (10 Jan 2025, 10 PM GMT) \\n\\n   **Weekly Chart:** The weekly chart clearly shows a significant downtrend, confirming a market undergoing the markdown phase. \\n    * The market was trending upwards until mid-August and entered the Markdown stage with huge bearish engulfing bar. It started forming lower lows, which further solidifies the downtrend direction.  There is a notable increase in volatility recently\\n*   **Daily Chart:** The daily chart displays a very distinct and volatile downtrend structure within the markdown phase. The price broke through a significant low at the start of November and this created massive volatility towards 1.02 handle.. There have been no clear accumulation patterns visible that will lead to a markup at all. There might be small distribution range at the end of Nov. However, it did not hold. The most recent daily price action are all sharp moves toward downside which shows an imbalance of sellers in market.\\n*   **Hourly Chart:** This confirms a markdown in price. The past few candles show volatility.  Recent price action suggests potential volatility, though not always leading to clear direction, suggesting consolidation prior to markdowns in the upcoming sessions. We need a decisive breakdown or test/bounce for clear direction\\n     * From the 6th to 7th of Jan, a significant upward trend but this does not suggest change of bigger trend yet. Since, there were small upward thrusts until the 8th of Jan and we see further continuation toward downward movement which validates bearish sentiments\\n      \\n**Recent Price Action**\\n *    From the weekly time-frame.  the most recent large bars that we saw shows increase in volatility and bears still have dominance. There might be minor bull bounce before it continues further towards down\\n  *    From daily - huge downtrend that showed no retracement and it indicates it will not stop. Expect lower low.  It has made no signal of changing into a markup. Recent daily trend suggest high volatility.\\n  *  From the hourly perspective. the trend went up slightly for a bit. This looks like just short correction/pullback as it tried to retest. Then recent action shows downtrend starting the 8th to 9th  which shows further price downtrend to be valid. we now expect market to continue lower as its shows an aggressive sell off and this was confirmed by breakdown the past day\\n\\n**Wyckoff Analysis & Short-Term Prediction**\\n\\n1.  **Current Phase:** All the analysis confirms current phase is Markdown on daily time-frame . We must respect the big picture until proven otherwise. Any upward move at this point might just be short covering with an expectation that price to continue markdown as part of the larger trend,\\n2.  **Effort vs Result**:\\n   * The large sell off we saw the recent hours confirms the downward pressure\\n   * volume on hourly suggest sellers still have much in reserves\\n3. **Recent Wyckoff events**: we are seeing constant markdowns as price make lower lows consistently with volatile prices . The most recent low that we saw shows it breaking support, creating huge sell off confirming larger downtrend . the volatility seems high right now and consolidation not apparent as price still moving downward with aggressive sell off\\n\\n**Short-Term Prediction:**\\n\\nGiven the downtrend and the current position, we are still bearish with market poised for further lower low as its shown an aggressive downtrend\\n\\n*   **Next Few Candles**: I would suggest next few hours / days there will be either continuation of downtrend movement or further short bounce only for price to retest a bit then drop down again. Any rallies we will see will likely only be part of small retests in an attempt to form a short horizontal consolidation only to breakdown toward further low and to create more lower lows. Based on the aggressiveness of sell off - I think there will not even be any consolidation as there no significant buy power in market.\\n *  Based on Hourly there could be small sideways consolidation between price of  1.0256 to 1.0235 but do not hold for long since sellers aggressive so expect downward movement towards lower. It broke through the latest swing lows with huge candle so expect the 1.023 low not to hold too much. we are already bearish for a long while now, not even looking for markup signals at this stage of overall bearish price action\\n\\n*  **Suggested Price**:\\n      * We can place our stop-loss above 1.027 and any bullish attempts should only be an opportunity to short on the rally. As soon as it approaches 1.024/5  the downtrend is most likely going to reassert it. I think the trend should move down to reach the recent swing low on the 6th Jan or go much lower given aggressive sellers. we are heading below the low from  jan 6 th and could even hit the low from Dec 12 which is  1.014 if no buyers can provide the demand to fight bears off\\n**Trading Strategy**\\n\\n*  **Entry:** Look for a potential short position as price gets near any short bullish attempts toward prices around 1.027. However, do be very weary to see whether any consolidation occurs on the 5 minute and if none. Then short opportunity. if sideways consolidation forms - its better to be neutral as some spring could still be possible which is a bull trap and that also allows the smart money to position itself on short positions for later down push\\n*  **Stop-Loss:** Above 1.027 which protects against potential short squeeze and sudden moves.\\n*  **Target Prices:** Initial target will be the most recent hourly low at around 1.023-1.02. then look at price reaction after for decision of whether to extend more short target given bigger daily timeframe, or consider take profit . The market could move to below jan low on 1.0197/5 as a next possible target range to secure for future lows\\n\\n**Additional Notes**\\n   * Be nimble and fast to reduce loss on any sudden turns of market, given very high volatility\\n\\n**Disclaimer:** This analysis is based on the provided data and the Wyckoff method, and it should not be considered as a financial or trading advice. It is based on a single analysis given what is available. Further due dilligence with proper risk analysis should be practiced prior to real trade to take in effect wider market context and also your risk appetite\",\r\n        )\r\n          return model\r\n\r\n    def _upload_file(self, path, mime_type):\r\n        \"\"\"Uploads a file to Gemini.\"\"\"\r\n        file = genai.upload_file(path, mime_type=mime_type)\r\n        print(f\"Uploaded file '{file.display_name}' as: {file.uri}\")\r\n        return file\r\n\r\n    def _wait_for_files_active(self):\r\n        \"\"\"Waits for the uploaded files to be active.\"\"\"\r\n        print(\"Waiting for file processing...\")\r\n        for file in self.files:\r\n          while file.state.name == \"PROCESSING\":\r\n              print(\".\", end=\"\", flush=True)\r\n              time.sleep(10)\r\n              file = genai.get_file(file.name)\r\n          if file.state.name != \"ACTIVE\":\r\n              raise Exception(f\"File {file.name} failed to process\")\r\n        print(\"...all files ready\")\r\n        print()\r\n\r\n    def upload_files(self):\r\n        \"\"\"Uploads all specified files to Gemini and waits for processing.\"\"\"\r\n        for path, mime_type in zip(self.file_paths, self.mime_types):\r\n            file = self._upload_file(path, mime_type)\r\n            self.files.append(file)\r\n        self._wait_for_files_active()\r\n\r\n    def analyze_market(self):\r\n         \"\"\"Sends the message to gemini to perform the analysis and prints the result.\"\"\"\r\n         chat_session = self.model.start_chat(\r\n            history=[\r\n             \r\n            ]\r\n        )\r\n         \r\n\r\n         input_prompt =  [\"Start the analysis from the last datapoints. Dont forget to calculate the estimated entry prices for the signals and state them\"] + self.files\r\n        \r\n         response = chat_session.send_message(\r\n             input_prompt\r\n            )\r\n         for chunk in response:\r\n             print(chunk.text, end=\"\")\r\n             print(self.directory_path)\r\n             text = chunk.text\r\n             \r\n             match = re.search(r\"\\*\\*short-term(.*?)(?=trading strategy)\", text, re.IGNORECASE  | re.DOTALL)\r\n            \r\n             print(\"Extracting Wyckoff Analysis\")\r\n             response_text = match.group()\r\n                \r\n             with open(self.resultFile, \"a\", encoding=\"utf-8\") as file:\r\n                file.write(\"\\n\\n\" + \"-\" * 95 + \"\\n\\n\" + \"\\n\\n---------------------WYCKOFF ANALYSIS --------------------\\n\\n\" + response_text)\r\n        \r\n        \r\n        #  print(response.text)\r\n        # #  with open(r\"C:\\Users\\USER\\Downloads\\gen-ai\\Forex-Analysis.md\", \"a\", encoding=\"utf-8\") as file:\r\n        #     # file.write(response.text)\r\n        \r\n\r\n\r\nif __name__ == \"__main__\":\r\n    # Example usage:\r\n    file_paths = [r'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_3mo_1d_processed.json', r'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_1y_1wk_processed.json', r'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_5d_1h_processed.json', r'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_3mo_1d_chart.png', r'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_1y_1wk_chart.png', r'C:\\\\Users\\\\USER\\\\Downloads\\\\gen-ai\\\\output_market_analysis\\\\NZD-USD\\\\NZD-USD_5d_1h_chart.png']\r\n    \r\n\r\n    mime_types = [\r\n        \"text/plain\",\r\n        \"text/plain\",\r\n        \"text/plain\",\r\n        \"image/png\",\r\n        \"image/png\",\r\n        \"image/png\",\r\n    ]\r\n    try:\r\n      analyzer = PriceChannelAnalyzer(file_paths, mime_types)\r\n      analyzer.upload_files()\r\n      analyzer.analyze_market()\r\n    except Exception as e:\r\n      print(f\"An error occurred: {e}\")","size_bytes":33625},"attached_assets/fx_1764097643859.py":{"content":"from datetime import datetime\r\nfrom forexApp import fx_analyser\r\nimport os\r\nimport google.generativeai as genai\r\nfrom forex_mailer import markdown_to_html_email\r\nimport sys  # Import the sys module\r\n\r\ngenai.configure(api_key=os.environ[\"GOOGLE_API_KEY\"])\r\n\r\ndef forex_signals(file, name):\r\n    result_file = file\r\n    file_name = name\r\n    generation_config = {\r\n        \"temperature\": 1,\r\n        \"top_p\": 0.95,\r\n        \"top_k\": 40,\r\n        \"max_output_tokens\": 8192,\r\n        \"response_mime_type\": \"text/plain\",\r\n    }\r\n\r\n    model = genai.GenerativeModel(\r\n        model_name=\"gemini-2.0-flash-exp\",\r\n        generation_config=generation_config,\r\n        system_instruction=\"you will be given a text containing the results of a trading analysis. there are three \\\"SMC Entries\\\" containing \\\"optimal entry price\\\" and three \\\"Wyckoff analysis\\\" containg the \\\"short term prediction\\\". you are to extract and summarize each \\\"SMC Entry\\\" and \\\"Wyckoff analysis\\\" in no more than 1 sentence, make sure to include the summary. \\n\\nexample reponse: \\\"Here are the Results of the Analysis:\\n\\n**Wyckoff Analysis:**\\n\\n*   **Wyckoff Analysis 1:** The analysis predicts continued downward movement with a small bounce near 0.6218 before a further decline towards 0.62.\\n*   **Wyckoff Analysis 2:** Expect sideways consolidation before a likely downward move towards 0.613, with short entries on rejections of a validated hourly distribution pattern.\\n*   **Wyckoff Analysis 3:** The market may move sideways with potential for a downside move, with a bearish bias unless a strong bullish breakout confirms otherwise.\\n\\\"\\n\\n**SMC Entries:**\\n\\n*   **SMC Entry 1:** A short entry is suggested around 0.6215 upon rejection with a target of 0.619, while a long entry is possible at 0.618 with a quick stop loss.\\n*   **SMC Entry 2:** A short entry is recommended at 0.6212 targeting 0.6206-0.6207 initially, potentially extending to 0.6199.\\n*   **SMC Entry 3:** A short entry is preferred at a specified zone, while a long position is only considered at 0.6197, both with tight stop losses and targets.\\n\\n**Summary:**\\n*   **Wyckoff: The first analysis predicts a continued downward movement immediately while the second and third analysis predicts a sideways movement first then downtrend\\n*   **SMC:  Preferred entries 1. Short - 0.6215     2. short - 0.6212    3. short - at specified zone\\n\",\r\n    )\r\n\r\n    chat_session = model.start_chat(\r\n        history=[\r\n        ]\r\n    )\r\n\r\n    print(\"Analysing \" + file_name)\r\n    md_content = \"\"\r\n    with open(result_file, \"r\", encoding=\"utf-8\") as file:\r\n        md_content = file.read()\r\n\r\n    response = chat_session.send_message(md_content)\r\n\r\n    with open(result_file, \"w\", encoding=\"utf-8\") as file:\r\n        file.write(response.text)\r\n\r\n    print(\"Finished Analysis for: \" + file_name)\r\n\r\nif __name__ == \"__main__\":\r\n    if len(sys.argv) < 2:\r\n        print(\"Please provide an argument ('btc' for crypto, anything else for forex).\")\r\n        sys.exit(1)\r\n\r\n    argument = sys.argv[1].lower()\r\n\r\n    forex_pairs_list = [\r\n        {\r\n            \"EUR/USD\": \"EURUSD=X\",\r\n            \"USD/JPY\": \"JPY=X\",\r\n            \"GBP/USD\": \"GBPUSD=X\",\r\n            \"USD/CHF\": \"CHF=X\",\r\n            \"USD/CAD\": \"CAD=X\"\r\n        },\r\n        {\r\n            \"AUD/USD\": \"AUDUSD=X\",\r\n            \"NZD/USD\": \"NZDUSD=X\",\r\n            \"GBP/JPY\": \"GBPJPY=X\",\r\n            \"EUR/JPY\": \"EURJPY=X\",\r\n            \"EUR/GBP\": \"EURGBP=X\"\r\n        }\r\n    ]\r\n\r\n    crypto_pairs_list = [\r\n        {\r\n            \"BTC/USD\": \"BTC-USD\",\r\n            \"BNB/USD\": \"BNB-USD\",\r\n            \"SOL/USD\": \"SOL-USD\",\r\n            \"AVAX/USD\": \"AVAX-USD\",\r\n            \"LINK/USD\": \"LINK-USD\"\r\n        },\r\n        {\r\n            \"UNI/USD\": \"UNI-USD\",\r\n            \"LTC/USD\": \"LTC-USD\",\r\n            \"DOGE/USD\": \"DOGE-USD\",\r\n            \"XRP/USD\": \"XRP-USD\",\r\n            \"ADA/USD\": \"ADA-USD\"\r\n        }\r\n    ]\r\n\r\n    if argument == \"btc\":\r\n        pairs = crypto_pairs_list\r\n    else:\r\n        pairs = forex_pairs_list\r\n\r\n    for pair_group in pairs:\r\n        for _ in range(3):  # Run fx_analyser 3 times for each pair\r\n            fx_analyser(pair_group)\r\n\r\n        print(\"Emailing Results\")\r\n\r\n        file_list = []\r\n        for root, _, files in os.walk(r\"C:\\Users\\USER\\Downloads\\gen-ai\\fx_analysis\"):\r\n            for file in files:\r\n                file_list.append(os.path.abspath(os.path.join(root, file)))\r\n        print(file_list)\r\n\r\n        for file in file_list:\r\n            file_name = os.path.splitext(os.path.basename(file))[0]\r\n\r\n            forex_signals(file, file_name)\r\n\r\n            markdown_file = file\r\n            recipient = \"braimahgifted@gmail.com\"\r\n            sender = \"braimahgifted@gmail.com\"\r\n            password = \"app-specific-password\"\r\n            subject_line = file_name\r\n            attachments = [\r\n                file,\r\n            ]\r\n\r\n            markdown_to_html_email(markdown_file, recipient, sender, password, subject_line, attachments)\r\n            os.remove(markdown_file)\r\n\r\n        print(\"All tasks have been completed and email sent\")\r\n","size_bytes":5088},"attached_assets/forexApp_1764097643858.py":{"content":"import os\r\nfrom tradebot import GeminiMarketAnalyzer\r\nfrom trade import dataRetriever\r\nfrom tradde import process_files_by_currency\r\nfrom datetime import datetime\r\nfrom forex_mailer import markdown_to_html_email\r\nfrom price_channels import PriceChannelAnalyzer\r\nimport time\r\nfrom threading import Lock\r\nfrom concurrent.futures import ProcessPoolExecutor  # Changed import\r\n\r\n# Paths and constants\r\nresults_file = r\"C:\\Users\\USER\\Downloads\\gen-ai\\Forex-Analysis.md\"\r\nprice_channels_file = r\"C:\\Users\\USER\\Downloads\\gen-ai\\price_channels.md\"\r\noutput_dir = r\"C:\\Users\\USER\\Downloads\\gen-ai\\output_market_analysis\"\r\nrecipient = \"braimahgifted@gmail.com\"\r\nsender = \"braimahgifted@gmail.com\"\r\npassword = \"app-specific-password\"\r\nsubject_line = \"Daily Forex Analysis\"\r\nattachments = [results_file]\r\n\r\n# Lock for thread-safe file access\r\nfile_write_lock = Lock()\r\n\r\ndef sort_files(file_paths):\r\n    \"\"\"Sorts file paths, placing JSON files before PNG files.\"\"\"\r\n    def key_function(file_path):\r\n        if isinstance(file_path, str) and file_path.endswith(\".json\"):\r\n            return 0\r\n        elif isinstance(file_path, str) and file_path.endswith(\".png\"):\r\n            return 1\r\n        else:\r\n            return 2\r\n\r\n    return sorted(file_paths, key=key_function)\r\n\r\ndef firstStep(sorted_file, mime_types):\r\n    # with file_write_lock:  # Ensure process-safe file access\r\n    #     with open(results_file, \"a\", encoding=\"utf-8\") as file:\r\n    #         file.write(\"\\n\\n\" + \"-\" * 95 + \"\\n\\n\")\r\n\r\n    try:\r\n        analyzer = GeminiMarketAnalyzer(sorted_file, mime_types)\r\n        analyzer.upload_files()\r\n        analyzer.analyze_market()\r\n    except Exception as e:\r\n        print(f\"Error in firstStep: {e}\")\r\n\r\ndef secondStep(sorted_file, mime_types):\r\n    # with file_write_lock:  # Ensure process-safe file access\r\n    #     with open(price_channels_file, \"a\", encoding=\"utf-8\") as file:\r\n    #         file.write(\"\\n\\n\" + \"-\" * 95 + \"\\n\\n\")\r\n\r\n    try:\r\n        channel = PriceChannelAnalyzer(sorted_file, mime_types)\r\n        channel.upload_files()\r\n        channel.analyze_market()\r\n    except Exception as e:\r\n        print(f\"Error in secondStep: {e}\")\r\n\r\ndef analyseFile(args):\r\n    file, mime_types = args\r\n    sorted_file = sort_files(file)\r\n    start_time = time.perf_counter()\r\n\r\n    firstStep(sorted_file, mime_types)\r\n    bot1_time = time.perf_counter() - start_time\r\n\r\n    secondStep(sorted_file, mime_types)\r\n    bot2_time = time.perf_counter() - start_time\r\n\r\n    return {\r\n        \"file\": sorted_file,\r\n        \"bot1_time\": bot1_time,\r\n        \"bot2_time\": bot2_time,\r\n    }\r\n\r\ndef fx_analyser(pairs):\r\n    pair_group=pairs\r\n    # Initialize results file\r\n    with open(results_file, \"w\", encoding=\"utf-8\") as file:\r\n        file.write(f\"FOREX ANALYSIS FOR {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\\n\")\r\n\r\n    # Retrieve and process files\r\n    files = dataRetriever(pair_group)\r\n    os.makedirs(output_dir, exist_ok=True)  # Create output directory if it doesn't exist\r\n    processed_files = process_files_by_currency(files, output_dir)\r\n\r\n    # Flatten processed files\r\n    re_processed_paths = [\r\n        ([item for item in file[0]] + [item for item in file[1]] + [item for item in file[2]])\r\n        for file in processed_files\r\n    ]\r\n\r\n    # MIME types used for analysis\r\n    mime_types = [\r\n        \"text/plain\",\r\n        \"text/plain\",\r\n        \"text/plain\",\r\n        \"image/png\",\r\n        \"image/png\",\r\n        \"image/png\",\r\n    ]\r\n\r\n    # Parallel processing with ProcessPoolExecutor\r\n    results = []\r\n    worker_count = min(len(re_processed_paths), os.cpu_count())\r\n    start_time = time.perf_counter()\r\n\r\n    with ProcessPoolExecutor(max_workers=worker_count) as executor:\r\n        # Pass mime_types to each task\r\n        tasks = [(file, mime_types) for file in re_processed_paths]\r\n        futures = [executor.submit(analyseFile, task) for task in tasks]\r\n        for future in futures:\r\n            try:\r\n                results.append(future.result())\r\n            except Exception as e:\r\n                print(f\"Error processing file: {e}\")\r\n\r\n    # Print results\r\n    for result in results:\r\n        print(f\"File: {result['file']}\")\r\n        print(f\"Bot 1 Time: {result['bot1_time']:.2f} seconds\")\r\n        print(f\"Bot 2 Time: {result['bot2_time']:.2f} seconds\")\r\n        print(\"---\")\r\n\r\n    total_time = time.perf_counter() - start_time\r\n    print(f\"Total Execution Time: {total_time:.2f} seconds\")\r\n\r\n    # Send results via email\r\n    # print(\"Emailing Results\")\r\n    # markdown_to_html_email(results_file, recipient, sender, password, subject_line, attachments)\r\n\r\nif __name__ == \"__main__\":\r\n    fx_analyser()\r\n","size_bytes":4653},"pyproject.toml":{"content":"[project]\nname = \"repl-nix-workspace\"\nversion = \"0.1.0\"\ndescription = \"Add your description here\"\nrequires-python = \">=3.11\"\ndependencies = [\n    \"matplotlib>=3.10.7\",\n    \"mplfinance>=0.12.10b0\",\n    \"pandas>=2.3.3\",\n    \"pycoingecko>=3.2.0\",\n    \"requests>=2.32.5\",\n    \"scipy>=1.16.3\",\n    \"tessa>=0.9.0\",\n    \"yfinance>=0.2.66\",\n]\n","size_bytes":335},"server/python/chart_generator.py":{"content":"#!/usr/bin/env python3\n\"\"\"\nChart Generator - Creates trading signal charts with zones and markers\nBased on user's original tradde.py using mplfinance\n\"\"\"\n\nimport sys\nimport json\nimport os\nimport pandas as pd\nimport numpy as np\nimport mplfinance as mpf\nfrom datetime import datetime\nimport matplotlib.pyplot as plt\nimport matplotlib.patches as mpatches\n\n# Set matplotlib to non-interactive backend\nimport matplotlib\nmatplotlib.use('Agg')\n\ndef generate_signal_chart(input_data: dict) -> dict:\n    \"\"\"\n    Generate a trading signal chart with zones and markers.\n    \n    Args:\n        input_data: Dictionary containing:\n            - symbol: Trading symbol\n            - timeframe: Timeframe (e.g., \"1H\", \"4H\")\n            - candles: List of OHLCV data\n            - signal: Entry signal info (direction, entry, sl, tp, confidence)\n            - supply_zones: List of {top, bottom} dicts\n            - demand_zones: List of {top, bottom} dicts\n            - output_path: Where to save the PNG\n    \n    Returns:\n        Dictionary with success status and file path\n    \"\"\"\n    try:\n        symbol = input_data.get('symbol', 'UNKNOWN')\n        timeframe = input_data.get('timeframe', '')\n        candles = input_data.get('candles', [])\n        signal = input_data.get('signal', {})\n        supply_zones = input_data.get('supply_zones', [])\n        demand_zones = input_data.get('demand_zones', [])\n        output_path = input_data.get('output_path', '/tmp/chart.png')\n        \n        if not candles:\n            return {\"success\": False, \"error\": \"No candle data provided\"}\n        \n        # Convert candles to DataFrame\n        df = pd.DataFrame(candles)\n        df['Date'] = pd.to_datetime(df['date'])\n        df.set_index('Date', inplace=True)\n        df = df.rename(columns={\n            'open': 'Open',\n            'high': 'High', \n            'low': 'Low',\n            'close': 'Close',\n            'volume': 'Volume'\n        })\n        \n        # Ensure correct column types\n        for col in ['Open', 'High', 'Low', 'Close']:\n            df[col] = pd.to_numeric(df[col], errors='coerce')\n        \n        df = df.dropna(subset=['Open', 'High', 'Low', 'Close'])\n        \n        if len(df) < 5:\n            return {\"success\": False, \"error\": \"Not enough candle data\"}\n        \n        # Custom dark style\n        mc = mpf.make_marketcolors(\n            up='#22c55e',\n            down='#ef4444',\n            edge='inherit',\n            wick='inherit',\n            volume='in',\n        )\n        \n        style = mpf.make_mpf_style(\n            base_mpf_style='nightclouds',\n            marketcolors=mc,\n            gridstyle='-',\n            gridcolor='#1f2937',\n            facecolor='#0a0a0f',\n            edgecolor='#1f2937',\n            figcolor='#0a0a0f',\n            rc={\n                'axes.labelcolor': '#e5e7eb',\n                'xtick.color': '#e5e7eb',\n                'ytick.color': '#e5e7eb',\n            }\n        )\n        \n        # Create figure\n        fig, axes = mpf.plot(\n            df,\n            type='candle',\n            style=style,\n            volume=False,\n            returnfig=True,\n            figsize=(14, 9),\n            warn_too_much_data=False,\n            tight_layout=True,\n        )\n        \n        ax = axes[0]\n        \n        # Get y-axis range\n        y_min, y_max = ax.get_ylim()\n        \n        # Draw zones\n        for zone in supply_zones:\n            top = float(zone.get('top', 0))\n            bottom = float(zone.get('bottom', 0))\n            if top > 0 and bottom > 0:\n                rect = mpatches.Rectangle(\n                    (ax.get_xlim()[0], bottom),\n                    ax.get_xlim()[1] - ax.get_xlim()[0],\n                    top - bottom,\n                    linewidth=1,\n                    edgecolor='#ef4444',\n                    facecolor='#ef444433',\n                    linestyle='--',\n                    zorder=1\n                )\n                ax.add_patch(rect)\n        \n        for zone in demand_zones:\n            top = float(zone.get('top', 0))\n            bottom = float(zone.get('bottom', 0))\n            if top > 0 and bottom > 0:\n                rect = mpatches.Rectangle(\n                    (ax.get_xlim()[0], bottom),\n                    ax.get_xlim()[1] - ax.get_xlim()[0],\n                    top - bottom,\n                    linewidth=1,\n                    edgecolor='#22c55e',\n                    facecolor='#22c55e33',\n                    linestyle='--',\n                    zorder=1\n                )\n                ax.add_patch(rect)\n        \n        # Draw signal lines\n        if signal:\n            direction = signal.get('direction', '')\n            entry = float(signal.get('entry', 0))\n            sl = float(signal.get('stopLoss', 0))\n            tp = float(signal.get('takeProfit', 0))\n            confidence = signal.get('confidence', 0)\n            \n            x_min, x_max = ax.get_xlim()\n            \n            # Entry line\n            if entry > 0:\n                color = '#22c55e' if direction == 'BUY' else '#ef4444'\n                ax.axhline(y=entry, color=color, linestyle='-', linewidth=2, alpha=0.8)\n                ax.text(x_max, entry, f' {direction} @ {entry:.5f} ({confidence}%)', \n                       va='center', ha='left', color=color, fontsize=10, fontweight='bold')\n            \n            # Stop Loss line\n            if sl > 0:\n                ax.axhline(y=sl, color='#f59e0b', linestyle='--', linewidth=1.5, alpha=0.8)\n                ax.text(x_max, sl, f' SL @ {sl:.5f}', \n                       va='center', ha='left', color='#f59e0b', fontsize=9)\n            \n            # Take Profit line  \n            if tp > 0:\n                ax.axhline(y=tp, color='#3b82f6', linestyle='--', linewidth=1.5, alpha=0.8)\n                ax.text(x_max, tp, f' TP @ {tp:.5f}', \n                       va='center', ha='left', color='#3b82f6', fontsize=9)\n        \n        # Title\n        title = f'{symbol} - {timeframe}'\n        timestamp = datetime.utcnow().strftime('%Y-%m-%d %H:%M UTC')\n        ax.set_title(f'{title}\\n{timestamp}', fontsize=14, fontweight='bold', color='#e5e7eb', pad=10)\n        \n        # Add legend for zones\n        legend_elements = [\n            mpatches.Patch(facecolor='#ef444433', edgecolor='#ef4444', label='Supply Zone'),\n            mpatches.Patch(facecolor='#22c55e33', edgecolor='#22c55e', label='Demand Zone'),\n        ]\n        ax.legend(handles=legend_elements, loc='upper left', fontsize=9, \n                 facecolor='#1f2937', edgecolor='#374151', labelcolor='#e5e7eb')\n        \n        # Ensure output directory exists\n        os.makedirs(os.path.dirname(output_path) if os.path.dirname(output_path) else '.', exist_ok=True)\n        \n        # Save figure\n        fig.savefig(output_path, dpi=150, bbox_inches='tight', facecolor='#0a0a0f', edgecolor='none')\n        plt.close(fig)\n        \n        return {\"success\": True, \"path\": output_path}\n        \n    except Exception as e:\n        return {\"success\": False, \"error\": str(e)}\n\n\ndef main():\n    \"\"\"Main entry point - reads JSON from stdin, outputs JSON to stdout\"\"\"\n    try:\n        # Read input from stdin\n        input_str = sys.stdin.read()\n        if not input_str.strip():\n            print(json.dumps({\"success\": False, \"error\": \"No input provided\"}))\n            return\n        \n        input_data = json.loads(input_str)\n        result = generate_signal_chart(input_data)\n        print(json.dumps(result))\n        \n    except json.JSONDecodeError as e:\n        print(json.dumps({\"success\": False, \"error\": f\"Invalid JSON: {e}\"}))\n    except Exception as e:\n        print(json.dumps({\"success\": False, \"error\": str(e)}))\n\n\nif __name__ == \"__main__\":\n    main()\n","size_bytes":7698},"server/services/geminiAnalysis.ts":{"content":"import { GoogleGenAI } from \"@google/genai\";\nimport * as fs from \"fs\";\n\n// Initialize Gemini AI with user's API key\nconst ai = new GoogleGenAI({ apiKey: process.env.GOOGLE_API_KEY || \"\" });\n\n// Gemini as ASSISTANT to our SMC Strategy - validates and enhances signals\nconst SIGNAL_VALIDATION_INSTRUCTION = `Role: You are a technical analysis assistant that validates and enhances Smart Money Concepts (SMC) trading signals.\n\nYour job is to review signals generated by our algorithmic SMC strategy and provide:\n1. Validation: Confirm if the signal setup looks valid\n2. Confidence adjustment: Suggest if confidence should be higher or lower based on additional context\n3. Risk assessment: Identify any concerns or additional confirmations\n\nKey SMC concepts you understand:\n- Supply/Demand zones (institutional order blocks)\n- Fair Value Gaps (FVG) - price imbalances\n- Change of Character (CHoCH) - trend reversals\n- Break of Structure (BOS) - trend continuation\n- Liquidity sweeps - stop hunts before reversals\n- Higher timeframe context (4H/2H for bias, 15M/30M for zones)\n\nCRITICAL VALIDATION RULES:\n1. DO NOT TRADE AGAINST THE TREND unless there is a CONFIRMED trend change (CHoCH):\n   - If the higher timeframe trend is bullish, only validate BUY signals\n   - If the higher timeframe trend is bearish, only validate SELL signals\n   - EXCEPTION: A counter-trend signal is ONLY valid if there is a confirmed CHoCH (Change of Character)\n   - CHoCH must be clear: Lower Low breaking structure (bullish CHoCH) or Higher High breaking structure (bearish CHoCH)\n\n2. AVOID UNCLEAR MARKETS:\n   - Skip signals when price is ranging/choppy with no clear direction\n   - Skip signals when there is no clear higher timeframe bias\n   - Skip signals when supply/demand zones are overlapping or messy\n   - Skip signals when there are conflicting signals on different timeframes\n   - If the market structure is unclear, recommend \"skip\"\n\nYou are NOT generating new signals. You are validating signals from our strategy.\n\nOutput Format (JSON only):\n{\n  \"validated\": true/false,\n  \"confidenceAdjustment\": number (-20 to +20),\n  \"concerns\": [\"list of any concerns\"],\n  \"strengths\": [\"list of signal strengths\"],\n  \"recommendation\": \"proceed\" | \"caution\" | \"skip\",\n  \"reasoning\": \"brief explanation\"\n}`;\n\n// Quick market scan instruction for screening\nconst MARKET_SCAN_INSTRUCTION = `Role: You are a quick market scanner for Smart Money Concepts.\nAnalyze the price data and identify if there are potential SMC setups forming.\nLook for: supply/demand zones, liquidity pools, potential CHoCH, FVGs.\n\nCRITICAL RULES:\n1. Only identify setups that ALIGN with the trend direction\n2. Counter-trend setups require CONFIRMED CHoCH (Change of Character)\n3. If the market is unclear/choppy/ranging, set hasSetup to false\n4. Do not identify setups in messy or conflicting market structures\n\nOutput Format (JSON only):\n{\n  \"hasSetup\": true/false,\n  \"direction\": \"BUY\" | \"SELL\" | \"NEUTRAL\",\n  \"setupType\": \"zone_entry\" | \"choch\" | \"liquidity_sweep\" | \"none\",\n  \"keyLevel\": number or null,\n  \"trendDirection\": \"bullish\" | \"bearish\" | \"unclear\",\n  \"marketClarity\": \"clear\" | \"moderate\" | \"unclear\",\n  \"reasoning\": \"brief explanation\"\n}`;\n\nexport interface SignalValidationResult {\n  validated: boolean;\n  confidenceAdjustment: number;\n  concerns: string[];\n  strengths: string[];\n  recommendation: 'proceed' | 'caution' | 'skip';\n  reasoning: string;\n  error?: string;\n  isFallback?: boolean; // True ONLY when Gemini is unavailable and we use strategy signal as-is\n}\n\nexport interface MarketScanResult {\n  hasSetup: boolean;\n  direction: 'BUY' | 'SELL' | 'NEUTRAL';\n  setupType: 'zone_entry' | 'choch' | 'liquidity_sweep' | 'none';\n  keyLevel: number | null;\n  trendDirection: 'bullish' | 'bearish' | 'unclear';\n  marketClarity: 'clear' | 'moderate' | 'unclear';\n  reasoning: string;\n  error?: string;\n}\n\nexport interface PriceData {\n  symbol: string;\n  timeframe: string;\n  candles: CandleData[];\n}\n\nexport interface CandleData {\n  date: string;\n  open: number;\n  high: number;\n  low: number;\n  close: number;\n  volume?: number;\n}\n\nexport interface SignalToValidate {\n  symbol: string;\n  direction: 'BUY' | 'SELL';\n  entryPrice: number;\n  stopLoss: number;\n  takeProfit: number;\n  confidence: number;\n  strategy: string;\n  entryType: string;\n  reasoning: string;\n  zones?: { type: string; top: number; bottom: number }[];\n}\n\n// Format price data for Gemini\nfunction formatPriceDataForGemini(priceData: PriceData[]): string {\n  return priceData.map(data => {\n    const recentCandles = data.candles.slice(-30); // Last 30 candles\n    const lastCandle = recentCandles[recentCandles.length - 1];\n    return `\n=== ${data.symbol} - ${data.timeframe} ===\nCurrent Price: ${lastCandle?.close || 'N/A'}\nLast Update: ${lastCandle?.date || 'N/A'}\n\nRecent Candles (newest first):\n${recentCandles.reverse().slice(0, 15).map(c => \n  `${c.date}: O:${c.open.toFixed(5)} H:${c.high.toFixed(5)} L:${c.low.toFixed(5)} C:${c.close.toFixed(5)}`\n).join('\\n')}\n`;\n  }).join('\\n\\n');\n}\n\n// Format signal for validation\nfunction formatSignalForValidation(signal: SignalToValidate): string {\n  let zonesText = '';\n  if (signal.zones && signal.zones.length > 0) {\n    zonesText = `\\nIdentified Zones:\\n${signal.zones.map(z => \n      `- ${z.type}: ${z.bottom.toFixed(5)} - ${z.top.toFixed(5)}`\n    ).join('\\n')}`;\n  }\n\n  return `\n=== SIGNAL TO VALIDATE ===\nSymbol: ${signal.symbol}\nDirection: ${signal.direction}\nEntry: ${signal.entryPrice.toFixed(5)}\nStop Loss: ${signal.stopLoss.toFixed(5)}\nTake Profit: ${signal.takeProfit.toFixed(5)}\nCurrent Confidence: ${signal.confidence}%\nStrategy: ${signal.strategy}\nEntry Type: ${signal.entryType}\nReasoning: ${signal.reasoning}\n${zonesText}\n`;\n}\n\n/**\n * Validate a signal generated by our SMC strategy\n * Gemini acts as a second opinion to enhance accuracy\n */\nexport async function validateSignalWithGemini(\n  signal: SignalToValidate,\n  priceData: PriceData[],\n  chartImagePath?: string\n): Promise<SignalValidationResult> {\n  try {\n    const formattedData = formatPriceDataForGemini(priceData);\n    const formattedSignal = formatSignalForValidation(signal);\n    \n    // Build content array\n    const contents: any[] = [];\n    \n    // Add chart image if provided\n    if (chartImagePath && fs.existsSync(chartImagePath)) {\n      const imageBytes = fs.readFileSync(chartImagePath);\n      const mimeType = chartImagePath.endsWith('.png') ? 'image/png' : 'image/jpeg';\n      contents.push({\n        inlineData: {\n          data: imageBytes.toString('base64'),\n          mimeType,\n        },\n      });\n    }\n    \n    contents.push(`\nPlease validate this trading signal from our SMC strategy:\n\n${formattedSignal}\n\nPrice Data Context:\n${formattedData}\n\nProvide your validation in the exact JSON format specified.\n`);\n\n    const response = await ai.models.generateContent({\n      model: \"gemini-2.5-flash\",\n      config: {\n        systemInstruction: SIGNAL_VALIDATION_INSTRUCTION,\n        responseMimeType: \"application/json\",\n        temperature: 0.3,\n        maxOutputTokens: 1024,\n      },\n      contents,\n    });\n\n    const text = response.text;\n    if (text) {\n      try {\n        const result = JSON.parse(text);\n        return {\n          validated: result.validated ?? false,\n          confidenceAdjustment: Math.max(-20, Math.min(20, result.confidenceAdjustment || 0)),\n          concerns: result.concerns || [],\n          strengths: result.strengths || [],\n          recommendation: result.recommendation || 'caution',\n          reasoning: result.reasoning || '',\n        };\n      } catch (parseError) {\n        return {\n          validated: true,\n          confidenceAdjustment: 0,\n          concerns: ['Could not parse Gemini response'],\n          strengths: [],\n          recommendation: 'caution',\n          reasoning: 'Validation response was not in expected format',\n        };\n      }\n    }\n    \n    return {\n      validated: false,\n      confidenceAdjustment: 0,\n      concerns: ['Empty response from Gemini'],\n      strengths: [],\n      recommendation: 'skip',\n      reasoning: 'No validation response received',\n    };\n  } catch (error) {\n    console.error('Gemini validation error:', error);\n    // ONLY when Gemini is unavailable (error): fallback to strategy signal as-is\n    return {\n      validated: true,\n      confidenceAdjustment: 0,\n      concerns: ['Gemini validation unavailable - using strategy signal as fallback'],\n      strengths: [],\n      recommendation: 'proceed', // Fallback: proceed with strategy signal\n      reasoning: 'Gemini service unavailable - FALLBACK: using strategy signal as-is',\n      error: error instanceof Error ? error.message : 'Unknown error',\n      isFallback: true, // Flag to indicate this is a fallback response\n    };\n  }\n}\n\n/**\n * Quick market scan to pre-screen instruments\n * Helps identify which markets have potential setups\n */\nexport async function quickMarketScan(\n  symbol: string,\n  priceData: PriceData[]\n): Promise<MarketScanResult> {\n  try {\n    const formattedData = formatPriceDataForGemini(priceData);\n    \n    const response = await ai.models.generateContent({\n      model: \"gemini-2.5-flash\",\n      config: {\n        systemInstruction: MARKET_SCAN_INSTRUCTION,\n        responseMimeType: \"application/json\",\n        temperature: 0.3,\n        maxOutputTokens: 512,\n      },\n      contents: `Quick scan for ${symbol}:\\n${formattedData}`,\n    });\n\n    const text = response.text;\n    if (text) {\n      try {\n        const result = JSON.parse(text);\n        return {\n          hasSetup: result.hasSetup ?? false,\n          direction: result.direction || 'NEUTRAL',\n          setupType: result.setupType || 'none',\n          keyLevel: result.keyLevel || null,\n          trendDirection: result.trendDirection || 'unclear',\n          marketClarity: result.marketClarity || 'unclear',\n          reasoning: result.reasoning || '',\n        };\n      } catch {\n        return {\n          hasSetup: false,\n          direction: 'NEUTRAL',\n          setupType: 'none',\n          keyLevel: null,\n          trendDirection: 'unclear',\n          marketClarity: 'unclear',\n          reasoning: 'Could not parse scan response',\n        };\n      }\n    }\n    \n    return {\n      hasSetup: false,\n      direction: 'NEUTRAL',\n      setupType: 'none',\n      keyLevel: null,\n      trendDirection: 'unclear',\n      marketClarity: 'unclear',\n      reasoning: 'Empty scan response',\n    };\n  } catch (error) {\n    console.error('Quick scan error:', error);\n    return {\n      hasSetup: false,\n      direction: 'NEUTRAL',\n      setupType: 'none',\n      keyLevel: null,\n      trendDirection: 'unclear',\n      marketClarity: 'unclear',\n      reasoning: 'Scan failed',\n      error: error instanceof Error ? error.message : 'Unknown error',\n    };\n  }\n}\n\n// Check if Gemini API is configured\nexport function isGeminiConfigured(): boolean {\n  return !!process.env.GOOGLE_API_KEY;\n}\n\n// Test Gemini connection\nexport async function testGeminiConnection(): Promise<{ success: boolean; message: string }> {\n  if (!isGeminiConfigured()) {\n    return { success: false, message: 'GOOGLE_API_KEY not configured' };\n  }\n\n  try {\n    const response = await ai.models.generateContent({\n      model: \"gemini-2.5-flash\",\n      contents: \"Respond with exactly: 'SMC validation ready'\",\n    });\n    \n    const text = response.text || '';\n    if (text.toLowerCase().includes('ready')) {\n      return { success: true, message: 'Gemini API connected successfully' };\n    }\n    return { success: true, message: `Gemini responded: ${text.slice(0, 50)}...` };\n  } catch (error) {\n    return { \n      success: false, \n      message: error instanceof Error ? error.message : 'Connection failed' \n    };\n  }\n}\n\n// Legacy exports for backward compatibility with routes\nexport async function analyzeWithGemini(\n  symbol: string,\n  priceData: PriceData[],\n  chartImagePath?: string\n): Promise<any> {\n  // Convert to validation format\n  const dummySignal: SignalToValidate = {\n    symbol,\n    direction: 'BUY',\n    entryPrice: 0,\n    stopLoss: 0,\n    takeProfit: 0,\n    confidence: 50,\n    strategy: 'smc',\n    entryType: 'analysis_request',\n    reasoning: 'Full analysis requested',\n  };\n  \n  const validation = await validateSignalWithGemini(dummySignal, priceData, chartImagePath);\n  const scan = await quickMarketScan(symbol, priceData);\n  \n  return {\n    validation,\n    marketScan: scan,\n    note: 'Use validateSignalWithGemini() to validate specific signals from our SMC strategy',\n  };\n}\n\nexport async function quickAnalyzeWithGemini(\n  symbol: string,\n  priceData: PriceData[]\n): Promise<{ direction: 'BUY' | 'SELL' | 'HOLD'; confidence: number; reasoning: string } | null> {\n  const scan = await quickMarketScan(symbol, priceData);\n  \n  if (scan.error) return null;\n  \n  return {\n    direction: scan.direction === 'NEUTRAL' ? 'HOLD' : scan.direction,\n    confidence: scan.hasSetup ? 60 : 30,\n    reasoning: scan.reasoning,\n  };\n}\n","size_bytes":12933},"server/services/chartGenerator.ts":{"content":"import { spawn } from 'child_process';\nimport * as path from 'path';\nimport * as fs from 'fs';\n\nexport interface ChartCandle {\n  date: string;\n  open: number;\n  high: number;\n  low: number;\n  close: number;\n  volume?: number;\n}\n\nexport interface SignalInfo {\n  direction: 'BUY' | 'SELL';\n  entry: number;\n  stopLoss: number;\n  takeProfit: number;\n  confidence: number;\n}\n\nexport interface ZoneInfo {\n  top: number;\n  bottom: number;\n}\n\nexport interface ChartGeneratorInput {\n  symbol: string;\n  timeframe: string;\n  candles: ChartCandle[];\n  signal?: SignalInfo;\n  supply_zones?: ZoneInfo[];\n  demand_zones?: ZoneInfo[];\n  output_path: string;\n}\n\nexport interface ChartGeneratorResult {\n  success: boolean;\n  path?: string;\n  error?: string;\n}\n\n// Generate chart using Python script\nexport async function generateSignalChart(input: ChartGeneratorInput): Promise<ChartGeneratorResult> {\n  return new Promise((resolve) => {\n    // Use absolute path to ensure script is found regardless of working directory\n    const pythonScript = path.resolve(process.cwd(), 'server/python/chart_generator.py');\n    \n    // Check if Python script exists\n    if (!fs.existsSync(pythonScript)) {\n      resolve({ success: false, error: 'Chart generator script not found' });\n      return;\n    }\n    \n    const python = spawn('python3', [pythonScript]);\n    let stdout = '';\n    let stderr = '';\n    \n    python.stdout.on('data', (data) => {\n      stdout += data.toString();\n    });\n    \n    python.stderr.on('data', (data) => {\n      stderr += data.toString();\n    });\n    \n    python.on('close', (code) => {\n      if (code !== 0) {\n        console.error('Chart generation stderr:', stderr);\n        resolve({ success: false, error: stderr || `Process exited with code ${code}` });\n        return;\n      }\n      \n      try {\n        const result = JSON.parse(stdout);\n        resolve(result);\n      } catch (e) {\n        resolve({ success: false, error: `Failed to parse result: ${stdout}` });\n      }\n    });\n    \n    python.on('error', (err) => {\n      resolve({ success: false, error: err.message });\n    });\n    \n    // Send input data as JSON\n    python.stdin.write(JSON.stringify(input));\n    python.stdin.end();\n  });\n}\n\n// Generate a trading signal chart (simplified interface)\nexport async function generateTradingSignalChart(\n  symbol: string,\n  timeframe: string,\n  candles: ChartCandle[],\n  signal: {\n    direction: 'BUY' | 'SELL';\n    entryPrice: number;\n    stopLoss: number;\n    takeProfit: number;\n    confidence: number;\n  },\n  supplyZones: ZoneInfo[] = [],\n  demandZones: ZoneInfo[] = []\n): Promise<ChartGeneratorResult> {\n  // Generate unique filename\n  const timestamp = Date.now();\n  const safeSymbol = symbol.replace(/[^a-zA-Z0-9]/g, '_');\n  const filename = `signal_${safeSymbol}_${timeframe}_${timestamp}.png`;\n  const outputPath = path.join('/tmp/charts', filename);\n  \n  // Ensure directory exists\n  const dir = path.dirname(outputPath);\n  if (!fs.existsSync(dir)) {\n    fs.mkdirSync(dir, { recursive: true });\n  }\n  \n  const input: ChartGeneratorInput = {\n    symbol,\n    timeframe,\n    candles,\n    signal: {\n      direction: signal.direction,\n      entry: signal.entryPrice,\n      stopLoss: signal.stopLoss,\n      takeProfit: signal.takeProfit,\n      confidence: signal.confidence,\n    },\n    supply_zones: supplyZones,\n    demand_zones: demandZones,\n    output_path: outputPath,\n  };\n  \n  return generateSignalChart(input);\n}\n\n// Check if chart generation is available\nexport async function isChartGeneratorAvailable(): Promise<boolean> {\n  try {\n    const testInput: ChartGeneratorInput = {\n      symbol: 'TEST',\n      timeframe: '1H',\n      candles: [\n        { date: '2024-01-01T00:00:00Z', open: 1.0, high: 1.1, low: 0.9, close: 1.05 },\n        { date: '2024-01-01T01:00:00Z', open: 1.05, high: 1.15, low: 1.0, close: 1.10 },\n        { date: '2024-01-01T02:00:00Z', open: 1.10, high: 1.12, low: 1.05, close: 1.08 },\n        { date: '2024-01-01T03:00:00Z', open: 1.08, high: 1.15, low: 1.06, close: 1.12 },\n        { date: '2024-01-01T04:00:00Z', open: 1.12, high: 1.18, low: 1.10, close: 1.15 },\n      ],\n      output_path: '/tmp/test_chart.png',\n    };\n    \n    const result = await generateSignalChart(testInput);\n    \n    // Clean up test file\n    if (result.success && result.path && fs.existsSync(result.path)) {\n      fs.unlinkSync(result.path);\n    }\n    \n    return result.success;\n  } catch {\n    return false;\n  }\n}\n\n// Read chart as buffer for sending via Telegram\nexport function readChartAsBuffer(chartPath: string): Buffer | null {\n  try {\n    if (fs.existsSync(chartPath)) {\n      return fs.readFileSync(chartPath);\n    }\n    return null;\n  } catch {\n    return null;\n  }\n}\n\n// Clean up old chart files\nexport function cleanupOldCharts(maxAgeMs: number = 3600000): void {\n  const chartsDir = '/tmp/charts';\n  \n  if (!fs.existsSync(chartsDir)) {\n    return;\n  }\n  \n  const now = Date.now();\n  const files = fs.readdirSync(chartsDir);\n  \n  for (const file of files) {\n    const filePath = path.join(chartsDir, file);\n    try {\n      const stats = fs.statSync(filePath);\n      if (now - stats.mtimeMs > maxAgeMs) {\n        fs.unlinkSync(filePath);\n      }\n    } catch {\n      // Ignore errors\n    }\n  }\n}\n","size_bytes":5231},"server/services/signalMonitor.ts":{"content":"import { storage } from \"../storage\";\nimport { getCachedPrice } from \"../lib/priceService\";\nimport type { TradingSignal, InsertTrade } from \"@shared/schema\";\n\nexport interface SignalOutcome {\n  signalId: string;\n  symbol: string;\n  outcome: 'hit_sl' | 'hit_tp' | 'expired' | 'active';\n  currentPrice: number;\n  entryPrice: number;\n  exitPrice?: number;\n  pnlPercent?: number;\n}\n\nexport class SignalMonitorService {\n  private monitoringInterval: NodeJS.Timeout | null = null;\n  private isRunning = false;\n\n  async start(intervalMs: number = 30000) {\n    if (this.isRunning) {\n      console.log('[SignalMonitor] Already running');\n      return;\n    }\n\n    this.isRunning = true;\n    console.log('[SignalMonitor] Starting signal monitoring...');\n    \n    await this.checkAllSignals();\n    \n    this.monitoringInterval = setInterval(async () => {\n      await this.checkAllSignals();\n    }, intervalMs);\n  }\n\n  stop() {\n    if (this.monitoringInterval) {\n      clearInterval(this.monitoringInterval);\n      this.monitoringInterval = null;\n    }\n    this.isRunning = false;\n    console.log('[SignalMonitor] Stopped');\n  }\n\n  async checkAllSignals(): Promise<SignalOutcome[]> {\n    try {\n      const activeSignals = await storage.getTradingSignals();\n      const outcomes: SignalOutcome[] = [];\n\n      for (const signal of activeSignals) {\n        if (signal.status !== 'active') continue;\n\n        const outcome = await this.checkSignal(signal);\n        outcomes.push(outcome);\n\n        if (outcome.outcome === 'hit_sl' || outcome.outcome === 'hit_tp') {\n          await this.archiveSignalToTrades(signal, outcome);\n        } else if (outcome.outcome === 'expired') {\n          await this.expireSignal(signal);\n        }\n      }\n\n      return outcomes;\n    } catch (error) {\n      console.error('[SignalMonitor] Error checking signals:', error);\n      return [];\n    }\n  }\n\n  async checkSignal(signal: TradingSignal): Promise<SignalOutcome> {\n    const entryPrice = parseFloat(signal.entryPrice?.toString() || '0');\n    const stopLoss = parseFloat(signal.stopLoss?.toString() || '0');\n    const takeProfit = parseFloat(signal.takeProfit?.toString() || '0');\n\n    const assetClass = this.mapAssetClass(signal.assetClass);\n    const priceResult = await getCachedPrice(signal.symbol, assetClass);\n    \n    if (!priceResult || priceResult.error) {\n      return {\n        signalId: signal.id,\n        symbol: signal.symbol,\n        outcome: 'active',\n        currentPrice: 0,\n        entryPrice,\n      };\n    }\n\n    const currentPrice = priceResult.price ?? 0;\n    const isBuy = signal.type.toLowerCase() === 'buy';\n\n    let outcome: SignalOutcome['outcome'] = 'active';\n    let exitPrice: number | undefined;\n    let pnlPercent: number | undefined;\n\n    if (currentPrice > 0) {\n      if (isBuy) {\n        if (currentPrice <= stopLoss) {\n          outcome = 'hit_sl';\n          exitPrice = stopLoss;\n          pnlPercent = ((stopLoss - entryPrice) / entryPrice) * 100;\n        } else if (currentPrice >= takeProfit) {\n          outcome = 'hit_tp';\n          exitPrice = takeProfit;\n          pnlPercent = ((takeProfit - entryPrice) / entryPrice) * 100;\n        }\n      } else {\n        if (currentPrice >= stopLoss) {\n          outcome = 'hit_sl';\n          exitPrice = stopLoss;\n          pnlPercent = ((entryPrice - stopLoss) / entryPrice) * 100;\n        } else if (currentPrice <= takeProfit) {\n          outcome = 'hit_tp';\n          exitPrice = takeProfit;\n          pnlPercent = ((entryPrice - takeProfit) / entryPrice) * 100;\n        }\n      }\n    }\n\n    if (signal.expiresAt && new Date() > new Date(signal.expiresAt)) {\n      outcome = 'expired';\n    }\n\n    return {\n      signalId: signal.id,\n      symbol: signal.symbol,\n      outcome,\n      currentPrice,\n      entryPrice,\n      exitPrice,\n      pnlPercent,\n    };\n  }\n\n  private mapAssetClass(assetClass: string): 'stock' | 'forex' | 'crypto' | 'commodity' {\n    const normalized = assetClass.toLowerCase();\n    if (normalized.includes('forex') || normalized.includes('fx')) return 'forex';\n    if (normalized.includes('crypto')) return 'crypto';\n    if (normalized.includes('commodity') || normalized.includes('commodities')) return 'commodity';\n    return 'stock';\n  }\n\n  private async archiveSignalToTrades(signal: TradingSignal, outcome: SignalOutcome): Promise<void> {\n    try {\n      const entryPrice = parseFloat(signal.entryPrice?.toString() || '0');\n      const exitPrice = outcome.exitPrice || outcome.currentPrice;\n      const pnlPercent = outcome.pnlPercent || 0;\n      \n      const isBuy = signal.type.toLowerCase() === 'buy';\n      const pnl = isBuy \n        ? (exitPrice - entryPrice) * 1\n        : (entryPrice - exitPrice) * 1;\n\n      const duration = this.calculateDuration(signal.createdAt || new Date());\n\n      const trade: InsertTrade = {\n        userId: null,\n        symbol: signal.symbol,\n        type: signal.type,\n        strategy: signal.strategy,\n        entryPrice: entryPrice.toString(),\n        exitPrice: exitPrice.toString(),\n        quantity: \"1\",\n        pnl: pnl.toFixed(2),\n        pnlPercent: pnlPercent.toFixed(2),\n        outcome: outcome.outcome === 'hit_sl' ? 'loss' : 'win',\n        timeframe: signal.primaryTimeframe,\n        entryReason: signal.technicalReasons?.join(', ') || signal.marketContext || 'SMC Signal',\n        exitDate: new Date(),\n        duration,\n      };\n\n      await storage.createTrade(trade);\n      \n      await storage.updateTradingSignal(signal.id, {\n        status: outcome.outcome === 'hit_sl' ? 'stopped_out' : 'target_hit',\n        invalidatedAt: new Date(),\n      });\n\n      console.log(`[SignalMonitor] Archived ${signal.symbol} signal: ${outcome.outcome}`);\n    } catch (error) {\n      console.error('[SignalMonitor] Error archiving signal:', error);\n    }\n  }\n\n  private async expireSignal(signal: TradingSignal): Promise<void> {\n    try {\n      await storage.updateTradingSignal(signal.id, {\n        status: 'expired',\n        invalidatedAt: new Date(),\n      });\n      console.log(`[SignalMonitor] Expired ${signal.symbol} signal`);\n    } catch (error) {\n      console.error('[SignalMonitor] Error expiring signal:', error);\n    }\n  }\n\n  private calculateDuration(startDate: Date): string {\n    const now = new Date();\n    const diffMs = now.getTime() - startDate.getTime();\n    const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n    const diffMins = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));\n\n    if (diffHours < 1) {\n      return `${diffMins}m`;\n    } else if (diffHours < 24) {\n      return `${diffHours}h ${diffMins}m`;\n    } else {\n      const diffDays = Math.floor(diffHours / 24);\n      return `${diffDays}d ${diffHours % 24}h`;\n    }\n  }\n\n  async getWatchlistSignals(): Promise<TradingSignal[]> {\n    const allSignals = await storage.getTradingSignals();\n    return allSignals.filter(s => s.status === 'watchlist' || s.status === 'pending');\n  }\n\n  async getActiveSignals(): Promise<TradingSignal[]> {\n    const allSignals = await storage.getTradingSignals();\n    return allSignals.filter(s => s.status === 'active');\n  }\n\n  async promoteToActive(signalId: string): Promise<TradingSignal | undefined> {\n    return storage.updateTradingSignal(signalId, { status: 'active' });\n  }\n\n  async moveToWatchlist(signalId: string): Promise<TradingSignal | undefined> {\n    return storage.updateTradingSignal(signalId, { status: 'watchlist' });\n  }\n}\n\nexport const signalMonitor = new SignalMonitorService();\n","size_bytes":7455},"server/strategies/core/strategyRegistry.ts":{"content":"import { BaseStrategy } from './baseStrategy';\nimport { StrategyResult, InstrumentData, StrategySignal } from './types';\n\ninterface RegistryEntry {\n  strategy: BaseStrategy;\n  lastResult: StrategyResult | null;\n  lastError: Error | null;\n  lastRunTime: number;\n}\n\nexport class StrategyRegistry {\n  private strategies: Map<string, RegistryEntry> = new Map();\n  private static instance: StrategyRegistry | null = null;\n\n  private constructor() {}\n\n  static getInstance(): StrategyRegistry {\n    if (!StrategyRegistry.instance) {\n      StrategyRegistry.instance = new StrategyRegistry();\n    }\n    return StrategyRegistry.instance;\n  }\n\n  register(strategy: BaseStrategy): void {\n    if (this.strategies.has(strategy.id)) {\n      console.warn(`Strategy ${strategy.id} already registered. Updating...`);\n    }\n\n    this.strategies.set(strategy.id, {\n      strategy,\n      lastResult: null,\n      lastError: null,\n      lastRunTime: 0,\n    });\n\n    console.log(`[StrategyRegistry] Registered strategy: ${strategy.name} (${strategy.id})`);\n  }\n\n  unregister(strategyId: string): boolean {\n    const removed = this.strategies.delete(strategyId);\n    if (removed) {\n      console.log(`[StrategyRegistry] Unregistered strategy: ${strategyId}`);\n    }\n    return removed;\n  }\n\n  getStrategy(strategyId: string): BaseStrategy | undefined {\n    return this.strategies.get(strategyId)?.strategy;\n  }\n\n  getAllStrategies(): BaseStrategy[] {\n    return Array.from(this.strategies.values()).map(entry => entry.strategy);\n  }\n\n  getEnabledStrategies(): BaseStrategy[] {\n    return this.getAllStrategies().filter(s => s.isEnabled);\n  }\n\n  async runStrategy(strategyId: string, instrument: InstrumentData): Promise<StrategyResult | null> {\n    const entry = this.strategies.get(strategyId);\n    if (!entry) {\n      console.error(`[StrategyRegistry] Strategy not found: ${strategyId}`);\n      return null;\n    }\n\n    if (!entry.strategy.isEnabled) {\n      return null;\n    }\n\n    const startTime = Date.now();\n\n    try {\n      const result = await entry.strategy.analyze(instrument);\n      entry.lastResult = result;\n      entry.lastError = null;\n      entry.lastRunTime = Date.now() - startTime;\n\n      return result;\n    } catch (error) {\n      entry.lastError = error as Error;\n      entry.lastResult = {\n        strategyId,\n        signals: [],\n        pendingSetups: [],\n        errors: [(error as Error).message],\n        analysisTimeMs: Date.now() - startTime,\n      };\n\n      console.error(`[StrategyRegistry] Error running ${strategyId}:`, (error as Error).message);\n      return entry.lastResult;\n    }\n  }\n\n  async runAllStrategies(instrument: InstrumentData): Promise<StrategySignal[]> {\n    const result = await this.runAllStrategiesWithPending(instrument);\n    return result.signals;\n  }\n\n  async runAllStrategiesWithPending(instrument: InstrumentData): Promise<{ signals: StrategySignal[]; pendingSetups: any[] }> {\n    const enabledStrategies = this.getEnabledStrategies();\n    const allSignals: StrategySignal[] = [];\n    const allPendingSetups: any[] = [];\n\n    const results = await Promise.allSettled(\n      enabledStrategies.map(strategy => this.runStrategy(strategy.id, instrument))\n    );\n\n    for (const result of results) {\n      if (result.status === 'fulfilled' && result.value) {\n        allSignals.push(...result.value.signals);\n        if (result.value.pendingSetups && result.value.pendingSetups.length > 0) {\n          allPendingSetups.push(...result.value.pendingSetups.map(setup => ({\n            ...setup,\n            symbol: instrument.symbol,\n            assetClass: instrument.assetClass,\n          })));\n        }\n      }\n    }\n\n    return { signals: allSignals, pendingSetups: allPendingSetups };\n  }\n\n  async runAllStrategiesForMultipleInstruments(\n    instruments: InstrumentData[]\n  ): Promise<Map<string, StrategySignal[]>> {\n    const signalsBySymbol = new Map<string, StrategySignal[]>();\n\n    for (const instrument of instruments) {\n      try {\n        const signals = await this.runAllStrategies(instrument);\n        signalsBySymbol.set(instrument.symbol, signals);\n      } catch (error) {\n        console.error(`[StrategyRegistry] Error analyzing ${instrument.symbol}:`, (error as Error).message);\n        signalsBySymbol.set(instrument.symbol, []);\n      }\n    }\n\n    return signalsBySymbol;\n  }\n\n  getLastResult(strategyId: string): StrategyResult | null {\n    return this.strategies.get(strategyId)?.lastResult || null;\n  }\n\n  getLastError(strategyId: string): Error | null {\n    return this.strategies.get(strategyId)?.lastError || null;\n  }\n\n  getStats(): {\n    totalStrategies: number;\n    enabledStrategies: number;\n    strategiesWithErrors: number;\n  } {\n    const entries = Array.from(this.strategies.values());\n    return {\n      totalStrategies: entries.length,\n      enabledStrategies: entries.filter(e => e.strategy.isEnabled).length,\n      strategiesWithErrors: entries.filter(e => e.lastError !== null).length,\n    };\n  }\n\n  enableStrategy(strategyId: string): boolean {\n    const entry = this.strategies.get(strategyId);\n    if (entry) {\n      entry.strategy.enable();\n      return true;\n    }\n    return false;\n  }\n\n  disableStrategy(strategyId: string): boolean {\n    const entry = this.strategies.get(strategyId);\n    if (entry) {\n      entry.strategy.disable();\n      return true;\n    }\n    return false;\n  }\n}\n\nexport const strategyRegistry = StrategyRegistry.getInstance();\n","size_bytes":5425},"server/strategies/smc/index.ts":{"content":"import { BaseStrategy } from '../core/baseStrategy';\nimport {\n  StrategyResult,\n  StrategySignal,\n  InstrumentData,\n  EntrySetup,\n  MultiTimeframeData,\n  SignalDirection,\n  Candle,\n  Timeframe,\n} from '../core/types';\nimport { SMC_STRATEGY_CONFIG, SMC_ENTRY_CONFIG } from './config';\nimport { analyzeH4Context, buildMarketContext, H4AnalysisResult } from './h4Context';\nimport { analyzeM15Zones, M15ZoneResult, findNearestUnmitigatedZone } from './m15Zones';\nimport { refineZoneToLowerTimeframe, RefinementResult } from './zoneRefinement';\nimport { detectEntry, EntryDetectionResult } from './entryDetection';\nimport { \n  selectBestTimeframes, \n  isMarketClear, \n  getMarketClarityStatus,\n  TimeframeSelection,\n  ClarityResult,\n} from './clarityAnalysis';\n\nexport class SMCStrategy extends BaseStrategy {\n  constructor() {\n    super(SMC_STRATEGY_CONFIG);\n  }\n\n  async analyze(instrument: InstrumentData): Promise<StrategyResult> {\n    const startTime = Date.now();\n    const signals: StrategySignal[] = [];\n    const pendingSetups: EntrySetup[] = [];\n    const errors: string[] = [];\n\n    try {\n      this.logAnalysis(`Analyzing ${instrument.symbol}...`);\n\n      const { data, currentPrice, symbol, assetClass } = instrument;\n\n      const tfSelection = selectBestTimeframes(\n        data.h4,\n        data.h2,\n        data.m30,\n        data.m15,\n        data.m5,\n        data.m3,\n        data.m1\n      );\n\n      this.logAnalysis(`Timeframe selection: ${tfSelection.contextTf}/${tfSelection.zoneTf}/${tfSelection.entryTf}`);\n      tfSelection.reasoning.forEach(r => this.logAnalysis(`  - ${r}`));\n\n      if (!isMarketClear(tfSelection)) {\n        this.logAnalysis(`Skipping ${symbol}: ${getMarketClarityStatus(tfSelection)}`);\n        return {\n          strategyId: this.id,\n          signals: [],\n          pendingSetups: [],\n          errors: [],\n          analysisTimeMs: Date.now() - startTime,\n        };\n      }\n\n      const contextCandles = this.getContextCandles(data, tfSelection.contextTf);\n      const h4Result = analyzeH4Context(contextCandles, currentPrice);\n      this.logAnalysis(`${tfSelection.contextTf} Control: ${h4Result.control}, Trend: ${h4Result.trend}`);\n\n      const zoneCandles = this.getZoneCandles(data, tfSelection.zoneTf);\n      const m15Result = analyzeM15Zones(zoneCandles, h4Result.control, currentPrice);\n      this.logAnalysis(`${tfSelection.zoneTf}: ${m15Result.tradableZones.length} tradable zones`);\n\n      if (m15Result.tradableZones.length === 0) {\n        this.logAnalysis('No tradable zones found, skipping...');\n        return {\n          strategyId: this.id,\n          signals: [],\n          pendingSetups: [],\n          errors: [],\n          analysisTimeMs: Date.now() - startTime,\n        };\n      }\n\n      for (const tradableZone of m15Result.tradableZones.slice(0, 3)) {\n        const refinementCandles = this.getRefinementCandles(data, tfSelection);\n        const refinementResult = refineZoneToLowerTimeframe(\n          tradableZone,\n          refinementCandles.intermediate,\n          refinementCandles.entry\n        );\n\n        const zoneToUse = refinementResult.refinedZone || tradableZone;\n        this.logAnalysis(`Using ${refinementResult.refinementLevel} zone for entry detection`);\n\n        const direction: SignalDirection = tradableZone.type === 'demand' ? 'buy' : 'sell';\n\n        const nearestTarget = direction === 'buy'\n          ? findNearestUnmitigatedZone(m15Result.unmitigatedSupply, currentPrice, 'above')\n            || h4Result.nearestSupplyTarget\n          : findNearestUnmitigatedZone(m15Result.unmitigatedDemand, currentPrice, 'below')\n            || h4Result.nearestDemandTarget;\n\n        const entryCandles = this.getEntryCandles(data, tfSelection.entryTf);\n        const entryResult = detectEntry(\n          entryCandles,\n          zoneToUse,\n          direction,\n          nearestTarget,\n          [...m15Result.allZones]\n        );\n\n        if (!entryResult.hasValidEntry) {\n          if (entryResult.setup && entryResult.setup.confidence >= 40) {\n            const pendingSetup = {\n              ...entryResult.setup,\n              symbol: instrument.symbol,\n              assetClass: instrument.assetClass,\n              direction: direction,\n              timeframe: tfSelection.zoneTf,\n            };\n            pendingSetups.push(pendingSetup);\n            this.logAnalysis(`Zone monitoring: ${direction} (${entryResult.setup.confidence}% confidence, awaiting entry)`);\n          }\n          continue;\n        }\n\n        if (entryResult.hasValidEntry && entryResult.setup) {\n          const lowerTfConfirmed = this.confirmOnLowerTimeframe(\n            data,\n            tfSelection.entryTf,\n            entryResult,\n            direction\n          );\n\n          if (!lowerTfConfirmed) {\n            this.logAnalysis(`Entry not confirmed on ${tfSelection.entryTf}, waiting...`);\n            if (entryResult.setup.confidence >= 50) {\n              const pendingSetup = {\n                ...entryResult.setup,\n                symbol: instrument.symbol,\n                assetClass: instrument.assetClass,\n                direction: direction,\n                timeframe: tfSelection.zoneTf,\n              };\n              pendingSetups.push(pendingSetup);\n              this.logAnalysis(`Added to watchlist: ${direction} (${entryResult.setup.confidence}%)`);\n            }\n            continue;\n          }\n\n          const confidence = entryResult.setup.confidence;\n\n          if (confidence >= this.minConfidence) {\n            const signal = this.buildSignal(\n              instrument,\n              entryResult,\n              h4Result,\n              m15Result,\n              refinementResult,\n              tfSelection,\n              data\n            );\n            signals.push(signal);\n            this.logAnalysis(`Signal generated: ${signal.direction} @ ${signal.entryPrice.toFixed(5)} (${confidence}% confidence)`);\n          } else if (confidence >= 50) {\n            pendingSetups.push(entryResult.setup);\n            this.logAnalysis(`Pending setup: ${direction} (${confidence}% confidence, needs ${this.minConfidence}%)`);\n          }\n        }\n      }\n\n    } catch (error) {\n      const err = error as Error;\n      errors.push(err.message);\n      this.logError('Analysis failed', err);\n    }\n\n    return {\n      strategyId: this.id,\n      signals,\n      pendingSetups,\n      errors,\n      analysisTimeMs: Date.now() - startTime,\n    };\n  }\n\n  private getContextCandles(data: MultiTimeframeData, tf: Timeframe): Candle[] {\n    switch (tf) {\n      case '4H': return data.h4;\n      case '2H': return data.h2;\n      default: return data.h4;\n    }\n  }\n\n  private getZoneCandles(data: MultiTimeframeData, tf: Timeframe): Candle[] {\n    switch (tf) {\n      case '15M': return data.m15;\n      case '30M': return data.m30;\n      default: return data.m15;\n    }\n  }\n\n  private getEntryCandles(data: MultiTimeframeData, tf: Timeframe): Candle[] {\n    switch (tf) {\n      case '5M': return data.m5;\n      case '3M': return data.m3;\n      case '1M': return data.m1;\n      default: return data.m5;\n    }\n  }\n\n  private getRefinementCandles(data: MultiTimeframeData, tfSelection: TimeframeSelection): { intermediate: Candle[], entry: Candle[] } {\n    if (tfSelection.zoneTf === '30M') {\n      return {\n        intermediate: data.m3,\n        entry: data.m1,\n      };\n    }\n\n    return {\n      intermediate: data.m5,\n      entry: tfSelection.entryTf === '1M' ? data.m1 : data.m3,\n    };\n  }\n\n  private confirmOnLowerTimeframe(\n    data: MultiTimeframeData,\n    entryTf: Timeframe,\n    entryResult: EntryDetectionResult,\n    direction: SignalDirection\n  ): boolean {\n    const entryCandles = this.getEntryCandles(data, entryTf);\n    if (entryCandles.length < 3) return false;\n\n    const lastCandle = entryCandles[entryCandles.length - 1];\n    const prevCandle = entryCandles[entryCandles.length - 2];\n\n    if (direction === 'buy') {\n      const bullishClose = lastCandle.close > lastCandle.open;\n      const higherLow = lastCandle.low > prevCandle.low;\n      const priceReaction = lastCandle.close > prevCandle.high;\n\n      return bullishClose && (higherLow || priceReaction);\n    } else {\n      const bearishClose = lastCandle.close < lastCandle.open;\n      const lowerHigh = lastCandle.high < prevCandle.high;\n      const priceReaction = lastCandle.close < prevCandle.low;\n\n      return bearishClose && (lowerHigh || priceReaction);\n    }\n  }\n\n  validateSetup(setup: EntrySetup, data: MultiTimeframeData): boolean {\n    if (setup.riskRewardRatio < SMC_ENTRY_CONFIG.minimumRiskReward) {\n      return false;\n    }\n\n    if (setup.confidence < this.minConfidence) {\n      return false;\n    }\n\n    const latestM1 = data.m1[data.m1.length - 1];\n    if (!latestM1) return false;\n\n    const currentPrice = latestM1.close;\n    const entryZone = setup.entryZone;\n\n    const isStillValid = currentPrice >= entryZone.bottomPrice * 0.995 &&\n                         currentPrice <= entryZone.topPrice * 1.005;\n\n    return isStillValid;\n  }\n\n  private buildSignal(\n    instrument: InstrumentData,\n    entryResult: EntryDetectionResult,\n    h4Result: H4AnalysisResult,\n    m15Result: M15ZoneResult,\n    refinementResult: RefinementResult,\n    tfSelection: TimeframeSelection,\n    data: MultiTimeframeData\n  ): StrategySignal {\n    const setup = entryResult.setup!;\n    const marketContext = buildMarketContext(h4Result, h4Result.swingPoints);\n\n    const allReasoning = [\n      `Context TF: ${tfSelection.contextTf} (clarity: ${tfSelection.contextClarity.score}%)`,\n      `Zone TF: ${tfSelection.zoneTf} (clarity: ${tfSelection.zoneClarity.score}%)`,\n      `Entry TF: ${tfSelection.entryTf} (clarity: ${tfSelection.entryClarity.score}%)`,\n      ...tfSelection.reasoning,\n      ...h4Result.reasoning,\n      ...m15Result.reasoning,\n      ...refinementResult.reasoning,\n      ...entryResult.reasoning,\n    ];\n\n    return {\n      id: this.createSignalId(),\n      strategyId: this.id,\n      strategyName: this.name,\n      symbol: instrument.symbol,\n      assetClass: instrument.assetClass,\n      direction: setup.direction,\n      entryType: setup.entryType,\n      entryPrice: setup.entryPrice,\n      stopLoss: setup.stopLoss,\n      takeProfit: setup.takeProfit,\n      riskRewardRatio: setup.riskRewardRatio,\n      confidence: setup.confidence,\n      timeframe: tfSelection.entryTf,\n      marketContext,\n      entrySetup: setup,\n      zones: {\n        h4: [...h4Result.unmitigatedSupply, ...h4Result.unmitigatedDemand],\n        m15: m15Result.allZones,\n        m5: [],\n        m1: [],\n      },\n      reasoning: allReasoning,\n      createdAt: Date.now(),\n      expiresAt: this.calculateExpiryTime(),\n    };\n  }\n}\n\nexport const smcStrategy = new SMCStrategy();\n","size_bytes":10713},"server/services/eodhd.ts":{"content":"import axios from 'axios';\nimport { db } from '../db';\nimport { economicEvents, InsertEconomicEvent } from '@shared/schema';\nimport { gte, and, eq } from 'drizzle-orm';\n\ninterface EODHDEvent {\n  date: string;\n  country: string;\n  actual: string | null;\n  previous: string | null;\n  estimate: string | null;\n  event: string;\n  impact: string;\n  change: string | null;\n  change_percentage: string | null;\n  unit: string | null;\n}\n\ninterface APICallLog {\n  timestamp: Date;\n  success: boolean;\n}\n\nclass EODHDService {\n  private apiKey: string | undefined;\n  private baseUrl = 'https://eodhd.com/api/economic-events';\n  private dailyCallLimit = 20;\n  private callsToday: APICallLog[] = [];\n  private lastResetDate: string = '';\n\n  constructor() {\n    this.apiKey = process.env.EODHD_API_KEY;\n  }\n\n  private resetDailyCounterIfNeeded(): void {\n    const today = new Date().toISOString().split('T')[0];\n    if (this.lastResetDate !== today) {\n      this.callsToday = [];\n      this.lastResetDate = today;\n      console.log('[EODHD] Daily API call counter reset');\n    }\n  }\n\n  getCallsRemaining(): number {\n    this.resetDailyCounterIfNeeded();\n    return this.dailyCallLimit - this.callsToday.length;\n  }\n\n  getCallsMadeToday(): number {\n    this.resetDailyCounterIfNeeded();\n    return this.callsToday.length;\n  }\n\n  canMakeCall(): boolean {\n    return this.getCallsRemaining() > 0 && !!this.apiKey;\n  }\n\n  private countryToCode(country: string): string {\n    const mapping: Record<string, string> = {\n      'USA': 'USD',\n      'United States': 'USD',\n      'Eurozone': 'EUR',\n      'Euro Area': 'EUR',\n      'Germany': 'EUR',\n      'France': 'EUR',\n      'Italy': 'EUR',\n      'Spain': 'EUR',\n      'United Kingdom': 'GBP',\n      'UK': 'GBP',\n      'Japan': 'JPY',\n      'Canada': 'CAD',\n      'Australia': 'AUD',\n      'New Zealand': 'NZD',\n      'Switzerland': 'CHF',\n      'China': 'CNY',\n    };\n    return mapping[country] || 'USD';\n  }\n\n  private getRegionFromCountry(country: string): string {\n    const regionMapping: Record<string, string> = {\n      'USA': 'Americas',\n      'United States': 'Americas',\n      'Canada': 'Americas',\n      'Eurozone': 'Europe',\n      'Euro Area': 'Europe',\n      'Germany': 'Europe',\n      'France': 'Europe',\n      'Italy': 'Europe',\n      'Spain': 'Europe',\n      'United Kingdom': 'Europe',\n      'UK': 'Europe',\n      'Switzerland': 'Europe',\n      'Japan': 'Asia',\n      'China': 'Asia',\n      'Australia': 'Asia-Pacific',\n      'New Zealand': 'Asia-Pacific',\n    };\n    return regionMapping[country] || 'Other';\n  }\n\n  private mapImpact(impact: string): 'High' | 'Medium' | 'Low' {\n    const impactLower = impact?.toLowerCase() || '';\n    if (impactLower === 'high' || impactLower === '3') return 'High';\n    if (impactLower === 'medium' || impactLower === '2') return 'Medium';\n    return 'Low';\n  }\n\n  async fetchEvents(fromDate?: string, toDate?: string): Promise<EODHDEvent[]> {\n    if (!this.apiKey) {\n      console.log('[EODHD] No API key configured');\n      return [];\n    }\n\n    if (!this.canMakeCall()) {\n      console.log(`[EODHD] Daily limit reached (${this.dailyCallLimit} calls). Using scraper fallback.`);\n      return [];\n    }\n\n    try {\n      const params: Record<string, string> = {\n        api_token: this.apiKey,\n        fmt: 'json',\n      };\n\n      if (fromDate) params.from = fromDate;\n      if (toDate) params.to = toDate;\n\n      console.log(`[EODHD] Fetching events (call ${this.callsToday.length + 1}/${this.dailyCallLimit})`);\n      \n      const response = await axios.get<EODHDEvent[]>(this.baseUrl, { \n        params,\n        timeout: 10000 \n      });\n\n      this.callsToday.push({ timestamp: new Date(), success: true });\n      \n      console.log(`[EODHD] Fetched ${response.data.length} events. Calls remaining: ${this.getCallsRemaining()}`);\n      \n      return response.data;\n    } catch (error) {\n      console.error('[EODHD] API error:', error);\n      this.callsToday.push({ timestamp: new Date(), success: false });\n      return [];\n    }\n  }\n\n  async fetchAndStoreEvents(): Promise<number> {\n    const today = new Date();\n    const nextWeek = new Date(today);\n    nextWeek.setDate(nextWeek.getDate() + 7);\n\n    const fromDate = today.toISOString().split('T')[0];\n    const toDate = nextWeek.toISOString().split('T')[0];\n\n    const events = await this.fetchEvents(fromDate, toDate);\n    \n    if (events.length === 0) {\n      return 0;\n    }\n\n    try {\n      const eventsToInsert: InsertEconomicEvent[] = events.map(event => {\n        const eventTime = new Date(event.date);\n        const currency = this.countryToCode(event.country);\n        \n        return {\n          title: event.event,\n          description: null,\n          eventType: 'economic',\n          country: event.country,\n          countryCode: currency,\n          region: this.getRegionFromCountry(event.country),\n          currency: currency,\n          impactLevel: this.mapImpact(event.impact),\n          eventTime: eventTime,\n          expectedValue: event.estimate || null,\n          previousValue: event.previous || null,\n          actualValue: event.actual || null,\n          unit: event.unit || null,\n          futuresImpliedExpectation: null,\n          surpriseFactor: event.change_percentage || null,\n          marketImpactAnalysis: null,\n          affectedCurrencies: [currency],\n          affectedStocks: null,\n          isReleased: !!event.actual,\n          sourceSite: 'EODHD',\n          sourceUrl: 'https://eodhd.com/api/economic-events',\n        };\n      });\n\n      await db.delete(economicEvents).where(\n        and(\n          gte(economicEvents.eventTime, new Date()),\n          eq(economicEvents.sourceSite, 'EODHD')\n        )\n      );\n\n      if (eventsToInsert.length > 0) {\n        await db.insert(economicEvents).values(eventsToInsert);\n      }\n\n      console.log(`[EODHD] Stored ${eventsToInsert.length} events in database`);\n      return eventsToInsert.length;\n    } catch (error) {\n      console.error('[EODHD] Error storing events:', error);\n      return 0;\n    }\n  }\n\n  getStatus(): { available: boolean; callsRemaining: number; callsMade: number } {\n    return {\n      available: !!this.apiKey,\n      callsRemaining: this.getCallsRemaining(),\n      callsMade: this.getCallsMadeToday(),\n    };\n  }\n}\n\nexport const eodhdService = new EODHDService();\n","size_bytes":6318},"server/services/eodhdScheduler.ts":{"content":"import cron, { ScheduledTask } from 'node-cron';\nimport { eodhdService } from './eodhd';\nimport { EconomicCalendarScraper } from '../scrapers/economicCalendarScraper';\nimport { CacheService } from '../scrapers/cacheService';\n\nclass EODHDScheduler {\n  private scraper: EconomicCalendarScraper;\n  private cacheService: CacheService;\n  private scheduledJobs: ScheduledTask[] = [];\n\n  constructor() {\n    this.scraper = new EconomicCalendarScraper();\n    this.cacheService = new CacheService();\n  }\n\n  async fetchWithFallback(): Promise<void> {\n    const status = eodhdService.getStatus();\n    \n    if (status.available && status.callsRemaining > 0) {\n      console.log(`[Scheduler] Using EODHD API (${status.callsRemaining} calls remaining)`);\n      const count = await eodhdService.fetchAndStoreEvents();\n      \n      if (count > 0) {\n        console.log(`[Scheduler] EODHD fetched ${count} events successfully`);\n        return;\n      }\n    }\n\n    console.log('[Scheduler] Falling back to web scraper');\n    try {\n      await this.cacheService.getOrFetchEvents('week', this.scraper);\n      console.log('[Scheduler] Scraper fallback completed');\n    } catch (error) {\n      console.error('[Scheduler] Scraper fallback failed:', error);\n    }\n  }\n\n  start(): void {\n    console.log('[EODHD Scheduler] Initializing smart API call distribution...');\n    \n    this.scheduledJobs.forEach(job => job.stop());\n    this.scheduledJobs = [];\n\n    this.scheduledJobs.push(\n      cron.schedule('50 7 * * 1-5', async () => {\n        console.log('[EODHD] Pre-London fetch #1 (10 min before open)');\n        await this.fetchWithFallback();\n      }, { timezone: 'Europe/London' })\n    );\n\n    this.scheduledJobs.push(\n      cron.schedule('55 7 * * 1-5', async () => {\n        console.log('[EODHD] Pre-London fetch #2 (5 min before open)');\n        await this.fetchWithFallback();\n      }, { timezone: 'Europe/London' })\n    );\n\n    this.scheduledJobs.push(\n      cron.schedule('20 9 * * 1-5', async () => {\n        console.log('[EODHD] Pre-NY fetch #1 (10 min before open)');\n        await this.fetchWithFallback();\n      }, { timezone: 'America/New_York' })\n    );\n\n    this.scheduledJobs.push(\n      cron.schedule('25 9 * * 1-5', async () => {\n        console.log('[EODHD] Pre-NY fetch #2 (5 min before open)');\n        await this.fetchWithFallback();\n      }, { timezone: 'America/New_York' })\n    );\n\n    const londonHours = [9, 10, 12, 14, 16];\n    londonHours.forEach((hour, index) => {\n      this.scheduledJobs.push(\n        cron.schedule(`0 ${hour} * * 1-5`, async () => {\n          console.log(`[EODHD] London session fetch #${index + 1}`);\n          await this.fetchWithFallback();\n        }, { timezone: 'Europe/London' })\n      );\n    });\n\n    const nyHours = [10, 11, 13, 14, 15];\n    nyHours.forEach((hour, index) => {\n      this.scheduledJobs.push(\n        cron.schedule(`30 ${hour} * * 1-5`, async () => {\n          console.log(`[EODHD] NY session fetch #${index + 1}`);\n          await this.fetchWithFallback();\n        }, { timezone: 'America/New_York' })\n      );\n    });\n\n    const offHours = [6, 18, 21];\n    offHours.forEach((hour, index) => {\n      this.scheduledJobs.push(\n        cron.schedule(`0 ${hour} * * 1-5`, async () => {\n          console.log(`[EODHD] Off-hours fetch #${index + 1}`);\n          await this.fetchWithFallback();\n        }, { timezone: 'UTC' })\n      );\n    });\n\n    this.scheduledJobs.push(\n      cron.schedule('0 12 * * 0,6', async () => {\n        console.log('[EODHD] Weekend maintenance fetch');\n        await this.fetchWithFallback();\n      }, { timezone: 'UTC' })\n    );\n\n    console.log('[EODHD Scheduler] Scheduled 20 strategic API calls:');\n    console.log('  - 2 calls: 10 & 5 min before London open (7:50, 7:55 GMT)');\n    console.log('  - 2 calls: 10 & 5 min before NY open (9:20, 9:25 EST)');\n    console.log('  - 5 calls: During London session (9, 10, 12, 14, 16 GMT)');\n    console.log('  - 5 calls: During NY session (10:30, 11:30, 13:30, 14:30, 15:30 EST)');\n    console.log('  - 3 calls: Off-hours coverage (6, 18, 21 UTC)');\n    console.log('  - 1 call: Weekend maintenance (12:00 UTC Sat/Sun)');\n    console.log('  - Fallback: Web scraper when API limit reached');\n\n    this.fetchWithFallback().then(() => {\n      console.log('[EODHD Scheduler] Initial fetch completed');\n    });\n  }\n\n  stop(): void {\n    this.scheduledJobs.forEach(job => job.stop());\n    this.scheduledJobs = [];\n    console.log('[EODHD Scheduler] Stopped all scheduled jobs');\n  }\n\n  getStatus(): {\n    apiStatus: { available: boolean; callsRemaining: number; callsMade: number };\n    scheduledJobs: number;\n  } {\n    return {\n      apiStatus: eodhdService.getStatus(),\n      scheduledJobs: this.scheduledJobs.length,\n    };\n  }\n}\n\nexport const eodhdScheduler = new EODHDScheduler();\n","size_bytes":4803},"server/static.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":777},"server/index.prod.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic, log } from \"./static\";\nimport { scraperScheduler } from \"./scrapers/scheduler\";\n\nconst app = express();\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // Production mode: serve static files only\n  serveStatic(app);\n\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n    \n    scraperScheduler.start();\n  });\n\n  process.on('SIGTERM', () => {\n    log('SIGTERM signal received: closing HTTP server');\n    scraperScheduler.stop();\n    server.close(() => {\n      log('HTTP server closed');\n    });\n  });\n\n  process.on('SIGINT', () => {\n    log('SIGINT signal received: closing HTTP server');\n    scraperScheduler.stop();\n    server.close(() => {\n      log('HTTP server closed');\n    });\n  });\n})();\n","size_bytes":2076}},"version":2}